const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/layout-BYZgOmdH.js","assets/index-CN3ze4F8.js","assets/index-BSwivPqU.css","assets/HomePage-CFPbNzW9.js","assets/Videocam--KrnGtRh.js","assets/Room-Bm2pVfnT.js"])))=>i.map(i=>d[i]);
var g0=Object.defineProperty;var v0=(r,a,d)=>a in r?g0(r,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[a]=d;var yt=(r,a,d)=>v0(r,typeof a!="symbol"?a+"":a,d);import{r as ae,t as Zh,e as sc,j as ut,o as vf,c as y0,g as b0,_ as zp}from"./index-CN3ze4F8.js";/**
 * @remix-run/router v1.3.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rn(){return Rn=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&(r[p]=d[p])}return r},Rn.apply(this,arguments)}var Fr;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(Fr||(Fr={}));const Am="popstate";function S0(r){r===void 0&&(r={});function a(p,g){let{pathname:R,search:E,hash:w}=p.location;return ef("",{pathname:R,search:E,hash:w},g.state&&g.state.usr||null,g.state&&g.state.key||"default")}function d(p,g){return typeof g=="string"?g:Gl(g)}return _0(a,d,null,r)}function $t(r,a){if(r===!1||r===null||typeof r>"u")throw new Error(a)}function E0(){return Math.random().toString(36).substr(2,8)}function Pm(r,a){return{usr:r.state,key:r.key,idx:a}}function ef(r,a,d,p){return d===void 0&&(d=null),Rn({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof a=="string"?Zc(a):a,{state:d,key:a&&a.key||p||E0()})}function Gl(r){let{pathname:a="/",search:d="",hash:p=""}=r;return d&&d!=="?"&&(a+=d.charAt(0)==="?"?d:"?"+d),p&&p!=="#"&&(a+=p.charAt(0)==="#"?p:"#"+p),a}function Zc(r){let a={};if(r){let d=r.indexOf("#");d>=0&&(a.hash=r.substr(d),r=r.substr(0,d));let p=r.indexOf("?");p>=0&&(a.search=r.substr(p),r=r.substr(0,p)),r&&(a.pathname=r)}return a}function _0(r,a,d,p){p===void 0&&(p={});let{window:g=document.defaultView,v5Compat:R=!1}=p,E=g.history,w=Fr.Pop,m=null,S=b();S==null&&(S=0,E.replaceState(Rn({},E.state,{idx:S}),""));function b(){return(E.state||{idx:null}).idx}function I(){w=Fr.Pop;let O=b(),j=O==null?null:O-S;S=O,m&&m({action:w,location:v.location,delta:j})}function _(O,j){w=Fr.Push;let D=ef(v.location,O,j);S=b()+1;let x=Pm(D,S),N=v.createHref(D);try{E.pushState(x,"",N)}catch{g.location.assign(N)}R&&m&&m({action:w,location:v.location,delta:1})}function A(O,j){w=Fr.Replace;let D=ef(v.location,O,j);S=b();let x=Pm(D,S),N=v.createHref(D);E.replaceState(x,"",N),R&&m&&m({action:w,location:v.location,delta:0})}function C(O){let j=g.location.origin!=="null"?g.location.origin:g.location.href,D=typeof O=="string"?O:Gl(O);return $t(j,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,j)}let v={get action(){return w},get location(){return r(g,E)},listen(O){if(m)throw new Error("A history only accepts one active listener");return g.addEventListener(Am,I),m=O,()=>{g.removeEventListener(Am,I),m=null}},createHref(O){return a(g,O)},createURL:C,encodeLocation(O){let j=C(O);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:_,replace:A,go(O){return E.go(O)}};return v}var Ai;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Ai||(Ai={}));function C0(r){return r.index===!0}function $g(r,a,d){return a===void 0&&(a=[]),d===void 0&&(d=new Set),r.map((p,g)=>{let R=[...a,g],E=typeof p.id=="string"?p.id:R.join("-");return $t(p.index!==!0||!p.children,"Cannot specify children on an index route"),$t(!d.has(E),'Found a route id collision on id "'+E+`".  Route id's must be globally unique within Data Router usages`),d.add(E),C0(p)?Rn({},p,{id:E}):Rn({},p,{id:E,children:p.children?$g(p.children,R,d):void 0})})}function zh(r,a,d){d===void 0&&(d="/");let p=typeof a=="string"?Zc(a):a,g=Gg(p.pathname||"/",d);if(g==null)return null;let R=Vg(r);T0(R);let E=null;for(let w=0;E==null&&w<R.length;++w)E=D0(R[w],L0(g));return E}function Vg(r,a,d,p){a===void 0&&(a=[]),d===void 0&&(d=[]),p===void 0&&(p="");let g=(R,E,w)=>{let m={relativePath:w===void 0?R.path||"":w,caseSensitive:R.caseSensitive===!0,childrenIndex:E,route:R};m.relativePath.startsWith("/")&&($t(m.relativePath.startsWith(p),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+p+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(p.length));let S=Xu([p,m.relativePath]),b=d.concat(m);R.children&&R.children.length>0&&($t(R.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+S+'".')),Vg(R.children,a,b,S)),!(R.path==null&&!R.index)&&a.push({path:S,score:P0(S,R.index),routesMeta:b})};return r.forEach((R,E)=>{var w;if(R.path===""||!((w=R.path)!=null&&w.includes("?")))g(R,E);else for(let m of Wg(R.path))g(R,E,m)}),a}function Wg(r){let a=r.split("/");if(a.length===0)return[];let[d,...p]=a,g=d.endsWith("?"),R=d.replace(/\?$/,"");if(p.length===0)return g?[R,""]:[R];let E=Wg(p.join("/")),w=[];return w.push(...E.map(m=>m===""?R:[R,m].join("/"))),g&&w.push(...E),w.map(m=>r.startsWith("/")&&m===""?"/":m)}function T0(r){r.sort((a,d)=>a.score!==d.score?d.score-a.score:x0(a.routesMeta.map(p=>p.childrenIndex),d.routesMeta.map(p=>p.childrenIndex)))}const R0=/^:\w+$/,w0=3,I0=2,k0=1,O0=10,A0=-2,xm=r=>r==="*";function P0(r,a){let d=r.split("/"),p=d.length;return d.some(xm)&&(p+=A0),a&&(p+=I0),d.filter(g=>!xm(g)).reduce((g,R)=>g+(R0.test(R)?w0:R===""?k0:O0),p)}function x0(r,a){return r.length===a.length&&r.slice(0,-1).every((p,g)=>p===a[g])?r[r.length-1]-a[a.length-1]:0}function D0(r,a){let{routesMeta:d}=r,p={},g="/",R=[];for(let E=0;E<d.length;++E){let w=d[E],m=E===d.length-1,S=g==="/"?a:a.slice(g.length)||"/",b=M0({path:w.relativePath,caseSensitive:w.caseSensitive,end:m},S);if(!b)return null;Object.assign(p,b.params);let I=w.route;R.push({params:p,pathname:Xu([g,b.pathname]),pathnameBase:F0(Xu([g,b.pathnameBase])),route:I}),b.pathnameBase!=="/"&&(g=Xu([g,b.pathnameBase]))}return R}function M0(r,a){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[d,p]=N0(r.path,r.caseSensitive,r.end),g=a.match(d);if(!g)return null;let R=g[0],E=R.replace(/(.)\/+$/,"$1"),w=g.slice(1);return{params:p.reduce((S,b,I)=>{if(b==="*"){let _=w[I]||"";E=R.slice(0,R.length-_.length).replace(/(.)\/+$/,"$1")}return S[b]=B0(w[I]||"",b),S},{}),pathname:R,pathnameBase:E,pattern:r}}function N0(r,a,d){a===void 0&&(a=!1),d===void 0&&(d=!0),tf(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let p=[],g="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(E,w)=>(p.push(w),"/([^\\/]+)"));return r.endsWith("*")?(p.push("*"),g+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):d?g+="\\/*$":r!==""&&r!=="/"&&(g+="(?:(?=\\/|$))"),[new RegExp(g,a?void 0:"i"),p]}function L0(r){try{return decodeURI(r)}catch(a){return tf(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),r}}function B0(r,a){try{return decodeURIComponent(r)}catch(d){return tf(!1,'The value for the URL param "'+a+'" will not be decoded because'+(' the string "'+r+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+d+").")),r}}function Gg(r,a){if(a==="/")return r;if(!r.toLowerCase().startsWith(a.toLowerCase()))return null;let d=a.endsWith("/")?a.length-1:a.length,p=r.charAt(d);return p&&p!=="/"?null:r.slice(d)||"/"}function tf(r,a){if(!r){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function j0(r,a){a===void 0&&(a="/");let{pathname:d,search:p="",hash:g=""}=typeof r=="string"?Zc(r):r;return{pathname:d?d.startsWith("/")?d:U0(d,a):a,search:$0(p),hash:V0(g)}}function U0(r,a){let d=a.replace(/\/+$/,"").split("/");return r.split("/").forEach(g=>{g===".."?d.length>1&&d.pop():g!=="."&&d.push(g)}),d.length>1?d.join("/"):"/"}function _p(r,a,d,p){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(p)+"].  Please separate it out to the ")+("`to."+d+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qp(r){return r.filter((a,d)=>d===0||a.route.path&&a.route.path.length>0)}function Hg(r,a,d,p){p===void 0&&(p=!1);let g;typeof r=="string"?g=Zc(r):(g=Rn({},r),$t(!g.pathname||!g.pathname.includes("?"),_p("?","pathname","search",g)),$t(!g.pathname||!g.pathname.includes("#"),_p("#","pathname","hash",g)),$t(!g.search||!g.search.includes("#"),_p("#","search","hash",g)));let R=r===""||g.pathname==="",E=R?"/":g.pathname,w;if(p||E==null)w=d;else{let I=a.length-1;if(E.startsWith("..")){let _=E.split("/");for(;_[0]==="..";)_.shift(),I-=1;g.pathname=_.join("/")}w=I>=0?a[I]:"/"}let m=j0(g,w),S=E&&E!=="/"&&E.endsWith("/"),b=(R||E===".")&&d.endsWith("/");return!m.pathname.endsWith("/")&&(S||b)&&(m.pathname+="/"),m}const Xu=r=>r.join("/").replace(/\/\/+/g,"/"),F0=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),$0=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,V0=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;class Dm extends Error{}class W0{constructor(a,d){this.pendingKeysSet=new Set,this.subscribers=new Set,this.deferredKeys=[],$t(a&&typeof a=="object"&&!Array.isArray(a),"defer() only accepts plain objects");let p;this.abortPromise=new Promise((R,E)=>p=E),this.controller=new AbortController;let g=()=>p(new Dm("Deferred data aborted"));this.unlistenAbortSignal=()=>this.controller.signal.removeEventListener("abort",g),this.controller.signal.addEventListener("abort",g),this.data=Object.entries(a).reduce((R,E)=>{let[w,m]=E;return Object.assign(R,{[w]:this.trackPromise(w,m)})},{}),this.done&&this.unlistenAbortSignal(),this.init=d}trackPromise(a,d){if(!(d instanceof Promise))return d;this.deferredKeys.push(a),this.pendingKeysSet.add(a);let p=Promise.race([d,this.abortPromise]).then(g=>this.onSettle(p,a,null,g),g=>this.onSettle(p,a,g));return p.catch(()=>{}),Object.defineProperty(p,"_tracked",{get:()=>!0}),p}onSettle(a,d,p,g){return this.controller.signal.aborted&&p instanceof Dm?(this.unlistenAbortSignal(),Object.defineProperty(a,"_error",{get:()=>p}),Promise.reject(p)):(this.pendingKeysSet.delete(d),this.done&&this.unlistenAbortSignal(),p?(Object.defineProperty(a,"_error",{get:()=>p}),this.emit(!1,d),Promise.reject(p)):(Object.defineProperty(a,"_data",{get:()=>g}),this.emit(!1,d),g))}emit(a,d){this.subscribers.forEach(p=>p(a,d))}subscribe(a){return this.subscribers.add(a),()=>this.subscribers.delete(a)}cancel(){this.controller.abort(),this.pendingKeysSet.forEach((a,d)=>this.pendingKeysSet.delete(d)),this.emit(!0)}async resolveData(a){let d=!1;if(!this.done){let p=()=>this.cancel();a.addEventListener("abort",p),d=await new Promise(g=>{this.subscribe(R=>{a.removeEventListener("abort",p),(R||this.done)&&g(R)})})}return d}get done(){return this.pendingKeysSet.size===0}get unwrappedData(){return $t(this.data!==null&&this.done,"Can only unwrap data on initialized and settled deferreds"),Object.entries(this.data).reduce((a,d)=>{let[p,g]=d;return Object.assign(a,{[p]:H0(g)})},{})}get pendingKeys(){return Array.from(this.pendingKeysSet)}}function G0(r){return r instanceof Promise&&r._tracked===!0}function H0(r){if(!G0(r))return r;if(r._error)throw r._error;return r._data}class Kp{constructor(a,d,p,g){g===void 0&&(g=!1),this.status=a,this.statusText=d||"",this.internal=g,p instanceof Error?(this.data=p.toString(),this.error=p):this.data=p}}function zg(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const qg=["post","put","patch","delete"],z0=new Set(qg),q0=["get",...qg],K0=new Set(q0),Y0=new Set([301,302,303,307,308]),J0=new Set([307,308]),Cp={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},X0={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},Mm={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Kg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Q0=!Kg;function Z0(r){$t(r.routes.length>0,"You must provide a non-empty routes array to createRouter");let a=$g(r.routes),d=null,p=new Set,g=null,R=null,E=null,w=r.hydrationData!=null,m=zh(a,r.history.location,r.basename),S=null;if(m==null){let me=Yu(404,{pathname:r.history.location.pathname}),{matches:Ee,route:ke}=Fm(a);m=Ee,S={[ke.id]:me}}let b=!m.some(me=>me.route.loader)||r.hydrationData!=null,I,_={historyAction:r.history.action,location:r.history.location,matches:m,initialized:b,navigation:Cp,restoreScrollPosition:r.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:r.hydrationData&&r.hydrationData.loaderData||{},actionData:r.hydrationData&&r.hydrationData.actionData||null,errors:r.hydrationData&&r.hydrationData.errors||S,fetchers:new Map,blockers:new Map},A=Fr.Pop,C=!1,v,O=!1,j=!1,D=[],x=[],N=new Map,$=0,H=-1,K=new Map,ce=new Set,Q=new Map,Z=new Map,Se=null,G=new Map,ie=!1;function de(){return d=r.history.listen(me=>{let{action:Ee,location:ke,delta:$e}=me;if(ie){ie=!1;return}tf(Se!=null&&$e===null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Te=Di({currentLocation:_.location,nextLocation:ke,historyAction:Ee});if(Te&&$e!=null){ie=!0,r.history.go($e*-1),xi(Te,{state:"blocked",location:ke,proceed(){xi(Te,{state:"proceeding",proceed:void 0,reset:void 0,location:ke}),r.history.go($e)},reset(){Qt(Te),W({blockers:new Map(I.state.blockers)})}});return}return Ie(Ee,ke)}),_.initialized||Ie(Fr.Pop,_.location),I}function ne(){d&&d(),p.clear(),v&&v.abort(),_.fetchers.forEach((me,Ee)=>gn(Ee)),_.blockers.forEach((me,Ee)=>Qt(Ee))}function J(me){return p.add(me),()=>p.delete(me)}function W(me){_=Rn({},_,me),p.forEach(Ee=>Ee(_))}function X(me,Ee){var ke,$e;let Te=_.actionData!=null&&_.navigation.formMethod!=null&&Yc(_.navigation.formMethod)&&_.navigation.state==="loading"&&((ke=me.state)==null?void 0:ke._isRedirect)!==!0,tt;Ee.actionData?Object.keys(Ee.actionData).length>0?tt=Ee.actionData:tt=null:Te?tt=_.actionData:tt=null;let lt=Ee.loaderData?Um(_.loaderData,Ee.loaderData,Ee.matches||[],Ee.errors):_.loaderData;for(let[Be]of G)Qt(Be);let Ve=C===!0||_.navigation.formMethod!=null&&Yc(_.navigation.formMethod)&&(($e=me.state)==null?void 0:$e._isRedirect)!==!0;W(Rn({},Ee,{actionData:tt,loaderData:lt,historyAction:A,location:me,initialized:!0,navigation:Cp,revalidation:"idle",restoreScrollPosition:Wr(me,Ee.matches||_.matches),preventScrollReset:Ve,blockers:new Map(_.blockers)})),O||A===Fr.Pop||(A===Fr.Push?r.history.push(me,me.state):A===Fr.Replace&&r.history.replace(me,me.state)),A=Fr.Pop,C=!1,O=!1,j=!1,D=[],x=[]}async function se(me,Ee){if(typeof me=="number"){r.history.go(me);return}let{path:ke,submission:$e,error:Te}=Nm(me,Ee),tt=_.location,lt=ef(_.location,ke,Ee&&Ee.state);lt=Rn({},lt,r.history.encodeLocation(lt));let Ve=Ee&&Ee.replace!=null?Ee.replace:void 0,Be=Fr.Push;Ve===!0?Be=Fr.Replace:Ve===!1||$e!=null&&Yc($e.formMethod)&&$e.formAction===_.location.pathname+_.location.search&&(Be=Fr.Replace);let Hn=Ee&&"preventScrollReset"in Ee?Ee.preventScrollReset===!0:void 0,Dt=Di({currentLocation:tt,nextLocation:lt,historyAction:Be});if(Dt){xi(Dt,{state:"blocked",location:lt,proceed(){xi(Dt,{state:"proceeding",proceed:void 0,reset:void 0,location:lt}),se(me,Ee)},reset(){Qt(Dt),W({blockers:new Map(_.blockers)})}});return}return await Ie(Be,lt,{submission:$e,pendingError:Te,preventScrollReset:Hn,replace:Ee&&Ee.replace})}function he(){if(At(),W({revalidation:"loading"}),_.navigation.state!=="submitting"){if(_.navigation.state==="idle"){Ie(_.historyAction,_.location,{startUninterruptedRevalidation:!0});return}Ie(A||_.historyAction,_.navigation.location,{overrideNavigation:_.navigation})}}async function Ie(me,Ee,ke){v&&v.abort(),v=null,A=me,O=(ke&&ke.startUninterruptedRevalidation)===!0,lr(_.location,_.matches),C=(ke&&ke.preventScrollReset)===!0;let $e=ke&&ke.overrideNavigation,Te=zh(a,Ee,r.basename);if(!Te){let Mt=Yu(404,{pathname:Ee.pathname}),{matches:Ke,route:Pr}=Fm(a);oi(),X(Ee,{matches:Ke,loaderData:{},errors:{[Pr.id]:Mt}});return}if(iy(_.location,Ee)&&!(ke&&ke.submission&&Yc(ke.submission.formMethod))){X(Ee,{matches:Te});return}v=new AbortController;let tt=$h(r.history,Ee,v.signal,ke&&ke.submission),lt,Ve;if(ke&&ke.pendingError)Ve={[Hd(Te).route.id]:ke.pendingError};else if(ke&&ke.submission&&Yc(ke.submission.formMethod)){let Mt=await we(tt,Ee,ke.submission,Te,{replace:ke.replace});if(Mt.shortCircuited)return;lt=Mt.pendingActionData,Ve=Mt.pendingActionError,$e=Rn({state:"loading",location:Ee},ke.submission),tt=new Request(tt.url,{signal:tt.signal})}let{shortCircuited:Be,loaderData:Hn,errors:Dt}=await Qe(tt,Ee,Te,$e,ke&&ke.submission,ke&&ke.replace,lt,Ve);Be||(v=null,X(Ee,Rn({matches:Te},lt?{actionData:lt}:{},{loaderData:Hn,errors:Dt})))}async function we(me,Ee,ke,$e,Te){At();let tt=Rn({state:"submitting",location:Ee},ke);W({navigation:tt});let lt,Ve=Gm($e,Ee);if(!Ve.route.action)lt={type:Ai.error,error:Yu(405,{method:me.method,pathname:Ee.pathname,routeId:Ve.route.id})};else if(lt=await Fh("action",me,Ve,$e,I.basename),me.signal.aborted)return{shortCircuited:!0};if(zd(lt)){let Be;return Te&&Te.replace!=null?Be=Te.replace:Be=lt.location===_.location.pathname+_.location.search,await Ht(_,lt,{submission:ke,replace:Be}),{shortCircuited:!0}}if(Kh(lt)){let Be=Hd($e,Ve.route.id);return(Te&&Te.replace)!==!0&&(A=Fr.Push),{pendingActionData:{},pendingActionError:{[Be.route.id]:lt.error}}}if($l(lt))throw Yu(400,{type:"defer-action"});return{pendingActionData:{[Ve.route.id]:lt.data}}}async function Qe(me,Ee,ke,$e,Te,tt,lt,Ve){let Be=$e;Be||(Be=Rn({state:"loading",location:Ee,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},Te));let Hn=Te||(Be.formMethod&&Be.formAction&&Be.formData&&Be.formEncType?{formMethod:Be.formMethod,formAction:Be.formAction,formData:Be.formData,formEncType:Be.formEncType}:void 0),[Dt,Mt]=Lm(r.history,_,ke,Hn,Ee,j,D,x,lt,Ve,Q);if(oi(oe=>!(ke&&ke.some(fe=>fe.route.id===oe))||Dt&&Dt.some(fe=>fe.route.id===oe)),Dt.length===0&&Mt.length===0)return X(Ee,Rn({matches:ke,loaderData:{},errors:Ve||null},lt?{actionData:lt}:{})),{shortCircuited:!0};if(!O){Mt.forEach(fe=>{let Ce=_.fetchers.get(fe.key),xe={state:"loading",data:Ce&&Ce.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};_.fetchers.set(fe.key,xe)});let oe=lt||_.actionData;W(Rn({navigation:Be},oe?Object.keys(oe).length===0?{actionData:null}:{actionData:oe}:{},Mt.length>0?{fetchers:new Map(_.fetchers)}:{}))}H=++$,Mt.forEach(oe=>N.set(oe.key,v));let{results:Ke,loaderResults:Pr,fetcherResults:xr}=await Ge(_.matches,ke,Dt,Mt,me);if(me.signal.aborted)return{shortCircuited:!0};Mt.forEach(oe=>N.delete(oe.key));let Mo=$m(Ke);if(Mo)return await Ht(_,Mo,{replace:tt}),{shortCircuited:!0};let{loaderData:Mi,errors:mi}=jm(_,ke,Dt,Pr,Ve,Mt,xr,Z);Z.forEach((oe,fe)=>{oe.subscribe(Ce=>{(Ce||oe.done)&&Z.delete(fe)})}),it();let Zi=Ar(H);return Rn({loaderData:Mi,errors:mi},Zi||Mt.length>0?{fetchers:new Map(_.fetchers)}:{})}function Tt(me){return _.fetchers.get(me)||X0}function vt(me,Ee,ke,$e){if(Q0)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");N.has(me)&&Dn(me);let Te=zh(a,ke,r.basename);if(!Te){rn(me,Ee,Yu(404,{pathname:ke}));return}let{path:tt,submission:lt}=Nm(ke,$e,!0),Ve=Gm(Te,tt);if(C=($e&&$e.preventScrollReset)===!0,lt&&Yc(lt.formMethod)){Ut(me,Ee,tt,Ve,Te,lt);return}Q.set(me,{routeId:Ee,path:tt,match:Ve,matches:Te}),Vt(me,Ee,tt,Ve,Te,lt)}async function Ut(me,Ee,ke,$e,Te,tt){if(At(),Q.delete(me),!$e.route.action){let nt=Yu(405,{method:tt.formMethod,pathname:ke,routeId:Ee});rn(me,Ee,nt);return}let lt=_.fetchers.get(me),Ve=Rn({state:"submitting"},tt,{data:lt&&lt.data," _hasFetcherDoneAnything ":!0});_.fetchers.set(me,Ve),W({fetchers:new Map(_.fetchers)});let Be=new AbortController,Hn=$h(r.history,ke,Be.signal,tt);N.set(me,Be);let Dt=await Fh("action",Hn,$e,Te,I.basename);if(Hn.signal.aborted){N.get(me)===Be&&N.delete(me);return}if(zd(Dt)){N.delete(me),ce.add(me);let nt=Rn({state:"loading"},tt,{data:void 0," _hasFetcherDoneAnything ":!0});return _.fetchers.set(me,nt),W({fetchers:new Map(_.fetchers)}),Ht(_,Dt,{isFetchActionRedirect:!0})}if(Kh(Dt)){rn(me,Ee,Dt.error);return}if($l(Dt))throw Yu(400,{type:"defer-action"});let Mt=_.navigation.location||_.location,Ke=$h(r.history,Mt,Be.signal),Pr=_.navigation.state!=="idle"?zh(a,_.navigation.location,r.basename):_.matches;$t(Pr,"Didn't find any matches after fetcher action");let xr=++$;K.set(me,xr);let Mo=Rn({state:"loading",data:Dt.data},tt,{" _hasFetcherDoneAnything ":!0});_.fetchers.set(me,Mo);let[Mi,mi]=Lm(r.history,_,Pr,tt,Mt,j,D,x,{[$e.route.id]:Dt.data},void 0,Q);mi.filter(nt=>nt.key!==me).forEach(nt=>{let Ye=nt.key,je=_.fetchers.get(Ye),Ze={state:"loading",data:je&&je.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};_.fetchers.set(Ye,Ze),N.set(Ye,Be)}),W({fetchers:new Map(_.fetchers)});let{results:Zi,loaderResults:oe,fetcherResults:fe}=await Ge(_.matches,Pr,Mi,mi,Ke);if(Be.signal.aborted)return;K.delete(me),N.delete(me),mi.forEach(nt=>N.delete(nt.key));let Ce=$m(Zi);if(Ce)return Ht(_,Ce);let{loaderData:xe,errors:dt}=jm(_,_.matches,Mi,oe,void 0,mi,fe,Z),vn={state:"idle",data:Dt.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};_.fetchers.set(me,vn);let bt=Ar(xr);_.navigation.state==="loading"&&xr>H?($t(A,"Expected pending action"),v&&v.abort(),X(_.navigation.location,{matches:Pr,loaderData:xe,errors:dt,fetchers:new Map(_.fetchers)})):(W(Rn({errors:dt,loaderData:Um(_.loaderData,xe,Pr,dt)},bt?{fetchers:new Map(_.fetchers)}:{})),j=!1)}async function Vt(me,Ee,ke,$e,Te,tt){let lt=_.fetchers.get(me),Ve=Rn({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},tt,{data:lt&&lt.data," _hasFetcherDoneAnything ":!0});_.fetchers.set(me,Ve),W({fetchers:new Map(_.fetchers)});let Be=new AbortController,Hn=$h(r.history,ke,Be.signal);N.set(me,Be);let Dt=await Fh("loader",Hn,$e,Te,I.basename);if($l(Dt)&&(Dt=await Qg(Dt,Hn.signal,!0)||Dt),N.get(me)===Be&&N.delete(me),Hn.signal.aborted)return;if(zd(Dt)){await Ht(_,Dt);return}if(Kh(Dt)){let Ke=Hd(_.matches,Ee);_.fetchers.delete(me),W({fetchers:new Map(_.fetchers),errors:{[Ke.route.id]:Dt.error}});return}$t(!$l(Dt),"Unhandled fetcher deferred data");let Mt={state:"idle",data:Dt.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};_.fetchers.set(me,Mt),W({fetchers:new Map(_.fetchers)})}async function Ht(me,Ee,ke){var $e;let{submission:Te,replace:tt,isFetchActionRedirect:lt}=ke===void 0?{}:ke;Ee.revalidate&&(j=!0);let Ve=ef(me.location,Ee.location,Rn({_isRedirect:!0},lt?{_isFetchActionRedirect:!0}:{}));if($t(Ve,"Expected a location on the redirect navigation"),Kg&&typeof(($e=window)==null?void 0:$e.location)<"u"){let Pr=r.history.createURL(Ee.location).origin;if(window.location.origin!==Pr){tt?window.location.replace(Ee.location):window.location.assign(Ee.location);return}}v=null;let Be=tt===!0?Fr.Replace:Fr.Push,{formMethod:Hn,formAction:Dt,formEncType:Mt,formData:Ke}=me.navigation;!Te&&Hn&&Dt&&Ke&&Mt&&(Te={formMethod:Hn,formAction:Dt,formEncType:Mt,formData:Ke}),J0.has(Ee.status)&&Te&&Yc(Te.formMethod)?await Ie(Be,Ve,{submission:Rn({},Te,{formAction:Ee.location}),preventScrollReset:C}):await Ie(Be,Ve,{overrideNavigation:{state:"loading",location:Ve,formMethod:Te?Te.formMethod:void 0,formAction:Te?Te.formAction:void 0,formEncType:Te?Te.formEncType:void 0,formData:Te?Te.formData:void 0},preventScrollReset:C})}async function Ge(me,Ee,ke,$e,Te){let tt=await Promise.all([...ke.map(Be=>Fh("loader",Te,Be,Ee,I.basename)),...$e.map(Be=>Fh("loader",$h(r.history,Be.path,Te.signal),Be.match,Be.matches,I.basename))]),lt=tt.slice(0,ke.length),Ve=tt.slice(ke.length);return await Promise.all([Vm(me,ke,lt,Te.signal,!1,_.loaderData),Vm(me,$e.map(Be=>Be.match),Ve,Te.signal,!0)]),{results:tt,loaderResults:lt,fetcherResults:Ve}}function At(){j=!0,D.push(...oi()),Q.forEach((me,Ee)=>{N.has(Ee)&&(x.push(Ee),Dn(Ee))})}function rn(me,Ee,ke){let $e=Hd(_.matches,Ee);gn(me),W({errors:{[$e.route.id]:ke},fetchers:new Map(_.fetchers)})}function gn(me){N.has(me)&&Dn(me),Q.delete(me),K.delete(me),ce.delete(me),_.fetchers.delete(me)}function Dn(me){let Ee=N.get(me);$t(Ee,"Expected fetch controller: "+me),Ee.abort(),N.delete(me)}function ur(me){for(let Ee of me){let $e={state:"idle",data:Tt(Ee).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};_.fetchers.set(Ee,$e)}}function it(){let me=[];for(let Ee of ce){let ke=_.fetchers.get(Ee);$t(ke,"Expected fetcher: "+Ee),ke.state==="loading"&&(ce.delete(Ee),me.push(Ee))}ur(me)}function Ar(me){let Ee=[];for(let[ke,$e]of K)if($e<me){let Te=_.fetchers.get(ke);$t(Te,"Expected fetcher: "+ke),Te.state==="loading"&&(Dn(ke),K.delete(ke),Ee.push(ke))}return ur(Ee),Ee.length>0}function ra(me,Ee){let ke=_.blockers.get(me)||Mm;return G.get(me)!==Ee&&(G.set(me,Ee),Se==null?Se=me:me!==Se&&tf(!1,"A router only supports one blocker at a time")),ke}function Qt(me){_.blockers.delete(me),G.delete(me),Se===me&&(Se=null)}function xi(me,Ee){let ke=_.blockers.get(me)||Mm;$t(ke.state==="unblocked"&&Ee.state==="blocked"||ke.state==="blocked"&&Ee.state==="blocked"||ke.state==="blocked"&&Ee.state==="proceeding"||ke.state==="blocked"&&Ee.state==="unblocked"||ke.state==="proceeding"&&Ee.state==="unblocked","Invalid blocker state transition: "+ke.state+" -> "+Ee.state),_.blockers.set(me,Ee),W({blockers:new Map(_.blockers)})}function Di(me){let{currentLocation:Ee,nextLocation:ke,historyAction:$e}=me;if(Se==null)return;let Te=G.get(Se);$t(Te,"Could not find a function for the active blocker");let tt=_.blockers.get(Se);if(!(tt&&tt.state==="proceeding")&&Te({currentLocation:Ee,nextLocation:ke,historyAction:$e}))return Se}function oi(me){let Ee=[];return Z.forEach((ke,$e)=>{(!me||me($e))&&(ke.cancel(),Ee.push($e),Z.delete($e))}),Ee}function Qi(me,Ee,ke){if(g=me,E=Ee,R=ke||($e=>$e.key),!w&&_.navigation===Cp){w=!0;let $e=Wr(_.location,_.matches);$e!=null&&W({restoreScrollPosition:$e})}return()=>{g=null,E=null,R=null}}function lr(me,Ee){if(g&&R&&E){let ke=Ee.map(Te=>Wm(Te,_.loaderData)),$e=R(me,ke)||me.key;g[$e]=E()}}function Wr(me,Ee){if(g&&R&&E){let ke=Ee.map(tt=>Wm(tt,_.loaderData)),$e=R(me,ke)||me.key,Te=g[$e];if(typeof Te=="number")return Te}return null}return I={get basename(){return r.basename},get state(){return _},get routes(){return a},initialize:de,subscribe:J,enableScrollRestoration:Qi,navigate:se,fetch:vt,revalidate:he,createHref:me=>r.history.createHref(me),encodeLocation:me=>r.history.encodeLocation(me),getFetcher:Tt,deleteFetcher:gn,dispose:ne,getBlocker:ra,deleteBlocker:Qt,_internalFetchControllers:N,_internalActiveDeferreds:Z},I}function ey(r){return r!=null&&"formData"in r}function Nm(r,a,d){d===void 0&&(d=!1);let p=typeof r=="string"?r:Gl(r);if(!a||!ey(a))return{path:p};if(a.formMethod&&!ay(a.formMethod))return{path:p,error:Yu(405,{method:a.formMethod})};let g;if(a.formData&&(g={formMethod:a.formMethod||"get",formAction:Xg(p),formEncType:a&&a.formEncType||"application/x-www-form-urlencoded",formData:a.formData},Yc(g.formMethod)))return{path:p,submission:g};let R=Zc(p),E=Jg(a.formData);return d&&R.search&&Zg(R.search)&&E.append("index",""),R.search="?"+E,{path:Gl(R),submission:g}}function ty(r,a){let d=r;if(a){let p=r.findIndex(g=>g.route.id===a);p>=0&&(d=r.slice(0,p))}return d}function Lm(r,a,d,p,g,R,E,w,m,S,b){let I=S?Object.values(S)[0]:m?Object.values(m)[0]:void 0,_=r.createURL(a.location),A=r.createURL(g),C=R||_.toString()===A.toString()||_.search!==A.search,v=S?Object.keys(S)[0]:void 0,j=ty(d,v).filter((x,N)=>{if(x.route.loader==null)return!1;if(ny(a.loaderData,a.matches[N],x)||E.some(K=>K===x.route.id))return!0;let $=a.matches[N],H=x;return Bm(x,Rn({currentUrl:_,currentParams:$.params,nextUrl:A,nextParams:H.params},p,{actionResult:I,defaultShouldRevalidate:C||Yg($,H)}))}),D=[];return b&&b.forEach((x,N)=>{if(d.some($=>$.route.id===x.routeId))w.includes(N)?D.push(Rn({key:N},x)):Bm(x.match,Rn({currentUrl:_,currentParams:a.matches[a.matches.length-1].params,nextUrl:A,nextParams:d[d.length-1].params},p,{actionResult:I,defaultShouldRevalidate:C}))&&D.push(Rn({key:N},x));else return}),[j,D]}function ny(r,a,d){let p=!a||d.route.id!==a.route.id,g=r[d.route.id]===void 0;return p||g}function Yg(r,a){let d=r.route.path;return r.pathname!==a.pathname||d!=null&&d.endsWith("*")&&r.params["*"]!==a.params["*"]}function Bm(r,a){if(r.route.shouldRevalidate){let d=r.route.shouldRevalidate(a);if(typeof d=="boolean")return d}return a.defaultShouldRevalidate}async function Fh(r,a,d,p,g,R,E,w){g===void 0&&(g="/"),R===void 0&&(R=!1),E===void 0&&(E=!1);let m,S,b,I=new Promise((A,C)=>b=C),_=()=>b();a.signal.addEventListener("abort",_);try{let A=d.route[r];$t(A,"Could not find the "+r+' to run on the "'+d.route.id+'" route'),S=await Promise.race([A({request:a,params:d.params,context:w}),I]),$t(S!==void 0,"You defined "+(r==="action"?"an action":"a loader")+" for route "+('"'+d.route.id+"\" but didn't return anything from your `"+r+"` ")+"function. Please return a value or `null`.")}catch(A){m=Ai.error,S=A}finally{a.signal.removeEventListener("abort",_)}if(oy(S)){let A=S.status;if(Y0.has(A)){let O=S.headers.get("Location");if($t(O,"Redirects returned/thrown from loaders/actions must have a Location header"),/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i.test(O)){if(!R){let D=new URL(a.url),x=O.startsWith("//")?new URL(D.protocol+O):new URL(O);x.origin===D.origin&&(O=x.pathname+x.search+x.hash)}}else{let D=p.slice(0,p.indexOf(d)+1),x=qp(D).map($=>$.pathnameBase),N=Hg(O,x,new URL(a.url).pathname);if($t(Gl(N),"Unable to resolve redirect location: "+O),g){let $=N.pathname;N.pathname=$==="/"?g:Xu([g,$])}O=Gl(N)}if(R)throw S.headers.set("Location",O),S;return{type:Ai.redirect,status:A,location:O,revalidate:S.headers.get("X-Remix-Revalidate")!==null}}if(E)throw{type:m||Ai.data,response:S};let C,v=S.headers.get("Content-Type");return v&&/\bapplication\/json\b/.test(v)?C=await S.json():C=await S.text(),m===Ai.error?{type:m,error:new Kp(A,S.statusText,C),headers:S.headers}:{type:Ai.data,data:C,statusCode:S.status,headers:S.headers}}return m===Ai.error?{type:m,error:S}:S instanceof W0?{type:Ai.deferred,deferredData:S}:{type:Ai.data,data:S}}function $h(r,a,d,p){let g=r.createURL(Xg(a)).toString(),R={signal:d};if(p&&Yc(p.formMethod)){let{formMethod:E,formEncType:w,formData:m}=p;R.method=E.toUpperCase(),R.body=w==="application/x-www-form-urlencoded"?Jg(m):m}return new Request(g,R)}function Jg(r){let a=new URLSearchParams;for(let[d,p]of r.entries())a.append(d,p instanceof File?p.name:p);return a}function ry(r,a,d,p,g){let R={},E=null,w,m=!1,S={};return d.forEach((b,I)=>{let _=a[I].route.id;if($t(!zd(b),"Cannot handle redirect results in processLoaderData"),Kh(b)){let A=Hd(r,_),C=b.error;p&&(C=Object.values(p)[0],p=void 0),E=E||{},E[A.route.id]==null&&(E[A.route.id]=C),R[_]=void 0,m||(m=!0,w=zg(b.error)?b.error.status:500),b.headers&&(S[_]=b.headers)}else $l(b)?(g.set(_,b.deferredData),R[_]=b.deferredData.data):R[_]=b.data,b.statusCode!=null&&b.statusCode!==200&&!m&&(w=b.statusCode),b.headers&&(S[_]=b.headers)}),p&&(E=p,R[Object.keys(p)[0]]=void 0),{loaderData:R,errors:E,statusCode:w||200,loaderHeaders:S}}function jm(r,a,d,p,g,R,E,w){let{loaderData:m,errors:S}=ry(a,d,p,g,w);for(let b=0;b<R.length;b++){let{key:I,match:_}=R[b];$t(E!==void 0&&E[b]!==void 0,"Did not find corresponding fetcher result");let A=E[b];if(Kh(A)){let C=Hd(r.matches,_.route.id);S&&S[C.route.id]||(S=Rn({},S,{[C.route.id]:A.error})),r.fetchers.delete(I)}else if(zd(A))$t(!1,"Unhandled fetcher revalidation redirect");else if($l(A))$t(!1,"Unhandled fetcher deferred data");else{let C={state:"idle",data:A.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};r.fetchers.set(I,C)}}return{loaderData:m,errors:S}}function Um(r,a,d,p){let g=Rn({},a);for(let R of d){let E=R.route.id;if(a.hasOwnProperty(E)?a[E]!==void 0&&(g[E]=a[E]):r[E]!==void 0&&(g[E]=r[E]),p&&p.hasOwnProperty(E))break}return g}function Hd(r,a){return(a?r.slice(0,r.findIndex(p=>p.route.id===a)+1):[...r]).reverse().find(p=>p.route.hasErrorBoundary===!0)||r[0]}function Fm(r){let a=r.find(d=>d.index||!d.path||d.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:a}],route:a}}function Yu(r,a){let{pathname:d,routeId:p,method:g,type:R}=a===void 0?{}:a,E="Unknown Server Error",w="Unknown @remix-run/router error";return r===400?(E="Bad Request",g&&d&&p?w="You made a "+g+' request to "'+d+'" but '+('did not provide a `loader` for route "'+p+'", ')+"so there is no way to handle the request.":R==="defer-action"&&(w="defer() is not supported in actions")):r===403?(E="Forbidden",w='Route "'+p+'" does not match URL "'+d+'"'):r===404?(E="Not Found",w='No route matches URL "'+d+'"'):r===405&&(E="Method Not Allowed",g&&d&&p?w="You made a "+g.toUpperCase()+' request to "'+d+'" but '+('did not provide an `action` for route "'+p+'", ')+"so there is no way to handle the request.":g&&(w='Invalid request method "'+g.toUpperCase()+'"')),new Kp(r||500,E,new Error(w),!0)}function $m(r){for(let a=r.length-1;a>=0;a--){let d=r[a];if(zd(d))return d}}function Xg(r){let a=typeof r=="string"?Zc(r):r;return Gl(Rn({},a,{hash:""}))}function iy(r,a){return r.pathname===a.pathname&&r.search===a.search&&r.hash!==a.hash}function $l(r){return r.type===Ai.deferred}function Kh(r){return r.type===Ai.error}function zd(r){return(r&&r.type)===Ai.redirect}function oy(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.headers=="object"&&typeof r.body<"u"}function ay(r){return K0.has(r)}function Yc(r){return z0.has(r)}async function Vm(r,a,d,p,g,R){for(let E=0;E<d.length;E++){let w=d[E],m=a[E],S=r.find(I=>I.route.id===m.route.id),b=S!=null&&!Yg(S,m)&&(R&&R[m.route.id])!==void 0;$l(w)&&(g||b)&&await Qg(w,p,g).then(I=>{I&&(d[E]=I||d[E])})}}async function Qg(r,a,d){if(d===void 0&&(d=!1),!await r.deferredData.resolveData(a)){if(d)try{return{type:Ai.data,data:r.deferredData.unwrappedData}}catch(g){return{type:Ai.error,error:g}}return{type:Ai.data,data:r.deferredData.data}}}function Zg(r){return new URLSearchParams(r).getAll("index").some(a=>a==="")}function Wm(r,a){let{route:d,pathname:p,params:g}=r;return{id:d.id,pathname:p,params:g,data:a[d.id],handle:d.handle}}function Gm(r,a){let d=typeof a=="string"?Zc(a).search:a.search;if(r[r.length-1].route.index&&Zg(d||""))return r[r.length-1];let p=qp(r);return p[p.length-1]}/**
 * React Router v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Af(){return Af=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&(r[p]=d[p])}return r},Af.apply(this,arguments)}function sy(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}const cy=typeof Object.is=="function"?Object.is:sy,{useState:uy,useEffect:ly,useLayoutEffect:dy,useDebugValue:hy}=Zh;function fy(r,a,d){const p=a(),[{inst:g},R]=uy({inst:{value:p,getSnapshot:a}});return dy(()=>{g.value=p,g.getSnapshot=a,Tp(g)&&R({inst:g})},[r,p,a]),ly(()=>(Tp(g)&&R({inst:g}),r(()=>{Tp(g)&&R({inst:g})})),[r]),hy(p),p}function Tp(r){const a=r.getSnapshot,d=r.value;try{const p=a();return!cy(d,p)}catch{return!0}}function py(r,a,d){return a()}const my=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gy=!my,vy=gy?py:fy,yy="useSyncExternalStore"in Zh?(r=>r.useSyncExternalStore)(Zh):vy,Yp=ae.createContext(null),Jp=ae.createContext(null),Xp=ae.createContext(null),Gf=ae.createContext(null),Zd=ae.createContext({outlet:null,matches:[]}),ev=ae.createContext(null);function Hf(){return ae.useContext(Gf)!=null}function tv(){return Hf()||$t(!1),ae.useContext(Gf).location}function sR(){Hf()||$t(!1);let{basename:r,navigator:a}=ae.useContext(Xp),{matches:d}=ae.useContext(Zd),{pathname:p}=tv(),g=JSON.stringify(qp(d).map(w=>w.pathnameBase)),R=ae.useRef(!1);return ae.useEffect(()=>{R.current=!0}),ae.useCallback(function(w,m){if(m===void 0&&(m={}),!R.current)return;if(typeof w=="number"){a.go(w);return}let S=Hg(w,JSON.parse(g),p,m.relative==="path");r!=="/"&&(S.pathname=S.pathname==="/"?r:Xu([r,S.pathname])),(m.replace?a.replace:a.push)(S,m.state,m)},[r,a,g,p])}const by=ae.createContext(null);function Sy(r){let a=ae.useContext(Zd).outlet;return a&&ae.createElement(by.Provider,{value:r},a)}function Ey(r,a){Hf()||$t(!1);let{navigator:d}=ae.useContext(Xp),p=ae.useContext(Jp),{matches:g}=ae.useContext(Zd),R=g[g.length-1],E=R?R.params:{};R&&R.pathname;let w=R?R.pathnameBase:"/";R&&R.route;let m=tv(),S;if(a){var b;let v=typeof a=="string"?Zc(a):a;w==="/"||(b=v.pathname)!=null&&b.startsWith(w)||$t(!1),S=v}else S=m;let I=S.pathname||"/",_=w==="/"?I:I.slice(w.length)||"/",A=zh(r,{pathname:_}),C=Ry(A&&A.map(v=>Object.assign({},v,{params:Object.assign({},E,v.params),pathname:Xu([w,d.encodeLocation?d.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?w:Xu([w,d.encodeLocation?d.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),g,p||void 0);return a&&C?ae.createElement(Gf.Provider,{value:{location:Af({pathname:"/",search:"",hash:"",state:null,key:"default"},S),navigationType:Fr.Pop}},C):C}function _y(){let r=Oy(),a=zg(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),d=r instanceof Error?r.stack:null,g={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ae.createElement(ae.Fragment,null,ae.createElement("h2",null,"Unexpected Application Error!"),ae.createElement("h3",{style:{fontStyle:"italic"}},a),d?ae.createElement("pre",{style:g},d):null,null)}class Cy extends ae.Component{constructor(a){super(a),this.state={location:a.location,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,d){return d.location!==a.location?{error:a.error,location:a.location}:{error:a.error||d.error,location:d.location}}componentDidCatch(a,d){console.error("React Router caught the following error during render",a,d)}render(){return this.state.error?ae.createElement(Zd.Provider,{value:this.props.routeContext},ae.createElement(ev.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ty(r){let{routeContext:a,match:d,children:p}=r,g=ae.useContext(Yp);return g&&g.static&&g.staticContext&&d.route.errorElement&&(g.staticContext._deepestRenderedBoundaryId=d.route.id),ae.createElement(Zd.Provider,{value:a},p)}function Ry(r,a,d){if(a===void 0&&(a=[]),r==null)if(d!=null&&d.errors)r=d.matches;else return null;let p=r,g=d==null?void 0:d.errors;if(g!=null){let R=p.findIndex(E=>E.route.id&&(g==null?void 0:g[E.route.id]));R>=0||$t(!1),p=p.slice(0,Math.min(p.length,R+1))}return p.reduceRight((R,E,w)=>{let m=E.route.id?g==null?void 0:g[E.route.id]:null,S=d?E.route.errorElement||ae.createElement(_y,null):null,b=a.concat(p.slice(0,w+1)),I=()=>ae.createElement(Ty,{match:E,routeContext:{outlet:R,matches:b}},m?S:E.route.element!==void 0?E.route.element:R);return d&&(E.route.errorElement||w===0)?ae.createElement(Cy,{location:d.location,component:S,error:m,children:I(),routeContext:{outlet:null,matches:b}}):I()},null)}var Hm;(function(r){r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator"})(Hm||(Hm={}));var Pf;(function(r){r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator"})(Pf||(Pf={}));function wy(r){let a=ae.useContext(Jp);return a||$t(!1),a}function Iy(r){let a=ae.useContext(Zd);return a||$t(!1),a}function ky(r){let a=Iy(),d=a.matches[a.matches.length-1];return d.route.id||$t(!1),d.route.id}function Oy(){var r;let a=ae.useContext(ev),d=wy(Pf.UseRouteError),p=ky(Pf.UseRouteError);return a||((r=d.errors)==null?void 0:r[p])}function Ay(r){let{fallbackElement:a,router:d}=r,p=yy(d.subscribe,()=>d.state,()=>d.state),g=ae.useMemo(()=>({createHref:d.createHref,encodeLocation:d.encodeLocation,go:E=>d.navigate(E),push:(E,w,m)=>d.navigate(E,{state:w,preventScrollReset:m==null?void 0:m.preventScrollReset}),replace:(E,w,m)=>d.navigate(E,{replace:!0,state:w,preventScrollReset:m==null?void 0:m.preventScrollReset})}),[d]),R=d.basename||"/";return ae.createElement(ae.Fragment,null,ae.createElement(Yp.Provider,{value:{router:d,navigator:g,static:!1,basename:R}},ae.createElement(Jp.Provider,{value:p},ae.createElement(xy,{basename:d.basename,location:d.state.location,navigationType:d.state.historyAction,navigator:g},d.state.initialized?ae.createElement(Dy,null):a))),null)}function cR(r){return Sy(r.context)}function Py(r){$t(!1)}function xy(r){let{basename:a="/",children:d=null,location:p,navigationType:g=Fr.Pop,navigator:R,static:E=!1}=r;Hf()&&$t(!1);let w=a.replace(/^\/*/,"/"),m=ae.useMemo(()=>({basename:w,navigator:R,static:E}),[w,R,E]);typeof p=="string"&&(p=Zc(p));let{pathname:S="/",search:b="",hash:I="",state:_=null,key:A="default"}=p,C=ae.useMemo(()=>{let v=Gg(S,w);return v==null?null:{pathname:v,search:b,hash:I,state:_,key:A}},[w,S,b,I,_,A]);return C==null?null:ae.createElement(Xp.Provider,{value:m},ae.createElement(Gf.Provider,{children:d,value:{location:C,navigationType:g}}))}function Dy(r){let{children:a,location:d}=r,p=ae.useContext(Yp),g=p&&!a?p.router.routes:Dp(a);return Ey(g,d)}var zm;(function(r){r[r.pending=0]="pending",r[r.success=1]="success",r[r.error=2]="error"})(zm||(zm={}));new Promise(()=>{});function Dp(r,a){a===void 0&&(a=[]);let d=[];return ae.Children.forEach(r,(p,g)=>{if(!ae.isValidElement(p))return;if(p.type===ae.Fragment){d.push.apply(d,Dp(p.props.children,a));return}p.type!==Py&&$t(!1),!p.props.index||!p.props.children||$t(!1);let R=[...a,g],E={id:p.props.id||R.join("-"),caseSensitive:p.props.caseSensitive,element:p.props.element,index:p.props.index,path:p.props.path,loader:p.props.loader,action:p.props.action,errorElement:p.props.errorElement,hasErrorBoundary:p.props.errorElement!=null,shouldRevalidate:p.props.shouldRevalidate,handle:p.props.handle};p.props.children&&(E.children=Dp(p.props.children,R)),d.push(E)}),d}function nv(r){return r.map(a=>{let d=Af({},a);return d.hasErrorBoundary==null&&(d.hasErrorBoundary=d.errorElement!=null),d.children&&(d.children=nv(d.children)),d})}/**
 * React Router DOM v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mp(){return Mp=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&(r[p]=d[p])}return r},Mp.apply(this,arguments)}function My(r,a){return Z0({basename:void 0,history:S0({window:void 0}),hydrationData:Ny(),routes:nv(r)}).initialize()}function Ny(){var r;let a=(r=window)==null?void 0:r.__staticRouterHydrationData;return a&&a.errors&&(a=Mp({},a,{errors:Ly(a.errors)})),a}function Ly(r){if(!r)return null;let a=Object.entries(r),d={};for(let[p,g]of a)if(g&&g.__type==="RouteErrorResponse")d[p]=new Kp(g.status,g.statusText,g.data,g.internal===!0);else if(g&&g.__type==="Error"){let R=new Error(g.message);R.stack="",d[p]=R}else d[p]=g;return d}var qm;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmitImpl="useSubmitImpl",r.UseFetcher="useFetcher"})(qm||(qm={}));var Km;(function(r){r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(Km||(Km={}));var rv={exports:{}},Vh={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ym;function By(){if(Ym)return Vh;Ym=1;var r=sc,a=Symbol.for("react.element"),d=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,g=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R={key:!0,ref:!0,__self:!0,__source:!0};function E(w,m,S){var b,I={},_=null,A=null;for(b in S!==void 0&&(_=""+S),m.key!==void 0&&(_=""+m.key),m.ref!==void 0&&(A=m.ref),m)p.call(m,b)&&!R.hasOwnProperty(b)&&(I[b]=m[b]);if(w&&w.defaultProps)for(b in m=w.defaultProps)I[b]===void 0&&(I[b]=m[b]);return{$$typeof:a,type:w,key:_,ref:A,props:I,_owner:g.current}}return Vh.Fragment=d,Vh.jsx=E,Vh.jsxs=E,Vh}rv.exports=By();var nn=rv.exports;const nf={black:"#000",white:"#fff"},Pd={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},xd={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Dd={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Md={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Nd={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Wh={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},jy={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Ne(){return Ne=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var p in d)({}).hasOwnProperty.call(d,p)&&(r[p]=d[p])}return r},Ne.apply(null,arguments)}const uR=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Ne}},Symbol.toStringTag,{value:"Module"}));function Ju(r){if(typeof r!="object"||r===null)return!1;const a=Object.getPrototypeOf(r);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function iv(r){if(ae.isValidElement(r)||!Ju(r))return r;const a={};return Object.keys(r).forEach(d=>{a[d]=iv(r[d])}),a}function cc(r,a,d={clone:!0}){const p=d.clone?Ne({},r):r;return Ju(r)&&Ju(a)&&Object.keys(a).forEach(g=>{ae.isValidElement(a[g])?p[g]=a[g]:Ju(a[g])&&Object.prototype.hasOwnProperty.call(r,g)&&Ju(r[g])?p[g]=cc(r[g],a[g],d):d.clone?p[g]=Ju(a[g])?iv(a[g]):a[g]:p[g]=a[g]}),p}function Jd(r){let a="https://mui.com/production-error/?code="+r;for(let d=1;d<arguments.length;d+=1)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified MUI error #"+r+"; visit "+a+" for the full message."}function fi(r){if(typeof r!="string")throw new Error(Jd(7));return r.charAt(0).toUpperCase()+r.slice(1)}function Rp(r){return r&&r.ownerDocument||document}function Uy(r,a){typeof r=="function"?r(a):r&&(r.current=a)}const Fy=typeof window<"u"?ae.useLayoutEffect:ae.useEffect;function Vl(r){const a=ae.useRef(r);return Fy(()=>{a.current=r}),ae.useRef((...d)=>(0,a.current)(...d)).current}function xf(...r){return ae.useMemo(()=>r.every(a=>a==null)?null:a=>{r.forEach(d=>{Uy(d,a)})},r)}class Qp{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Qp}start(a,d){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,d()},a)}}let zf=!0,Np=!1;const $y=new Qp,Vy={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Wy(r){const{type:a,tagName:d}=r;return!!(d==="INPUT"&&Vy[a]&&!r.readOnly||d==="TEXTAREA"&&!r.readOnly||r.isContentEditable)}function Gy(r){r.metaKey||r.altKey||r.ctrlKey||(zf=!0)}function wp(){zf=!1}function Hy(){this.visibilityState==="hidden"&&Np&&(zf=!0)}function zy(r){r.addEventListener("keydown",Gy,!0),r.addEventListener("mousedown",wp,!0),r.addEventListener("pointerdown",wp,!0),r.addEventListener("touchstart",wp,!0),r.addEventListener("visibilitychange",Hy,!0)}function qy(r){const{target:a}=r;try{return a.matches(":focus-visible")}catch{}return zf||Wy(a)}function Ky(){const r=ae.useCallback(g=>{g!=null&&zy(g.ownerDocument)},[]),a=ae.useRef(!1);function d(){return a.current?(Np=!0,$y.start(100,()=>{Np=!1}),a.current=!1,!0):!1}function p(g){return qy(g)?(a.current=!0,!0):!1}return{isFocusVisibleRef:a,onFocus:p,onBlur:d,ref:r}}function Df(r,a){const d=Ne({},a);return Object.keys(r).forEach(p=>{if(p.toString().match(/^(components|slots)$/))d[p]=Ne({},r[p],d[p]);else if(p.toString().match(/^(componentsProps|slotProps)$/)){const g=r[p]||{},R=a[p];d[p]={},!R||!Object.keys(R)?d[p]=g:!g||!Object.keys(g)?d[p]=R:(d[p]=Ne({},R),Object.keys(g).forEach(E=>{d[p][E]=Df(g[E],R[E])}))}else d[p]===void 0&&(d[p]=r[p])}),d}function ql(r,a,d=void 0){const p={};return Object.keys(r).forEach(g=>{p[g]=r[g].reduce((R,E)=>{if(E){const w=a(E);w!==""&&R.push(w),d&&d[E]&&R.push(d[E])}return R},[]).join(" ")}),p}const Jm=r=>r,Yy=()=>{let r=Jm;return{configure(a){r=a},generate(a){return r(a)},reset(){r=Jm}}},ov=Yy(),Jy={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Xi(r,a,d="Mui"){const p=Jy[a];return p?`${d}-${p}`:`${ov.generate(r)}-${a}`}function ii(r,a,d="Mui"){const p={};return a.forEach(g=>{p[g]=Xi(r,g,d)}),p}function Xy(r,a=Number.MIN_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER){return Math.max(a,Math.min(r,d))}function cr(r,a){if(r==null)return{};var d={};for(var p in r)if({}.hasOwnProperty.call(r,p)){if(a.includes(p))continue;d[p]=r[p]}return d}function av(r){var a=Object.create(null);return function(d){return a[d]===void 0&&(a[d]=r(d)),a[d]}}var Qy=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Zy=av(function(r){return Qy.test(r)||r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)<91}),eb=!1;function tb(r){if(r.sheet)return r.sheet;for(var a=0;a<document.styleSheets.length;a++)if(document.styleSheets[a].ownerNode===r)return document.styleSheets[a]}function nb(r){var a=document.createElement("style");return a.setAttribute("data-emotion",r.key),r.nonce!==void 0&&a.setAttribute("nonce",r.nonce),a.appendChild(document.createTextNode("")),a.setAttribute("data-s",""),a}var rb=function(){function r(d){var p=this;this._insertTag=function(g){var R;p.tags.length===0?p.insertionPoint?R=p.insertionPoint.nextSibling:p.prepend?R=p.container.firstChild:R=p.before:R=p.tags[p.tags.length-1].nextSibling,p.container.insertBefore(g,R),p.tags.push(g)},this.isSpeedy=d.speedy===void 0?!eb:d.speedy,this.tags=[],this.ctr=0,this.nonce=d.nonce,this.key=d.key,this.container=d.container,this.prepend=d.prepend,this.insertionPoint=d.insertionPoint,this.before=null}var a=r.prototype;return a.hydrate=function(p){p.forEach(this._insertTag)},a.insert=function(p){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(nb(this));var g=this.tags[this.tags.length-1];if(this.isSpeedy){var R=tb(g);try{R.insertRule(p,R.cssRules.length)}catch{}}else g.appendChild(document.createTextNode(p));this.ctr++},a.flush=function(){this.tags.forEach(function(p){var g;return(g=p.parentNode)==null?void 0:g.removeChild(p)}),this.tags=[],this.ctr=0},r}(),Ki="-ms-",Mf="-moz-",Cn="-webkit-",sv="comm",Zp="rule",em="decl",ib="@import",cv="@keyframes",ob="@layer",ab=Math.abs,qf=String.fromCharCode,sb=Object.assign;function cb(r,a){return Pi(r,0)^45?(((a<<2^Pi(r,0))<<2^Pi(r,1))<<2^Pi(r,2))<<2^Pi(r,3):0}function uv(r){return r.trim()}function ub(r,a){return(r=a.exec(r))?r[0]:r}function Tn(r,a,d){return r.replace(a,d)}function Lp(r,a){return r.indexOf(a)}function Pi(r,a){return r.charCodeAt(a)|0}function rf(r,a,d){return r.slice(a,d)}function oc(r){return r.length}function tm(r){return r.length}function yf(r,a){return a.push(r),r}function lb(r,a){return r.map(a).join("")}var Kf=1,Xd=1,lv=0,xo=0,Vr=0,eh="";function Yf(r,a,d,p,g,R,E){return{value:r,root:a,parent:d,type:p,props:g,children:R,line:Kf,column:Xd,length:E,return:""}}function Gh(r,a){return sb(Yf("",null,null,"",null,null,0),r,{length:-r.length},a)}function db(){return Vr}function hb(){return Vr=xo>0?Pi(eh,--xo):0,Xd--,Vr===10&&(Xd=1,Kf--),Vr}function ta(){return Vr=xo<lv?Pi(eh,xo++):0,Xd++,Vr===10&&(Xd=1,Kf++),Vr}function uc(){return Pi(eh,xo)}function Tf(){return xo}function cf(r,a){return rf(eh,r,a)}function of(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function dv(r){return Kf=Xd=1,lv=oc(eh=r),xo=0,[]}function hv(r){return eh="",r}function Rf(r){return uv(cf(xo-1,Bp(r===91?r+2:r===40?r+1:r)))}function fb(r){for(;(Vr=uc())&&Vr<33;)ta();return of(r)>2||of(Vr)>3?"":" "}function pb(r,a){for(;--a&&ta()&&!(Vr<48||Vr>102||Vr>57&&Vr<65||Vr>70&&Vr<97););return cf(r,Tf()+(a<6&&uc()==32&&ta()==32))}function Bp(r){for(;ta();)switch(Vr){case r:return xo;case 34:case 39:r!==34&&r!==39&&Bp(Vr);break;case 40:r===41&&Bp(r);break;case 92:ta();break}return xo}function mb(r,a){for(;ta()&&r+Vr!==57;)if(r+Vr===84&&uc()===47)break;return"/*"+cf(a,xo-1)+"*"+qf(r===47?r:ta())}function gb(r){for(;!of(uc());)ta();return cf(r,xo)}function vb(r){return hv(wf("",null,null,null,[""],r=dv(r),0,[0],r))}function wf(r,a,d,p,g,R,E,w,m){for(var S=0,b=0,I=E,_=0,A=0,C=0,v=1,O=1,j=1,D=0,x="",N=g,$=R,H=p,K=x;O;)switch(C=D,D=ta()){case 40:if(C!=108&&Pi(K,I-1)==58){Lp(K+=Tn(Rf(D),"&","&\f"),"&\f")!=-1&&(j=-1);break}case 34:case 39:case 91:K+=Rf(D);break;case 9:case 10:case 13:case 32:K+=fb(C);break;case 92:K+=pb(Tf()-1,7);continue;case 47:switch(uc()){case 42:case 47:yf(yb(mb(ta(),Tf()),a,d),m);break;default:K+="/"}break;case 123*v:w[S++]=oc(K)*j;case 125*v:case 59:case 0:switch(D){case 0:case 125:O=0;case 59+b:j==-1&&(K=Tn(K,/\f/g,"")),A>0&&oc(K)-I&&yf(A>32?Qm(K+";",p,d,I-1):Qm(Tn(K," ","")+";",p,d,I-2),m);break;case 59:K+=";";default:if(yf(H=Xm(K,a,d,S,b,g,w,x,N=[],$=[],I),R),D===123)if(b===0)wf(K,a,H,H,N,R,I,w,$);else switch(_===99&&Pi(K,3)===110?100:_){case 100:case 108:case 109:case 115:wf(r,H,H,p&&yf(Xm(r,H,H,0,0,g,w,x,g,N=[],I),$),g,$,I,w,p?N:$);break;default:wf(K,H,H,H,[""],$,0,w,$)}}S=b=A=0,v=j=1,x=K="",I=E;break;case 58:I=1+oc(K),A=C;default:if(v<1){if(D==123)--v;else if(D==125&&v++==0&&hb()==125)continue}switch(K+=qf(D),D*v){case 38:j=b>0?1:(K+="\f",-1);break;case 44:w[S++]=(oc(K)-1)*j,j=1;break;case 64:uc()===45&&(K+=Rf(ta())),_=uc(),b=I=oc(x=K+=gb(Tf())),D++;break;case 45:C===45&&oc(K)==2&&(v=0)}}return R}function Xm(r,a,d,p,g,R,E,w,m,S,b){for(var I=g-1,_=g===0?R:[""],A=tm(_),C=0,v=0,O=0;C<p;++C)for(var j=0,D=rf(r,I+1,I=ab(v=E[C])),x=r;j<A;++j)(x=uv(v>0?_[j]+" "+D:Tn(D,/&\f/g,_[j])))&&(m[O++]=x);return Yf(r,a,d,g===0?Zp:w,m,S,b)}function yb(r,a,d){return Yf(r,a,d,sv,qf(db()),rf(r,2,-2),0)}function Qm(r,a,d,p){return Yf(r,a,d,em,rf(r,0,p),rf(r,p+1,-1),p)}function qd(r,a){for(var d="",p=tm(r),g=0;g<p;g++)d+=a(r[g],g,r,a)||"";return d}function bb(r,a,d,p){switch(r.type){case ob:if(r.children.length)break;case ib:case em:return r.return=r.return||r.value;case sv:return"";case cv:return r.return=r.value+"{"+qd(r.children,p)+"}";case Zp:r.value=r.props.join(",")}return oc(d=qd(r.children,p))?r.return=r.value+"{"+d+"}":""}function Sb(r){var a=tm(r);return function(d,p,g,R){for(var E="",w=0;w<a;w++)E+=r[w](d,p,g,R)||"";return E}}function Eb(r){return function(a){a.root||(a=a.return)&&r(a)}}var _b=function(a,d,p){for(var g=0,R=0;g=R,R=uc(),g===38&&R===12&&(d[p]=1),!of(R);)ta();return cf(a,xo)},Cb=function(a,d){var p=-1,g=44;do switch(of(g)){case 0:g===38&&uc()===12&&(d[p]=1),a[p]+=_b(xo-1,d,p);break;case 2:a[p]+=Rf(g);break;case 4:if(g===44){a[++p]=uc()===58?"&\f":"",d[p]=a[p].length;break}default:a[p]+=qf(g)}while(g=ta());return a},Tb=function(a,d){return hv(Cb(dv(a),d))},Zm=new WeakMap,Rb=function(a){if(!(a.type!=="rule"||!a.parent||a.length<1)){for(var d=a.value,p=a.parent,g=a.column===p.column&&a.line===p.line;p.type!=="rule";)if(p=p.parent,!p)return;if(!(a.props.length===1&&d.charCodeAt(0)!==58&&!Zm.get(p))&&!g){Zm.set(a,!0);for(var R=[],E=Tb(d,R),w=p.props,m=0,S=0;m<E.length;m++)for(var b=0;b<w.length;b++,S++)a.props[S]=R[m]?E[m].replace(/&\f/g,w[b]):w[b]+" "+E[m]}}},wb=function(a){if(a.type==="decl"){var d=a.value;d.charCodeAt(0)===108&&d.charCodeAt(2)===98&&(a.return="",a.value="")}};function fv(r,a){switch(cb(r,a)){case 5103:return Cn+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cn+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return Cn+r+Mf+r+Ki+r+r;case 6828:case 4268:return Cn+r+Ki+r+r;case 6165:return Cn+r+Ki+"flex-"+r+r;case 5187:return Cn+r+Tn(r,/(\w+).+(:[^]+)/,Cn+"box-$1$2"+Ki+"flex-$1$2")+r;case 5443:return Cn+r+Ki+"flex-item-"+Tn(r,/flex-|-self/,"")+r;case 4675:return Cn+r+Ki+"flex-line-pack"+Tn(r,/align-content|flex-|-self/,"")+r;case 5548:return Cn+r+Ki+Tn(r,"shrink","negative")+r;case 5292:return Cn+r+Ki+Tn(r,"basis","preferred-size")+r;case 6060:return Cn+"box-"+Tn(r,"-grow","")+Cn+r+Ki+Tn(r,"grow","positive")+r;case 4554:return Cn+Tn(r,/([^-])(transform)/g,"$1"+Cn+"$2")+r;case 6187:return Tn(Tn(Tn(r,/(zoom-|grab)/,Cn+"$1"),/(image-set)/,Cn+"$1"),r,"")+r;case 5495:case 3959:return Tn(r,/(image-set\([^]*)/,Cn+"$1$`$1");case 4968:return Tn(Tn(r,/(.+:)(flex-)?(.*)/,Cn+"box-pack:$3"+Ki+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cn+r+r;case 4095:case 3583:case 4068:case 2532:return Tn(r,/(.+)-inline(.+)/,Cn+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(oc(r)-1-a>6)switch(Pi(r,a+1)){case 109:if(Pi(r,a+4)!==45)break;case 102:return Tn(r,/(.+:)(.+)-([^]+)/,"$1"+Cn+"$2-$3$1"+Mf+(Pi(r,a+3)==108?"$3":"$2-$3"))+r;case 115:return~Lp(r,"stretch")?fv(Tn(r,"stretch","fill-available"),a)+r:r}break;case 4949:if(Pi(r,a+1)!==115)break;case 6444:switch(Pi(r,oc(r)-3-(~Lp(r,"!important")&&10))){case 107:return Tn(r,":",":"+Cn)+r;case 101:return Tn(r,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cn+(Pi(r,14)===45?"inline-":"")+"box$3$1"+Cn+"$2$3$1"+Ki+"$2box$3")+r}break;case 5936:switch(Pi(r,a+11)){case 114:return Cn+r+Ki+Tn(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return Cn+r+Ki+Tn(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return Cn+r+Ki+Tn(r,/[svh]\w+-[tblr]{2}/,"lr")+r}return Cn+r+Ki+r+r}return r}var Ib=function(a,d,p,g){if(a.length>-1&&!a.return)switch(a.type){case em:a.return=fv(a.value,a.length);break;case cv:return qd([Gh(a,{value:Tn(a.value,"@","@"+Cn)})],g);case Zp:if(a.length)return lb(a.props,function(R){switch(ub(R,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return qd([Gh(a,{props:[Tn(R,/:(read-\w+)/,":"+Mf+"$1")]})],g);case"::placeholder":return qd([Gh(a,{props:[Tn(R,/:(plac\w+)/,":"+Cn+"input-$1")]}),Gh(a,{props:[Tn(R,/:(plac\w+)/,":"+Mf+"$1")]}),Gh(a,{props:[Tn(R,/:(plac\w+)/,Ki+"input-$1")]})],g)}return""})}},kb=[Ib],pv=function(a){var d=a.key;if(d==="css"){var p=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(p,function(v){var O=v.getAttribute("data-emotion");O.indexOf(" ")!==-1&&(document.head.appendChild(v),v.setAttribute("data-s",""))})}var g=a.stylisPlugins||kb,R={},E,w=[];E=a.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+d+' "]'),function(v){for(var O=v.getAttribute("data-emotion").split(" "),j=1;j<O.length;j++)R[O[j]]=!0;w.push(v)});var m,S=[Rb,wb];{var b,I=[bb,Eb(function(v){b.insert(v)})],_=Sb(S.concat(g,I)),A=function(O){return qd(vb(O),_)};m=function(O,j,D,x){b=D,A(O?O+"{"+j.styles+"}":j.styles),x&&(C.inserted[j.name]=!0)}}var C={key:d,sheet:new rb({key:d,container:E,nonce:a.nonce,speedy:a.speedy,prepend:a.prepend,insertionPoint:a.insertionPoint}),nonce:a.nonce,inserted:R,registered:{},insert:m};return C.sheet.hydrate(w),C},mv={exports:{}},xn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pi=typeof Symbol=="function"&&Symbol.for,nm=pi?Symbol.for("react.element"):60103,rm=pi?Symbol.for("react.portal"):60106,Jf=pi?Symbol.for("react.fragment"):60107,Xf=pi?Symbol.for("react.strict_mode"):60108,Qf=pi?Symbol.for("react.profiler"):60114,Zf=pi?Symbol.for("react.provider"):60109,ep=pi?Symbol.for("react.context"):60110,im=pi?Symbol.for("react.async_mode"):60111,tp=pi?Symbol.for("react.concurrent_mode"):60111,np=pi?Symbol.for("react.forward_ref"):60112,rp=pi?Symbol.for("react.suspense"):60113,Ob=pi?Symbol.for("react.suspense_list"):60120,ip=pi?Symbol.for("react.memo"):60115,op=pi?Symbol.for("react.lazy"):60116,Ab=pi?Symbol.for("react.block"):60121,Pb=pi?Symbol.for("react.fundamental"):60117,xb=pi?Symbol.for("react.responder"):60118,Db=pi?Symbol.for("react.scope"):60119;function na(r){if(typeof r=="object"&&r!==null){var a=r.$$typeof;switch(a){case nm:switch(r=r.type,r){case im:case tp:case Jf:case Qf:case Xf:case rp:return r;default:switch(r=r&&r.$$typeof,r){case ep:case np:case op:case ip:case Zf:return r;default:return a}}case rm:return a}}}function gv(r){return na(r)===tp}xn.AsyncMode=im;xn.ConcurrentMode=tp;xn.ContextConsumer=ep;xn.ContextProvider=Zf;xn.Element=nm;xn.ForwardRef=np;xn.Fragment=Jf;xn.Lazy=op;xn.Memo=ip;xn.Portal=rm;xn.Profiler=Qf;xn.StrictMode=Xf;xn.Suspense=rp;xn.isAsyncMode=function(r){return gv(r)||na(r)===im};xn.isConcurrentMode=gv;xn.isContextConsumer=function(r){return na(r)===ep};xn.isContextProvider=function(r){return na(r)===Zf};xn.isElement=function(r){return typeof r=="object"&&r!==null&&r.$$typeof===nm};xn.isForwardRef=function(r){return na(r)===np};xn.isFragment=function(r){return na(r)===Jf};xn.isLazy=function(r){return na(r)===op};xn.isMemo=function(r){return na(r)===ip};xn.isPortal=function(r){return na(r)===rm};xn.isProfiler=function(r){return na(r)===Qf};xn.isStrictMode=function(r){return na(r)===Xf};xn.isSuspense=function(r){return na(r)===rp};xn.isValidElementType=function(r){return typeof r=="string"||typeof r=="function"||r===Jf||r===tp||r===Qf||r===Xf||r===rp||r===Ob||typeof r=="object"&&r!==null&&(r.$$typeof===op||r.$$typeof===ip||r.$$typeof===Zf||r.$$typeof===ep||r.$$typeof===np||r.$$typeof===Pb||r.$$typeof===xb||r.$$typeof===Db||r.$$typeof===Ab)};xn.typeOf=na;mv.exports=xn;var Mb=mv.exports,vv=Mb,Nb={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Lb={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yv={};yv[vv.ForwardRef]=Nb;yv[vv.Memo]=Lb;var Bb=!0;function jb(r,a,d){var p="";return d.split(" ").forEach(function(g){r[g]!==void 0?a.push(r[g]+";"):g&&(p+=g+" ")}),p}var bv=function(a,d,p){var g=a.key+"-"+d.name;(p===!1||Bb===!1)&&a.registered[g]===void 0&&(a.registered[g]=d.styles)},Sv=function(a,d,p){bv(a,d,p);var g=a.key+"-"+d.name;if(a.inserted[d.name]===void 0){var R=d;do a.insert(d===R?"."+g:"",R,a.sheet,!0),R=R.next;while(R!==void 0)}};function Ub(r){for(var a=0,d,p=0,g=r.length;g>=4;++p,g-=4)d=r.charCodeAt(p)&255|(r.charCodeAt(++p)&255)<<8|(r.charCodeAt(++p)&255)<<16|(r.charCodeAt(++p)&255)<<24,d=(d&65535)*1540483477+((d>>>16)*59797<<16),d^=d>>>24,a=(d&65535)*1540483477+((d>>>16)*59797<<16)^(a&65535)*1540483477+((a>>>16)*59797<<16);switch(g){case 3:a^=(r.charCodeAt(p+2)&255)<<16;case 2:a^=(r.charCodeAt(p+1)&255)<<8;case 1:a^=r.charCodeAt(p)&255,a=(a&65535)*1540483477+((a>>>16)*59797<<16)}return a^=a>>>13,a=(a&65535)*1540483477+((a>>>16)*59797<<16),((a^a>>>15)>>>0).toString(36)}var Fb={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$b=!1,Vb=/[A-Z]|^ms/g,Wb=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ev=function(a){return a.charCodeAt(1)===45},eg=function(a){return a!=null&&typeof a!="boolean"},Ip=av(function(r){return Ev(r)?r:r.replace(Vb,"-$&").toLowerCase()}),tg=function(a,d){switch(a){case"animation":case"animationName":if(typeof d=="string")return d.replace(Wb,function(p,g,R){return ac={name:g,styles:R,next:ac},g})}return Fb[a]!==1&&!Ev(a)&&typeof d=="number"&&d!==0?d+"px":d},Gb="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function af(r,a,d){if(d==null)return"";var p=d;if(p.__emotion_styles!==void 0)return p;switch(typeof d){case"boolean":return"";case"object":{var g=d;if(g.anim===1)return ac={name:g.name,styles:g.styles,next:ac},g.name;var R=d;if(R.styles!==void 0){var E=R.next;if(E!==void 0)for(;E!==void 0;)ac={name:E.name,styles:E.styles,next:ac},E=E.next;var w=R.styles+";";return w}return Hb(r,a,d)}case"function":{if(r!==void 0){var m=ac,S=d(r);return ac=m,af(r,a,S)}break}}var b=d;if(a==null)return b;var I=a[b];return I!==void 0?I:b}function Hb(r,a,d){var p="";if(Array.isArray(d))for(var g=0;g<d.length;g++)p+=af(r,a,d[g])+";";else for(var R in d){var E=d[R];if(typeof E!="object"){var w=E;a!=null&&a[w]!==void 0?p+=R+"{"+a[w]+"}":eg(w)&&(p+=Ip(R)+":"+tg(R,w)+";")}else{if(R==="NO_COMPONENT_SELECTOR"&&$b)throw new Error(Gb);if(Array.isArray(E)&&typeof E[0]=="string"&&(a==null||a[E[0]]===void 0))for(var m=0;m<E.length;m++)eg(E[m])&&(p+=Ip(R)+":"+tg(R,E[m])+";");else{var S=af(r,a,E);switch(R){case"animation":case"animationName":{p+=Ip(R)+":"+S+";";break}default:p+=R+"{"+S+"}"}}}}return p}var ng=/label:\s*([^\s;{]+)\s*(;|$)/g,ac;function om(r,a,d){if(r.length===1&&typeof r[0]=="object"&&r[0]!==null&&r[0].styles!==void 0)return r[0];var p=!0,g="";ac=void 0;var R=r[0];if(R==null||R.raw===void 0)p=!1,g+=af(d,a,R);else{var E=R;g+=E[0]}for(var w=1;w<r.length;w++)if(g+=af(d,a,r[w]),p){var m=R;g+=m[w]}ng.lastIndex=0;for(var S="",b;(b=ng.exec(g))!==null;)S+="-"+b[1];var I=Ub(g)+S;return{name:I,styles:g,next:ac}}var zb=function(a){return a()},_v=Zh.useInsertionEffect?Zh.useInsertionEffect:!1,qb=_v||zb,rg=_v||ae.useLayoutEffect,Cv=ae.createContext(typeof HTMLElement<"u"?pv({key:"css"}):null),Kb=Cv.Provider,Tv=function(a){return ae.forwardRef(function(d,p){var g=ae.useContext(Cv);return a(d,g,p)})},th=ae.createContext({}),Yb=Tv(function(r,a){var d=r.styles,p=om([d],void 0,ae.useContext(th)),g=ae.useRef();return rg(function(){var R=a.key+"-global",E=new a.sheet.constructor({key:R,nonce:a.sheet.nonce,container:a.sheet.container,speedy:a.sheet.isSpeedy}),w=!1,m=document.querySelector('style[data-emotion="'+R+" "+p.name+'"]');return a.sheet.tags.length&&(E.before=a.sheet.tags[0]),m!==null&&(w=!0,m.setAttribute("data-emotion",R),E.hydrate([m])),g.current=[E,w],function(){E.flush()}},[a]),rg(function(){var R=g.current,E=R[0],w=R[1];if(w){R[1]=!1;return}if(p.next!==void 0&&Sv(a,p.next,!0),E.tags.length){var m=E.tags[E.tags.length-1].nextElementSibling;E.before=m,E.flush()}a.insert("",p,E,!1)},[a,p.name]),null});function Rv(){for(var r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];return om(a)}var ap=function(){var a=Rv.apply(void 0,arguments),d="animation-"+a.name;return{name:d,styles:"@keyframes "+d+"{"+a.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Jb=Zy,Xb=function(a){return a!=="theme"},ig=function(a){return typeof a=="string"&&a.charCodeAt(0)>96?Jb:Xb},og=function(a,d,p){var g;if(d){var R=d.shouldForwardProp;g=a.__emotion_forwardProp&&R?function(E){return a.__emotion_forwardProp(E)&&R(E)}:R}return typeof g!="function"&&p&&(g=a.__emotion_forwardProp),g},Qb=function(a){var d=a.cache,p=a.serialized,g=a.isStringTag;return bv(d,p,g),qb(function(){return Sv(d,p,g)}),null},Zb=function r(a,d){var p=a.__emotion_real===a,g=p&&a.__emotion_base||a,R,E;d!==void 0&&(R=d.label,E=d.target);var w=og(a,d,p),m=w||ig(g),S=!m("as");return function(){var b=arguments,I=p&&a.__emotion_styles!==void 0?a.__emotion_styles.slice(0):[];if(R!==void 0&&I.push("label:"+R+";"),b[0]==null||b[0].raw===void 0)I.push.apply(I,b);else{I.push(b[0][0]);for(var _=b.length,A=1;A<_;A++)I.push(b[A],b[0][A])}var C=Tv(function(v,O,j){var D=S&&v.as||g,x="",N=[],$=v;if(v.theme==null){$={};for(var H in v)$[H]=v[H];$.theme=ae.useContext(th)}typeof v.className=="string"?x=jb(O.registered,N,v.className):v.className!=null&&(x=v.className+" ");var K=om(I.concat(N),O.registered,$);x+=O.key+"-"+K.name,E!==void 0&&(x+=" "+E);var ce=S&&w===void 0?ig(D):m,Q={};for(var Z in v)S&&Z==="as"||ce(Z)&&(Q[Z]=v[Z]);return Q.className=x,Q.ref=j,ae.createElement(ae.Fragment,null,ae.createElement(Qb,{cache:O,serialized:K,isStringTag:typeof D=="string"}),ae.createElement(D,Q))});return C.displayName=R!==void 0?R:"Styled("+(typeof g=="string"?g:g.displayName||g.name||"Component")+")",C.defaultProps=a.defaultProps,C.__emotion_real=C,C.__emotion_base=g,C.__emotion_styles=I,C.__emotion_forwardProp=w,Object.defineProperty(C,"toString",{value:function(){return"."+E}}),C.withComponent=function(v,O){return r(v,Ne({},d,O,{shouldForwardProp:og(C,O,!0)})).apply(void 0,I)},C}},eS=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],jp=Zb.bind();eS.forEach(function(r){jp[r]=jp(r)});let Up;typeof document=="object"&&(Up=pv({key:"css",prepend:!0}));function tS(r){const{injectFirst:a,children:d}=r;return a&&Up?ut.jsx(Kb,{value:Up,children:d}):d}function nS(r){return r==null||Object.keys(r).length===0}function wv(r){const{styles:a,defaultTheme:d={}}=r,p=typeof a=="function"?g=>a(nS(g)?d:g):a;return ut.jsx(Yb,{styles:p})}function am(r,a){return jp(r,a)}const Iv=(r,a)=>{Array.isArray(r.__emotion_styles)&&(r.__emotion_styles=a(r.__emotion_styles))},lR=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:wv,StyledEngineProvider:tS,ThemeContext:th,css:Rv,default:am,internal_processStyles:Iv,keyframes:ap},Symbol.toStringTag,{value:"Module"})),rS=["values","unit","step"],iS=r=>{const a=Object.keys(r).map(d=>({key:d,val:r[d]}))||[];return a.sort((d,p)=>d.val-p.val),a.reduce((d,p)=>Ne({},d,{[p.key]:p.val}),{})};function oS(r){const{values:a={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:d="px",step:p=5}=r,g=cr(r,rS),R=iS(a),E=Object.keys(R);function w(_){return`@media (min-width:${typeof a[_]=="number"?a[_]:_}${d})`}function m(_){return`@media (max-width:${(typeof a[_]=="number"?a[_]:_)-p/100}${d})`}function S(_,A){const C=E.indexOf(A);return`@media (min-width:${typeof a[_]=="number"?a[_]:_}${d}) and (max-width:${(C!==-1&&typeof a[E[C]]=="number"?a[E[C]]:A)-p/100}${d})`}function b(_){return E.indexOf(_)+1<E.length?S(_,E[E.indexOf(_)+1]):w(_)}function I(_){const A=E.indexOf(_);return A===0?w(E[1]):A===E.length-1?m(E[A]):S(_,E[E.indexOf(_)+1]).replace("@media","@media not all and")}return Ne({keys:E,values:R,up:w,down:m,between:S,only:b,not:I,unit:d},g)}const aS={borderRadius:4};function Yh(r,a){return a?cc(r,a,{clone:!1}):r}const sm={xs:0,sm:600,md:900,lg:1200,xl:1536},ag={keys:["xs","sm","md","lg","xl"],up:r=>`@media (min-width:${sm[r]}px)`};function Xc(r,a,d){const p=r.theme||{};if(Array.isArray(a)){const R=p.breakpoints||ag;return a.reduce((E,w,m)=>(E[R.up(R.keys[m])]=d(a[m]),E),{})}if(typeof a=="object"){const R=p.breakpoints||ag;return Object.keys(a).reduce((E,w)=>{if(Object.keys(R.values||sm).indexOf(w)!==-1){const m=R.up(w);E[m]=d(a[w],w)}else{const m=w;E[m]=a[m]}return E},{})}return d(a)}function kv(r={}){var a;return((a=r.keys)==null?void 0:a.reduce((p,g)=>{const R=r.up(g);return p[R]={},p},{}))||{}}function Ov(r,a){return r.reduce((d,p)=>{const g=d[p];return(!g||Object.keys(g).length===0)&&delete d[p],d},a)}function dR(r,...a){const d=kv(r),p=[d,...a].reduce((g,R)=>cc(g,R),{});return Ov(Object.keys(d),p)}function sS(r,a){if(typeof r!="object")return{};const d={},p=Object.keys(a);return Array.isArray(r)?p.forEach((g,R)=>{R<r.length&&(d[g]=!0)}):p.forEach(g=>{r[g]!=null&&(d[g]=!0)}),d}function hR({values:r,breakpoints:a,base:d}){const p=d||sS(r,a),g=Object.keys(p);if(g.length===0)return r;let R;return g.reduce((E,w,m)=>(Array.isArray(r)?(E[w]=r[m]!=null?r[m]:r[R],R=m):typeof r=="object"?(E[w]=r[w]!=null?r[w]:r[R],R=w):E[w]=r,E),{})}function sp(r,a,d=!0){if(!a||typeof a!="string")return null;if(r&&r.vars&&d){const p=`vars.${a}`.split(".").reduce((g,R)=>g&&g[R]?g[R]:null,r);if(p!=null)return p}return a.split(".").reduce((p,g)=>p&&p[g]!=null?p[g]:null,r)}function Nf(r,a,d,p=d){let g;return typeof r=="function"?g=r(d):Array.isArray(r)?g=r[d]||p:g=sp(r,d)||p,a&&(g=a(g,p,r)),g}function Or(r){const{prop:a,cssProperty:d=r.prop,themeKey:p,transform:g}=r,R=E=>{if(E[a]==null)return null;const w=E[a],m=E.theme,S=sp(m,p)||{};return Xc(E,w,I=>{let _=Nf(S,g,I);return I===_&&typeof I=="string"&&(_=Nf(S,g,`${a}${I==="default"?"":fi(I)}`,I)),d===!1?_:{[d]:_}})};return R.propTypes={},R.filterProps=[a],R}function cS(r){const a={};return d=>(a[d]===void 0&&(a[d]=r(d)),a[d])}const uS={m:"margin",p:"padding"},lS={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},sg={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},dS=cS(r=>{if(r.length>2)if(sg[r])r=sg[r];else return[r];const[a,d]=r.split(""),p=uS[a],g=lS[d]||"";return Array.isArray(g)?g.map(R=>p+R):[p+g]}),cm=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],um=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...cm,...um];function uf(r,a,d,p){var g;const R=(g=sp(r,a,!1))!=null?g:d;return typeof R=="number"?E=>typeof E=="string"?E:R*E:Array.isArray(R)?E=>typeof E=="string"?E:R[E]:typeof R=="function"?R:()=>{}}function Av(r){return uf(r,"spacing",8)}function lf(r,a){if(typeof a=="string"||a==null)return a;const d=Math.abs(a),p=r(d);return a>=0?p:typeof p=="number"?-p:`-${p}`}function hS(r,a){return d=>r.reduce((p,g)=>(p[g]=lf(a,d),p),{})}function fS(r,a,d,p){if(a.indexOf(d)===-1)return null;const g=dS(d),R=hS(g,p),E=r[d];return Xc(r,E,R)}function Pv(r,a){const d=Av(r.theme);return Object.keys(r).map(p=>fS(r,a,p,d)).reduce(Yh,{})}function vr(r){return Pv(r,cm)}vr.propTypes={};vr.filterProps=cm;function yr(r){return Pv(r,um)}yr.propTypes={};yr.filterProps=um;function pS(r=8){if(r.mui)return r;const a=Av({spacing:r}),d=(...p)=>(p.length===0?[1]:p).map(R=>{const E=a(R);return typeof E=="number"?`${E}px`:E}).join(" ");return d.mui=!0,d}function cp(...r){const a=r.reduce((p,g)=>(g.filterProps.forEach(R=>{p[R]=g}),p),{}),d=p=>Object.keys(p).reduce((g,R)=>a[R]?Yh(g,a[R](p)):g,{});return d.propTypes={},d.filterProps=r.reduce((p,g)=>p.concat(g.filterProps),[]),d}function Ra(r){return typeof r!="number"?r:`${r}px solid`}function Ia(r,a){return Or({prop:r,themeKey:"borders",transform:a})}const mS=Ia("border",Ra),gS=Ia("borderTop",Ra),vS=Ia("borderRight",Ra),yS=Ia("borderBottom",Ra),bS=Ia("borderLeft",Ra),SS=Ia("borderColor"),ES=Ia("borderTopColor"),_S=Ia("borderRightColor"),CS=Ia("borderBottomColor"),TS=Ia("borderLeftColor"),RS=Ia("outline",Ra),wS=Ia("outlineColor"),up=r=>{if(r.borderRadius!==void 0&&r.borderRadius!==null){const a=uf(r.theme,"shape.borderRadius",4),d=p=>({borderRadius:lf(a,p)});return Xc(r,r.borderRadius,d)}return null};up.propTypes={};up.filterProps=["borderRadius"];cp(mS,gS,vS,yS,bS,SS,ES,_S,CS,TS,up,RS,wS);const lp=r=>{if(r.gap!==void 0&&r.gap!==null){const a=uf(r.theme,"spacing",8),d=p=>({gap:lf(a,p)});return Xc(r,r.gap,d)}return null};lp.propTypes={};lp.filterProps=["gap"];const dp=r=>{if(r.columnGap!==void 0&&r.columnGap!==null){const a=uf(r.theme,"spacing",8),d=p=>({columnGap:lf(a,p)});return Xc(r,r.columnGap,d)}return null};dp.propTypes={};dp.filterProps=["columnGap"];const hp=r=>{if(r.rowGap!==void 0&&r.rowGap!==null){const a=uf(r.theme,"spacing",8),d=p=>({rowGap:lf(a,p)});return Xc(r,r.rowGap,d)}return null};hp.propTypes={};hp.filterProps=["rowGap"];const IS=Or({prop:"gridColumn"}),kS=Or({prop:"gridRow"}),OS=Or({prop:"gridAutoFlow"}),AS=Or({prop:"gridAutoColumns"}),PS=Or({prop:"gridAutoRows"}),xS=Or({prop:"gridTemplateColumns"}),DS=Or({prop:"gridTemplateRows"}),MS=Or({prop:"gridTemplateAreas"}),NS=Or({prop:"gridArea"});cp(lp,dp,hp,IS,kS,OS,AS,PS,xS,DS,MS,NS);function Kd(r,a){return a==="grey"?a:r}const LS=Or({prop:"color",themeKey:"palette",transform:Kd}),BS=Or({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Kd}),jS=Or({prop:"backgroundColor",themeKey:"palette",transform:Kd});cp(LS,BS,jS);function Zo(r){return r<=1&&r!==0?`${r*100}%`:r}const US=Or({prop:"width",transform:Zo}),lm=r=>{if(r.maxWidth!==void 0&&r.maxWidth!==null){const a=d=>{var p,g;const R=((p=r.theme)==null||(p=p.breakpoints)==null||(p=p.values)==null?void 0:p[d])||sm[d];return R?((g=r.theme)==null||(g=g.breakpoints)==null?void 0:g.unit)!=="px"?{maxWidth:`${R}${r.theme.breakpoints.unit}`}:{maxWidth:R}:{maxWidth:Zo(d)}};return Xc(r,r.maxWidth,a)}return null};lm.filterProps=["maxWidth"];const FS=Or({prop:"minWidth",transform:Zo}),$S=Or({prop:"height",transform:Zo}),VS=Or({prop:"maxHeight",transform:Zo}),WS=Or({prop:"minHeight",transform:Zo});Or({prop:"size",cssProperty:"width",transform:Zo});Or({prop:"size",cssProperty:"height",transform:Zo});const GS=Or({prop:"boxSizing"});cp(US,lm,FS,$S,VS,WS,GS);const fp={border:{themeKey:"borders",transform:Ra},borderTop:{themeKey:"borders",transform:Ra},borderRight:{themeKey:"borders",transform:Ra},borderBottom:{themeKey:"borders",transform:Ra},borderLeft:{themeKey:"borders",transform:Ra},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ra},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:up},color:{themeKey:"palette",transform:Kd},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Kd},backgroundColor:{themeKey:"palette",transform:Kd},p:{style:yr},pt:{style:yr},pr:{style:yr},pb:{style:yr},pl:{style:yr},px:{style:yr},py:{style:yr},padding:{style:yr},paddingTop:{style:yr},paddingRight:{style:yr},paddingBottom:{style:yr},paddingLeft:{style:yr},paddingX:{style:yr},paddingY:{style:yr},paddingInline:{style:yr},paddingInlineStart:{style:yr},paddingInlineEnd:{style:yr},paddingBlock:{style:yr},paddingBlockStart:{style:yr},paddingBlockEnd:{style:yr},m:{style:vr},mt:{style:vr},mr:{style:vr},mb:{style:vr},ml:{style:vr},mx:{style:vr},my:{style:vr},margin:{style:vr},marginTop:{style:vr},marginRight:{style:vr},marginBottom:{style:vr},marginLeft:{style:vr},marginX:{style:vr},marginY:{style:vr},marginInline:{style:vr},marginInlineStart:{style:vr},marginInlineEnd:{style:vr},marginBlock:{style:vr},marginBlockStart:{style:vr},marginBlockEnd:{style:vr},displayPrint:{cssProperty:!1,transform:r=>({"@media print":{display:r}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:lp},rowGap:{style:hp},columnGap:{style:dp},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Zo},maxWidth:{style:lm},minWidth:{transform:Zo},height:{transform:Zo},maxHeight:{transform:Zo},minHeight:{transform:Zo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function HS(...r){const a=r.reduce((p,g)=>p.concat(Object.keys(g)),[]),d=new Set(a);return r.every(p=>d.size===Object.keys(p).length)}function zS(r,a){return typeof r=="function"?r(a):r}function qS(){function r(d,p,g,R){const E={[d]:p,theme:g},w=R[d];if(!w)return{[d]:p};const{cssProperty:m=d,themeKey:S,transform:b,style:I}=w;if(p==null)return null;if(S==="typography"&&p==="inherit")return{[d]:p};const _=sp(g,S)||{};return I?I(E):Xc(E,p,C=>{let v=Nf(_,b,C);return C===v&&typeof C=="string"&&(v=Nf(_,b,`${d}${C==="default"?"":fi(C)}`,C)),m===!1?v:{[m]:v}})}function a(d){var p;const{sx:g,theme:R={}}=d||{};if(!g)return null;const E=(p=R.unstable_sxConfig)!=null?p:fp;function w(m){let S=m;if(typeof m=="function")S=m(R);else if(typeof m!="object")return m;if(!S)return null;const b=kv(R.breakpoints),I=Object.keys(b);let _=b;return Object.keys(S).forEach(A=>{const C=zS(S[A],R);if(C!=null)if(typeof C=="object")if(E[A])_=Yh(_,r(A,C,R,E));else{const v=Xc({theme:R},C,O=>({[A]:O}));HS(v,C)?_[A]=a({sx:C,theme:R}):_=Yh(_,v)}else _=Yh(_,r(A,C,R,E))}),Ov(I,_)}return Array.isArray(g)?g.map(w):w(g)}return a}const df=qS();df.filterProps=["sx"];function KS(r,a){const d=this;return d.vars&&typeof d.getColorSchemeSelector=="function"?{[d.getColorSchemeSelector(r).replace(/(\[[^\]]+\])/,"*:where($1)")]:a}:d.palette.mode===r?a:{}}const YS=["breakpoints","palette","spacing","shape"];function dm(r={},...a){const{breakpoints:d={},palette:p={},spacing:g,shape:R={}}=r,E=cr(r,YS),w=oS(d),m=pS(g);let S=cc({breakpoints:w,direction:"ltr",components:{},palette:Ne({mode:"light"},p),spacing:m,shape:Ne({},aS,R)},E);return S.applyStyles=KS,S=a.reduce((b,I)=>cc(b,I),S),S.unstable_sxConfig=Ne({},fp,E==null?void 0:E.unstable_sxConfig),S.unstable_sx=function(I){return df({sx:I,theme:this})},S}function JS(r){return Object.keys(r).length===0}function xv(r=null){const a=ae.useContext(th);return!a||JS(a)?r:a}const XS=dm();function pp(r=XS){return xv(r)}function QS({styles:r,themeId:a,defaultTheme:d={}}){const p=pp(d),g=typeof r=="function"?r(a&&p[a]||p):r;return ut.jsx(wv,{styles:g})}const ZS=["sx"],eE=r=>{var a,d;const p={systemProps:{},otherProps:{}},g=(a=r==null||(d=r.theme)==null?void 0:d.unstable_sxConfig)!=null?a:fp;return Object.keys(r).forEach(R=>{g[R]?p.systemProps[R]=r[R]:p.otherProps[R]=r[R]}),p};function tE(r){const{sx:a}=r,d=cr(r,ZS),{systemProps:p,otherProps:g}=eE(d);let R;return Array.isArray(a)?R=[p,...a]:typeof a=="function"?R=(...E)=>{const w=a(...E);return Ju(w)?Ne({},p,w):p}:R=Ne({},p,a),Ne({},g,{sx:R})}function Dv(r){var a,d,p="";if(typeof r=="string"||typeof r=="number")p+=r;else if(typeof r=="object")if(Array.isArray(r)){var g=r.length;for(a=0;a<g;a++)r[a]&&(d=Dv(r[a]))&&(p&&(p+=" "),p+=d)}else for(d in r)r[d]&&(p&&(p+=" "),p+=d);return p}function nE(){for(var r,a,d=0,p="",g=arguments.length;d<g;d++)(r=arguments[d])&&(a=Dv(r))&&(p&&(p+=" "),p+=a);return p}const rE=["className","component"];function iE(r={}){const{themeId:a,defaultTheme:d,defaultClassName:p="MuiBox-root",generateClassName:g}=r,R=am("div",{shouldForwardProp:w=>w!=="theme"&&w!=="sx"&&w!=="as"})(df);return ae.forwardRef(function(m,S){const b=pp(d),I=tE(m),{className:_,component:A="div"}=I,C=cr(I,rE);return ut.jsx(R,Ne({as:A,ref:S,className:nE(_,g?g(p):p),theme:a&&b[a]||b},C))})}const oE=["ownerState"],aE=["variants"],sE=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function cE(r){return Object.keys(r).length===0}function uE(r){return typeof r=="string"&&r.charCodeAt(0)>96}function Jh(r){return r!=="ownerState"&&r!=="theme"&&r!=="sx"&&r!=="as"}const lE=dm(),dE=r=>r&&r.charAt(0).toLowerCase()+r.slice(1);function bf({defaultTheme:r,theme:a,themeId:d}){return cE(a)?r:a[d]||a}function hE(r){return r?(a,d)=>d[r]:null}function If(r,a){let{ownerState:d}=a,p=cr(a,oE);const g=typeof r=="function"?r(Ne({ownerState:d},p)):r;if(Array.isArray(g))return g.flatMap(R=>If(R,Ne({ownerState:d},p)));if(g&&typeof g=="object"&&Array.isArray(g.variants)){const{variants:R=[]}=g;let w=cr(g,aE);return R.forEach(m=>{let S=!0;typeof m.props=="function"?S=m.props(Ne({ownerState:d},p,d)):Object.keys(m.props).forEach(b=>{(d==null?void 0:d[b])!==m.props[b]&&p[b]!==m.props[b]&&(S=!1)}),S&&(Array.isArray(w)||(w=[w]),w.push(typeof m.style=="function"?m.style(Ne({ownerState:d},p,d)):m.style))}),w}return g}function fE(r={}){const{themeId:a,defaultTheme:d=lE,rootShouldForwardProp:p=Jh,slotShouldForwardProp:g=Jh}=r,R=E=>df(Ne({},E,{theme:bf(Ne({},E,{defaultTheme:d,themeId:a}))}));return R.__mui_systemSx=!0,(E,w={})=>{Iv(E,$=>$.filter(H=>!(H!=null&&H.__mui_systemSx)));const{name:m,slot:S,skipVariantsResolver:b,skipSx:I,overridesResolver:_=hE(dE(S))}=w,A=cr(w,sE),C=b!==void 0?b:S&&S!=="Root"&&S!=="root"||!1,v=I||!1;let O,j=Jh;S==="Root"||S==="root"?j=p:S?j=g:uE(E)&&(j=void 0);const D=am(E,Ne({shouldForwardProp:j,label:O},A)),x=$=>typeof $=="function"&&$.__emotion_real!==$||Ju($)?H=>If($,Ne({},H,{theme:bf({theme:H.theme,defaultTheme:d,themeId:a})})):$,N=($,...H)=>{let K=x($);const ce=H?H.map(x):[];m&&_&&ce.push(Se=>{const G=bf(Ne({},Se,{defaultTheme:d,themeId:a}));if(!G.components||!G.components[m]||!G.components[m].styleOverrides)return null;const ie=G.components[m].styleOverrides,de={};return Object.entries(ie).forEach(([ne,J])=>{de[ne]=If(J,Ne({},Se,{theme:G}))}),_(Se,de)}),m&&!C&&ce.push(Se=>{var G;const ie=bf(Ne({},Se,{defaultTheme:d,themeId:a})),de=ie==null||(G=ie.components)==null||(G=G[m])==null?void 0:G.variants;return If({variants:de},Ne({},Se,{theme:ie}))}),v||ce.push(R);const Q=ce.length-H.length;if(Array.isArray($)&&Q>0){const Se=new Array(Q).fill("");K=[...$,...Se],K.raw=[...$.raw,...Se]}const Z=D(K,...ce);return E.muiName&&(Z.muiName=E.muiName),Z};return D.withConfig&&(N.withConfig=D.withConfig),N}}function pE(r){const{theme:a,name:d,props:p}=r;return!a||!a.components||!a.components[d]||!a.components[d].defaultProps?p:Df(a.components[d].defaultProps,p)}function mE({props:r,name:a,defaultTheme:d,themeId:p}){let g=pp(d);return p&&(g=g[p]||g),pE({theme:g,name:a,props:r})}function hm(r,a=0,d=1){return Xy(r,a,d)}function gE(r){r=r.slice(1);const a=new RegExp(`.{1,${r.length>=6?2:1}}`,"g");let d=r.match(a);return d&&d[0].length===1&&(d=d.map(p=>p+p)),d?`rgb${d.length===4?"a":""}(${d.map((p,g)=>g<3?parseInt(p,16):Math.round(parseInt(p,16)/255*1e3)/1e3).join(", ")})`:""}function Hl(r){if(r.type)return r;if(r.charAt(0)==="#")return Hl(gE(r));const a=r.indexOf("("),d=r.substring(0,a);if(["rgb","rgba","hsl","hsla","color"].indexOf(d)===-1)throw new Error(Jd(9,r));let p=r.substring(a+1,r.length-1),g;if(d==="color"){if(p=p.split(" "),g=p.shift(),p.length===4&&p[3].charAt(0)==="/"&&(p[3]=p[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(g)===-1)throw new Error(Jd(10,g))}else p=p.split(",");return p=p.map(R=>parseFloat(R)),{type:d,values:p,colorSpace:g}}function mp(r){const{type:a,colorSpace:d}=r;let{values:p}=r;return a.indexOf("rgb")!==-1?p=p.map((g,R)=>R<3?parseInt(g,10):g):a.indexOf("hsl")!==-1&&(p[1]=`${p[1]}%`,p[2]=`${p[2]}%`),a.indexOf("color")!==-1?p=`${d} ${p.join(" ")}`:p=`${p.join(", ")}`,`${a}(${p})`}function vE(r){r=Hl(r);const{values:a}=r,d=a[0],p=a[1]/100,g=a[2]/100,R=p*Math.min(g,1-g),E=(S,b=(S+d/30)%12)=>g-R*Math.max(Math.min(b-3,9-b,1),-1);let w="rgb";const m=[Math.round(E(0)*255),Math.round(E(8)*255),Math.round(E(4)*255)];return r.type==="hsla"&&(w+="a",m.push(a[3])),mp({type:w,values:m})}function Fp(r){r=Hl(r);let a=r.type==="hsl"||r.type==="hsla"?Hl(vE(r)).values:r.values;return a=a.map(d=>(r.type!=="color"&&(d/=255),d<=.03928?d/12.92:((d+.055)/1.055)**2.4)),Number((.2126*a[0]+.7152*a[1]+.0722*a[2]).toFixed(3))}function yE(r,a){const d=Fp(r),p=Fp(a);return(Math.max(d,p)+.05)/(Math.min(d,p)+.05)}function $r(r,a){return r=Hl(r),a=hm(a),(r.type==="rgb"||r.type==="hsl")&&(r.type+="a"),r.type==="color"?r.values[3]=`/${a}`:r.values[3]=a,mp(r)}function Lf(r,a){if(r=Hl(r),a=hm(a),r.type.indexOf("hsl")!==-1)r.values[2]*=1-a;else if(r.type.indexOf("rgb")!==-1||r.type.indexOf("color")!==-1)for(let d=0;d<3;d+=1)r.values[d]*=1-a;return mp(r)}function Bf(r,a){if(r=Hl(r),a=hm(a),r.type.indexOf("hsl")!==-1)r.values[2]+=(100-r.values[2])*a;else if(r.type.indexOf("rgb")!==-1)for(let d=0;d<3;d+=1)r.values[d]+=(255-r.values[d])*a;else if(r.type.indexOf("color")!==-1)for(let d=0;d<3;d+=1)r.values[d]+=(1-r.values[d])*a;return mp(r)}function bE(r,a=.15){return Fp(r)>.5?Lf(r,a):Bf(r,a)}const Mv=ae.createContext(null);function Nv(){return ae.useContext(Mv)}const SE=typeof Symbol=="function"&&Symbol.for,EE=SE?Symbol.for("mui.nested"):"__THEME_NESTED__";function _E(r,a){return typeof a=="function"?a(r):Ne({},r,a)}function CE(r){const{children:a,theme:d}=r,p=Nv(),g=ae.useMemo(()=>{const R=p===null?d:_E(p,d);return R!=null&&(R[EE]=p!==null),R},[d,p]);return ut.jsx(Mv.Provider,{value:g,children:a})}const TE=["value"],RE=ae.createContext();function wE(r){let{value:a}=r,d=cr(r,TE);return ut.jsx(RE.Provider,Ne({value:a??!0},d))}const Lv=ae.createContext(void 0);function IE({value:r,children:a}){return ut.jsx(Lv.Provider,{value:r,children:a})}function kE(r){const{theme:a,name:d,props:p}=r;if(!a||!a.components||!a.components[d])return p;const g=a.components[d];return g.defaultProps?Df(g.defaultProps,p):!g.styleOverrides&&!g.variants?Df(g,p):p}function fR({props:r,name:a}){const d=ae.useContext(Lv);return kE({props:r,name:a,theme:{components:d}})}const cg={};function ug(r,a,d,p=!1){return ae.useMemo(()=>{const g=r&&a[r]||a;if(typeof d=="function"){const R=d(g),E=r?Ne({},a,{[r]:R}):R;return p?()=>E:E}return r?Ne({},a,{[r]:d}):Ne({},a,d)},[r,a,d,p])}function OE(r){const{children:a,theme:d,themeId:p}=r,g=xv(cg),R=Nv()||cg,E=ug(p,g,d),w=ug(p,R,d,!0),m=E.direction==="rtl";return ut.jsx(CE,{theme:w,children:ut.jsx(th.Provider,{value:E,children:ut.jsx(wE,{value:m,children:ut.jsx(IE,{value:E==null?void 0:E.components,children:a})})})})}function AE(r,a){return Ne({toolbar:{minHeight:56,[r.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[r.up("sm")]:{minHeight:64}}},a)}const PE=["mode","contrastThreshold","tonalOffset"],lg={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:nf.white,default:nf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},kp={text:{primary:nf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:nf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function dg(r,a,d,p){const g=p.light||p,R=p.dark||p*1.5;r[a]||(r.hasOwnProperty(d)?r[a]=r[d]:a==="light"?r.light=Bf(r.main,g):a==="dark"&&(r.dark=Lf(r.main,R)))}function xE(r="light"){return r==="dark"?{main:Dd[200],light:Dd[50],dark:Dd[400]}:{main:Dd[700],light:Dd[400],dark:Dd[800]}}function DE(r="light"){return r==="dark"?{main:xd[200],light:xd[50],dark:xd[400]}:{main:xd[500],light:xd[300],dark:xd[700]}}function ME(r="light"){return r==="dark"?{main:Pd[500],light:Pd[300],dark:Pd[700]}:{main:Pd[700],light:Pd[400],dark:Pd[800]}}function NE(r="light"){return r==="dark"?{main:Md[400],light:Md[300],dark:Md[700]}:{main:Md[700],light:Md[500],dark:Md[900]}}function LE(r="light"){return r==="dark"?{main:Nd[400],light:Nd[300],dark:Nd[700]}:{main:Nd[800],light:Nd[500],dark:Nd[900]}}function BE(r="light"){return r==="dark"?{main:Wh[400],light:Wh[300],dark:Wh[700]}:{main:"#ed6c02",light:Wh[500],dark:Wh[900]}}function jE(r){const{mode:a="light",contrastThreshold:d=3,tonalOffset:p=.2}=r,g=cr(r,PE),R=r.primary||xE(a),E=r.secondary||DE(a),w=r.error||ME(a),m=r.info||NE(a),S=r.success||LE(a),b=r.warning||BE(a);function I(v){return yE(v,kp.text.primary)>=d?kp.text.primary:lg.text.primary}const _=({color:v,name:O,mainShade:j=500,lightShade:D=300,darkShade:x=700})=>{if(v=Ne({},v),!v.main&&v[j]&&(v.main=v[j]),!v.hasOwnProperty("main"))throw new Error(Jd(11,O?` (${O})`:"",j));if(typeof v.main!="string")throw new Error(Jd(12,O?` (${O})`:"",JSON.stringify(v.main)));return dg(v,"light",D,p),dg(v,"dark",x,p),v.contrastText||(v.contrastText=I(v.main)),v},A={dark:kp,light:lg};return cc(Ne({common:Ne({},nf),mode:a,primary:_({color:R,name:"primary"}),secondary:_({color:E,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:_({color:w,name:"error"}),warning:_({color:b,name:"warning"}),info:_({color:m,name:"info"}),success:_({color:S,name:"success"}),grey:jy,contrastThreshold:d,getContrastText:I,augmentColor:_,tonalOffset:p},A[a]),g)}const UE=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function FE(r){return Math.round(r*1e5)/1e5}const hg={textTransform:"uppercase"},fg='"Roboto", "Helvetica", "Arial", sans-serif';function $E(r,a){const d=typeof a=="function"?a(r):a,{fontFamily:p=fg,fontSize:g=14,fontWeightLight:R=300,fontWeightRegular:E=400,fontWeightMedium:w=500,fontWeightBold:m=700,htmlFontSize:S=16,allVariants:b,pxToRem:I}=d,_=cr(d,UE),A=g/14,C=I||(j=>`${j/S*A}rem`),v=(j,D,x,N,$)=>Ne({fontFamily:p,fontWeight:j,fontSize:C(D),lineHeight:x},p===fg?{letterSpacing:`${FE(N/D)}em`}:{},$,b),O={h1:v(R,96,1.167,-1.5),h2:v(R,60,1.2,-.5),h3:v(E,48,1.167,0),h4:v(E,34,1.235,.25),h5:v(E,24,1.334,0),h6:v(w,20,1.6,.15),subtitle1:v(E,16,1.75,.15),subtitle2:v(w,14,1.57,.1),body1:v(E,16,1.5,.15),body2:v(E,14,1.43,.15),button:v(w,14,1.75,.4,hg),caption:v(E,12,1.66,.4),overline:v(E,12,2.66,1,hg)};return cc(Ne({htmlFontSize:S,pxToRem:C,fontFamily:p,fontSize:g,fontWeightLight:R,fontWeightRegular:E,fontWeightMedium:w,fontWeightBold:m},O),_,{clone:!1})}const VE=.2,WE=.14,GE=.12;function ir(...r){return[`${r[0]}px ${r[1]}px ${r[2]}px ${r[3]}px rgba(0,0,0,${VE})`,`${r[4]}px ${r[5]}px ${r[6]}px ${r[7]}px rgba(0,0,0,${WE})`,`${r[8]}px ${r[9]}px ${r[10]}px ${r[11]}px rgba(0,0,0,${GE})`].join(",")}const HE=["none",ir(0,2,1,-1,0,1,1,0,0,1,3,0),ir(0,3,1,-2,0,2,2,0,0,1,5,0),ir(0,3,3,-2,0,3,4,0,0,1,8,0),ir(0,2,4,-1,0,4,5,0,0,1,10,0),ir(0,3,5,-1,0,5,8,0,0,1,14,0),ir(0,3,5,-1,0,6,10,0,0,1,18,0),ir(0,4,5,-2,0,7,10,1,0,2,16,1),ir(0,5,5,-3,0,8,10,1,0,3,14,2),ir(0,5,6,-3,0,9,12,1,0,3,16,2),ir(0,6,6,-3,0,10,14,1,0,4,18,3),ir(0,6,7,-4,0,11,15,1,0,4,20,3),ir(0,7,8,-4,0,12,17,2,0,5,22,4),ir(0,7,8,-4,0,13,19,2,0,5,24,4),ir(0,7,9,-4,0,14,21,2,0,5,26,4),ir(0,8,9,-5,0,15,22,2,0,6,28,5),ir(0,8,10,-5,0,16,24,2,0,6,30,5),ir(0,8,11,-5,0,17,26,2,0,6,32,5),ir(0,9,11,-5,0,18,28,2,0,7,34,6),ir(0,9,12,-6,0,19,29,2,0,7,36,6),ir(0,10,13,-6,0,20,31,3,0,8,38,7),ir(0,10,13,-6,0,21,33,3,0,8,40,7),ir(0,10,14,-6,0,22,35,3,0,8,42,7),ir(0,11,14,-7,0,23,36,3,0,9,44,8),ir(0,11,15,-7,0,24,38,3,0,9,46,8)],zE=["duration","easing","delay"],qE={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},KE={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function pg(r){return`${Math.round(r)}ms`}function YE(r){if(!r)return 0;const a=r/36;return Math.round((4+15*a**.25+a/5)*10)}function JE(r){const a=Ne({},qE,r.easing),d=Ne({},KE,r.duration);return Ne({getAutoHeightDuration:YE,create:(g=["all"],R={})=>{const{duration:E=d.standard,easing:w=a.easeInOut,delay:m=0}=R;return cr(R,zE),(Array.isArray(g)?g:[g]).map(S=>`${S} ${typeof E=="string"?E:pg(E)} ${w} ${typeof m=="string"?m:pg(m)}`).join(",")}},r,{easing:a,duration:d})}const XE={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},QE=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Bv(r={},...a){const{mixins:d={},palette:p={},transitions:g={},typography:R={}}=r,E=cr(r,QE);if(r.vars)throw new Error(Jd(18));const w=jE(p),m=dm(r);let S=cc(m,{mixins:AE(m.breakpoints,d),palette:w,shadows:HE.slice(),typography:$E(w,R),transitions:JE(g),zIndex:Ne({},XE)});return S=cc(S,E),S=a.reduce((b,I)=>cc(b,I),S),S.unstable_sxConfig=Ne({},fp,E==null?void 0:E.unstable_sxConfig),S.unstable_sx=function(I){return df({sx:I,theme:this})},S}const gp=Bv();function fm(){return pp(gp)}function eu({props:r,name:a}){return mE({props:r,name:a,defaultTheme:gp})}const ZE=r=>Jh(r)&&r!=="classes",pR=Jh,Do=fE({defaultTheme:gp,rootShouldForwardProp:ZE}),mg=r=>{let a;return r<1?a=5.11916*r**2:a=4.5*Math.log(r+1)+2,(a/100).toFixed(2)};function jv(r){var a,d,p="";if(typeof r=="string"||typeof r=="number")p+=r;else if(typeof r=="object")if(Array.isArray(r))for(a=0;a<r.length;a++)r[a]&&(d=jv(r[a]))&&(p&&(p+=" "),p+=d);else for(a in r)r[a]&&(p&&(p+=" "),p+=a);return p}function Ji(){for(var r,a,d=0,p="";d<arguments.length;)(r=arguments[d++])&&(a=jv(r))&&(p&&(p+=" "),p+=a);return p}function gg(r){return r.substring(2).toLowerCase()}function e_(r,a){return a.documentElement.clientWidth<r.clientX||a.documentElement.clientHeight<r.clientY}function t_(r){const{children:a,disableReactTree:d=!1,mouseEvent:p="onClick",onClickAway:g,touchEvent:R="onTouchEnd"}=r,E=ae.useRef(!1),w=ae.useRef(null),m=ae.useRef(!1),S=ae.useRef(!1);ae.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const b=xf(a.ref,w),I=Vl(C=>{const v=S.current;S.current=!1;const O=Rp(w.current);if(!m.current||!w.current||"clientX"in C&&e_(C,O))return;if(E.current){E.current=!1;return}let j;C.composedPath?j=C.composedPath().indexOf(w.current)>-1:j=!O.documentElement.contains(C.target)||w.current.contains(C.target),!j&&(d||!v)&&g(C)}),_=C=>v=>{S.current=!0;const O=a.props[C];O&&O(v)},A={ref:b};return R!==!1&&(A[R]=_(R)),ae.useEffect(()=>{if(R!==!1){const C=gg(R),v=Rp(w.current),O=()=>{E.current=!0};return v.addEventListener(C,I),v.addEventListener("touchmove",O),()=>{v.removeEventListener(C,I),v.removeEventListener("touchmove",O)}}},[I,R]),p!==!1&&(A[p]=_(p)),ae.useEffect(()=>{if(p!==!1){const C=gg(p),v=Rp(w.current);return v.addEventListener(C,I),()=>{v.removeEventListener(C,I)}}},[I,p]),ut.jsx(ae.Fragment,{children:ae.cloneElement(a,A)})}function n_(r){return Xi("MuiSvgIcon",r)}ii("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const r_=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],i_=r=>{const{color:a,fontSize:d,classes:p}=r,g={root:["root",a!=="inherit"&&`color${fi(a)}`,`fontSize${fi(d)}`]};return ql(g,n_,p)},o_=Do("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:d}=r;return[a.root,d.color!=="inherit"&&a[`color${fi(d.color)}`],a[`fontSize${fi(d.fontSize)}`]]}})(({theme:r,ownerState:a})=>{var d,p,g,R,E,w,m,S,b,I,_,A,C,v,O,j,D;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:(d=r.transitions)==null||(p=d.create)==null?void 0:p.call(d,"fill",{duration:(g=r.transitions)==null||(R=g.duration)==null?void 0:R.shorter}),fontSize:{inherit:"inherit",small:((E=r.typography)==null||(w=E.pxToRem)==null?void 0:w.call(E,20))||"1.25rem",medium:((m=r.typography)==null||(S=m.pxToRem)==null?void 0:S.call(m,24))||"1.5rem",large:((b=r.typography)==null||(I=b.pxToRem)==null?void 0:I.call(b,35))||"2.1875rem"}[a.fontSize],color:(_=(A=(r.vars||r).palette)==null||(C=A[a.color])==null?void 0:C.main)!=null?_:{action:(v=(r.vars||r).palette)==null||(O=v.action)==null?void 0:O.active,disabled:(j=(r.vars||r).palette)==null||(D=j.action)==null?void 0:D.disabled,inherit:void 0}[a.color]}}),lc=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiSvgIcon"}),{children:g,className:R,color:E="inherit",component:w="svg",fontSize:m="medium",htmlColor:S,inheritViewBox:b=!1,titleAccess:I,viewBox:_="0 0 24 24"}=p,A=cr(p,r_),C=Ne({},p,{color:E,component:w,fontSize:m,instanceFontSize:a.fontSize,inheritViewBox:b,viewBox:_}),v={};b||(v.viewBox=_);const O=i_(C);return ut.jsxs(o_,Ne({as:w,className:Ji(O.root,R),focusable:"false",color:S,"aria-hidden":I?void 0:!0,role:I?"img":void 0,ref:d},v,A,{ownerState:C,children:[g,I?ut.jsx("title",{children:I}):null]}))});lc.muiName="SvgIcon";function hf(r,a){function d(p,g){return ut.jsx(lc,Ne({"data-testid":`${a}Icon`,ref:g},p,{children:r}))}return d.muiName=lc.muiName,ae.memo(ae.forwardRef(d))}function $p(r,a){return $p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,p){return d.__proto__=p,d},$p(r,a)}function Uv(r,a){r.prototype=Object.create(a.prototype),r.prototype.constructor=r,$p(r,a)}const vg={disabled:!1},jf=sc.createContext(null);var a_=function(a){return a.scrollTop},qh="unmounted",Ul="exited",Fl="entering",Wd="entered",Vp="exiting",tu=function(r){Uv(a,r);function a(p,g){var R;R=r.call(this,p,g)||this;var E=g,w=E&&!E.isMounting?p.enter:p.appear,m;return R.appearStatus=null,p.in?w?(m=Ul,R.appearStatus=Fl):m=Wd:p.unmountOnExit||p.mountOnEnter?m=qh:m=Ul,R.state={status:m},R.nextCallback=null,R}a.getDerivedStateFromProps=function(g,R){var E=g.in;return E&&R.status===qh?{status:Ul}:null};var d=a.prototype;return d.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},d.componentDidUpdate=function(g){var R=null;if(g!==this.props){var E=this.state.status;this.props.in?E!==Fl&&E!==Wd&&(R=Fl):(E===Fl||E===Wd)&&(R=Vp)}this.updateStatus(!1,R)},d.componentWillUnmount=function(){this.cancelNextCallback()},d.getTimeouts=function(){var g=this.props.timeout,R,E,w;return R=E=w=g,g!=null&&typeof g!="number"&&(R=g.exit,E=g.enter,w=g.appear!==void 0?g.appear:E),{exit:R,enter:E,appear:w}},d.updateStatus=function(g,R){if(g===void 0&&(g=!1),R!==null)if(this.cancelNextCallback(),R===Fl){if(this.props.unmountOnExit||this.props.mountOnEnter){var E=this.props.nodeRef?this.props.nodeRef.current:vf.findDOMNode(this);E&&a_(E)}this.performEnter(g)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ul&&this.setState({status:qh})},d.performEnter=function(g){var R=this,E=this.props.enter,w=this.context?this.context.isMounting:g,m=this.props.nodeRef?[w]:[vf.findDOMNode(this),w],S=m[0],b=m[1],I=this.getTimeouts(),_=w?I.appear:I.enter;if(!g&&!E||vg.disabled){this.safeSetState({status:Wd},function(){R.props.onEntered(S)});return}this.props.onEnter(S,b),this.safeSetState({status:Fl},function(){R.props.onEntering(S,b),R.onTransitionEnd(_,function(){R.safeSetState({status:Wd},function(){R.props.onEntered(S,b)})})})},d.performExit=function(){var g=this,R=this.props.exit,E=this.getTimeouts(),w=this.props.nodeRef?void 0:vf.findDOMNode(this);if(!R||vg.disabled){this.safeSetState({status:Ul},function(){g.props.onExited(w)});return}this.props.onExit(w),this.safeSetState({status:Vp},function(){g.props.onExiting(w),g.onTransitionEnd(E.exit,function(){g.safeSetState({status:Ul},function(){g.props.onExited(w)})})})},d.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},d.safeSetState=function(g,R){R=this.setNextCallback(R),this.setState(g,R)},d.setNextCallback=function(g){var R=this,E=!0;return this.nextCallback=function(w){E&&(E=!1,R.nextCallback=null,g(w))},this.nextCallback.cancel=function(){E=!1},this.nextCallback},d.onTransitionEnd=function(g,R){this.setNextCallback(R);var E=this.props.nodeRef?this.props.nodeRef.current:vf.findDOMNode(this),w=g==null&&!this.props.addEndListener;if(!E||w){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[E,this.nextCallback],S=m[0],b=m[1];this.props.addEndListener(S,b)}g!=null&&setTimeout(this.nextCallback,g)},d.render=function(){var g=this.state.status;if(g===qh)return null;var R=this.props,E=R.children;R.in,R.mountOnEnter,R.unmountOnExit,R.appear,R.enter,R.exit,R.timeout,R.addEndListener,R.onEnter,R.onEntering,R.onEntered,R.onExit,R.onExiting,R.onExited,R.nodeRef;var w=cr(R,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return sc.createElement(jf.Provider,{value:null},typeof E=="function"?E(g,w):sc.cloneElement(sc.Children.only(E),w))},a}(sc.Component);tu.contextType=jf;tu.propTypes={};function Ld(){}tu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ld,onEntering:Ld,onEntered:Ld,onExit:Ld,onExiting:Ld,onExited:Ld};tu.UNMOUNTED=qh;tu.EXITED=Ul;tu.ENTERING=Fl;tu.ENTERED=Wd;tu.EXITING=Vp;function s_(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pm(r,a){var d=function(R){return a&&ae.isValidElement(R)?a(R):R},p=Object.create(null);return r&&ae.Children.map(r,function(g){return g}).forEach(function(g){p[g.key]=d(g)}),p}function c_(r,a){r=r||{},a=a||{};function d(b){return b in a?a[b]:r[b]}var p=Object.create(null),g=[];for(var R in r)R in a?g.length&&(p[R]=g,g=[]):g.push(R);var E,w={};for(var m in a){if(p[m])for(E=0;E<p[m].length;E++){var S=p[m][E];w[p[m][E]]=d(S)}w[m]=d(m)}for(E=0;E<g.length;E++)w[g[E]]=d(g[E]);return w}function Wl(r,a,d){return d[a]!=null?d[a]:r.props[a]}function u_(r,a){return pm(r.children,function(d){return ae.cloneElement(d,{onExited:a.bind(null,d),in:!0,appear:Wl(d,"appear",r),enter:Wl(d,"enter",r),exit:Wl(d,"exit",r)})})}function l_(r,a,d){var p=pm(r.children),g=c_(a,p);return Object.keys(g).forEach(function(R){var E=g[R];if(ae.isValidElement(E)){var w=R in a,m=R in p,S=a[R],b=ae.isValidElement(S)&&!S.props.in;m&&(!w||b)?g[R]=ae.cloneElement(E,{onExited:d.bind(null,E),in:!0,exit:Wl(E,"exit",r),enter:Wl(E,"enter",r)}):!m&&w&&!b?g[R]=ae.cloneElement(E,{in:!1}):m&&w&&ae.isValidElement(S)&&(g[R]=ae.cloneElement(E,{onExited:d.bind(null,E),in:S.props.in,exit:Wl(E,"exit",r),enter:Wl(E,"enter",r)}))}}),g}var d_=Object.values||function(r){return Object.keys(r).map(function(a){return r[a]})},h_={component:"div",childFactory:function(a){return a}},mm=function(r){Uv(a,r);function a(p,g){var R;R=r.call(this,p,g)||this;var E=R.handleExited.bind(s_(R));return R.state={contextValue:{isMounting:!0},handleExited:E,firstRender:!0},R}var d=a.prototype;return d.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},d.componentWillUnmount=function(){this.mounted=!1},a.getDerivedStateFromProps=function(g,R){var E=R.children,w=R.handleExited,m=R.firstRender;return{children:m?u_(g,w):l_(g,E,w),firstRender:!1}},d.handleExited=function(g,R){var E=pm(this.props.children);g.key in E||(g.props.onExited&&g.props.onExited(R),this.mounted&&this.setState(function(w){var m=Ne({},w.children);return delete m[g.key],{children:m}}))},d.render=function(){var g=this.props,R=g.component,E=g.childFactory,w=cr(g,["component","childFactory"]),m=this.state.contextValue,S=d_(this.state.children).map(E);return delete w.appear,delete w.enter,delete w.exit,R===null?sc.createElement(jf.Provider,{value:m},S):sc.createElement(jf.Provider,{value:m},sc.createElement(R,w,S))},a}(sc.Component);mm.propTypes={};mm.defaultProps=h_;const f_=r=>r.scrollTop;function yg(r,a){var d,p;const{timeout:g,easing:R,style:E={}}=r;return{duration:(d=E.transitionDuration)!=null?d:typeof g=="number"?g:g[a.mode]||0,easing:(p=E.transitionTimingFunction)!=null?p:typeof R=="object"?R[a.mode]:R,delay:E.transitionDelay}}function p_(r){return Xi("MuiPaper",r)}const m_=ii("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]),g_=["className","component","elevation","square","variant"],v_=r=>{const{square:a,elevation:d,variant:p,classes:g}=r,R={root:["root",p,!a&&"rounded",p==="elevation"&&`elevation${d}`]};return ql(R,p_,g)},y_=Do("div",{name:"MuiPaper",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:d}=r;return[a.root,a[d.variant],!d.square&&a.rounded,d.variant==="elevation"&&a[`elevation${d.elevation}`]]}})(({theme:r,ownerState:a})=>{var d;return Ne({backgroundColor:(r.vars||r).palette.background.paper,color:(r.vars||r).palette.text.primary,transition:r.transitions.create("box-shadow")},!a.square&&{borderRadius:r.shape.borderRadius},a.variant==="outlined"&&{border:`1px solid ${(r.vars||r).palette.divider}`},a.variant==="elevation"&&Ne({boxShadow:(r.vars||r).shadows[a.elevation]},!r.vars&&r.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${$r("#fff",mg(a.elevation))}, ${$r("#fff",mg(a.elevation))})`},r.vars&&{backgroundImage:(d=r.vars.overlays)==null?void 0:d[a.elevation]}))}),Fv=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiPaper"}),{className:g,component:R="div",elevation:E=1,square:w=!1,variant:m="elevation"}=p,S=cr(p,g_),b=Ne({},p,{component:R,elevation:E,square:w,variant:m}),I=v_(b);return ut.jsx(y_,Ne({as:R,ownerState:b,className:Ji(I.root,g),ref:d},S))});function b_(r){const{className:a,classes:d,pulsate:p=!1,rippleX:g,rippleY:R,rippleSize:E,in:w,onExited:m,timeout:S}=r,[b,I]=ae.useState(!1),_=Ji(a,d.ripple,d.rippleVisible,p&&d.ripplePulsate),A={width:E,height:E,top:-(E/2)+R,left:-(E/2)+g},C=Ji(d.child,b&&d.childLeaving,p&&d.childPulsate);return!w&&!b&&I(!0),ae.useEffect(()=>{if(!w&&m!=null){const v=setTimeout(m,S);return()=>{clearTimeout(v)}}},[m,w,S]),ut.jsx("span",{className:_,style:A,children:ut.jsx("span",{className:C})})}const Ta=ii("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),S_=["center","classes","className"];let vp=r=>r,bg,Sg,Eg,_g;const Wp=550,E_=80,__=ap(bg||(bg=vp`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),C_=ap(Sg||(Sg=vp`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),T_=ap(Eg||(Eg=vp`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),R_=Do("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),w_=Do(b_,{name:"MuiTouchRipple",slot:"Ripple"})(_g||(_g=vp`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Ta.rippleVisible,__,Wp,({theme:r})=>r.transitions.easing.easeInOut,Ta.ripplePulsate,({theme:r})=>r.transitions.duration.shorter,Ta.child,Ta.childLeaving,C_,Wp,({theme:r})=>r.transitions.easing.easeInOut,Ta.childPulsate,T_,({theme:r})=>r.transitions.easing.easeInOut),I_=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiTouchRipple"}),{center:g=!1,classes:R={},className:E}=p,w=cr(p,S_),[m,S]=ae.useState([]),b=ae.useRef(0),I=ae.useRef(null);ae.useEffect(()=>{I.current&&(I.current(),I.current=null)},[m]);const _=ae.useRef(!1),A=ae.useRef(null),C=ae.useRef(null),v=ae.useRef(null);ae.useEffect(()=>()=>{clearTimeout(A.current)},[]);const O=ae.useCallback(N=>{const{pulsate:$,rippleX:H,rippleY:K,rippleSize:ce,cb:Q}=N;S(Z=>[...Z,ut.jsx(w_,{classes:{ripple:Ji(R.ripple,Ta.ripple),rippleVisible:Ji(R.rippleVisible,Ta.rippleVisible),ripplePulsate:Ji(R.ripplePulsate,Ta.ripplePulsate),child:Ji(R.child,Ta.child),childLeaving:Ji(R.childLeaving,Ta.childLeaving),childPulsate:Ji(R.childPulsate,Ta.childPulsate)},timeout:Wp,pulsate:$,rippleX:H,rippleY:K,rippleSize:ce},b.current)]),b.current+=1,I.current=Q},[R]),j=ae.useCallback((N={},$={},H=()=>{})=>{const{pulsate:K=!1,center:ce=g||$.pulsate,fakeElement:Q=!1}=$;if((N==null?void 0:N.type)==="mousedown"&&_.current){_.current=!1;return}(N==null?void 0:N.type)==="touchstart"&&(_.current=!0);const Z=Q?null:v.current,Se=Z?Z.getBoundingClientRect():{width:0,height:0,left:0,top:0};let G,ie,de;if(ce||N===void 0||N.clientX===0&&N.clientY===0||!N.clientX&&!N.touches)G=Math.round(Se.width/2),ie=Math.round(Se.height/2);else{const{clientX:ne,clientY:J}=N.touches&&N.touches.length>0?N.touches[0]:N;G=Math.round(ne-Se.left),ie=Math.round(J-Se.top)}if(ce)de=Math.sqrt((2*Se.width**2+Se.height**2)/3),de%2===0&&(de+=1);else{const ne=Math.max(Math.abs((Z?Z.clientWidth:0)-G),G)*2+2,J=Math.max(Math.abs((Z?Z.clientHeight:0)-ie),ie)*2+2;de=Math.sqrt(ne**2+J**2)}N!=null&&N.touches?C.current===null&&(C.current=()=>{O({pulsate:K,rippleX:G,rippleY:ie,rippleSize:de,cb:H})},A.current=setTimeout(()=>{C.current&&(C.current(),C.current=null)},E_)):O({pulsate:K,rippleX:G,rippleY:ie,rippleSize:de,cb:H})},[g,O]),D=ae.useCallback(()=>{j({},{pulsate:!0})},[j]),x=ae.useCallback((N,$)=>{if(clearTimeout(A.current),(N==null?void 0:N.type)==="touchend"&&C.current){C.current(),C.current=null,A.current=setTimeout(()=>{x(N,$)});return}C.current=null,S(H=>H.length>0?H.slice(1):H),I.current=$},[]);return ae.useImperativeHandle(d,()=>({pulsate:D,start:j,stop:x}),[D,j,x]),ut.jsx(R_,Ne({className:Ji(Ta.root,R.root,E),ref:v},w,{children:ut.jsx(mm,{component:null,exit:!0,children:m})}))});function k_(r){return Xi("MuiButtonBase",r)}const O_=ii("MuiButtonBase",["root","disabled","focusVisible"]),A_=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],P_=r=>{const{disabled:a,focusVisible:d,focusVisibleClassName:p,classes:g}=r,E=ql({root:["root",a&&"disabled",d&&"focusVisible"]},k_,g);return d&&p&&(E.root+=` ${p}`),E},x_=Do("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(r,a)=>a.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${O_.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),D_=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiButtonBase"}),{action:g,centerRipple:R=!1,children:E,className:w,component:m="button",disabled:S=!1,disableRipple:b=!1,disableTouchRipple:I=!1,focusRipple:_=!1,LinkComponent:A="a",onBlur:C,onClick:v,onContextMenu:O,onDragLeave:j,onFocus:D,onFocusVisible:x,onKeyDown:N,onKeyUp:$,onMouseDown:H,onMouseLeave:K,onMouseUp:ce,onTouchEnd:Q,onTouchMove:Z,onTouchStart:Se,tabIndex:G=0,TouchRippleProps:ie,touchRippleRef:de,type:ne}=p,J=cr(p,A_),W=ae.useRef(null),X=ae.useRef(null),se=xf(X,de),{isFocusVisibleRef:he,onFocus:Ie,onBlur:we,ref:Qe}=Ky(),[Tt,vt]=ae.useState(!1);S&&Tt&&vt(!1),ae.useImperativeHandle(g,()=>({focusVisible:()=>{vt(!0),W.current.focus()}}),[]);const[Ut,Vt]=ae.useState(!1);ae.useEffect(()=>{Vt(!0)},[]);const Ht=Ut&&!b&&!S;ae.useEffect(()=>{Tt&&_&&!b&&Ut&&X.current.pulsate()},[b,_,Tt,Ut]);function Ge(Te,tt,lt=I){return Vl(Ve=>(tt&&tt(Ve),!lt&&X.current&&X.current[Te](Ve),!0))}const At=Ge("start",H),rn=Ge("stop",O),gn=Ge("stop",j),Dn=Ge("stop",ce),ur=Ge("stop",Te=>{Tt&&Te.preventDefault(),K&&K(Te)}),it=Ge("start",Se),Ar=Ge("stop",Q),ra=Ge("stop",Z),Qt=Ge("stop",Te=>{we(Te),he.current===!1&&vt(!1),C&&C(Te)},!1),xi=Vl(Te=>{W.current||(W.current=Te.currentTarget),Ie(Te),he.current===!0&&(vt(!0),x&&x(Te)),D&&D(Te)}),Di=()=>{const Te=W.current;return m&&m!=="button"&&!(Te.tagName==="A"&&Te.href)},oi=ae.useRef(!1),Qi=Vl(Te=>{_&&!oi.current&&Tt&&X.current&&Te.key===" "&&(oi.current=!0,X.current.stop(Te,()=>{X.current.start(Te)})),Te.target===Te.currentTarget&&Di()&&Te.key===" "&&Te.preventDefault(),N&&N(Te),Te.target===Te.currentTarget&&Di()&&Te.key==="Enter"&&!S&&(Te.preventDefault(),v&&v(Te))}),lr=Vl(Te=>{_&&Te.key===" "&&X.current&&Tt&&!Te.defaultPrevented&&(oi.current=!1,X.current.stop(Te,()=>{X.current.pulsate(Te)})),$&&$(Te),v&&Te.target===Te.currentTarget&&Di()&&Te.key===" "&&!Te.defaultPrevented&&v(Te)});let Wr=m;Wr==="button"&&(J.href||J.to)&&(Wr=A);const me={};Wr==="button"?(me.type=ne===void 0?"button":ne,me.disabled=S):(!J.href&&!J.to&&(me.role="button"),S&&(me["aria-disabled"]=S));const Ee=xf(d,Qe,W),ke=Ne({},p,{centerRipple:R,component:m,disabled:S,disableRipple:b,disableTouchRipple:I,focusRipple:_,tabIndex:G,focusVisible:Tt}),$e=P_(ke);return ut.jsxs(x_,Ne({as:Wr,className:Ji($e.root,w),ownerState:ke,onBlur:Qt,onClick:v,onContextMenu:rn,onFocus:xi,onKeyDown:Qi,onKeyUp:lr,onMouseDown:At,onMouseLeave:ur,onMouseUp:Dn,onDragLeave:gn,onTouchEnd:Ar,onTouchMove:ra,onTouchStart:it,ref:Ee,tabIndex:S?-1:G,type:ne},me,J,{children:[E,Ht?ut.jsx(I_,Ne({ref:se,center:R},ie)):null]}))});function M_(r){return Xi("MuiAlert",r)}const Uf=ii("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function N_(r){return Xi("MuiIconButton",r)}const L_=ii("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),B_=["edge","children","className","color","disabled","disableFocusRipple","size"],j_=r=>{const{classes:a,disabled:d,color:p,edge:g,size:R}=r,E={root:["root",d&&"disabled",p!=="default"&&`color${fi(p)}`,g&&`edge${fi(g)}`,`size${fi(R)}`]};return ql(E,N_,a)},U_=Do(D_,{name:"MuiIconButton",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:d}=r;return[a.root,d.color!=="default"&&a[`color${fi(d.color)}`],d.edge&&a[`edge${fi(d.edge)}`],a[`size${fi(d.size)}`]]}})(({theme:r,ownerState:a})=>Ne({textAlign:"center",flex:"0 0 auto",fontSize:r.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(r.vars||r).palette.action.active,transition:r.transitions.create("background-color",{duration:r.transitions.duration.shortest})},!a.disableRipple&&{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:$r(r.palette.action.active,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12}),({theme:r,ownerState:a})=>{var d;const p=(d=(r.vars||r).palette)==null?void 0:d[a.color];return Ne({},a.color==="inherit"&&{color:"inherit"},a.color!=="inherit"&&a.color!=="default"&&Ne({color:p==null?void 0:p.main},!a.disableRipple&&{"&:hover":Ne({},p&&{backgroundColor:r.vars?`rgba(${p.mainChannel} / ${r.vars.palette.action.hoverOpacity})`:$r(p.main,r.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),a.size==="small"&&{padding:5,fontSize:r.typography.pxToRem(18)},a.size==="large"&&{padding:12,fontSize:r.typography.pxToRem(28)},{[`&.${L_.disabled}`]:{backgroundColor:"transparent",color:(r.vars||r).palette.action.disabled}})}),F_=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiIconButton"}),{edge:g=!1,children:R,className:E,color:w="default",disabled:m=!1,disableFocusRipple:S=!1,size:b="medium"}=p,I=cr(p,B_),_=Ne({},p,{edge:g,color:w,disabled:m,disableFocusRipple:S,size:b}),A=j_(_);return ut.jsx(U_,Ne({className:Ji(A.root,E),centerRipple:!0,focusRipple:!S,disabled:m,ref:d,ownerState:_},I,{children:R}))}),$_=hf(ut.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),V_=hf(ut.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),W_=hf(ut.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),G_=hf(ut.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),H_=hf(ut.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),z_=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],q_=r=>{const{variant:a,color:d,severity:p,classes:g}=r,R={root:["root",`${a}${fi(d||p)}`,`${a}`],icon:["icon"],message:["message"],action:["action"]};return ql(R,M_,g)},K_=Do(Fv,{name:"MuiAlert",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:d}=r;return[a.root,a[d.variant],a[`${d.variant}${fi(d.color||d.severity)}`]]}})(({theme:r,ownerState:a})=>{const d=r.palette.mode==="light"?Lf:Bf,p=r.palette.mode==="light"?Bf:Lf,g=a.color||a.severity;return Ne({},r.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},g&&a.variant==="standard"&&{color:r.vars?r.vars.palette.Alert[`${g}Color`]:d(r.palette[g].light,.6),backgroundColor:r.vars?r.vars.palette.Alert[`${g}StandardBg`]:p(r.palette[g].light,.9),[`& .${Uf.icon}`]:r.vars?{color:r.vars.palette.Alert[`${g}IconColor`]}:{color:r.palette[g].main}},g&&a.variant==="outlined"&&{color:r.vars?r.vars.palette.Alert[`${g}Color`]:d(r.palette[g].light,.6),border:`1px solid ${(r.vars||r).palette[g].light}`,[`& .${Uf.icon}`]:r.vars?{color:r.vars.palette.Alert[`${g}IconColor`]}:{color:r.palette[g].main}},g&&a.variant==="filled"&&Ne({fontWeight:r.typography.fontWeightMedium},r.vars?{color:r.vars.palette.Alert[`${g}FilledColor`],backgroundColor:r.vars.palette.Alert[`${g}FilledBg`]}:{backgroundColor:r.palette.mode==="dark"?r.palette[g].dark:r.palette[g].main,color:r.palette.getContrastText(r.palette[g].main)}))}),Y_=Do("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(r,a)=>a.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),J_=Do("div",{name:"MuiAlert",slot:"Message",overridesResolver:(r,a)=>a.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),Cg=Do("div",{name:"MuiAlert",slot:"Action",overridesResolver:(r,a)=>a.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Tg={success:ut.jsx($_,{fontSize:"inherit"}),warning:ut.jsx(V_,{fontSize:"inherit"}),error:ut.jsx(W_,{fontSize:"inherit"}),info:ut.jsx(G_,{fontSize:"inherit"})},X_=ae.forwardRef(function(a,d){var p,g,R,E,w,m;const S=eu({props:a,name:"MuiAlert"}),{action:b,children:I,className:_,closeText:A="Close",color:C,components:v={},componentsProps:O={},icon:j,iconMapping:D=Tg,onClose:x,role:N="alert",severity:$="success",slotProps:H={},slots:K={},variant:ce="standard"}=S,Q=cr(S,z_),Z=Ne({},S,{color:C,severity:$,variant:ce}),Se=q_(Z),G=(p=(g=K.closeButton)!=null?g:v.CloseButton)!=null?p:F_,ie=(R=(E=K.closeIcon)!=null?E:v.CloseIcon)!=null?R:H_,de=(w=H.closeButton)!=null?w:O.closeButton,ne=(m=H.closeIcon)!=null?m:O.closeIcon;return ut.jsxs(K_,Ne({role:N,elevation:0,ownerState:Z,className:Ji(Se.root,_),ref:d},Q,{children:[j!==!1?ut.jsx(Y_,{ownerState:Z,className:Se.icon,children:j||D[$]||Tg[$]}):null,ut.jsx(J_,{ownerState:Z,className:Se.message,children:I}),b!=null?ut.jsx(Cg,{ownerState:Z,className:Se.action,children:b}):null,b==null&&x?ut.jsx(Cg,{ownerState:Z,className:Se.action,children:ut.jsx(G,Ne({size:"small","aria-label":A,title:A,color:"inherit",onClick:x},de,{children:ut.jsx(ie,Ne({fontSize:"small"},ne))}))}):null]}))});function mR(r){return Xi("MuiChip",r)}const Sf=ii("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]);function Q_(r){return ut.jsx(QS,Ne({},r,{defaultTheme:gp}))}function gR(r){return Xi("MuiInputBase",r)}const Xh=ii("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);function vR(r){return Xi("MuiOutlinedInput",r)}const Ku=Ne({},Xh,ii("MuiOutlinedInput",["root","notchedOutline","input"]));function yR(r){return Xi("MuiFilledInput",r)}const Rg=Ne({},Xh,ii("MuiFilledInput",["root","underline","input"])),Gp=ii("MuiAutocomplete",["root","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]),Z_=Bv(),eC=iE({defaultTheme:Z_,defaultClassName:"MuiBox-root",generateClassName:ov.generate}),tC=(r,a)=>Ne({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},a&&!r.vars&&{colorScheme:r.palette.mode}),nC=r=>Ne({color:(r.vars||r).palette.text.primary},r.typography.body1,{backgroundColor:(r.vars||r).palette.background.default,"@media print":{backgroundColor:(r.vars||r).palette.common.white}}),rC=(r,a=!1)=>{var d,p;const g={};a&&r.colorSchemes&&Object.entries(r.colorSchemes).forEach(([w,m])=>{var S;g[r.getColorSchemeSelector(w).replace(/\s*&/,"")]={colorScheme:(S=m.palette)==null?void 0:S.mode}});let R=Ne({html:tC(r,a),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.typography.fontWeightBold},body:Ne({margin:0},nC(r),{"&::backdrop":{backgroundColor:(r.vars||r).palette.background.default}})},g);const E=(d=r.components)==null||(p=d.MuiCssBaseline)==null?void 0:p.styleOverrides;return E&&(R=[R,E]),R};function iC(r){const a=eu({props:r,name:"MuiCssBaseline"}),{children:d,enableColorScheme:p=!1}=a;return ut.jsxs(ae.Fragment,{children:[ut.jsx(Q_,{styles:g=>rC(g,p)}),d]})}function bR(r){return Xi("MuiDialog",r)}const Ef=ii("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]);function SR(r){return Xi("MuiDialogActions",r)}const oC=ii("MuiDialogActions",["root","spacing"]);function ER(r){return Xi("MuiFormLabel",r)}const wg=ii("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),aC=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Hp(r){return`scale(${r}, ${r**2})`}const sC={entering:{opacity:1,transform:Hp(1)},entered:{opacity:1,transform:"none"}},Op=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),gm=ae.forwardRef(function(a,d){const{addEndListener:p,appear:g=!0,children:R,easing:E,in:w,onEnter:m,onEntered:S,onEntering:b,onExit:I,onExited:_,onExiting:A,style:C,timeout:v="auto",TransitionComponent:O=tu}=a,j=cr(a,aC),D=ae.useRef(),x=ae.useRef(),N=fm(),$=ae.useRef(null),H=xf($,R.ref,d),K=ne=>J=>{if(ne){const W=$.current;J===void 0?ne(W):ne(W,J)}},ce=K(b),Q=K((ne,J)=>{f_(ne);const{duration:W,delay:X,easing:se}=yg({style:C,timeout:v,easing:E},{mode:"enter"});let he;v==="auto"?(he=N.transitions.getAutoHeightDuration(ne.clientHeight),x.current=he):he=W,ne.style.transition=[N.transitions.create("opacity",{duration:he,delay:X}),N.transitions.create("transform",{duration:Op?he:he*.666,delay:X,easing:se})].join(","),m&&m(ne,J)}),Z=K(S),Se=K(A),G=K(ne=>{const{duration:J,delay:W,easing:X}=yg({style:C,timeout:v,easing:E},{mode:"exit"});let se;v==="auto"?(se=N.transitions.getAutoHeightDuration(ne.clientHeight),x.current=se):se=J,ne.style.transition=[N.transitions.create("opacity",{duration:se,delay:W}),N.transitions.create("transform",{duration:Op?se:se*.666,delay:Op?W:W||se*.333,easing:X})].join(","),ne.style.opacity=0,ne.style.transform=Hp(.75),I&&I(ne)}),ie=K(_),de=ne=>{v==="auto"&&(D.current=setTimeout(ne,x.current||0)),p&&p($.current,ne)};return ae.useEffect(()=>()=>{clearTimeout(D.current)},[]),ut.jsx(O,Ne({appear:g,in:w,nodeRef:$,onEnter:Q,onEntered:Z,onEntering:ce,onExit:G,onExited:ie,onExiting:Se,addEndListener:de,timeout:v==="auto"?null:v},j,{children:(ne,J)=>ae.cloneElement(R,Ne({style:Ne({opacity:0,transform:Hp(.75),visibility:ne==="exited"&&!w?"hidden":void 0},sC[ne],C,R.props.style),ref:H},J))}))});gm.muiSupportAuto=!0;function _R(r){return Xi("MuiInputLabel",r)}const Ap=ii("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]),Ig=ii("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon"]);function cC(r){return Xi("MuiSnackbarContent",r)}ii("MuiSnackbarContent",["root","message","action"]);const uC=["action","className","message","role"],lC=r=>{const{classes:a}=r;return ql({root:["root"],action:["action"],message:["message"]},cC,a)},dC=Do(Fv,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(r,a)=>a.root})(({theme:r})=>{const a=r.palette.mode==="light"?.8:.98,d=bE(r.palette.background.default,a);return Ne({},r.typography.body2,{color:r.vars?r.vars.palette.SnackbarContent.color:r.palette.getContrastText(d),backgroundColor:r.vars?r.vars.palette.SnackbarContent.bg:d,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(r.vars||r).shape.borderRadius,flexGrow:1,[r.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),hC=Do("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(r,a)=>a.message})({padding:"8px 0"}),fC=Do("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(r,a)=>a.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),pC=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiSnackbarContent"}),{action:g,className:R,message:E,role:w="alert"}=p,m=cr(p,uC),S=p,b=lC(S);return ut.jsxs(dC,Ne({role:w,square:!0,elevation:6,className:Ji(b.root,R),ownerState:S,ref:d},m,{children:[ut.jsx(hC,{className:b.message,ownerState:S,children:E}),g?ut.jsx(fC,{className:b.action,ownerState:S,children:g}):null]}))});function mC(r){return Xi("MuiSnackbar",r)}ii("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const gC=["onEnter","onExited"],vC=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],yC=r=>{const{classes:a,anchorOrigin:d}=r,p={root:["root",`anchorOrigin${fi(d.vertical)}${fi(d.horizontal)}`]};return ql(p,mC,a)},bC=Do("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:d}=r;return[a.root,a[`anchorOrigin${fi(d.anchorOrigin.vertical)}${fi(d.anchorOrigin.horizontal)}`]]}})(({theme:r,ownerState:a})=>{const d={left:"50%",right:"auto",transform:"translateX(-50%)"};return Ne({zIndex:(r.vars||r).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},a.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},a.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},a.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[r.breakpoints.up("sm")]:Ne({},a.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},a.anchorOrigin.horizontal==="center"&&d,a.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},a.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),SC=ae.forwardRef(function(a,d){const p=eu({props:a,name:"MuiSnackbar"}),g=fm(),R={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{action:E,anchorOrigin:{vertical:w,horizontal:m}={vertical:"bottom",horizontal:"left"},autoHideDuration:S=null,children:b,className:I,ClickAwayListenerProps:_,ContentProps:A,disableWindowBlurListener:C=!1,message:v,onBlur:O,onClose:j,onFocus:D,onMouseEnter:x,onMouseLeave:N,open:$,resumeHideDuration:H,TransitionComponent:K=gm,transitionDuration:ce=R,TransitionProps:{onEnter:Q,onExited:Z}={}}=p,Se=cr(p.TransitionProps,gC),G=cr(p,vC),ie=Ne({},p,{anchorOrigin:{vertical:w,horizontal:m}}),de=yC(ie),ne=ae.useRef(),[J,W]=ae.useState(!0),X=Vl((...Ge)=>{j&&j(...Ge)}),se=Vl(Ge=>{!j||Ge==null||(clearTimeout(ne.current),ne.current=setTimeout(()=>{X(null,"timeout")},Ge))});ae.useEffect(()=>($&&se(S),()=>{clearTimeout(ne.current)}),[$,S,se]);const he=()=>{clearTimeout(ne.current)},Ie=ae.useCallback(()=>{S!=null&&se(H??S*.5)},[S,H,se]),we=Ge=>{D&&D(Ge),he()},Qe=Ge=>{x&&x(Ge),he()},Tt=Ge=>{O&&O(Ge),Ie()},vt=Ge=>{N&&N(Ge),Ie()},Ut=Ge=>{j&&j(Ge,"clickaway")},Vt=Ge=>{W(!0),Z&&Z(Ge)},Ht=(Ge,At)=>{W(!1),Q&&Q(Ge,At)};return ae.useEffect(()=>{if(!C&&$)return window.addEventListener("focus",Ie),window.addEventListener("blur",he),()=>{window.removeEventListener("focus",Ie),window.removeEventListener("blur",he)}},[C,Ie,$]),ae.useEffect(()=>{if(!$)return;function Ge(At){At.defaultPrevented||(At.key==="Escape"||At.key==="Esc")&&j&&j(At,"escapeKeyDown")}return document.addEventListener("keydown",Ge),()=>{document.removeEventListener("keydown",Ge)}},[J,$,j]),!$&&J?null:ut.jsx(t_,Ne({onClickAway:Ut},_,{children:ut.jsx(bC,Ne({className:Ji(de.root,I),onBlur:Tt,onFocus:we,onMouseEnter:Qe,onMouseLeave:vt,ownerState:ie,ref:d,role:"presentation"},G,{children:ut.jsx(K,Ne({appear:!0,in:$,timeout:ce,direction:w==="top"?"down":"up",onEnter:Ht,onExited:Vt},Se,{children:b||ut.jsx(pC,Ne({message:v,action:E},A))}))}))}))}),kg=ii("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),ar={0:"#FFFFFF",100:"#F9FAFB",200:"#F4F6F8",300:"#DFE3E8",400:"#C4CDD5",500:"#919EAB",600:"#637381",700:"#454F5B",800:"#212B36",900:"#161C24"},$v={lighter:"#BBDEFB",light:"#79B5FB",main:"#0E78F4",dark:"#0651A8",darker:"#113F84",contrastText:"#fff"},vm={lighter:"#DFE3E8",light:"#919EAB",main:"#454F5B",dark:"#212B36",darker:"#161C24",contrastText:"#fff"},Vv={lighter:"#CAFDF5",light:"#61F3F3",main:"#00B8D9",dark:"#006C9C",darker:"#003768",contrastText:"#fff"},Wv={lighter:"#D8FBDE",light:"#86E8AB",main:"#36B37E",dark:"#1B806A",darker:"#0A5554",contrastText:"#fff"},Gv={lighter:"#FFF5CC",light:"#FFD666",main:"#FFAB00",dark:"#B76E00",darker:"#7A4100",contrastText:ar[800]},Hv={lighter:"#FFE9D5",light:"#FFAC82",main:"#FF5630",dark:"#B71D18",darker:"#7A0916",contrastText:"#fff"},zv={lighter:"#B7B1FF",light:"#9385FF",main:"#7B61FF",dark:"#5D30F7",darker:"#4F1EE3",contrastText:"#fff"},_f={common:{black:"#000",white:"#fff"},primary:$v,secondary:vm,info:Vv,success:Wv,warning:Gv,error:Hv,aiInfo:zv,grey:ar,divider:$r(ar[500],.24),action:{hover:$r(ar[500],.08),selected:$r(ar[500],.16),disabled:$r(ar[500],.8),disabledBackground:$r(ar[500],.24),focus:$r(ar[500],.24),hoverOpacity:.08,disabledOpacity:.48}};function qv(r="light"){const a={..._f,mode:"light",text:{primary:ar[800],secondary:ar[600],disabled:ar[500]},background:{paper:"#fff",default:"#fff",neutral:ar[200],option:ar[400]},action:{..._f.action,active:ar[600]}},d={..._f,mode:"dark",text:{primary:"#fff",secondary:ar[500],disabled:ar[600]},background:{paper:ar[800],default:ar[900],neutral:$r(ar[500],.16),option:vm.main},action:{..._f.action,active:ar[500]}};return r==="light"?a:d}function EC(r,a=Number.MIN_SAFE_INTEGER,d=Number.MAX_SAFE_INTEGER){return Math.max(a,Math.min(r,d))}function Qd(r){let a="https://mui.com/production-error/?code="+r;for(let d=1;d<arguments.length;d+=1)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified MUI error #"+r+"; visit "+a+" for the full message."}function ym(r,a=0,d=1){return EC(r,a,d)}function _C(r){r=r.slice(1);const a=new RegExp(`.{1,${r.length>=6?2:1}}`,"g");let d=r.match(a);return d&&d[0].length===1&&(d=d.map(p=>p+p)),d?`rgb${d.length===4?"a":""}(${d.map((p,g)=>g<3?parseInt(p,16):Math.round(parseInt(p,16)/255*1e3)/1e3).join(", ")})`:""}function zl(r){if(r.type)return r;if(r.charAt(0)==="#")return zl(_C(r));const a=r.indexOf("("),d=r.substring(0,a);if(["rgb","rgba","hsl","hsla","color"].indexOf(d)===-1)throw new Error(Qd(9,r));let p,g=r.substring(a+1,r.length-1);if(d==="color"){if(g=g.split(" "),p=g.shift(),g.length===4&&g[3].charAt(0)==="/"&&(g[3]=g[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(p)===-1)throw new Error(Qd(10,p))}else g=g.split(",");return g=g.map(R=>parseFloat(R)),{type:d,values:g,colorSpace:p}}function yp(r){const{type:a,colorSpace:d}=r;let{values:p}=r;return a.indexOf("rgb")!==-1?p=p.map((g,R)=>R<3?parseInt(g,10):g):a.indexOf("hsl")!==-1&&(p[1]=`${p[1]}%`,p[2]=`${p[2]}%`),p=a.indexOf("color")!==-1?`${d} ${p.join(" ")}`:`${p.join(", ")}`,`${a}(${p})`}function CC(r){r=zl(r);const{values:a}=r,d=a[0],p=a[1]/100,g=a[2]/100,R=p*Math.min(g,1-g),E=(S,b=(S+d/30)%12)=>g-R*Math.max(Math.min(b-3,9-b,1),-1);let w="rgb";const m=[Math.round(255*E(0)),Math.round(255*E(8)),Math.round(255*E(4))];return r.type==="hsla"&&(w+="a",m.push(a[3])),yp({type:w,values:m})}function Og(r){let a=(r=zl(r)).type==="hsl"||r.type==="hsla"?zl(CC(r)).values:r.values;return a=a.map(d=>(r.type!=="color"&&(d/=255),d<=.03928?d/12.92:((d+.055)/1.055)**2.4)),Number((.2126*a[0]+.7152*a[1]+.0722*a[2]).toFixed(3))}function TC(r,a){const d=Og(r),p=Og(a);return(Math.max(d,p)+.05)/(Math.min(d,p)+.05)}function mn(r,a){return r=zl(r),a=ym(a),r.type!=="rgb"&&r.type!=="hsl"||(r.type+="a"),r.type==="color"?r.values[3]=`/${a}`:r.values[3]=a,yp(r)}function RC(r,a){if(r=zl(r),a=ym(a),r.type.indexOf("hsl")!==-1)r.values[2]*=1-a;else if(r.type.indexOf("rgb")!==-1||r.type.indexOf("color")!==-1)for(let d=0;d<3;d+=1)r.values[d]*=1-a;return yp(r)}function wC(r,a){if(r=zl(r),a=ym(a),r.type.indexOf("hsl")!==-1)r.values[2]+=(100-r.values[2])*a;else if(r.type.indexOf("rgb")!==-1)for(let d=0;d<3;d+=1)r.values[d]+=(255-r.values[d])*a;else if(r.type.indexOf("color")!==-1)for(let d=0;d<3;d+=1)r.values[d]+=(1-r.values[d])*a;return yp(r)}const Kv=qv(),IC=Kv.grey[500],kC=Kv.common.black;function OC(r){const a=mn(r,.16);return{z1:`0 1px 2px 0 ${a}`,z4:`0 4px 8px 0 ${a}`,z12:`0 12px 24px -4px ${a}`,z16:`0 16px 32px -4px ${a}`,z20:`0 20px 40px -4px ${a}`,z24:`0 24px 48px 0 ${a}`,primary:`0 8px 16px 0 ${mn($v.main,.24)}`,info:`0 8px 16px 0 ${mn(Vv.main,.24)}`,secondary:`0 8px 16px 0 ${mn(vm.main,.48)}`,success:`0 8px 16px 0 ${mn(Wv.main,.24)}`,warning:`0 8px 16px 0 ${mn(Gv.main,.24)}`,error:`0 8px 16px 0 ${mn(Hv.main,.24)}`,aiInfo:`0 8px 16px 0 ${mn(zv.main,.25)}`,card:`0 0 2px 0 ${mn(r,.2)}, 0 12px 24px -4px ${mn(r,.12)}`,dialog:`-40px 40px 80px -8px ${mn(r,.24)}`,dropdown:`0 0 2px 0 ${mn(r,.24)}, -20px 20px 40px -4px ${mn(r,.24)}`,button:`0 8px 16px 0 ${mn(r,.16)}`}}function AC(r="light"){return OC(r==="light"?IC:kC)}function PC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 C17.5228475,22 22,17.5228475 22,12 C22,9.3478351 20.9464316,6.80429597 19.0710678,4.92893219 C17.195704,3.0535684 14.6521649,2 12,2 Z M13,16 C13,16.5522847 12.5522847,17 12,17 C11.4477153,17 11,16.5522847 11,16 L11,11 C11,10.4477153 11.4477153,10 12,10 C12.5522847,10 13,10.4477153 13,11 L13,16 Z M12,9 C11.4477153,9 11,8.55228475 11,8 C11,7.44771525 11.4477153,7 12,7 C12.5522847,7 13,7.44771525 13,8 C13,8.55228475 12.5522847,9 12,9 Z"})})}function xC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M22.56,16.3 L14.89,3.58 C14.2597186,2.59400001 13.1702353,1.99737652 12,1.99737652 C10.8297647,1.99737652 9.74028139,2.59400001 9.11,3.58 L1.44,16.3 C0.888546003,17.2192471 0.869485343,18.3628867 1.39,19.3 C1.99197363,20.3551378 3.11522982,21.0046397 4.33,21 L19.67,21 C20.8765042,21.0128744 21.9978314,20.3797441 22.61,19.34 C23.146086,18.3926382 23.1269508,17.2292197 22.56,16.3 L22.56,16.3 Z M12,17 C11.4477153,17 11,16.5522847 11,16 C11,15.4477153 11.4477153,15 12,15 C12.5522847,15 13,15.4477153 13,16 C13,16.5522847 12.5522847,17 12,17 Z M13,13 C13,13.5522847 12.5522847,14 12,14 C11.4477153,14 11,13.5522847 11,13 L11,9 C11,8.44771525 11.4477153,8 12,8 C12.5522847,8 13,8.44771525 13,9 L13,13 Z"})})}function DC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 C17.5228475,22 22,17.5228475 22,12 C22,9.3478351 20.9464316,6.80429597 19.0710678,4.92893219 C17.195704,3.0535684 14.6521649,2 12,2 Z M16.3,9.61 L11.73,15.61 C11.5412074,15.855247 11.2494966,15.9992561 10.94,16.0000145 C10.6322197,16.001658 10.3408221,15.861492 10.15,15.62 L7.71,12.51 C7.49028166,12.2277602 7.43782669,11.8497415 7.57239438,11.5183399 C7.70696206,11.1869384 8.00810836,10.9525017 8.36239438,10.9033399 C8.7166804,10.8541782 9.07028166,10.9977602 9.29,11.28 L10.92,13.36 L14.7,8.36 C14.917932,8.07418751 15.2717886,7.92635122 15.6282755,7.97217964 C15.9847624,8.01800806 16.2897207,8.25053875 16.4282755,8.58217966 C16.5668304,8.91382056 16.517932,9.29418753 16.3,9.58 L16.3,9.61 Z"})})}function MC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 C17.5228475,22 22,17.5228475 22,12 C22,9.3478351 20.9464316,6.80429597 19.0710678,4.92893219 C17.195704,3.0535684 14.6521649,2 12,2 Z M12,17 C11.4477153,17 11,16.5522847 11,16 C11,15.4477153 11.4477153,15 12,15 C12.5522847,15 13,15.4477153 13,16 C13,16.5522847 12.5522847,17 12,17 Z M13,13 C13,13.5522847 12.5522847,14 12,14 C11.4477153,14 11,13.5522847 11,13 L11,8 C11,7.44771525 11.4477153,7 12,7 C12.5522847,7 13,7.44771525 13,8 L13,13 Z"})})}const NC=["info","success","warning","error"];function LC(r){return{MuiAlert:{defaultProps:{iconMapping:{info:nn.jsx(PC,{}),success:nn.jsx(DC,{}),warning:nn.jsx(xC,{}),error:nn.jsx(MC,{})}},styleOverrides:{root:({ownerState:a})=>(d=>{const p=d.variant==="standard",g=d.variant==="filled",R=d.variant==="outlined";return[...NC.map(E=>({borderRadius:r.shape.borderRadius,...d.severity===E&&{...p&&{color:r.palette[E].darker,backgroundColor:r.palette[E].lighter,[`& .${Uf.icon}`]:{color:r.palette[E].main}},...g&&{color:r.palette[E].contrastText,backgroundColor:r.palette[E].main},...R&&{color:r.palette[E].dark,border:`solid 1px ${r.palette[E].main}`,[`& .${Uf.icon}`]:{color:r.palette[E].main}}}}))]})(a),icon:{opacity:1}}},MuiAlertTitle:{styleOverrides:{root:{marginBottom:r.spacing(.5)}}}}}function BC(r){return{MuiAutocomplete:{styleOverrides:{paper:{boxShadow:r.customShadows.dropdown},listbox:({ownerState:a})=>({padding:r.spacing(0),[`& .${Gp.option}`]:{padding:r.spacing(2),'&[aria-selected="true"]':{backgroundColor:a.multiple?"transparent":r.palette.action.selected,[`&.${Gp.focused}`]:{backgroundColor:a.multiple?"transparent":r.palette.action.selected,"&:hover":{backgroundColor:r.palette.action.selected}},"&:hover":{backgroundColor:r.palette.action.selected}},'&[aria-selected="false"]:hover':{background:r.palette.action.hover}}}),option:{...r.typography.body2,padding:r.spacing(1)},noOption:r.typography.body2}}}}function jC(r){return{MuiAvatar:{styleOverrides:{colorDefault:{color:r.palette.text.secondary,backgroundColor:mn(r.palette.grey[500],.24)}}}}}const UC=["primary","secondary","info","success","warning","error"];function FC(r){return{MuiButton:{defaultProps:{disableElevation:!0},styleOverrides:{root:({ownerState:a})=>(d=>{const p=d.color==="inherit",g=d.variant==="contained",R=d.variant==="outlined",E=d.variant==="text",w=d.variant==="soft",m=d.size==="small",S=d.size==="large",b={...p&&{...g&&{color:r.palette.grey[800],"&:hover":{boxShadow:r.customShadows.button,backgroundColor:r.palette.grey[400]}},...R&&{borderColor:mn(r.palette.grey[500],.32),"&:hover":{borderColor:r.palette.text.primary,backgroundColor:r.palette.action.hover}},...E&&{"&:hover":{backgroundColor:r.palette.action.hover}},...w&&{color:r.palette.text.primary,backgroundColor:mn(r.palette.grey[500],.08),"&:hover":{backgroundColor:mn(r.palette.grey[500],.24)}}}};return[...UC.map(I=>({...d.color===I&&{...g&&{"&:hover":{boxShadow:r.customShadows[I]}},...w&&{color:r.palette[I].dark,backgroundColor:mn(r.palette[I].main,.16),"&:hover":{backgroundColor:mn(r.palette[I].main,.32)}}}})),b,{"&.Mui-disabled":{...w&&{backgroundColor:r.palette.action.disabledBackground}}},{padding:r.spacing(.75,2),...m&&{height:30,fontSize:13,padding:r.spacing(.5,1.25)},...S&&{height:48,fontSize:15,padding:r.spacing(1,2.75)}}]})(a)}}}}function $C(r){return{MuiCard:{styleOverrides:{root:({ownerState:a})=>({position:"relative",boxShadow:a.variant==="outlined"?"none":r.customShadows.card,borderRadius:2*Number(r.shape.borderRadius),zIndex:0})}},MuiCardHeader:{defaultProps:{titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"body2",marginTop:r.spacing(.5)}},styleOverrides:{root:{padding:r.spacing(3)},action:{display:"flex",alignSelf:"center",alignItems:"center",margin:r.spacing(0,0,0,2)}}},MuiCardContent:{styleOverrides:{root:{padding:r.spacing(0,3,3)}}},MuiCardActions:{styleOverrides:{root:{padding:r.spacing(0,3,3)}}}}}function VC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M17.9 2.318A5 5 0 0 1 22.895 7.1l.005.217v10a5 5 0 0 1-4.783 4.995l-.217.005h-10a5 5 0 0 1-4.995-4.783l-.005-.217v-10a5 5 0 0 1 4.783-4.996l.217-.004h10Zm-.5 1.5h-9a4 4 0 0 0-4 4v9a4 4 0 0 0 4 4h9a4 4 0 0 0 4-4v-9a4 4 0 0 0-4-4Z"})})}function WC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M17 2a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm-1.625 7.255-4.13 4.13-1.75-1.75a.881.881 0 0 0-1.24 0c-.34.34-.34.89 0 1.24l2.38 2.37c.17.17.39.25.61.25.23 0 .45-.08.62-.25l4.75-4.75c.34-.34.34-.89 0-1.24a.881.881 0 0 0-1.24 0Z"})})}function GC(r){return nn.jsx(lc,{...r,children:nn.jsx("path",{d:"M17,2 C19.7614,2 22,4.23858 22,7 L22,7 L22,17 C22,19.7614 19.7614,22 17,22 L17,22 L7,22 C4.23858,22 2,19.7614 2,17 L2,17 L2,7 C2,4.23858 4.23858,2 7,2 L7,2 Z M15,11 L9,11 C8.44772,11 8,11.4477 8,12 C8,12.5523 8.44772,13 9,13 L15,13 C15.5523,13 16,12.5523 16,12 C16,11.4477 15.5523,11 15,11 Z"})})}function HC(r){return{MuiCheckbox:{defaultProps:{icon:nn.jsx(VC,{}),checkedIcon:nn.jsx(WC,{}),indeterminateIcon:nn.jsx(GC,{})},styleOverrides:{root:({ownerState:a})=>({padding:r.spacing(1),...a.size==="small"&&{"& svg":{width:20,height:20}},...a.size==="medium"&&{"& svg":{width:24,height:24}}})}}}}const zC=["primary","secondary","info","success","warning","error","aiInfo"];function qC(r){const a=r.palette.mode==="light";return{MuiChip:{styleOverrides:{root:({ownerState:d})=>(p=>{const g=p.color==="default",R=p.variant==="filled",E=p.variant==="outlined",w=p.variant==="soft",m={...g&&{[`& .${Sf.avatar}`]:{color:r.palette.text[a?"secondary":"primary"],backgroundColor:mn(r.palette.grey[500],.48)},...E&&{color:r.palette.grey[600],border:`solid 1px ${mn(r.palette.grey[500],.32)}`},...w&&{color:r.palette.text.secondary,backgroundColor:mn(r.palette.grey[500],.16),"&:hover":{backgroundColor:mn(r.palette.grey[500],.32)}}}};return[...zC.map(S=>({...p.color===S&&{[`& .${Sf.avatar}`]:{color:r.palette[S].lighter,backgroundColor:r.palette[S].dark},...R&&{[`& .${Sf.deleteIcon}`]:{color:mn(r.palette[S].contrastText,.56),"&:hover":{color:r.palette[S].contrastText}}},...w&&{color:r.palette[S][a?S==="aiInfo"?"main":"dark":"light"],backgroundColor:mn(r.palette[S].main,.16),"&:hover":{backgroundColor:mn(r.palette[S].main,.32)},[`& .${Sf.deleteIcon}`]:{color:mn(r.palette[S][a?S==="aiInfo"?"main":"dark":"light"],.48),"&:hover":{color:r.palette[S].dark}}}}})),m]})(d),icon:{marginRight:1},sizeSmall:{fontSize:12,paddingTop:"2px",paddingBottom:"2px"}}}}}function KC(r){const a={"&:-webkit-autofill":{transition:"background-color 5000s ease-in-out 0s",WebkitTextFillColor:r.palette.text.primary,"&:hover, &:focus, &:active":{transition:"background-color 5000s ease-in-out 0s",WebkitTextFillColor:r.palette.text.primary}}};return{MuiCssBaseline:{styleOverrides:{input:a,textarea:a,select:a}}}}function YC(r){return{MuiDialog:{styleOverrides:{paper:{boxShadow:r.customShadows.dialog,[`&.${m_.rounded}`]:{borderRadius:2*Number(r.shape.borderRadius)},[`&.${Ef.paperFullScreen}`]:{borderRadius:0},[`&.${Ef.paper} .${oC.root}`]:{padding:r.spacing(3)},"@media (max-width: 600px)":{margin:r.spacing(2)},"@media (max-width: 663.95px)":{[`&.${Ef.paperWidthSm}.${Ef.paperScrollBody}`]:{maxWidth:"100%"}}},paperFullWidth:{width:"100%"}}},MuiDialogTitle:{styleOverrides:{root:{padding:r.spacing(3)}}},MuiDialogContent:{styleOverrides:{root:{padding:r.spacing(1,3),minHeight:"80px"},dividers:{border:0}}},MuiDialogActions:{styleOverrides:{root:{"& > :not(:first-of-type)":{marginLeft:r.spacing(1.5)}}}}}}function JC(r){return{MuiFormHelperText:{styleOverrides:{root:{marginTop:r.spacing(1)}}},MuiFormLabel:{styleOverrides:{root:{[`&:not(.${wg.error}).${wg.focused}`]:{color:r.palette.primary.main}},asterisk:{color:r.palette.error.main}}}}}function XC(r){return{MuiIconButton:{styleOverrides:{root:({ownerState:a})=>[{...a.size==="large"&&{padding:r.spacing(1)},...a.size==="xs"&&{padding:r.spacing("5px")}}]}}}}function QC(r){return{MuiInputBase:{styleOverrides:{root:{[`&.${Xh.disabled}`]:{"& svg":{color:r.palette.text.disabled}}},input:{"&::placeholder":{opacity:1,color:r.palette.text.disabled}}}},MuiInput:{styleOverrides:{underline:{"&:before":{borderBottomColor:$r(r.palette.grey[500],.56)},"&:after":{borderBottomColor:r.palette.text.primary}}}},MuiTextField:{styleOverrides:{root:({ownerState:a})=>({[` .${Ap.root}:not(.${Ap.error}).${Ap.focused}`]:{color:r.palette.primary.main},[` .${Ku.disabled}`]:{[`& .${Ku.notchedOutline}`]:{borderColor:$r(ar[500],.24),backgroundColor:$r(ar[500],.08)}},[`.${Xh.root}`]:{...(a.size==="medium"||!a.size)&&{[`input:not(.${Gp.input}).${Ku.input}`]:{paddingTop:r.spacing(2),paddingBottom:r.spacing(2)}},[`&.${Xh.multiline}`]:{paddingTop:r.spacing(2),paddingBottom:r.spacing(2)}}})}},MuiFilledInput:{styleOverrides:{root:{borderRadius:r.shape.borderRadius,backgroundColor:$r(r.palette.grey[500],.08),"&:hover":{backgroundColor:$r(r.palette.grey[500],.16)},[`&.${Rg.focused}`]:{backgroundColor:$r(r.palette.grey[500],.16)},[`&.${Rg.disabled}`]:{backgroundColor:r.palette.action.disabledBackground}},underline:{"&:before, :after":{display:"none"}}}},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:Number(r.shape.borderRadius),[`& .${Ku.notchedOutline}`]:{borderColor:$r(r.palette.grey[500],.88)},[`&.${Ku.focused}`]:{[`& .${Ku.notchedOutline}`]:{borderWidth:1}},[`&.${Ku.disabled}`]:{[`& .${Ku.notchedOutline}`]:{borderColor:$r(ar[500],.24),backgroundColor:$r(ar[500],.08)}}}}}}}const ZC=["primary","secondary","info","success","warning","error"];function e1(r){const a=r.palette.mode==="light";return{MuiPagination:{defaultProps:{color:"primary"},styleOverrides:{root:({ownerState:d})=>(p=>{const g=p.variant==="outlined",R=p.variant==="soft",E={[`& .${Ig.root}`]:{...g&&{borderColor:mn(r.palette.grey[500],.32)},"&.Mui-selected":{fontWeight:r.typography.fontWeightMedium}}};return[...ZC.map(w=>({...p.color===w&&{...R&&{[`& .${Ig.root}`]:{"&.Mui-selected":{color:r.palette[w][a?"dark":"light"],backgroundColor:mn(r.palette[w].main,.16),"&:hover":{backgroundColor:mn(r.palette[w].main,.32)}}}}}})),E]})(d)}}}}function t1(r){return{MuiPaper:{styleOverrides:{root:({ownerState:a})=>{const{variant:d,elevation:p}=a;return{...typeof p=="number"&&p>0&&d!=="outlined"&&{boxShadow:r.customShadows.card},borderRadius:2*Number(r.shape.borderRadius)}}}}}}function n1(r){const a=r.palette.mode==="light";return{MuiSlider:{defaultProps:{size:"small"},styleOverrides:{root:{"&.Mui-disabled":{color:r.palette.action.disabled},height:4},rail:{opacity:.32},thumb:{height:20,width:20},markLabel:{fontSize:12,color:r.palette.text.secondary},valueLabel:{borderRadius:8,backgroundColor:r.palette.grey[a?800:700]},mark:{height:4,width:4,borderRadius:2,"&.MuiSlider-markActive":{backgroundColor:"transparent"}}}}}}function r1(){return{MuiSvgIcon:{styleOverrides:{root:({ownerState:r})=>[{...r.fontSize==="large"&&{fontSize:"32px"},...r.fontSize==="xs"&&{fontSize:"18px"}}]}}}}function i1(r){const a=r.palette.mode==="light";return{MuiSwitch:{styleOverrides:{root:({ownerState:d})=>(p=>({marginRight:9,width:33,height:20,padding:0,...p.size==="small"&&{width:25,height:16},"& .MuiSwitch-thumb":{width:14,height:14,boxShadow:"none",color:`${r.palette.common.white} !important`,...p.size==="small"&&{width:10,height:10}},"& .MuiSwitch-track":{opacity:1,borderRadius:14,backgroundColor:mn(r.palette.grey[500],.48)},"& .MuiSwitch-switchBase":{left:0,padding:3,...p.size==="small"&&{padding:3},"&.Mui-checked":{transform:"translateX(12px)","&+.MuiSwitch-track":{opacity:1},...p.size==="small"&&{transform:"translateX(8px)"}},"&.Mui-disabled":{"& .MuiSwitch-thumb":{opacity:a?1:.48},"&+.MuiSwitch-track":{opacity:.48}}}}))(d)}}}}function o1(r){return{MuiTableContainer:{styleOverrides:{root:{position:"relative"}}},MuiTableRow:{styleOverrides:{root:{"&.Mui-selected":{backgroundColor:r.palette.action.selected,"&:hover":{backgroundColor:r.palette.action.selected}}}}},MuiTableCell:{styleOverrides:{root:{borderBottom:"none",fontSize:14},head:{color:r.palette.text.secondary,backgroundColor:r.palette.background.neutral,fontSize:13},stickyHeader:{backgroundColor:r.palette.background.paper,backgroundImage:`linear-gradient(to bottom, ${r.palette.background.neutral} 0%, ${r.palette.background.neutral} 100%)`},paddingCheckbox:{paddingLeft:r.spacing(1)}}},MuiTablePagination:{defaultProps:{backIconButtonProps:{size:"small"},nextIconButtonProps:{size:"small"},SelectProps:{MenuProps:{MenuListProps:{sx:{"& .MuiMenuItem-root":{...r.typography.body2}}}}}},styleOverrides:{root:{borderTop:`solid 1px ${r.palette.divider}`},toolbar:{height:64},actions:{marginRight:r.spacing(1)},select:{"&:focus":{borderRadius:r.shape.borderRadius}}}}}}function a1(r){return{MuiTabs:{defaultProps:{textColor:"inherit",allowScrollButtonsMobile:!0,variant:"scrollable"},styleOverrides:{root:({ownerState:a})=>({padding:r.spacing(.5,0,0),...((a==null?void 0:a.textColor)==="primary"||(a==null?void 0:a.textColor)==="inherit")&&{[`.${kg.selected}`]:{color:r.palette.primary.main}}}),scrollButtons:{width:48,borderRadius:"50%"}}},MuiTab:{defaultProps:{disableRipple:!0,iconPosition:"start"},styleOverrides:{root:({ownerState:a})=>({padding:r.spacing(1.25,0,0),opacity:1,minWidth:48,fontWeight:600,fontSize:16,"&:not(:last-of-type)":{marginRight:r.spacing(3),[r.breakpoints.up("sm")]:{marginRight:r.spacing(6)}},[`&:not(${kg.selected})`]:{color:r.palette.text.secondary},...(a.iconPosition==="start"||a.iconPosition==="end")&&{minHeight:50}})}}}}function s1(r){const a=r.palette.mode==="light";return{MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:r.palette.grey[a?800:700],fontWeight:400,borderRadius:r.shape.borderRadius/2},arrow:{color:r.palette.grey[a?800:700],"&::before":{borderRadius:r.shape.borderRadius/4}}}}}}function c1(r){return Object.assign(LC(r),BC(r),jC(r),FC(r),$C(r),HC(r),qC(r),KC(r),YC(r),JC(r),QC(r),i1(r),n1(r),e1(r),t1(r),o1(r),a1(r),s1(r),XC(r),r1())}function sr(){return sr=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var p in d)({}).hasOwnProperty.call(d,p)&&(r[p]=d[p])}return r},sr.apply(null,arguments)}function nh(r,a){if(r==null)return{};var d={};for(var p in r)if({}.hasOwnProperty.call(r,p)){if(a.includes(p))continue;d[p]=r[p]}return d}function u1(r,a){return sr({toolbar:{minHeight:56,[r.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[r.up("sm")]:{minHeight:64}}},a)}var sf={black:"#000",white:"#fff"},l1={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Bd={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},jd={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Hh={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ud={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Fd={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},$d={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function Gd(r){if(typeof r!="object"||r===null)return!1;const a=Object.getPrototypeOf(r);return!(a!==null&&a!==Object.prototype&&Object.getPrototypeOf(a)!==null||Symbol.toStringTag in r||Symbol.iterator in r)}function Yv(r){if(ae.isValidElement(r)||!Gd(r))return r;const a={};return Object.keys(r).forEach(d=>{a[d]=Yv(r[d])}),a}function Jc(r,a,d={clone:!0}){const p=d.clone?sr({},r):r;return Gd(r)&&Gd(a)&&Object.keys(a).forEach(g=>{ae.isValidElement(a[g])?p[g]=a[g]:Gd(a[g])&&Object.prototype.hasOwnProperty.call(r,g)&&Gd(r[g])?p[g]=Jc(r[g],a[g],d):d.clone?p[g]=Gd(a[g])?Yv(a[g]):a[g]:p[g]=a[g]}),p}const d1=["mode","contrastThreshold","tonalOffset"],Ag={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:sf.white,default:sf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Pp={text:{primary:sf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:sf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Pg(r,a,d,p){const g=p.light||p,R=p.dark||1.5*p;r[a]||(r.hasOwnProperty(d)?r[a]=r[d]:a==="light"?r.light=wC(r.main,g):a==="dark"&&(r.dark=RC(r.main,R)))}function h1(r){const{mode:a="light",contrastThreshold:d=3,tonalOffset:p=.2}=r,g=nh(r,d1),R=r.primary||function(C="light"){return C==="dark"?{main:Ud[200],light:Ud[50],dark:Ud[400]}:{main:Ud[700],light:Ud[400],dark:Ud[800]}}(a),E=r.secondary||function(C="light"){return C==="dark"?{main:Bd[200],light:Bd[50],dark:Bd[400]}:{main:Bd[500],light:Bd[300],dark:Bd[700]}}(a),w=r.error||function(C="light"){return C==="dark"?{main:jd[500],light:jd[300],dark:jd[700]}:{main:jd[700],light:jd[400],dark:jd[800]}}(a),m=r.info||function(C="light"){return C==="dark"?{main:Fd[400],light:Fd[300],dark:Fd[700]}:{main:Fd[700],light:Fd[500],dark:Fd[900]}}(a),S=r.success||function(C="light"){return C==="dark"?{main:$d[400],light:$d[300],dark:$d[700]}:{main:$d[800],light:$d[500],dark:$d[900]}}(a),b=r.warning||function(C="light"){return C==="dark"?{main:Hh[400],light:Hh[300],dark:Hh[700]}:{main:"#ed6c02",light:Hh[500],dark:Hh[900]}}(a);function I(C){return TC(C,Pp.text.primary)>=d?Pp.text.primary:Ag.text.primary}const _=({color:C,name:v,mainShade:O=500,lightShade:j=300,darkShade:D=700})=>{if(!(C=sr({},C)).main&&C[O]&&(C.main=C[O]),!C.hasOwnProperty("main"))throw new Error(Qd(11,v?` (${v})`:"",O));if(typeof C.main!="string")throw new Error(Qd(12,v?` (${v})`:"",JSON.stringify(C.main)));return Pg(C,"light",j,p),Pg(C,"dark",D,p),C.contrastText||(C.contrastText=I(C.main)),C},A={dark:Pp,light:Ag};return Jc(sr({common:sr({},sf),mode:a,primary:_({color:R,name:"primary"}),secondary:_({color:E,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:_({color:w,name:"error"}),warning:_({color:b,name:"warning"}),info:_({color:m,name:"info"}),success:_({color:S,name:"success"}),grey:l1,contrastThreshold:d,getContrastText:I,augmentColor:_,tonalOffset:p},A[a]),g)}const f1=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"],xg={textTransform:"uppercase"},Dg='"Roboto", "Helvetica", "Arial", sans-serif';function p1(r,a){const d=typeof a=="function"?a(r):a,{fontFamily:p=Dg,fontSize:g=14,fontWeightLight:R=300,fontWeightRegular:E=400,fontWeightMedium:w=500,fontWeightBold:m=700,htmlFontSize:S=16,allVariants:b,pxToRem:I}=d,_=nh(d,f1),A=g/14,C=I||(j=>j/S*A+"rem"),v=(j,D,x,N,$)=>{return sr({fontFamily:p,fontWeight:j,fontSize:C(D),lineHeight:x},p===Dg?{letterSpacing:(H=N/D,Math.round(1e5*H)/1e5+"em")}:{},$,b);var H},O={h1:v(R,96,1.167,-1.5),h2:v(R,60,1.2,-.5),h3:v(E,48,1.167,0),h4:v(E,34,1.235,.25),h5:v(E,24,1.334,0),h6:v(w,20,1.6,.15),subtitle1:v(E,16,1.75,.15),subtitle2:v(w,14,1.57,.1),body1:v(E,16,1.5,.15),body2:v(E,14,1.43,.15),button:v(w,14,1.75,.4,xg),caption:v(E,12,1.66,.4),overline:v(E,12,2.66,1,xg)};return Jc(sr({htmlFontSize:S,pxToRem:C,fontFamily:p,fontSize:g,fontWeightLight:R,fontWeightRegular:E,fontWeightMedium:w,fontWeightBold:m},O),_,{clone:!1})}function or(...r){return[`${r[0]}px ${r[1]}px ${r[2]}px ${r[3]}px rgba(0,0,0,0.2)`,`${r[4]}px ${r[5]}px ${r[6]}px ${r[7]}px rgba(0,0,0,0.14)`,`${r[8]}px ${r[9]}px ${r[10]}px ${r[11]}px rgba(0,0,0,0.12)`].join(",")}var m1=["none",or(0,2,1,-1,0,1,1,0,0,1,3,0),or(0,3,1,-2,0,2,2,0,0,1,5,0),or(0,3,3,-2,0,3,4,0,0,1,8,0),or(0,2,4,-1,0,4,5,0,0,1,10,0),or(0,3,5,-1,0,5,8,0,0,1,14,0),or(0,3,5,-1,0,6,10,0,0,1,18,0),or(0,4,5,-2,0,7,10,1,0,2,16,1),or(0,5,5,-3,0,8,10,1,0,3,14,2),or(0,5,6,-3,0,9,12,1,0,3,16,2),or(0,6,6,-3,0,10,14,1,0,4,18,3),or(0,6,7,-4,0,11,15,1,0,4,20,3),or(0,7,8,-4,0,12,17,2,0,5,22,4),or(0,7,8,-4,0,13,19,2,0,5,24,4),or(0,7,9,-4,0,14,21,2,0,5,26,4),or(0,8,9,-5,0,15,22,2,0,6,28,5),or(0,8,10,-5,0,16,24,2,0,6,30,5),or(0,8,11,-5,0,17,26,2,0,6,32,5),or(0,9,11,-5,0,18,28,2,0,7,34,6),or(0,9,12,-6,0,19,29,2,0,7,36,6),or(0,10,13,-6,0,20,31,3,0,8,38,7),or(0,10,13,-6,0,21,33,3,0,8,40,7),or(0,10,14,-6,0,22,35,3,0,8,42,7),or(0,11,14,-7,0,23,36,3,0,9,44,8),or(0,11,15,-7,0,24,38,3,0,9,46,8)];const g1=["duration","easing","delay"],v1={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},y1={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Mg(r){return`${Math.round(r)}ms`}function b1(r){if(!r)return 0;const a=r/36;return Math.round(10*(4+15*a**.25+a/5))}function S1(r){const a=sr({},v1,r.easing),d=sr({},y1,r.duration);return sr({getAutoHeightDuration:b1,create:(p=["all"],g={})=>{const{duration:R=d.standard,easing:E=a.easeInOut,delay:w=0}=g;return nh(g,g1),(Array.isArray(p)?p:[p]).map(m=>`${m} ${typeof R=="string"?R:Mg(R)} ${E} ${typeof w=="string"?w:Mg(w)}`).join(",")}},r,{easing:a,duration:d})}var E1={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};const _1=["values","unit","step"];function C1(r){const{values:a={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:d="px",step:p=5}=r,g=nh(r,_1),R=(b=>{const I=Object.keys(b).map(_=>({key:_,val:b[_]}))||[];return I.sort((_,A)=>_.val-A.val),I.reduce((_,A)=>sr({},_,{[A.key]:A.val}),{})})(a),E=Object.keys(R);function w(b){return`@media (min-width:${typeof a[b]=="number"?a[b]:b}${d})`}function m(b){return`@media (max-width:${(typeof a[b]=="number"?a[b]:b)-p/100}${d})`}function S(b,I){const _=E.indexOf(I);return`@media (min-width:${typeof a[b]=="number"?a[b]:b}${d}) and (max-width:${(_!==-1&&typeof a[E[_]]=="number"?a[E[_]]:I)-p/100}${d})`}return sr({keys:E,values:R,up:w,down:m,between:S,only:function(b){return E.indexOf(b)+1<E.length?S(b,E[E.indexOf(b)+1]):w(b)},not:function(b){const I=E.indexOf(b);return I===0?w(E[1]):I===E.length-1?m(E[I]):S(b,E[E.indexOf(b)+1]).replace("@media","@media not all and")},unit:d},g)}var T1={borderRadius:4};function bm(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}const Sm={xs:0,sm:600,md:900,lg:1200,xl:1536},Ng={keys:["xs","sm","md","lg","xl"],up:r=>`@media (min-width:${Sm[r]}px)`};function Qc(r,a,d){const p=r.theme||{};if(Array.isArray(a)){const g=p.breakpoints||Ng;return a.reduce((R,E,w)=>(R[g.up(g.keys[w])]=d(a[w]),R),{})}if(typeof a=="object"){const g=p.breakpoints||Ng;return Object.keys(a).reduce((R,E)=>{if(Object.keys(g.values||Sm).indexOf(E)!==-1)R[g.up(E)]=d(a[E],E);else{const w=E;R[w]=a[w]}return R},{})}return d(a)}function R1(r={}){var a;return((a=r.keys)==null?void 0:a.reduce((d,p)=>(d[r.up(p)]={},d),{}))||{}}function w1(r,a){return r.reduce((d,p)=>{const g=d[p];return(!g||Object.keys(g).length===0)&&delete d[p],d},a)}function Jv(r){if(typeof r!="string")throw new Error(Qd(7));return r.charAt(0).toUpperCase()+r.slice(1)}function bp(r,a,d=!0){if(!a||typeof a!="string")return null;if(r&&r.vars&&d){const p=`vars.${a}`.split(".").reduce((g,R)=>g&&g[R]?g[R]:null,r);if(p!=null)return p}return a.split(".").reduce((p,g)=>p&&p[g]!=null?p[g]:null,r)}function Ff(r,a,d,p=d){let g;return g=typeof r=="function"?r(d):Array.isArray(r)?r[d]||p:bp(r,d)||p,a&&(g=a(g,p,r)),g}function kr(r){const{prop:a,cssProperty:d=r.prop,themeKey:p,transform:g}=r,R=E=>{if(E[a]==null)return null;const w=E[a],m=bp(E.theme,p)||{};return Qc(E,w,S=>{let b=Ff(m,g,S);return S===b&&typeof S=="string"&&(b=Ff(m,g,`${a}${S==="default"?"":Jv(S)}`,S)),d===!1?b:{[d]:b}})};return R.propTypes={},R.filterProps=[a],R}function Qh(r,a){return a?Jc(r,a,{clone:!1}):r}function I1(r){const a={};return d=>(a[d]===void 0&&(a[d]=r(d)),a[d])}const k1={m:"margin",p:"padding"},O1={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Lg={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},A1=I1(r=>{if(r.length>2){if(!Lg[r])return[r];r=Lg[r]}const[a,d]=r.split(""),p=k1[a],g=O1[d]||"";return Array.isArray(g)?g.map(R=>p+R):[p+g]}),Em=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],_m=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Em,..._m];function ff(r,a,d,p){var g;const R=(g=bp(r,a,!1))!=null?g:d;return typeof R=="number"?E=>typeof E=="string"?E:R*E:Array.isArray(R)?E=>typeof E=="string"?E:R[E]:typeof R=="function"?R:()=>{}}function Xv(r){return ff(r,"spacing",8)}function pf(r,a){if(typeof a=="string"||a==null)return a;const d=r(Math.abs(a));return a>=0?d:typeof d=="number"?-d:`-${d}`}function P1(r,a){return d=>r.reduce((p,g)=>(p[g]=pf(a,d),p),{})}function Qv(r,a){const d=Xv(r.theme);return Object.keys(r).map(p=>function(g,R,E,w){if(R.indexOf(E)===-1)return null;const m=P1(A1(E),w),S=g[E];return Qc(g,S,m)}(r,a,p,d)).reduce(Qh,{})}function br(r){return Qv(r,Em)}function Sr(r){return Qv(r,_m)}br.propTypes={},br.filterProps=Em,Sr.propTypes={},Sr.filterProps=_m;function x1(r=8){if(r.mui)return r;const a=Xv({spacing:r}),d=(...p)=>(p.length===0?[1]:p).map(g=>{const R=a(g);return typeof R=="number"?`${R}px`:R}).join(" ");return d.mui=!0,d}function Sp(...r){const a=r.reduce((p,g)=>(g.filterProps.forEach(R=>{p[R]=g}),p),{}),d=p=>Object.keys(p).reduce((g,R)=>a[R]?Qh(g,a[R](p)):g,{});return d.propTypes={},d.filterProps=r.reduce((p,g)=>p.concat(g.filterProps),[]),d}function wa(r){return typeof r!="number"?r:`${r}px solid`}function ka(r,a){return kr({prop:r,themeKey:"borders",transform:a})}const D1=ka("border",wa),M1=ka("borderTop",wa),N1=ka("borderRight",wa),L1=ka("borderBottom",wa),B1=ka("borderLeft",wa),j1=ka("borderColor"),U1=ka("borderTopColor"),F1=ka("borderRightColor"),$1=ka("borderBottomColor"),V1=ka("borderLeftColor"),W1=ka("outline",wa),G1=ka("outlineColor"),kf=r=>{if(r.borderRadius!==void 0&&r.borderRadius!==null){const a=ff(r.theme,"shape.borderRadius",4),d=p=>({borderRadius:pf(a,p)});return Qc(r,r.borderRadius,d)}return null};kf.propTypes={},kf.filterProps=["borderRadius"],Sp(D1,M1,N1,L1,B1,j1,U1,F1,$1,V1,kf,W1,G1);const $f=r=>{if(r.gap!==void 0&&r.gap!==null){const a=ff(r.theme,"spacing",8),d=p=>({gap:pf(a,p)});return Qc(r,r.gap,d)}return null};$f.propTypes={},$f.filterProps=["gap"];const Vf=r=>{if(r.columnGap!==void 0&&r.columnGap!==null){const a=ff(r.theme,"spacing",8),d=p=>({columnGap:pf(a,p)});return Qc(r,r.columnGap,d)}return null};Vf.propTypes={},Vf.filterProps=["columnGap"];const Wf=r=>{if(r.rowGap!==void 0&&r.rowGap!==null){const a=ff(r.theme,"spacing",8),d=p=>({rowGap:pf(a,p)});return Qc(r,r.rowGap,d)}return null};Wf.propTypes={},Wf.filterProps=["rowGap"];const H1=kr({prop:"gridColumn"}),z1=kr({prop:"gridRow"}),q1=kr({prop:"gridAutoFlow"}),K1=kr({prop:"gridAutoColumns"}),Y1=kr({prop:"gridAutoRows"}),J1=kr({prop:"gridTemplateColumns"}),X1=kr({prop:"gridTemplateRows"}),Q1=kr({prop:"gridTemplateAreas"}),Z1=kr({prop:"gridArea"});Sp($f,Vf,Wf,H1,z1,q1,K1,Y1,J1,X1,Q1,Z1);function Yd(r,a){return a==="grey"?a:r}const eT=kr({prop:"color",themeKey:"palette",transform:Yd}),tT=kr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Yd}),nT=kr({prop:"backgroundColor",themeKey:"palette",transform:Yd});Sp(eT,tT,nT);function ea(r){return r<=1&&r!==0?100*r+"%":r}const rT=kr({prop:"width",transform:ea}),Cm=r=>{if(r.maxWidth!==void 0&&r.maxWidth!==null){const a=d=>{var p,g;const R=((p=r.theme)==null||(p=p.breakpoints)==null||(p=p.values)==null?void 0:p[d])||Sm[d];return R?((g=r.theme)==null||(g=g.breakpoints)==null?void 0:g.unit)!=="px"?{maxWidth:`${R}${r.theme.breakpoints.unit}`}:{maxWidth:R}:{maxWidth:ea(d)}};return Qc(r,r.maxWidth,a)}return null};Cm.filterProps=["maxWidth"];const iT=kr({prop:"minWidth",transform:ea}),oT=kr({prop:"height",transform:ea}),aT=kr({prop:"maxHeight",transform:ea}),sT=kr({prop:"minHeight",transform:ea});kr({prop:"size",cssProperty:"width",transform:ea}),kr({prop:"size",cssProperty:"height",transform:ea});const cT=kr({prop:"boxSizing"});Sp(rT,Cm,iT,oT,aT,sT,cT);var Tm={border:{themeKey:"borders",transform:wa},borderTop:{themeKey:"borders",transform:wa},borderRight:{themeKey:"borders",transform:wa},borderBottom:{themeKey:"borders",transform:wa},borderLeft:{themeKey:"borders",transform:wa},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:wa},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:kf},color:{themeKey:"palette",transform:Yd},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Yd},backgroundColor:{themeKey:"palette",transform:Yd},p:{style:Sr},pt:{style:Sr},pr:{style:Sr},pb:{style:Sr},pl:{style:Sr},px:{style:Sr},py:{style:Sr},padding:{style:Sr},paddingTop:{style:Sr},paddingRight:{style:Sr},paddingBottom:{style:Sr},paddingLeft:{style:Sr},paddingX:{style:Sr},paddingY:{style:Sr},paddingInline:{style:Sr},paddingInlineStart:{style:Sr},paddingInlineEnd:{style:Sr},paddingBlock:{style:Sr},paddingBlockStart:{style:Sr},paddingBlockEnd:{style:Sr},m:{style:br},mt:{style:br},mr:{style:br},mb:{style:br},ml:{style:br},mx:{style:br},my:{style:br},margin:{style:br},marginTop:{style:br},marginRight:{style:br},marginBottom:{style:br},marginLeft:{style:br},marginX:{style:br},marginY:{style:br},marginInline:{style:br},marginInlineStart:{style:br},marginInlineEnd:{style:br},marginBlock:{style:br},marginBlockStart:{style:br},marginBlockEnd:{style:br},displayPrint:{cssProperty:!1,transform:r=>({"@media print":{display:r}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:$f},rowGap:{style:Wf},columnGap:{style:Vf},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ea},maxWidth:{style:Cm},minWidth:{transform:ea},height:{transform:ea},maxHeight:{transform:ea},minHeight:{transform:ea},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function uT(){function r(a,d,p,g){const R={[a]:d,theme:p},E=g[a];if(!E)return{[a]:d};const{cssProperty:w=a,themeKey:m,transform:S,style:b}=E;if(d==null)return null;if(m==="typography"&&d==="inherit")return{[a]:d};const I=bp(p,m)||{};return b?b(R):Qc(R,d,_=>{let A=Ff(I,S,_);return _===A&&typeof _=="string"&&(A=Ff(I,S,`${a}${_==="default"?"":Jv(_)}`,_)),w===!1?A:{[w]:A}})}return function a(d){var p;const{sx:g,theme:R={}}=d||{};if(!g)return null;const E=(p=R.unstable_sxConfig)!=null?p:Tm;function w(m){let S=m;if(typeof m=="function")S=m(R);else if(typeof m!="object")return m;if(!S)return null;const b=R1(R.breakpoints),I=Object.keys(b);let _=b;return Object.keys(S).forEach(A=>{const C=(v=S[A],O=R,typeof v=="function"?v(O):v);var v,O;if(C!=null)if(typeof C=="object")if(E[A])_=Qh(_,r(A,C,R,E));else{const j=Qc({theme:R},C,D=>({[A]:D}));(function(...D){const x=D.reduce(($,H)=>$.concat(Object.keys(H)),[]),N=new Set(x);return D.every($=>N.size===Object.keys($).length)})(j,C)?_[A]=a({sx:C,theme:R}):_=Qh(_,j)}else _=Qh(_,r(A,C,R,E))}),w1(I,_)}return Array.isArray(g)?g.map(w):w(g)}}const Zv=uT();Zv.filterProps=["sx"];var e0=Zv;function lT(r,a){const d=this;return d.vars&&typeof d.getColorSchemeSelector=="function"?{[d.getColorSchemeSelector(r).replace(/(\[[^\]]+\])/,"*:where($1)")]:a}:d.palette.mode===r?a:{}}const dT=["breakpoints","palette","spacing","shape"];function t0(r={},...a){const{breakpoints:d={},palette:p={},spacing:g,shape:R={}}=r,E=nh(r,dT),w=C1(d),m=x1(g);let S=Jc({breakpoints:w,direction:"ltr",components:{},palette:sr({mode:"light"},p),spacing:m,shape:sr({},T1,R)},E);return S.applyStyles=lT,S=a.reduce((b,I)=>Jc(b,I),S),S.unstable_sxConfig=sr({},Tm,E==null?void 0:E.unstable_sxConfig),S.unstable_sx=function(b){return e0({sx:b,theme:this})},S}const hT=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function n0(r={},...a){const{mixins:d={},palette:p={},transitions:g={},typography:R={}}=r,E=nh(r,hT);if(r.vars)throw new Error(Qd(18));const w=h1(p),m=t0(r);let S=Jc(m,{mixins:u1(m.breakpoints,d),palette:w,shadows:m1.slice(),typography:p1(w,R),transitions:S1(g),zIndex:sr({},E1)});return S=Jc(S,E),S=a.reduce((b,I)=>Jc(b,I),S),S.unstable_sxConfig=sr({},Tm,E==null?void 0:E.unstable_sxConfig),S.unstable_sx=function(b){return e0({sx:b,theme:this})},S}function Yi(r){return r/16+"rem"}function Vd({sm:r,md:a,lg:d}){return{"@media (min-width:600px)":{fontSize:Yi(r)},"@media (min-width:900px)":{fontSize:Yi(a)},"@media (min-width:1200px)":{fontSize:Yi(d)}}}const fT={fontFamily:["Noto Sans JP","Noto Sans TC","Inter","Noto Sans","sans-serif"].join(","),fontWeightRegular:400,fontWeightMedium:600,fontWeightBold:700,h1:{fontWeight:800,lineHeight:1.25,fontSize:Yi(40),...Vd({sm:52,md:58,lg:64})},h2:{fontWeight:800,lineHeight:64/48,fontSize:Yi(32),...Vd({sm:40,md:44,lg:48})},h3:{fontWeight:700,lineHeight:1.5,fontSize:Yi(24),...Vd({sm:26,md:30,lg:32})},h4:{fontWeight:700,lineHeight:1.5,fontSize:Yi(20),...Vd({sm:20,md:24,lg:24})},h5:{fontWeight:700,lineHeight:1.5,fontSize:Yi(18),...Vd({sm:19,md:20,lg:20})},h6:{fontWeight:700,lineHeight:28/18,fontSize:Yi(17),...Vd({sm:18,md:18,lg:18})},subtitle1:{fontWeight:600,lineHeight:1.5,fontSize:Yi(16)},subtitle2:{fontWeight:600,lineHeight:22/14,fontSize:Yi(14)},body1:{lineHeight:1.5,fontSize:Yi(16)},body2:{lineHeight:22/14,fontSize:Yi(14)},caption:{lineHeight:1.5,fontSize:Yi(12)},overline:{fontWeight:700,lineHeight:1.5,fontSize:Yi(12)},button:{fontWeight:700,lineHeight:24/14,fontSize:Yi(14),textTransform:"none"}},pT=(r="light",a)=>{const d=n0({palette:{...qv(r),...a},customShadows:AC(r),shape:{borderRadius:8},typography:fT});return d.components=c1(d),d};var mT=n0();function gT(r=null){const a=ae.useContext(th);return a&&(d=a,Object.keys(d).length!==0)?a:r;var d}const vT=t0();function yT(r=vT){return gT(r)}function r0(r,a){const d=sr({},a);return Object.keys(r).forEach(p=>{if(p.toString().match(/^(components|slots)$/))d[p]=sr({},r[p],d[p]);else if(p.toString().match(/^(componentsProps|slotProps)$/)){const g=r[p]||{},R=a[p];d[p]={},R&&Object.keys(R)?g&&Object.keys(g)?(d[p]=sr({},R),Object.keys(g).forEach(E=>{d[p][E]=r0(g[E],R[E])})):d[p]=R:d[p]=g}else d[p]===void 0&&(d[p]=r[p])}),d}function bT(r){const{theme:a,name:d,props:p}=r;return a&&a.components&&a.components[d]&&a.components[d].defaultProps?r0(a.components[d].defaultProps,p):p}function ST({props:r,name:a,defaultTheme:d,themeId:p}){let g=yT(d);return p&&(g=g[p]||g),bT({theme:g,name:a,props:r})}function ET({props:r,name:a}){return ST({props:r,name:a,defaultTheme:mT})}const _T=r=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:sr({},r)}}}}),i0={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"open previous view",openNextView:"open next view",calendarViewSwitchingButtonAriaLabel:r=>r==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",inputModeToggleButtonAriaLabel:(r,a)=>r?`text input view is open, go to ${a} view`:`${a} view is open, go to text input view`,start:"Start",end:"End",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerDefaultToolbarTitle:"Select date",dateTimePickerDefaultToolbarTitle:"Select date & time",timePickerDefaultToolbarTitle:"Select time",dateRangePickerDefaultToolbarTitle:"Select date range",clockLabelText:(r,a,d)=>`Select ${r}. ${a===null?"No time selected":`Selected time is ${d.format(a,"fullTime")}`}`,hoursClockNumberText:r=>`${r} hours`,minutesClockNumberText:r=>`${r} minutes`,secondsClockNumberText:r=>`${r} seconds`,openDatePickerDialogue:(r,a)=>r&&a.isValid(a.date(r))?`Choose date, selected date is ${a.format(a.date(r),"fullDate")}`:"Choose date",openTimePickerDialogue:(r,a)=>r&&a.isValid(a.date(r))?`Choose time, selected time is ${a.format(a.date(r),"fullTime")}`:"Choose time",timeTableLabel:"pick time",dateTableLabel:"pick date"},CT=i0;_T(i0);const TT=ae.createContext(null);function RT(r){const a=ET({props:r,name:"MuiLocalizationProvider"}),{children:d,dateAdapter:p,dateFormats:g,dateLibInstance:R,locale:E,adapterLocale:w,localeText:m}=a,S=ae.useMemo(()=>new p({locale:w??E,formats:g,instance:R}),[p,E,w,g,R]),b=ae.useMemo(()=>({minDate:S.date("1900-01-01T00:00:00.000"),maxDate:S.date("2099-12-31T00:00:00.000")}),[S]),I=ae.useMemo(()=>({utils:S,defaultDates:b,localeText:sr({},CT,m??{})}),[b,S,m]);return nn.jsx(TT.Provider,{value:I,children:d})}var o0={exports:{}};(function(r,a){(function(d,p){r.exports=p()})(y0,function(){var d=1e3,p=6e4,g=36e5,R="millisecond",E="second",w="minute",m="hour",S="day",b="week",I="month",_="quarter",A="year",C="date",v="Invalid Date",O=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,j=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(ie){var de=["th","st","nd","rd"],ne=ie%100;return"["+ie+(de[(ne-20)%10]||de[ne]||de[0])+"]"}},x=function(ie,de,ne){var J=String(ie);return!J||J.length>=de?ie:""+Array(de+1-J.length).join(ne)+ie},N={s:x,z:function(ie){var de=-ie.utcOffset(),ne=Math.abs(de),J=Math.floor(ne/60),W=ne%60;return(de<=0?"+":"-")+x(J,2,"0")+":"+x(W,2,"0")},m:function ie(de,ne){if(de.date()<ne.date())return-ie(ne,de);var J=12*(ne.year()-de.year())+(ne.month()-de.month()),W=de.clone().add(J,I),X=ne-W<0,se=de.clone().add(J+(X?-1:1),I);return+(-(J+(ne-W)/(X?W-se:se-W))||0)},a:function(ie){return ie<0?Math.ceil(ie)||0:Math.floor(ie)},p:function(ie){return{M:I,y:A,w:b,d:S,D:C,h:m,m:w,s:E,ms:R,Q:_}[ie]||String(ie||"").toLowerCase().replace(/s$/,"")},u:function(ie){return ie===void 0}},$="en",H={};H[$]=D;var K=function(ie){return ie instanceof Se},ce=function ie(de,ne,J){var W;if(!de)return $;if(typeof de=="string"){var X=de.toLowerCase();H[X]&&(W=X),ne&&(H[X]=ne,W=X);var se=de.split("-");if(!W&&se.length>1)return ie(se[0])}else{var he=de.name;H[he]=de,W=he}return!J&&W&&($=W),W||!J&&$},Q=function(ie,de){if(K(ie))return ie.clone();var ne=typeof de=="object"?de:{};return ne.date=ie,ne.args=arguments,new Se(ne)},Z=N;Z.l=ce,Z.i=K,Z.w=function(ie,de){return Q(ie,{locale:de.$L,utc:de.$u,x:de.$x,$offset:de.$offset})};var Se=function(){function ie(ne){this.$L=ce(ne.locale,null,!0),this.parse(ne)}var de=ie.prototype;return de.parse=function(ne){this.$d=function(J){var W=J.date,X=J.utc;if(W===null)return new Date(NaN);if(Z.u(W))return new Date;if(W instanceof Date)return new Date(W);if(typeof W=="string"&&!/Z$/i.test(W)){var se=W.match(O);if(se){var he=se[2]-1||0,Ie=(se[7]||"0").substring(0,3);return X?new Date(Date.UTC(se[1],he,se[3]||1,se[4]||0,se[5]||0,se[6]||0,Ie)):new Date(se[1],he,se[3]||1,se[4]||0,se[5]||0,se[6]||0,Ie)}}return new Date(W)}(ne),this.$x=ne.x||{},this.init()},de.init=function(){var ne=this.$d;this.$y=ne.getFullYear(),this.$M=ne.getMonth(),this.$D=ne.getDate(),this.$W=ne.getDay(),this.$H=ne.getHours(),this.$m=ne.getMinutes(),this.$s=ne.getSeconds(),this.$ms=ne.getMilliseconds()},de.$utils=function(){return Z},de.isValid=function(){return this.$d.toString()!==v},de.isSame=function(ne,J){var W=Q(ne);return this.startOf(J)<=W&&W<=this.endOf(J)},de.isAfter=function(ne,J){return Q(ne)<this.startOf(J)},de.isBefore=function(ne,J){return this.endOf(J)<Q(ne)},de.$g=function(ne,J,W){return Z.u(ne)?this[J]:this.set(W,ne)},de.unix=function(){return Math.floor(this.valueOf()/1e3)},de.valueOf=function(){return this.$d.getTime()},de.startOf=function(ne,J){var W=this,X=!!Z.u(J)||J,se=Z.p(ne),he=function(Ht,Ge){var At=Z.w(W.$u?Date.UTC(W.$y,Ge,Ht):new Date(W.$y,Ge,Ht),W);return X?At:At.endOf(S)},Ie=function(Ht,Ge){return Z.w(W.toDate()[Ht].apply(W.toDate("s"),(X?[0,0,0,0]:[23,59,59,999]).slice(Ge)),W)},we=this.$W,Qe=this.$M,Tt=this.$D,vt="set"+(this.$u?"UTC":"");switch(se){case A:return X?he(1,0):he(31,11);case I:return X?he(1,Qe):he(0,Qe+1);case b:var Ut=this.$locale().weekStart||0,Vt=(we<Ut?we+7:we)-Ut;return he(X?Tt-Vt:Tt+(6-Vt),Qe);case S:case C:return Ie(vt+"Hours",0);case m:return Ie(vt+"Minutes",1);case w:return Ie(vt+"Seconds",2);case E:return Ie(vt+"Milliseconds",3);default:return this.clone()}},de.endOf=function(ne){return this.startOf(ne,!1)},de.$set=function(ne,J){var W,X=Z.p(ne),se="set"+(this.$u?"UTC":""),he=(W={},W[S]=se+"Date",W[C]=se+"Date",W[I]=se+"Month",W[A]=se+"FullYear",W[m]=se+"Hours",W[w]=se+"Minutes",W[E]=se+"Seconds",W[R]=se+"Milliseconds",W)[X],Ie=X===S?this.$D+(J-this.$W):J;if(X===I||X===A){var we=this.clone().set(C,1);we.$d[he](Ie),we.init(),this.$d=we.set(C,Math.min(this.$D,we.daysInMonth())).$d}else he&&this.$d[he](Ie);return this.init(),this},de.set=function(ne,J){return this.clone().$set(ne,J)},de.get=function(ne){return this[Z.p(ne)]()},de.add=function(ne,J){var W,X=this;ne=Number(ne);var se=Z.p(J),he=function(Qe){var Tt=Q(X);return Z.w(Tt.date(Tt.date()+Math.round(Qe*ne)),X)};if(se===I)return this.set(I,this.$M+ne);if(se===A)return this.set(A,this.$y+ne);if(se===S)return he(1);if(se===b)return he(7);var Ie=(W={},W[w]=p,W[m]=g,W[E]=d,W)[se]||1,we=this.$d.getTime()+ne*Ie;return Z.w(we,this)},de.subtract=function(ne,J){return this.add(-1*ne,J)},de.format=function(ne){var J=this,W=this.$locale();if(!this.isValid())return W.invalidDate||v;var X=ne||"YYYY-MM-DDTHH:mm:ssZ",se=Z.z(this),he=this.$H,Ie=this.$m,we=this.$M,Qe=W.weekdays,Tt=W.months,vt=function(Ge,At,rn,gn){return Ge&&(Ge[At]||Ge(J,X))||rn[At].slice(0,gn)},Ut=function(Ge){return Z.s(he%12||12,Ge,"0")},Vt=W.meridiem||function(Ge,At,rn){var gn=Ge<12?"AM":"PM";return rn?gn.toLowerCase():gn},Ht={YY:String(this.$y).slice(-2),YYYY:this.$y,M:we+1,MM:Z.s(we+1,2,"0"),MMM:vt(W.monthsShort,we,Tt,3),MMMM:vt(Tt,we),D:this.$D,DD:Z.s(this.$D,2,"0"),d:String(this.$W),dd:vt(W.weekdaysMin,this.$W,Qe,2),ddd:vt(W.weekdaysShort,this.$W,Qe,3),dddd:Qe[this.$W],H:String(he),HH:Z.s(he,2,"0"),h:Ut(1),hh:Ut(2),a:Vt(he,Ie,!0),A:Vt(he,Ie,!1),m:String(Ie),mm:Z.s(Ie,2,"0"),s:String(this.$s),ss:Z.s(this.$s,2,"0"),SSS:Z.s(this.$ms,3,"0"),Z:se};return X.replace(j,function(Ge,At){return At||Ht[Ge]||se.replace(":","")})},de.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},de.diff=function(ne,J,W){var X,se=Z.p(J),he=Q(ne),Ie=(he.utcOffset()-this.utcOffset())*p,we=this-he,Qe=Z.m(this,he);return Qe=(X={},X[A]=Qe/12,X[I]=Qe,X[_]=Qe/3,X[b]=(we-Ie)/6048e5,X[S]=(we-Ie)/864e5,X[m]=we/g,X[w]=we/p,X[E]=we/d,X)[se]||we,W?Qe:Z.a(Qe)},de.daysInMonth=function(){return this.endOf(I).$D},de.$locale=function(){return H[this.$L]},de.locale=function(ne,J){if(!ne)return this.$L;var W=this.clone(),X=ce(ne,J,!0);return X&&(W.$L=X),W},de.clone=function(){return Z.w(this.$d,this)},de.toDate=function(){return new Date(this.valueOf())},de.toJSON=function(){return this.isValid()?this.toISOString():null},de.toISOString=function(){return this.$d.toISOString()},de.toString=function(){return this.$d.toUTCString()},ie}(),G=Se.prototype;return Q.prototype=G,[["$ms",R],["$s",E],["$m",w],["$H",m],["$W",S],["$M",I],["$y",A],["$D",C]].forEach(function(ie){G[ie[1]]=function(de){return this.$g(de,ie[0],ie[1])}}),Q.extend=function(ie,de){return ie.$i||(ie(de,Se,Q),ie.$i=!0),Q},Q.locale=ce,Q.isDayjs=K,Q.unix=function(ie){return Q(1e3*ie)},Q.en=H[$],Q.Ls=H,Q.p={},Q})})(o0);var wT=o0.exports;const Of=b0(wT);var a0={exports:{}};a0.exports=function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d\d/,p=/\d\d?/,g=/\d*[^-_:/,()\s\d]+/,R={},E=function(A){return(A=+A)+(A>68?1900:2e3)},w=function(A){return function(C){this[A]=+C}},m=[/[+-]\d\d:?(\d\d)?|Z/,function(A){(this.zone||(this.zone={})).offset=function(C){if(!C||C==="Z")return 0;var v=C.match(/([+-]|\d\d)/g),O=60*v[1]+(+v[2]||0);return O===0?0:v[0]==="+"?-O:O}(A)}],S=function(A){var C=R[A];return C&&(C.indexOf?C:C.s.concat(C.f))},b=function(A,C){var v,O=R.meridiem;if(O){for(var j=1;j<=24;j+=1)if(A.indexOf(O(j,0,C))>-1){v=j>12;break}}else v=A===(C?"pm":"PM");return v},I={A:[g,function(A){this.afternoon=b(A,!1)}],a:[g,function(A){this.afternoon=b(A,!0)}],S:[/\d/,function(A){this.milliseconds=100*+A}],SS:[d,function(A){this.milliseconds=10*+A}],SSS:[/\d{3}/,function(A){this.milliseconds=+A}],s:[p,w("seconds")],ss:[p,w("seconds")],m:[p,w("minutes")],mm:[p,w("minutes")],H:[p,w("hours")],h:[p,w("hours")],HH:[p,w("hours")],hh:[p,w("hours")],D:[p,w("day")],DD:[d,w("day")],Do:[g,function(A){var C=R.ordinal,v=A.match(/\d+/);if(this.day=v[0],C)for(var O=1;O<=31;O+=1)C(O).replace(/\[|\]/g,"")===A&&(this.day=O)}],M:[p,w("month")],MM:[d,w("month")],MMM:[g,function(A){var C=S("months"),v=(S("monthsShort")||C.map(function(O){return O.slice(0,3)})).indexOf(A)+1;if(v<1)throw new Error;this.month=v%12||v}],MMMM:[g,function(A){var C=S("months").indexOf(A)+1;if(C<1)throw new Error;this.month=C%12||C}],Y:[/[+-]?\d+/,w("year")],YY:[d,function(A){this.year=E(A)}],YYYY:[/\d{4}/,w("year")],Z:m,ZZ:m};function _(A){var C,v;C=A,v=R&&R.formats;for(var O=(A=C.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(K,ce,Q){var Z=Q&&Q.toUpperCase();return ce||v[Q]||r[Q]||v[Z].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Se,G,ie){return G||ie.slice(1)})})).match(a),j=O.length,D=0;D<j;D+=1){var x=O[D],N=I[x],$=N&&N[0],H=N&&N[1];O[D]=H?{regex:$,parser:H}:x.replace(/^\[|\]$/g,"")}return function(K){for(var ce={},Q=0,Z=0;Q<j;Q+=1){var Se=O[Q];if(typeof Se=="string")Z+=Se.length;else{var G=Se.regex,ie=Se.parser,de=K.slice(Z),ne=G.exec(de)[0];ie.call(ce,ne),K=K.replace(ne,"")}}return function(J){var W=J.afternoon;if(W!==void 0){var X=J.hours;W?X<12&&(J.hours+=12):X===12&&(J.hours=0),delete J.afternoon}}(ce),ce}}return function(A,C,v){v.p.customParseFormat=!0,A&&A.parseTwoDigitYear&&(E=A.parseTwoDigitYear);var O=C.prototype,j=O.parse;O.parse=function(D){var x=D.date,N=D.utc,$=D.args;this.$u=N;var H=$[1];if(typeof H=="string"){var K=$[2]===!0,ce=$[3]===!0,Q=K||ce,Z=$[2];ce&&(Z=$[2]),R=this.$locale(),!K&&Z&&(R=v.Ls[Z]),this.$d=function(de,ne,J){try{if(["x","X"].indexOf(ne)>-1)return new Date((ne==="X"?1e3:1)*de);var W=_(ne)(de),X=W.year,se=W.month,he=W.day,Ie=W.hours,we=W.minutes,Qe=W.seconds,Tt=W.milliseconds,vt=W.zone,Ut=new Date,Vt=he||(X||se?1:Ut.getDate()),Ht=X||Ut.getFullYear(),Ge=0;X&&!se||(Ge=se>0?se-1:Ut.getMonth());var At=Ie||0,rn=we||0,gn=Qe||0,Dn=Tt||0;return vt?new Date(Date.UTC(Ht,Ge,Vt,At,rn,gn,Dn+60*vt.offset*1e3)):J?new Date(Date.UTC(Ht,Ge,Vt,At,rn,gn,Dn)):new Date(Ht,Ge,Vt,At,rn,gn,Dn)}catch{return new Date("")}}(x,H,N),this.init(),Z&&Z!==!0&&(this.$L=this.locale(Z).$L),Q&&x!=this.format(H)&&(this.$d=new Date("")),R={}}else if(H instanceof Array)for(var Se=H.length,G=1;G<=Se;G+=1){$[1]=H[G-1];var ie=v.apply(this,$);if(ie.isValid()){this.$d=ie.$d,this.$L=ie.$L,this.init();break}G===Se&&(this.$d=new Date(""))}else j.call(this,D)}}}();var IT=bm(a0.exports),s0={exports:{}},xp;s0.exports=(xp={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},function(r,a,d){var p=a.prototype,g=p.format;d.en.formats=xp,p.format=function(R){R===void 0&&(R="YYYY-MM-DDTHH:mm:ssZ");var E=this.$locale().formats,w=function(m,S){return m.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(b,I,_){var A=_&&_.toUpperCase();return I||S[_]||xp[_]||S[A].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(C,v,O){return v||O.slice(1)})})}(R,E===void 0?{}:E);return g.call(this,w)}});var kT=bm(s0.exports),c0={exports:{}};c0.exports=function(r,a,d){a.prototype.isBetween=function(p,g,R,E){var w=d(p),m=d(g),S=(E=E||"()")[0]==="(",b=E[1]===")";return(S?this.isAfter(w,R):!this.isBefore(w,R))&&(b?this.isBefore(m,R):!this.isAfter(m,R))||(S?this.isBefore(w,R):!this.isAfter(w,R))&&(b?this.isAfter(m,R):!this.isBefore(m,R))}};var OT=bm(c0.exports);Of.extend(IT),Of.extend(kT),Of.extend(OT);const AT={normalDateWithWeekday:"ddd, MMM D",normalDate:"D MMMM",shortDate:"MMM D",monthAndDate:"MMMM D",dayOfMonth:"D",year:"YYYY",month:"MMMM",monthShort:"MMM",monthAndYear:"MMMM YYYY",weekday:"dddd",weekdayShort:"ddd",minutes:"mm",hours12h:"hh",hours24h:"HH",seconds:"ss",fullTime:"LT",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",fullDate:"ll",fullDateWithWeekday:"dddd, LL",fullDateTime:"lll",fullDateTime12h:"ll hh:mm A",fullDateTime24h:"ll HH:mm",keyboardDate:"L",keyboardDateTime:"L LT",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"};let PT=class{constructor({locale:a,formats:d,instance:p}={}){this.lib="dayjs",this.is12HourCycleInCurrentLocale=()=>{var g,R,E;return/A|a/.test((E=(R=(g=this.rawDayJsInstance.Ls[this.locale||"en"])===null||g===void 0?void 0:g.formats)===null||R===void 0?void 0:R.LT)!==null&&E!==void 0?E:"")},this.getCurrentLocaleCode=()=>this.locale||"en",this.getFormatHelperText=g=>{var R,E;return(E=(R=g.match(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?)|./g))===null||R===void 0?void 0:R.map(w=>{var m,S;return w[0]==="L"&&(S=(m=this.rawDayJsInstance.Ls[this.locale||"en"])===null||m===void 0?void 0:m.formats[w])!==null&&S!==void 0?S:w}).join("").replace(/a/gi,"(a|p)m").toLocaleLowerCase())!==null&&E!==void 0?E:g},this.parseISO=g=>this.dayjs(g),this.toISO=g=>g.toISOString(),this.parse=(g,R)=>g===""?null:this.dayjs(g,R,this.locale,!0),this.date=g=>g===null?null:this.dayjs(g),this.toJsDate=g=>g.toDate(),this.isValid=g=>this.dayjs(g).isValid(),this.isNull=g=>g===null,this.getDiff=(g,R,E)=>(typeof R=="string"&&(R=this.dayjs(R)),R.isValid()?g.diff(R,E):0),this.isAfter=(g,R)=>g.isAfter(R),this.isBefore=(g,R)=>g.isBefore(R),this.isAfterDay=(g,R)=>g.isAfter(R,"day"),this.isBeforeDay=(g,R)=>g.isBefore(R,"day"),this.isAfterMonth=(g,R)=>g.isAfter(R,"month"),this.isBeforeMonth=(g,R)=>g.isBefore(R,"month"),this.isBeforeYear=(g,R)=>g.isBefore(R,"year"),this.isAfterYear=(g,R)=>g.isAfter(R,"year"),this.startOfDay=g=>g.startOf("day"),this.endOfDay=g=>g.endOf("day"),this.format=(g,R)=>this.formatByString(g,this.formats[R]),this.formatByString=(g,R)=>this.dayjs(g).format(R),this.formatNumber=g=>g,this.getHours=g=>g.hour(),this.addSeconds=(g,R)=>R<0?g.subtract(Math.abs(R),"second"):g.add(R,"second"),this.addMinutes=(g,R)=>R<0?g.subtract(Math.abs(R),"minute"):g.add(R,"minute"),this.addHours=(g,R)=>R<0?g.subtract(Math.abs(R),"hour"):g.add(R,"hour"),this.addDays=(g,R)=>R<0?g.subtract(Math.abs(R),"day"):g.add(R,"day"),this.addWeeks=(g,R)=>R<0?g.subtract(Math.abs(R),"week"):g.add(R,"week"),this.addMonths=(g,R)=>R<0?g.subtract(Math.abs(R),"month"):g.add(R,"month"),this.addYears=(g,R)=>R<0?g.subtract(Math.abs(R),"year"):g.add(R,"year"),this.setMonth=(g,R)=>g.set("month",R),this.setHours=(g,R)=>g.set("hour",R),this.getMinutes=g=>g.minute(),this.setMinutes=(g,R)=>g.set("minute",R),this.getSeconds=g=>g.second(),this.setSeconds=(g,R)=>g.set("second",R),this.getMonth=g=>g.month(),this.getDate=g=>g.date(),this.setDate=(g,R)=>g.set("date",R),this.getDaysInMonth=g=>g.daysInMonth(),this.isSameDay=(g,R)=>g.isSame(R,"day"),this.isSameMonth=(g,R)=>g.isSame(R,"month"),this.isSameYear=(g,R)=>g.isSame(R,"year"),this.isSameHour=(g,R)=>g.isSame(R,"hour"),this.getMeridiemText=g=>g==="am"?"AM":"PM",this.startOfYear=g=>g.startOf("year"),this.endOfYear=g=>g.endOf("year"),this.startOfMonth=g=>g.startOf("month"),this.endOfMonth=g=>g.endOf("month"),this.startOfWeek=g=>g.startOf("week"),this.endOfWeek=g=>g.endOf("week"),this.getNextMonth=g=>g.add(1,"month"),this.getPreviousMonth=g=>g.subtract(1,"month"),this.getMonthArray=g=>{const R=[g.startOf("year")];for(;R.length<12;){const E=R[R.length-1];R.push(this.getNextMonth(E))}return R},this.getYear=g=>g.year(),this.setYear=(g,R)=>g.set("year",R),this.mergeDateAndTime=(g,R)=>g.hour(R.hour()).minute(R.minute()).second(R.second()),this.getWeekdays=()=>{const g=this.dayjs().startOf("week");return[0,1,2,3,4,5,6].map(R=>this.formatByString(g.add(R,"day"),"dd"))},this.isEqual=(g,R)=>g===null&&R===null||this.dayjs(g).isSame(R),this.getWeekArray=g=>{const R=this.dayjs(g).startOf("month").startOf("week"),E=this.dayjs(g).endOf("month").endOf("week");let w=0,m=R;const S=[];for(;m.isBefore(E);){const b=Math.floor(w/7);S[b]=S[b]||[],S[b].push(m),m=m.add(1,"day"),w+=1}return S},this.getYearRange=(g,R)=>{const E=this.dayjs(g).startOf("year"),w=this.dayjs(R).endOf("year"),m=[];let S=E;for(;S.isBefore(w);)m.push(S),S=S.add(1,"year");return m},this.isWithinRange=(g,[R,E])=>g.isBetween(R,E,null,"[]"),this.rawDayJsInstance=p||Of,this.dayjs=((g,R)=>R?(...E)=>g(...E).locale(R):g)(this.rawDayJsInstance,a),this.locale=a,this.formats=Object.assign({},AT,d)}};const xT={YY:"year",YYYY:"year",M:"month",MM:"month",MMM:"month",MMMM:"month",D:"day",DD:"day",H:"hour",HH:"hour",h:"hour",hh:"hour",m:"minute",mm:"minute",s:"second",ss:"second",A:"am-pm",a:"am-pm"};class DT extends PT{constructor(...a){super(...a),this.formatTokenMap=xT,this.expandFormat=d=>{var p;const g=(p=this.rawDayJsInstance.Ls[this.locale||"en"])==null?void 0:p.formats;return d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(R,E,w)=>{const m=w&&w.toUpperCase();return E||g[w]||g[m].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(S,b,I)=>b||I.slice(1))})},this.getFormatHelperText=d=>this.expandFormat(d).replace(/a/gi,"(a|p)m").toLocaleLowerCase()}}var Bg={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Cf;const MT=new Uint8Array(16);function NT(){if(!Cf&&(Cf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Cf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Cf(MT)}const ki=[];for(let r=0;r<256;++r)ki.push((r+256).toString(16).slice(1));function LT(r,a=0){return ki[r[a+0]]+ki[r[a+1]]+ki[r[a+2]]+ki[r[a+3]]+"-"+ki[r[a+4]]+ki[r[a+5]]+"-"+ki[r[a+6]]+ki[r[a+7]]+"-"+ki[r[a+8]]+ki[r[a+9]]+"-"+ki[r[a+10]]+ki[r[a+11]]+ki[r[a+12]]+ki[r[a+13]]+ki[r[a+14]]+ki[r[a+15]]}function jg(r,a,d){if(Bg.randomUUID&&!a&&!r)return Bg.randomUUID();const p=(r=r||{}).random||(r.rng||NT)();return p[6]=15&p[6]|64,p[8]=63&p[8]|128,LT(p)}const BT=ae.createContext({addToast:()=>{},toastState:[]}),jT=({toast:r,onClose:a})=>(ae.useEffect(()=>{r!=null&&r.duration&&setTimeout(()=>{a()},r==null?void 0:r.duration)},[a,r==null?void 0:r.duration]),nn.jsx(gm,{in:!0,timeout:300,children:nn.jsx(X_,{severity:r.type,sx:{overflowWrap:"anywhere"},onClose:a,children:r.message})})),UT=({children:r})=>{const a=fm(),[d,p]=ae.useState([]),g=ae.useCallback(({message:E,type:w="success",key:m})=>{const S=m?`${jg()}-${m}`:jg();d.find(b=>b.key===S)||p(b=>{const I=b.length<10?b:b.slice(0,-1);return[{message:E,type:w,duration:5e3,key:S},...I]})},[d]),R=ae.useCallback(E=>{p(w=>w.filter(m=>m.key!==E))},[]);return nn.jsxs(nn.Fragment,{children:[nn.jsx(SC,{anchorOrigin:{vertical:"top",horizontal:"center"},open:!0,autoHideDuration:null,transitionDuration:0,sx:{top:64,minWidth:240,maxWidth:"calc(100% - 480px)",[a.breakpoints.down("sm")]:{maxWidth:320,right:0,left:0,marginLeft:"auto",marginRight:"auto"}},children:nn.jsx(eC,{display:"flex",flexDirection:"column",gap:1,children:d.map(E=>nn.jsx(jT,{toast:E,onClose:()=>R(E.key)},E.key))})}),nn.jsx(BT.Provider,{value:{addToast:g,toastState:d},children:r})]})},u0=ae.createContext({openedDialogCount:0,increaseDialogCount:()=>{},decreaseDialogCount:()=>{}}),FT=({children:r,themeMode:a="light",locale:d="en",customPalette:p})=>{const[g,R]=ae.useState(0),E=ae.useCallback(()=>R(S=>S+1),[]),w=ae.useCallback(()=>R(S=>Math.max(0,S-1)),[]),m=ae.useMemo(()=>({openedDialogCount:g,increaseDialogCount:E,decreaseDialogCount:w}),[w,E,g]);return ae.useEffect(()=>{document.body.style.overflow=g>0?"hidden":"initial"},[g]),nn.jsx(u0.Provider,{value:m,children:nn.jsx(RT,{dateAdapter:DT,adapterLocale:d,children:nn.jsxs(OE,{theme:pT(a,p),children:[nn.jsx(iC,{}),nn.jsx(UT,{children:r})]})})})},TR=()=>{const r=ae.useContext(u0);if(!r)throw new Error("useDialogContext must be used within a WebUiProvider");return r},$T=ae.lazy(()=>zp(()=>import("./layout-BYZgOmdH.js"),__vite__mapDeps([0,1,2]))),VT=ae.lazy(()=>zp(()=>import("./HomePage-CFPbNzW9.js"),__vite__mapDeps([3,1,2,4]))),WT=ae.lazy(()=>zp(()=>import("./Room-Bm2pVfnT.js"),__vite__mapDeps([5,1,2,4]))),GT=My([{path:"/",element:ut.jsx($T,{}),children:[{index:!0,element:ut.jsx(VT,{})},{path:"room",element:ut.jsx(WT,{})}]}]);var Oi=(r=>(r.MuteAudio="MUTE_AUDIO",r.UnmuteAudio="UNMUTE_AUDIO",r.MuteVideo="MUTE_VIDEO",r.UnmuteVideo="UNMUTE_VIDEO",r.StatusUpdate="STATUS_UPDATE",r))(Oi||{});async function HT(r,a,d){const p={video:{deviceId:r?{ideal:r}:void 0,width:{ideal:a,max:a},height:{ideal:d,max:d}},audio:!1};try{return await navigator.mediaDevices.getUserMedia(p)}catch(g){throw g}}async function Ug(r){return navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:r}},video:!1})}function Rm(r){return{hasAudio:(r==null?void 0:r.getAudioTracks().some(a=>a.readyState==="live"&&a.enabled))??!1,hasVideo:(r==null?void 0:r.getVideoTracks().some(a=>a.readyState==="live"&&a.enabled))??!1}}const Fg=r=>"type"in r;class zT{constructor(a,d,p,g,R){yt(this,"config");yt(this,"callbacks");yt(this,"publishManager");yt(this,"mediaManager");yt(this,"participantManager");this.config=a,this.callbacks=d,this.publishManager=p,this.mediaManager=g,this.participantManager=R}handleSeiMessage(a,d){const p=d.payload instanceof ArrayBuffer?d.payload:d.payload instanceof Uint8Array?d.payload.buffer.slice(d.payload.byteOffset,d.payload.byteOffset+d.payload.byteLength):null;if(p)try{const g=JSON.parse(new TextDecoder().decode(p));Fg(g)&&(this.applyCommand(g),this.callbacks.onCommandReceived&&this.callbacks.onCommandReceived(g))}catch{console.warn("Failed to parse SEI message")}}applyCommand(a){const d=a.targetParticipantId;if(!d)return;const g={[Oi.MuteAudio]:()=>this.handleAudioControl(d,!1),[Oi.UnmuteAudio]:()=>this.handleAudioControl(d,!0),[Oi.MuteVideo]:()=>this.handleVideoControl(d,!1),[Oi.UnmuteVideo]:()=>this.handleVideoControl(d,!0),[Oi.StatusUpdate]:()=>this.handleStatusUpdate(d,a)}[a.type];g&&g()}handleAudioControl(a,d){const p=this.participantManager.getSelfId();!p||a!==p||(this.publishManager.setLocalAudioEnabled(d),this.updateAndBroadcastStatus(p))}handleVideoControl(a,d){const p=this.participantManager.getSelfId();!p||a!==p||(this.publishManager.setLocalVideoEnabled(d),this.updateAndBroadcastStatus(p))}updateAndBroadcastStatus(a){const d=this.publishManager.getLocalStream(),{hasAudio:p,hasVideo:g}=Rm(d);this.mediaManager.setRemoteControlState(a,"audio",p),this.mediaManager.setRemoteControlState(a,"video",g),this.sendSeiMessage({type:Oi.StatusUpdate,targetParticipantId:a,data:{hasAudio:p,hasVideo:g}})}handleStatusUpdate(a,d){if(!Fg(d))return;const{hasAudio:p,hasVideo:g}=d.data;p!==void 0&&this.mediaManager.setRemoteControlState(a,"audio",p),g!==void 0&&this.mediaManager.setRemoteControlState(a,"video",g),console.log(`Status updated for ${a}:`,{hasAudio:p,hasVideo:g})}async broadcastCommand(a,d=3){return a.type===Oi.StatusUpdate?this.sendSeiMessage(a,d):this.config.role!=="admin"?!1:this.sendSeiMessage(a,d)}async sendSeiMessage(a,d=3){const p=this.publishManager.getRawVideoStream();if(!p)return console.warn("No video stream available for SEI message"),!1;const g=p.mediaStreamTrack;if(!g||g.readyState!=="live")return console.warn("Video track is not ready for SEI message",{hasTrack:!!g,readyState:g==null?void 0:g.readyState}),!1;const R=new TextEncoder().encode(JSON.stringify({...a,timestamp:Date.now()})),E=R.buffer.slice(R.byteOffset,R.byteOffset+R.byteLength);try{return await p.insertSeiMessage(E,{repeatCount:d}),!0}catch{try{return await p.insertSeiMessage(E),!0}catch{return!1}}}muteAudio(a){this.config.role==="admin"&&(this.broadcastCommand({type:Oi.MuteAudio,targetParticipantId:a}),this.callbacks.onParticipantMuted&&this.callbacks.onParticipantMuted(a,"audio"),this.mediaManager.setRemoteControlState(a,"audio",!1))}unmuteAudio(a){this.config.role==="admin"&&(this.broadcastCommand({type:Oi.UnmuteAudio,targetParticipantId:a}),this.callbacks.onParticipantUnmuted&&this.callbacks.onParticipantUnmuted(a,"audio"),this.mediaManager.setRemoteControlState(a,"audio",!0))}muteVideo(a){this.config.role==="admin"&&(this.broadcastCommand({type:Oi.MuteVideo,targetParticipantId:a}),this.callbacks.onParticipantMuted&&this.callbacks.onParticipantMuted(a,"video"),this.mediaManager.setRemoteControlState(a,"video",!1))}unmuteVideo(a){this.config.role==="admin"&&(this.broadcastCommand({type:Oi.UnmuteVideo,targetParticipantId:a}),this.callbacks.onParticipantUnmuted&&this.callbacks.onParticipantUnmuted(a,"video"),this.mediaManager.setRemoteControlState(a,"video",!0))}}class qT{constructor(a,d,p){yt(this,"callbacks");yt(this,"subscriptionManager");yt(this,"participantManager");yt(this,"audioContext",null);yt(this,"isSafari",/Safari/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent));yt(this,"media",new Map);this.callbacks=a,this.subscriptionManager=d,this.participantManager=p}initializeParticipant(a){this.media.set(a,{remoteStream:null,videoElement:null,audioElement:null,audioContext:null,analyser:null,source:null,volume:0,streamStatus:{hasAudio:!1,hasVideo:!1,isActive:!1,lastUpdated:Date.now()},remoteControlState:null})}addStreams(a,d){let p=this.media.get(a);p||(this.initializeParticipant(a),p=this.media.get(a));const g=d.map(E=>E.mediaStreamTrack).filter(E=>E);let R;return p!=null&&p.remoteStream?(R=p.remoteStream,g.forEach(E=>{R.getTrackById(E.id)||R.addTrack(E)})):R=new MediaStream(g),p&&(p.remoteStream=R),R}removeStreams(a,d){const p=this.media.get(a);return p!=null&&p.remoteStream?(d.forEach(g=>{g.mediaStreamTrack&&p.remoteStream.removeTrack(g.mediaStreamTrack)}),p.remoteStream.getAudioTracks().some(g=>g.readyState==="live")||this.cleanupAudio(a),this.updateVideoElement(a),p.remoteStream.getTracks().length>0):!1}attachStreams(a){const d=this.media.get(a);if(!(d!=null&&d.remoteStream))return;this.updateVideoElement(a);const p=this.participantManager.getSelfId();a!==p&&d.remoteStream.getAudioTracks().length>0?this.setupAudioPlayback(a):a===p&&(this.cleanupAudio(a),this.updateVideoElement(a)),this.updateStreamStatus(a)}updateVideoElement(a){const d=this.media.get(a);if(!(d!=null&&d.remoteStream)){console.warn(`No remote stream for participant ${a}`);return}if(d.videoElement)d.videoElement.srcObject=null,d.videoElement&&d.remoteStream&&(d.videoElement.srcObject=d.remoteStream,d.videoElement.play().catch(p=>{console.error(`Failed to play video for ${a}:`,p)}));else{const p=document.createElement("video");p.autoplay=!0,p.playsInline=!0,p.muted=!0,p.srcObject=d.remoteStream,p.play().catch(g=>{console.error(`Failed to play video for ${a}:`,g)}),d.videoElement=p}}setupAudioPlayback(a){const d=this.media.get(a);if(!(d!=null&&d.remoteStream))return;if(!d.audioElement){const E=document.createElement("audio");E.autoplay=!0,E.muted=!1,E.controls=!1,E.style.display="none",document.body.appendChild(E),d.audioElement=E}if(d.audioElement.srcObject=d.remoteStream,d.audioElement.play().catch(()=>{}),this.isSafari)return;const p=this.getAudioContext();if(!p)return;const g=p.createMediaStreamSource(d.remoteStream),R=p.createAnalyser();R.fftSize=256,R.smoothingTimeConstant=.8,g.connect(R),d.audioContext=p,d.source=g,d.analyser=R}cleanupAudio(a){var p;const d=this.media.get(a);d&&(d.audioElement&&(d.audioElement.pause(),d.audioElement.srcObject=null,(p=d.audioElement.parentNode)==null||p.removeChild(d.audioElement),d.audioElement=null),d.source&&(d.source.disconnect(),d.source=null),d.analyser&&(d.analyser.disconnect(),d.analyser=null),d.audioContext&&(d.audioContext.close().catch(()=>{}),d.audioContext=null))}updateSubscription(a){const d=this.media.get(a),p=this.subscriptionManager.getSubscription(a);!(d!=null&&d.remoteStream)||!p||(p.audio&&d.remoteStream.getAudioTracks().length>0?this.setupAudioPlayback(a):this.cleanupAudio(a),this.updateStreamStatus(a))}updateStreamStatus(a){const d=this.media.get(a),p=this.subscriptionManager.getSubscription(a)||{video:!0,audio:!0};if(!d)return;const{hasAudio:g,hasVideo:R}=Rm(d.remoteStream);let E=g,w=R;d.remoteControlState?Date.now()-d.remoteControlState.lastUpdated<5e3?(d.remoteControlState.hasAudio!==void 0&&(E=d.remoteControlState.hasAudio),d.remoteControlState.hasVideo!==void 0&&(w=d.remoteControlState.hasVideo)):d.remoteControlState=null:console.log(`No remote control state for ${a}, using actual stream state`);const m={hasAudio:p.audio&&E,hasVideo:p.video&&w,isActive:!!d.remoteStream&&(E||w),lastUpdated:Date.now()},S=d.streamStatus,b=S.hasAudio!==m.hasAudio||S.hasVideo!==m.hasVideo||S.isActive!==m.isActive;d.streamStatus=m,b&&this.callbacks.onStreamStatusChanged&&this.callbacks.onStreamStatusChanged(a,m)}getVolume(a){var d;return((d=this.media.get(a))==null?void 0:d.volume)??0}getAnalyser(a){var d;return((d=this.media.get(a))==null?void 0:d.analyser)??null}cleanup(a){const d=this.media.get(a);d&&(d.streamStatus.isActive=!1,d.streamStatus.lastUpdated=Date.now(),this.callbacks.onStreamStatusChanged&&this.callbacks.onStreamStatusChanged(a,d.streamStatus),d.videoElement&&(d.videoElement.pause(),d.videoElement.srcObject=null,d.videoElement.parentNode&&d.videoElement.parentNode.removeChild(d.videoElement),d.videoElement=null),this.cleanupAudio(a),d.remoteStream=null,d.volume=0,this.media.delete(a))}cleanupAll(){this.media.forEach((a,d)=>this.cleanup(d)),this.audioContext&&this.audioContext.state!=="closed"&&(this.audioContext.close().catch(()=>{}),this.audioContext=null)}forceRefreshVideoElement(a){const d=this.media.get(a);if(!(d!=null&&d.remoteStream)){console.warn(`No remote stream for participant ${a} to force refresh`);return}d.videoElement&&(d.videoElement.srcObject=null,d.videoElement=null),this.updateVideoElement(a)}setLocalStream(a,d){this.initializeParticipant(a);const p=this.media.get(a);p&&(p.remoteStream=d,this.updateVideoElement(a),this.updateStreamStatus(a))}setRemoteControlState(a,d,p){const g=this.media.get(a);g&&(g.remoteControlState||(g.remoteControlState={lastUpdated:Date.now()}),d==="audio"?g.remoteControlState.hasAudio=p:g.remoteControlState.hasVideo=p,g.remoteControlState.lastUpdated=Date.now(),console.log("Remote control state set:",g.remoteControlState),this.updateStreamStatus(a))}getAudioContext(){if(this.audioContext&&this.audioContext.state!=="closed")return this.audioContext;try{return this.audioContext=new AudioContext,this.audioContext.state==="suspended"&&this.audioContext.resume().catch(()=>{}),this.audioContext}catch{return null}}}class KT{constructor(a){yt(this,"participants",new Map);yt(this,"publishManager");yt(this,"selfId",null);this.publishManager=a}getSelfId(){return this.selfId}checkSelfParticipant(a,d){const p=new Set(this.publishManager.getStreams().map(R=>{var E;return(E=R.mediaStreamTrack)==null?void 0:E.id}).filter(R=>R));d.some(R=>R.mediaStreamTrack&&p.has(R.mediaStreamTrack.id))&&(this.selfId=a.id)}add(a){this.participants.set(a.id,a)}remove(a){this.participants.delete(a)}getParticipants(){return this.participants.values()}clear(){this.participants.clear()}}var l0={exports:{}};/*! For license information please see amazon-ivs-web-broadcast.js.LICENSE.txt */(function(r,a){(function(d,p){r.exports=p()})(self,()=>(()=>{var d={2505:(E,w,m)=>{E.exports=m(8015)},5592:(E,w,m)=>{var S=m(9516),b=m(7522),I=m(3948),_=m(9106),A=m(9615),C=m(2012),v=m(4202),O=m(4896),j=m(5845),D=m(8563),x=m(5656);E.exports=function(N){return new Promise(function($,H){var K,ce=N.data,Q=N.headers,Z=N.responseType;function Se(){N.cancelToken&&N.cancelToken.unsubscribe(K),N.signal&&N.signal.removeEventListener("abort",K)}S.isFormData(ce)&&S.isStandardBrowserEnv()&&delete Q["Content-Type"];var G=new XMLHttpRequest;if(N.auth){var ie=N.auth.username||"",de=N.auth.password?unescape(encodeURIComponent(N.auth.password)):"";Q.Authorization="Basic "+btoa(ie+":"+de)}var ne=A(N.baseURL,N.url);function J(){if(G){var se="getAllResponseHeaders"in G?C(G.getAllResponseHeaders()):null,he={data:Z&&Z!=="text"&&Z!=="json"?G.response:G.responseText,status:G.status,statusText:G.statusText,headers:se,config:N,request:G};b(function(Ie){$(Ie),Se()},function(Ie){H(Ie),Se()},he),G=null}}if(G.open(N.method.toUpperCase(),_(ne,N.params,N.paramsSerializer),!0),G.timeout=N.timeout,"onloadend"in G?G.onloadend=J:G.onreadystatechange=function(){G&&G.readyState===4&&(G.status!==0||G.responseURL&&G.responseURL.indexOf("file:")===0)&&setTimeout(J)},G.onabort=function(){G&&(H(new j("Request aborted",j.ECONNABORTED,N,G)),G=null)},G.onerror=function(){H(new j("Network Error",j.ERR_NETWORK,N,G,G)),G=null},G.ontimeout=function(){var se=N.timeout?"timeout of "+N.timeout+"ms exceeded":"timeout exceeded",he=N.transitional||O;N.timeoutErrorMessage&&(se=N.timeoutErrorMessage),H(new j(se,he.clarifyTimeoutError?j.ETIMEDOUT:j.ECONNABORTED,N,G)),G=null},S.isStandardBrowserEnv()){var W=(N.withCredentials||v(ne))&&N.xsrfCookieName?I.read(N.xsrfCookieName):void 0;W&&(Q[N.xsrfHeaderName]=W)}"setRequestHeader"in G&&S.forEach(Q,function(se,he){ce===void 0&&he.toLowerCase()==="content-type"?delete Q[he]:G.setRequestHeader(he,se)}),S.isUndefined(N.withCredentials)||(G.withCredentials=!!N.withCredentials),Z&&Z!=="json"&&(G.responseType=N.responseType),typeof N.onDownloadProgress=="function"&&G.addEventListener("progress",N.onDownloadProgress),typeof N.onUploadProgress=="function"&&G.upload&&G.upload.addEventListener("progress",N.onUploadProgress),(N.cancelToken||N.signal)&&(K=function(se){G&&(H(!se||se&&se.type?new D:se),G.abort(),G=null)},N.cancelToken&&N.cancelToken.subscribe(K),N.signal&&(N.signal.aborted?K():N.signal.addEventListener("abort",K))),ce||(ce=null);var X=x(ne);X&&["http","https","file"].indexOf(X)===-1?H(new j("Unsupported protocol "+X+":",j.ERR_BAD_REQUEST,N)):G.send(ce)})}},8015:(E,w,m)=>{var S=m(9516),b=m(9012),I=m(5155),_=m(5343),A=function C(v){var O=new I(v),j=b(I.prototype.request,O);return S.extend(j,I.prototype,O),S.extend(j,O),j.create=function(D){return C(_(v,D))},j}(m(7412));A.Axios=I,A.CanceledError=m(8563),A.CancelToken=m(3191),A.isCancel=m(3864),A.VERSION=m(9641).version,A.toFormData=m(6440),A.AxiosError=m(5845),A.Cancel=A.CanceledError,A.all=function(C){return Promise.all(C)},A.spread=m(7980),A.isAxiosError=m(5019),E.exports=A,E.exports.default=A},3191:(E,w,m)=>{var S=m(8563);function b(I){if(typeof I!="function")throw new TypeError("executor must be a function.");var _;this.promise=new Promise(function(C){_=C});var A=this;this.promise.then(function(C){if(A._listeners){var v,O=A._listeners.length;for(v=0;v<O;v++)A._listeners[v](C);A._listeners=null}}),this.promise.then=function(C){var v,O=new Promise(function(j){A.subscribe(j),v=j}).then(C);return O.cancel=function(){A.unsubscribe(v)},O},I(function(C){A.reason||(A.reason=new S(C),_(A.reason))})}b.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},b.prototype.subscribe=function(I){this.reason?I(this.reason):this._listeners?this._listeners.push(I):this._listeners=[I]},b.prototype.unsubscribe=function(I){if(this._listeners){var _=this._listeners.indexOf(I);_!==-1&&this._listeners.splice(_,1)}},b.source=function(){var I;return{token:new b(function(_){I=_}),cancel:I}},E.exports=b},8563:(E,w,m)=>{var S=m(5845);function b(I){S.call(this,I??"canceled",S.ERR_CANCELED),this.name="CanceledError"}m(9516).inherits(b,S,{__CANCEL__:!0}),E.exports=b},3864:E=>{E.exports=function(w){return!(!w||!w.__CANCEL__)}},5155:(E,w,m)=>{var S=m(9516),b=m(9106),I=m(3471),_=m(4490),A=m(5343),C=m(9615),v=m(4841),O=v.validators;function j(D){this.defaults=D,this.interceptors={request:new I,response:new I}}j.prototype.request=function(D,x){typeof D=="string"?(x=x||{}).url=D:x=D||{},(x=A(this.defaults,x)).method?x.method=x.method.toLowerCase():this.defaults.method?x.method=this.defaults.method.toLowerCase():x.method="get";var N=x.transitional;N!==void 0&&v.assertOptions(N,{silentJSONParsing:O.transitional(O.boolean),forcedJSONParsing:O.transitional(O.boolean),clarifyTimeoutError:O.transitional(O.boolean)},!1);var $=[],H=!0;this.interceptors.request.forEach(function(ie){typeof ie.runWhen=="function"&&ie.runWhen(x)===!1||(H=H&&ie.synchronous,$.unshift(ie.fulfilled,ie.rejected))});var K,ce=[];if(this.interceptors.response.forEach(function(ie){ce.push(ie.fulfilled,ie.rejected)}),!H){var Q=[_,void 0];for(Array.prototype.unshift.apply(Q,$),Q=Q.concat(ce),K=Promise.resolve(x);Q.length;)K=K.then(Q.shift(),Q.shift());return K}for(var Z=x;$.length;){var Se=$.shift(),G=$.shift();try{Z=Se(Z)}catch(ie){G(ie);break}}try{K=_(Z)}catch(ie){return Promise.reject(ie)}for(;ce.length;)K=K.then(ce.shift(),ce.shift());return K},j.prototype.getUri=function(D){D=A(this.defaults,D);var x=C(D.baseURL,D.url);return b(x,D.params,D.paramsSerializer)},S.forEach(["delete","get","head","options"],function(D){j.prototype[D]=function(x,N){return this.request(A(N||{},{method:D,url:x,data:(N||{}).data}))}}),S.forEach(["post","put","patch"],function(D){function x(N){return function($,H,K){return this.request(A(K||{},{method:D,headers:N?{"Content-Type":"multipart/form-data"}:{},url:$,data:H}))}}j.prototype[D]=x(),j.prototype[D+"Form"]=x(!0)}),E.exports=j},5845:(E,w,m)=>{var S=m(9516);function b(A,C,v,O,j){Error.call(this),this.message=A,this.name="AxiosError",C&&(this.code=C),v&&(this.config=v),O&&(this.request=O),j&&(this.response=j)}S.inherits(b,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var I=b.prototype,_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(A){_[A]={value:A}}),Object.defineProperties(b,_),Object.defineProperty(I,"isAxiosError",{value:!0}),b.from=function(A,C,v,O,j,D){var x=Object.create(I);return S.toFlatObject(A,x,function(N){return N!==Error.prototype}),b.call(x,A.message,C,v,O,j),x.name=A.name,D&&Object.assign(x,D),x},E.exports=b},3471:(E,w,m)=>{var S=m(9516);function b(){this.handlers=[]}b.prototype.use=function(I,_,A){return this.handlers.push({fulfilled:I,rejected:_,synchronous:!!A&&A.synchronous,runWhen:A?A.runWhen:null}),this.handlers.length-1},b.prototype.eject=function(I){this.handlers[I]&&(this.handlers[I]=null)},b.prototype.forEach=function(I){S.forEach(this.handlers,function(_){_!==null&&I(_)})},E.exports=b},9615:(E,w,m)=>{var S=m(9137),b=m(4680);E.exports=function(I,_){return I&&!S(_)?b(I,_):_}},4490:(E,w,m)=>{var S=m(9516),b=m(2881),I=m(3864),_=m(7412),A=m(8563);function C(v){if(v.cancelToken&&v.cancelToken.throwIfRequested(),v.signal&&v.signal.aborted)throw new A}E.exports=function(v){return C(v),v.headers=v.headers||{},v.data=b.call(v,v.data,v.headers,v.transformRequest),v.headers=S.merge(v.headers.common||{},v.headers[v.method]||{},v.headers),S.forEach(["delete","get","head","post","put","patch","common"],function(O){delete v.headers[O]}),(v.adapter||_.adapter)(v).then(function(O){return C(v),O.data=b.call(v,O.data,O.headers,v.transformResponse),O},function(O){return I(O)||(C(v),O&&O.response&&(O.response.data=b.call(v,O.response.data,O.response.headers,v.transformResponse))),Promise.reject(O)})}},5343:(E,w,m)=>{var S=m(9516);E.exports=function(b,I){I=I||{};var _={};function A(x,N){return S.isPlainObject(x)&&S.isPlainObject(N)?S.merge(x,N):S.isPlainObject(N)?S.merge({},N):S.isArray(N)?N.slice():N}function C(x){return S.isUndefined(I[x])?S.isUndefined(b[x])?void 0:A(void 0,b[x]):A(b[x],I[x])}function v(x){if(!S.isUndefined(I[x]))return A(void 0,I[x])}function O(x){return S.isUndefined(I[x])?S.isUndefined(b[x])?void 0:A(void 0,b[x]):A(void 0,I[x])}function j(x){return x in I?A(b[x],I[x]):x in b?A(void 0,b[x]):void 0}var D={url:v,method:v,data:v,baseURL:O,transformRequest:O,transformResponse:O,paramsSerializer:O,timeout:O,timeoutMessage:O,withCredentials:O,adapter:O,responseType:O,xsrfCookieName:O,xsrfHeaderName:O,onUploadProgress:O,onDownloadProgress:O,decompress:O,maxContentLength:O,maxBodyLength:O,beforeRedirect:O,transport:O,httpAgent:O,httpsAgent:O,cancelToken:O,socketPath:O,responseEncoding:O,validateStatus:j};return S.forEach(Object.keys(b).concat(Object.keys(I)),function(x){var N=D[x]||C,$=N(x);S.isUndefined($)&&N!==j||(_[x]=$)}),_}},7522:(E,w,m)=>{var S=m(5845);E.exports=function(b,I,_){var A=_.config.validateStatus;_.status&&A&&!A(_.status)?I(new S("Request failed with status code "+_.status,[S.ERR_BAD_REQUEST,S.ERR_BAD_RESPONSE][Math.floor(_.status/100)-4],_.config,_.request,_)):b(_)}},2881:(E,w,m)=>{var S=m(9516),b=m(7412);E.exports=function(I,_,A){var C=this||b;return S.forEach(A,function(v){I=v.call(C,I,_)}),I}},7412:(E,w,m)=>{var S=m(9516),b=m(7018),I=m(5845),_=m(4896),A=m(6440),C={"Content-Type":"application/x-www-form-urlencoded"};function v(D,x){!S.isUndefined(D)&&S.isUndefined(D["Content-Type"])&&(D["Content-Type"]=x)}var O,j={transitional:_,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(O=m(5592)),O),transformRequest:[function(D,x){if(b(x,"Accept"),b(x,"Content-Type"),S.isFormData(D)||S.isArrayBuffer(D)||S.isBuffer(D)||S.isStream(D)||S.isFile(D)||S.isBlob(D))return D;if(S.isArrayBufferView(D))return D.buffer;if(S.isURLSearchParams(D))return v(x,"application/x-www-form-urlencoded;charset=utf-8"),D.toString();var N,$=S.isObject(D),H=x&&x["Content-Type"];if((N=S.isFileList(D))||$&&H==="multipart/form-data"){var K=this.env&&this.env.FormData;return A(N?{"files[]":D}:D,K&&new K)}return $||H==="application/json"?(v(x,"application/json"),function(ce,Q,Z){if(S.isString(ce))try{return(Q||JSON.parse)(ce),S.trim(ce)}catch(Se){if(Se.name!=="SyntaxError")throw Se}return(0,JSON.stringify)(ce)}(D)):D}],transformResponse:[function(D){var x=this.transitional||j.transitional,N=x&&x.silentJSONParsing,$=x&&x.forcedJSONParsing,H=!N&&this.responseType==="json";if(H||$&&S.isString(D)&&D.length)try{return JSON.parse(D)}catch(K){if(H)throw K.name==="SyntaxError"?I.from(K,I.ERR_BAD_RESPONSE,this,null,this.response):K}return D}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:m(1534)},validateStatus:function(D){return D>=200&&D<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};S.forEach(["delete","get","head"],function(D){j.headers[D]={}}),S.forEach(["post","put","patch"],function(D){j.headers[D]=S.merge(C)}),E.exports=j},4896:E=>{E.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},9641:E=>{E.exports={version:"0.27.2"}},9012:E=>{E.exports=function(w,m){return function(){for(var S=new Array(arguments.length),b=0;b<S.length;b++)S[b]=arguments[b];return w.apply(m,S)}}},9106:(E,w,m)=>{var S=m(9516);function b(I){return encodeURIComponent(I).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}E.exports=function(I,_,A){if(!_)return I;var C;if(A)C=A(_);else if(S.isURLSearchParams(_))C=_.toString();else{var v=[];S.forEach(_,function(j,D){j!=null&&(S.isArray(j)?D+="[]":j=[j],S.forEach(j,function(x){S.isDate(x)?x=x.toISOString():S.isObject(x)&&(x=JSON.stringify(x)),v.push(b(D)+"="+b(x))}))}),C=v.join("&")}if(C){var O=I.indexOf("#");O!==-1&&(I=I.slice(0,O)),I+=(I.indexOf("?")===-1?"?":"&")+C}return I}},4680:E=>{E.exports=function(w,m){return m?w.replace(/\/+$/,"")+"/"+m.replace(/^\/+/,""):w}},3948:(E,w,m)=>{var S=m(9516);E.exports=S.isStandardBrowserEnv()?{write:function(b,I,_,A,C,v){var O=[];O.push(b+"="+encodeURIComponent(I)),S.isNumber(_)&&O.push("expires="+new Date(_).toGMTString()),S.isString(A)&&O.push("path="+A),S.isString(C)&&O.push("domain="+C),v===!0&&O.push("secure"),document.cookie=O.join("; ")},read:function(b){var I=document.cookie.match(new RegExp("(^|;\\s*)("+b+")=([^;]*)"));return I?decodeURIComponent(I[3]):null},remove:function(b){this.write(b,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},9137:E=>{E.exports=function(w){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(w)}},5019:(E,w,m)=>{var S=m(9516);E.exports=function(b){return S.isObject(b)&&b.isAxiosError===!0}},4202:(E,w,m)=>{var S=m(9516);E.exports=S.isStandardBrowserEnv()?function(){var b,I=/(msie|trident)/i.test(navigator.userAgent),_=document.createElement("a");function A(C){var v=C;return I&&(_.setAttribute("href",v),v=_.href),_.setAttribute("href",v),{href:_.href,protocol:_.protocol?_.protocol.replace(/:$/,""):"",host:_.host,search:_.search?_.search.replace(/^\?/,""):"",hash:_.hash?_.hash.replace(/^#/,""):"",hostname:_.hostname,port:_.port,pathname:_.pathname.charAt(0)==="/"?_.pathname:"/"+_.pathname}}return b=A(window.location.href),function(C){var v=S.isString(C)?A(C):C;return v.protocol===b.protocol&&v.host===b.host}}():function(){return!0}},7018:(E,w,m)=>{var S=m(9516);E.exports=function(b,I){S.forEach(b,function(_,A){A!==I&&A.toUpperCase()===I.toUpperCase()&&(b[I]=_,delete b[A])})}},1534:E=>{E.exports=null},2012:(E,w,m)=>{var S=m(9516),b=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];E.exports=function(I){var _,A,C,v={};return I&&S.forEach(I.split(`
`),function(O){if(C=O.indexOf(":"),_=S.trim(O.substr(0,C)).toLowerCase(),A=S.trim(O.substr(C+1)),_){if(v[_]&&b.indexOf(_)>=0)return;v[_]=_==="set-cookie"?(v[_]?v[_]:[]).concat([A]):v[_]?v[_]+", "+A:A}}),v}},5656:E=>{E.exports=function(w){var m=/^([-+\w]{1,25})(:?\/\/|:)/.exec(w);return m&&m[1]||""}},7980:E=>{E.exports=function(w){return function(m){return w.apply(null,m)}}},6440:(E,w,m)=>{var S=m(9516);E.exports=function(b,I){I=I||new FormData;var _=[];function A(C){return C===null?"":S.isDate(C)?C.toISOString():S.isArrayBuffer(C)||S.isTypedArray(C)?typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}return function C(v,O){if(S.isPlainObject(v)||S.isArray(v)){if(_.indexOf(v)!==-1)throw Error("Circular reference detected in "+O);_.push(v),S.forEach(v,function(j,D){if(!S.isUndefined(j)){var x,N=O?O+"."+D:D;if(j&&!O&&typeof j=="object"){if(S.endsWith(D,"{}"))j=JSON.stringify(j);else if(S.endsWith(D,"[]")&&(x=S.toArray(j)))return void x.forEach(function($){!S.isUndefined($)&&I.append(N,A($))})}C(j,N)}}),_.pop()}else I.append(O,A(v))}(b),I}},4841:(E,w,m)=>{var S=m(9641).version,b=m(5845),I={};["object","boolean","number","function","string","symbol"].forEach(function(A,C){I[A]=function(v){return typeof v===A||"a"+(C<1?"n ":" ")+A}});var _={};I.transitional=function(A,C,v){function O(j,D){return"[Axios v"+S+"] Transitional option '"+j+"'"+D+(v?". "+v:"")}return function(j,D,x){if(A===!1)throw new b(O(D," has been removed"+(C?" in "+C:"")),b.ERR_DEPRECATED);return C&&!_[D]&&(_[D]=!0,console.warn(O(D," has been deprecated since v"+C+" and will be removed in the near future"))),!A||A(j,D,x)}},E.exports={assertOptions:function(A,C,v){if(typeof A!="object")throw new b("options must be an object",b.ERR_BAD_OPTION_VALUE);for(var O=Object.keys(A),j=O.length;j-- >0;){var D=O[j],x=C[D];if(x){var N=A[D],$=N===void 0||x(N,D,A);if($!==!0)throw new b("option "+D+" must be "+$,b.ERR_BAD_OPTION_VALUE)}else if(v!==!0)throw new b("Unknown option "+D,b.ERR_BAD_OPTION)}},validators:I}},9516:(E,w,m)=>{var S,b=m(9012),I=Object.prototype.toString,_=(S=Object.create(null),function(G){var ie=I.call(G);return S[ie]||(S[ie]=ie.slice(8,-1).toLowerCase())});function A(G){return G=G.toLowerCase(),function(ie){return _(ie)===G}}function C(G){return Array.isArray(G)}function v(G){return G===void 0}var O=A("ArrayBuffer");function j(G){return G!==null&&typeof G=="object"}function D(G){if(_(G)!=="object")return!1;var ie=Object.getPrototypeOf(G);return ie===null||ie===Object.prototype}var x=A("Date"),N=A("File"),$=A("Blob"),H=A("FileList");function K(G){return I.call(G)==="[object Function]"}var ce=A("URLSearchParams");function Q(G,ie){if(G!=null)if(typeof G!="object"&&(G=[G]),C(G))for(var de=0,ne=G.length;de<ne;de++)ie.call(null,G[de],de,G);else for(var J in G)Object.prototype.hasOwnProperty.call(G,J)&&ie.call(null,G[J],J,G)}var Z,Se=(Z=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(G){return Z&&G instanceof Z});E.exports={isArray:C,isArrayBuffer:O,isBuffer:function(G){return G!==null&&!v(G)&&G.constructor!==null&&!v(G.constructor)&&typeof G.constructor.isBuffer=="function"&&G.constructor.isBuffer(G)},isFormData:function(G){var ie="[object FormData]";return G&&(typeof FormData=="function"&&G instanceof FormData||I.call(G)===ie||K(G.toString)&&G.toString()===ie)},isArrayBufferView:function(G){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(G):G&&G.buffer&&O(G.buffer)},isString:function(G){return typeof G=="string"},isNumber:function(G){return typeof G=="number"},isObject:j,isPlainObject:D,isUndefined:v,isDate:x,isFile:N,isBlob:$,isFunction:K,isStream:function(G){return j(G)&&K(G.pipe)},isURLSearchParams:ce,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:Q,merge:function G(){var ie={};function de(W,X){D(ie[X])&&D(W)?ie[X]=G(ie[X],W):D(W)?ie[X]=G({},W):C(W)?ie[X]=W.slice():ie[X]=W}for(var ne=0,J=arguments.length;ne<J;ne++)Q(arguments[ne],de);return ie},extend:function(G,ie,de){return Q(ie,function(ne,J){G[J]=de&&typeof ne=="function"?b(ne,de):ne}),G},trim:function(G){return G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")},stripBOM:function(G){return G.charCodeAt(0)===65279&&(G=G.slice(1)),G},inherits:function(G,ie,de,ne){G.prototype=Object.create(ie.prototype,ne),G.prototype.constructor=G,de&&Object.assign(G.prototype,de)},toFlatObject:function(G,ie,de){var ne,J,W,X={};ie=ie||{};do{for(J=(ne=Object.getOwnPropertyNames(G)).length;J-- >0;)X[W=ne[J]]||(ie[W]=G[W],X[W]=!0);G=Object.getPrototypeOf(G)}while(G&&(!de||de(G,ie))&&G!==Object.prototype);return ie},kindOf:_,kindOfTest:A,endsWith:function(G,ie,de){G=String(G),(de===void 0||de>G.length)&&(de=G.length),de-=ie.length;var ne=G.indexOf(ie,de);return ne!==-1&&ne===de},toArray:function(G){if(!G)return null;var ie=G.length;if(v(ie))return null;for(var de=new Array(ie);ie-- >0;)de[ie]=G[ie];return de},isTypedArray:Se,isFileList:H}},6880:function(E){E.exports=function(w){var m={};function S(b){if(m[b])return m[b].exports;var I=m[b]={i:b,l:!1,exports:{}};return w[b].call(I.exports,I,I.exports,S),I.l=!0,I.exports}return S.m=w,S.c=m,S.d=function(b,I,_){S.o(b,I)||Object.defineProperty(b,I,{enumerable:!0,get:_})},S.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},S.t=function(b,I){if(1&I&&(b=S(b)),8&I||4&I&&typeof b=="object"&&b&&b.__esModule)return b;var _=Object.create(null);if(S.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:b}),2&I&&typeof b!="string")for(var A in b)S.d(_,A,(function(C){return b[C]}).bind(null,A));return _},S.n=function(b){var I=b&&b.__esModule?function(){return b.default}:function(){return b};return S.d(I,"a",I),I},S.o=function(b,I){return Object.prototype.hasOwnProperty.call(b,I)},S.p="",S(S.s=90)}({17:function(w,m,S){m.__esModule=!0,m.default=void 0;var b=S(18),I=function(){function _(){}return _.getFirstMatch=function(A,C){var v=C.match(A);return v&&v.length>0&&v[1]||""},_.getSecondMatch=function(A,C){var v=C.match(A);return v&&v.length>1&&v[2]||""},_.matchAndReturnConst=function(A,C,v){if(A.test(C))return v},_.getWindowsVersionName=function(A){switch(A){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},_.getMacOSVersionName=function(A){var C=A.split(".").splice(0,2).map(function(v){return parseInt(v,10)||0});if(C.push(0),C[0]===10)switch(C[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},_.getAndroidVersionName=function(A){var C=A.split(".").splice(0,2).map(function(v){return parseInt(v,10)||0});if(C.push(0),!(C[0]===1&&C[1]<5))return C[0]===1&&C[1]<6?"Cupcake":C[0]===1&&C[1]>=6?"Donut":C[0]===2&&C[1]<2?"Eclair":C[0]===2&&C[1]===2?"Froyo":C[0]===2&&C[1]>2?"Gingerbread":C[0]===3?"Honeycomb":C[0]===4&&C[1]<1?"Ice Cream Sandwich":C[0]===4&&C[1]<4?"Jelly Bean":C[0]===4&&C[1]>=4?"KitKat":C[0]===5?"Lollipop":C[0]===6?"Marshmallow":C[0]===7?"Nougat":C[0]===8?"Oreo":C[0]===9?"Pie":void 0},_.getVersionPrecision=function(A){return A.split(".").length},_.compareVersions=function(A,C,v){v===void 0&&(v=!1);var O=_.getVersionPrecision(A),j=_.getVersionPrecision(C),D=Math.max(O,j),x=0,N=_.map([A,C],function($){var H=D-_.getVersionPrecision($),K=$+new Array(H+1).join(".0");return _.map(K.split("."),function(ce){return new Array(20-ce.length).join("0")+ce}).reverse()});for(v&&(x=D-Math.min(O,j)),D-=1;D>=x;){if(N[0][D]>N[1][D])return 1;if(N[0][D]===N[1][D]){if(D===x)return 0;D-=1}else if(N[0][D]<N[1][D])return-1}},_.map=function(A,C){var v,O=[];if(Array.prototype.map)return Array.prototype.map.call(A,C);for(v=0;v<A.length;v+=1)O.push(C(A[v]));return O},_.find=function(A,C){var v,O;if(Array.prototype.find)return Array.prototype.find.call(A,C);for(v=0,O=A.length;v<O;v+=1){var j=A[v];if(C(j,v))return j}},_.assign=function(A){for(var C,v,O=A,j=arguments.length,D=new Array(j>1?j-1:0),x=1;x<j;x++)D[x-1]=arguments[x];if(Object.assign)return Object.assign.apply(Object,[A].concat(D));var N=function(){var $=D[C];typeof $=="object"&&$!==null&&Object.keys($).forEach(function(H){O[H]=$[H]})};for(C=0,v=D.length;C<v;C+=1)N();return A},_.getBrowserAlias=function(A){return b.BROWSER_ALIASES_MAP[A]},_.getBrowserTypeByAlias=function(A){return b.BROWSER_MAP[A]||""},_}();m.default=I,w.exports=m.default},18:function(w,m,S){m.__esModule=!0,m.ENGINE_MAP=m.OS_MAP=m.PLATFORMS_MAP=m.BROWSER_MAP=m.BROWSER_ALIASES_MAP=void 0,m.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},m.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},m.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},m.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},m.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(w,m,S){m.__esModule=!0,m.default=void 0;var b,I=(b=S(91))&&b.__esModule?b:{default:b},_=S(18);function A(v,O){for(var j=0;j<O.length;j++){var D=O[j];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(v,D.key,D)}}var C=function(){function v(){}var O,j,D;return v.getParser=function(x,N){if(N===void 0&&(N=!1),typeof x!="string")throw new Error("UserAgent should be a string");return new I.default(x,N)},v.parse=function(x){return new I.default(x).getResult()},O=v,D=[{key:"BROWSER_MAP",get:function(){return _.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return _.ENGINE_MAP}},{key:"OS_MAP",get:function(){return _.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return _.PLATFORMS_MAP}}],(j=null)&&A(O.prototype,j),D&&A(O,D),v}();m.default=C,w.exports=m.default},91:function(w,m,S){m.__esModule=!0,m.default=void 0;var b=v(S(92)),I=v(S(93)),_=v(S(94)),A=v(S(95)),C=v(S(17));function v(j){return j&&j.__esModule?j:{default:j}}var O=function(){function j(x,N){if(N===void 0&&(N=!1),x==null||x==="")throw new Error("UserAgent parameter can't be empty");this._ua=x,this.parsedResult={},N!==!0&&this.parse()}var D=j.prototype;return D.getUA=function(){return this._ua},D.test=function(x){return x.test(this._ua)},D.parseBrowser=function(){var x=this;this.parsedResult.browser={};var N=C.default.find(b.default,function($){if(typeof $.test=="function")return $.test(x);if($.test instanceof Array)return $.test.some(function(H){return x.test(H)});throw new Error("Browser's test function is not valid")});return N&&(this.parsedResult.browser=N.describe(this.getUA())),this.parsedResult.browser},D.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},D.getBrowserName=function(x){return x?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},D.getBrowserVersion=function(){return this.getBrowser().version},D.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},D.parseOS=function(){var x=this;this.parsedResult.os={};var N=C.default.find(I.default,function($){if(typeof $.test=="function")return $.test(x);if($.test instanceof Array)return $.test.some(function(H){return x.test(H)});throw new Error("Browser's test function is not valid")});return N&&(this.parsedResult.os=N.describe(this.getUA())),this.parsedResult.os},D.getOSName=function(x){var N=this.getOS().name;return x?String(N).toLowerCase()||"":N||""},D.getOSVersion=function(){return this.getOS().version},D.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},D.getPlatformType=function(x){x===void 0&&(x=!1);var N=this.getPlatform().type;return x?String(N).toLowerCase()||"":N||""},D.parsePlatform=function(){var x=this;this.parsedResult.platform={};var N=C.default.find(_.default,function($){if(typeof $.test=="function")return $.test(x);if($.test instanceof Array)return $.test.some(function(H){return x.test(H)});throw new Error("Browser's test function is not valid")});return N&&(this.parsedResult.platform=N.describe(this.getUA())),this.parsedResult.platform},D.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},D.getEngineName=function(x){return x?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},D.parseEngine=function(){var x=this;this.parsedResult.engine={};var N=C.default.find(A.default,function($){if(typeof $.test=="function")return $.test(x);if($.test instanceof Array)return $.test.some(function(H){return x.test(H)});throw new Error("Browser's test function is not valid")});return N&&(this.parsedResult.engine=N.describe(this.getUA())),this.parsedResult.engine},D.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},D.getResult=function(){return C.default.assign({},this.parsedResult)},D.satisfies=function(x){var N=this,$={},H=0,K={},ce=0;if(Object.keys(x).forEach(function(J){var W=x[J];typeof W=="string"?(K[J]=W,ce+=1):typeof W=="object"&&($[J]=W,H+=1)}),H>0){var Q=Object.keys($),Z=C.default.find(Q,function(J){return N.isOS(J)});if(Z){var Se=this.satisfies($[Z]);if(Se!==void 0)return Se}var G=C.default.find(Q,function(J){return N.isPlatform(J)});if(G){var ie=this.satisfies($[G]);if(ie!==void 0)return ie}}if(ce>0){var de=Object.keys(K),ne=C.default.find(de,function(J){return N.isBrowser(J,!0)});if(ne!==void 0)return this.compareVersion(K[ne])}},D.isBrowser=function(x,N){N===void 0&&(N=!1);var $=this.getBrowserName().toLowerCase(),H=x.toLowerCase(),K=C.default.getBrowserTypeByAlias(H);return N&&K&&(H=K.toLowerCase()),H===$},D.compareVersion=function(x){var N=[0],$=x,H=!1,K=this.getBrowserVersion();if(typeof K=="string")return x[0]===">"||x[0]==="<"?($=x.substr(1),x[1]==="="?(H=!0,$=x.substr(2)):N=[],x[0]===">"?N.push(1):N.push(-1)):x[0]==="="?$=x.substr(1):x[0]==="~"&&(H=!0,$=x.substr(1)),N.indexOf(C.default.compareVersions(K,$,H))>-1},D.isOS=function(x){return this.getOSName(!0)===String(x).toLowerCase()},D.isPlatform=function(x){return this.getPlatformType(!0)===String(x).toLowerCase()},D.isEngine=function(x){return this.getEngineName(!0)===String(x).toLowerCase()},D.is=function(x,N){return N===void 0&&(N=!1),this.isBrowser(x,N)||this.isOS(x)||this.isPlatform(x)},D.some=function(x){var N=this;return x===void 0&&(x=[]),x.some(function($){return N.is($)})},j}();m.default=O,w.exports=m.default},92:function(w,m,S){m.__esModule=!0,m.default=void 0;var b,I=(b=S(17))&&b.__esModule?b:{default:b},_=/version\/(\d+(\.?_?\d+)+)/i,A=[{test:[/googlebot/i],describe:function(C){var v={name:"Googlebot"},O=I.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/opera/i],describe:function(C){var v={name:"Opera"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/opr\/|opios/i],describe:function(C){var v={name:"Opera"},O=I.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/SamsungBrowser/i],describe:function(C){var v={name:"Samsung Internet for Android"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/Whale/i],describe:function(C){var v={name:"NAVER Whale Browser"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/MZBrowser/i],describe:function(C){var v={name:"MZ Browser"},O=I.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/focus/i],describe:function(C){var v={name:"Focus"},O=I.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/swing/i],describe:function(C){var v={name:"Swing"},O=I.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/coast/i],describe:function(C){var v={name:"Opera Coast"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(C){var v={name:"Opera Touch"},O=I.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/yabrowser/i],describe:function(C){var v={name:"Yandex Browser"},O=I.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/ucbrowser/i],describe:function(C){var v={name:"UC Browser"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/Maxthon|mxios/i],describe:function(C){var v={name:"Maxthon"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/epiphany/i],describe:function(C){var v={name:"Epiphany"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/puffin/i],describe:function(C){var v={name:"Puffin"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/sleipnir/i],describe:function(C){var v={name:"Sleipnir"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/k-meleon/i],describe:function(C){var v={name:"K-Meleon"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/micromessenger/i],describe:function(C){var v={name:"WeChat"},O=I.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/qqbrowser/i],describe:function(C){var v={name:/qqbrowserlite/i.test(C)?"QQ Browser Lite":"QQ Browser"},O=I.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/msie|trident/i],describe:function(C){var v={name:"Internet Explorer"},O=I.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/\sedg\//i],describe:function(C){var v={name:"Microsoft Edge"},O=I.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/edg([ea]|ios)/i],describe:function(C){var v={name:"Microsoft Edge"},O=I.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/vivaldi/i],describe:function(C){var v={name:"Vivaldi"},O=I.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/seamonkey/i],describe:function(C){var v={name:"SeaMonkey"},O=I.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/sailfish/i],describe:function(C){var v={name:"Sailfish"},O=I.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,C);return O&&(v.version=O),v}},{test:[/silk/i],describe:function(C){var v={name:"Amazon Silk"},O=I.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/phantom/i],describe:function(C){var v={name:"PhantomJS"},O=I.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/slimerjs/i],describe:function(C){var v={name:"SlimerJS"},O=I.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(C){var v={name:"BlackBerry"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/(web|hpw)[o0]s/i],describe:function(C){var v={name:"WebOS Browser"},O=I.default.getFirstMatch(_,C)||I.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/bada/i],describe:function(C){var v={name:"Bada"},O=I.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/tizen/i],describe:function(C){var v={name:"Tizen"},O=I.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/qupzilla/i],describe:function(C){var v={name:"QupZilla"},O=I.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/firefox|iceweasel|fxios/i],describe:function(C){var v={name:"Firefox"},O=I.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/electron/i],describe:function(C){var v={name:"Electron"},O=I.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/MiuiBrowser/i],describe:function(C){var v={name:"Miui"},O=I.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/chromium/i],describe:function(C){var v={name:"Chromium"},O=I.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,C)||I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/chrome|crios|crmo/i],describe:function(C){var v={name:"Chrome"},O=I.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/GSA/i],describe:function(C){var v={name:"Google Search"},O=I.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:function(C){var v=!C.test(/like android/i),O=C.test(/android/i);return v&&O},describe:function(C){var v={name:"Android Browser"},O=I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/playstation 4/i],describe:function(C){var v={name:"PlayStation 4"},O=I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/safari|applewebkit/i],describe:function(C){var v={name:"Safari"},O=I.default.getFirstMatch(_,C);return O&&(v.version=O),v}},{test:[/.*/i],describe:function(C){var v=C.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:I.default.getFirstMatch(v,C),version:I.default.getSecondMatch(v,C)}}}];m.default=A,w.exports=m.default},93:function(w,m,S){m.__esModule=!0,m.default=void 0;var b,I=(b=S(17))&&b.__esModule?b:{default:b},_=S(18),A=[{test:[/Roku\/DVP/],describe:function(C){var v=I.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,C);return{name:_.OS_MAP.Roku,version:v}}},{test:[/windows phone/i],describe:function(C){var v=I.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,C);return{name:_.OS_MAP.WindowsPhone,version:v}}},{test:[/windows /i],describe:function(C){var v=I.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,C),O=I.default.getWindowsVersionName(v);return{name:_.OS_MAP.Windows,version:v,versionName:O}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(C){var v={name:_.OS_MAP.iOS},O=I.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,C);return O&&(v.version=O),v}},{test:[/macintosh/i],describe:function(C){var v=I.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,C).replace(/[_\s]/g,"."),O=I.default.getMacOSVersionName(v),j={name:_.OS_MAP.MacOS,version:v};return O&&(j.versionName=O),j}},{test:[/(ipod|iphone|ipad)/i],describe:function(C){var v=I.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,C).replace(/[_\s]/g,".");return{name:_.OS_MAP.iOS,version:v}}},{test:function(C){var v=!C.test(/like android/i),O=C.test(/android/i);return v&&O},describe:function(C){var v=I.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,C),O=I.default.getAndroidVersionName(v),j={name:_.OS_MAP.Android,version:v};return O&&(j.versionName=O),j}},{test:[/(web|hpw)[o0]s/i],describe:function(C){var v=I.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,C),O={name:_.OS_MAP.WebOS};return v&&v.length&&(O.version=v),O}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(C){var v=I.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,C)||I.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,C)||I.default.getFirstMatch(/\bbb(\d+)/i,C);return{name:_.OS_MAP.BlackBerry,version:v}}},{test:[/bada/i],describe:function(C){var v=I.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,C);return{name:_.OS_MAP.Bada,version:v}}},{test:[/tizen/i],describe:function(C){var v=I.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,C);return{name:_.OS_MAP.Tizen,version:v}}},{test:[/linux/i],describe:function(){return{name:_.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:_.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(C){var v=I.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,C);return{name:_.OS_MAP.PlayStation4,version:v}}}];m.default=A,w.exports=m.default},94:function(w,m,S){m.__esModule=!0,m.default=void 0;var b,I=(b=S(17))&&b.__esModule?b:{default:b},_=S(18),A=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(C){var v=I.default.getFirstMatch(/(can-l01)/i,C)&&"Nova",O={type:_.PLATFORMS_MAP.mobile,vendor:"Huawei"};return v&&(O.model=v),O}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet}}},{test:function(C){var v=C.test(/ipod|iphone/i),O=C.test(/like (ipod|iphone)/i);return v&&!O},describe:function(C){var v=I.default.getFirstMatch(/(ipod|iphone)/i,C);return{type:_.PLATFORMS_MAP.mobile,vendor:"Apple",model:v}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(C){return C.getBrowserName(!0)==="blackberry"},describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(C){return C.getBrowserName(!0)==="bada"},describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(C){return C.getBrowserName()==="windows phone"},describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(C){var v=Number(String(C.getOSVersion()).split(".")[0]);return C.getOSName(!0)==="android"&&v>=3},describe:function(){return{type:_.PLATFORMS_MAP.tablet}}},{test:function(C){return C.getOSName(!0)==="android"},describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(C){return C.getOSName(!0)==="macos"},describe:function(){return{type:_.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(C){return C.getOSName(!0)==="windows"},describe:function(){return{type:_.PLATFORMS_MAP.desktop}}},{test:function(C){return C.getOSName(!0)==="linux"},describe:function(){return{type:_.PLATFORMS_MAP.desktop}}},{test:function(C){return C.getOSName(!0)==="playstation 4"},describe:function(){return{type:_.PLATFORMS_MAP.tv}}},{test:function(C){return C.getOSName(!0)==="roku"},describe:function(){return{type:_.PLATFORMS_MAP.tv}}}];m.default=A,w.exports=m.default},95:function(w,m,S){m.__esModule=!0,m.default=void 0;var b,I=(b=S(17))&&b.__esModule?b:{default:b},_=S(18),A=[{test:function(C){return C.getBrowserName(!0)==="microsoft edge"},describe:function(C){if(/\sedg\//i.test(C))return{name:_.ENGINE_MAP.Blink};var v=I.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,C);return{name:_.ENGINE_MAP.EdgeHTML,version:v}}},{test:[/trident/i],describe:function(C){var v={name:_.ENGINE_MAP.Trident},O=I.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:function(C){return C.test(/presto/i)},describe:function(C){var v={name:_.ENGINE_MAP.Presto},O=I.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:function(C){var v=C.test(/gecko/i),O=C.test(/like gecko/i);return v&&!O},describe:function(C){var v={name:_.ENGINE_MAP.Gecko},O=I.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:_.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(C){var v={name:_.ENGINE_MAP.WebKit},O=I.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,C);return O&&(v.version=O),v}}];m.default=A,w.exports=m.default}})},228:E=>{var w=Object.prototype.hasOwnProperty,m="~";function S(){}function b(C,v,O){this.fn=C,this.context=v,this.once=O||!1}function I(C,v,O,j,D){if(typeof O!="function")throw new TypeError("The listener must be a function");var x=new b(O,j||C,D),N=m?m+v:v;return C._events[N]?C._events[N].fn?C._events[N]=[C._events[N],x]:C._events[N].push(x):(C._events[N]=x,C._eventsCount++),C}function _(C,v){--C._eventsCount==0?C._events=new S:delete C._events[v]}function A(){this._events=new S,this._eventsCount=0}Object.create&&(S.prototype=Object.create(null),new S().__proto__||(m=!1)),A.prototype.eventNames=function(){var C,v,O=[];if(this._eventsCount===0)return O;for(v in C=this._events)w.call(C,v)&&O.push(m?v.slice(1):v);return Object.getOwnPropertySymbols?O.concat(Object.getOwnPropertySymbols(C)):O},A.prototype.listeners=function(C){var v=m?m+C:C,O=this._events[v];if(!O)return[];if(O.fn)return[O.fn];for(var j=0,D=O.length,x=new Array(D);j<D;j++)x[j]=O[j].fn;return x},A.prototype.listenerCount=function(C){var v=m?m+C:C,O=this._events[v];return O?O.fn?1:O.length:0},A.prototype.emit=function(C,v,O,j,D,x){var N=m?m+C:C;if(!this._events[N])return!1;var $,H,K=this._events[N],ce=arguments.length;if(K.fn){switch(K.once&&this.removeListener(C,K.fn,void 0,!0),ce){case 1:return K.fn.call(K.context),!0;case 2:return K.fn.call(K.context,v),!0;case 3:return K.fn.call(K.context,v,O),!0;case 4:return K.fn.call(K.context,v,O,j),!0;case 5:return K.fn.call(K.context,v,O,j,D),!0;case 6:return K.fn.call(K.context,v,O,j,D,x),!0}for(H=1,$=new Array(ce-1);H<ce;H++)$[H-1]=arguments[H];K.fn.apply(K.context,$)}else{var Q,Z=K.length;for(H=0;H<Z;H++)switch(K[H].once&&this.removeListener(C,K[H].fn,void 0,!0),ce){case 1:K[H].fn.call(K[H].context);break;case 2:K[H].fn.call(K[H].context,v);break;case 3:K[H].fn.call(K[H].context,v,O);break;case 4:K[H].fn.call(K[H].context,v,O,j);break;default:if(!$)for(Q=1,$=new Array(ce-1);Q<ce;Q++)$[Q-1]=arguments[Q];K[H].fn.apply(K[H].context,$)}}return!0},A.prototype.on=function(C,v,O){return I(this,C,v,O,!1)},A.prototype.once=function(C,v,O){return I(this,C,v,O,!0)},A.prototype.removeListener=function(C,v,O,j){var D=m?m+C:C;if(!this._events[D])return this;if(!v)return _(this,D),this;var x=this._events[D];if(x.fn)x.fn!==v||j&&!x.once||O&&x.context!==O||_(this,D);else{for(var N=0,$=[],H=x.length;N<H;N++)(x[N].fn!==v||j&&!x[N].once||O&&x[N].context!==O)&&$.push(x[N]);$.length?this._events[D]=$.length===1?$[0]:$:_(this,D)}return this},A.prototype.removeAllListeners=function(C){var v;return C?(v=m?m+C:C,this._events[v]&&_(this,v)):(this._events=new S,this._eventsCount=0),this},A.prototype.off=A.prototype.removeListener,A.prototype.addListener=A.prototype.on,A.prefixed=m,A.EventEmitter=A,E.exports=A},8954:function(E){var w;w=()=>(()=>{var m={228:I=>{var _=Object.prototype.hasOwnProperty,A="~";function C(){}function v(x,N,$){this.fn=x,this.context=N,this.once=$||!1}function O(x,N,$,H,K){if(typeof $!="function")throw new TypeError("The listener must be a function");var ce=new v($,H||x,K),Q=A?A+N:N;return x._events[Q]?x._events[Q].fn?x._events[Q]=[x._events[Q],ce]:x._events[Q].push(ce):(x._events[Q]=ce,x._eventsCount++),x}function j(x,N){--x._eventsCount==0?x._events=new C:delete x._events[N]}function D(){this._events=new C,this._eventsCount=0}Object.create&&(C.prototype=Object.create(null),new C().__proto__||(A=!1)),D.prototype.eventNames=function(){var x,N,$=[];if(this._eventsCount===0)return $;for(N in x=this._events)_.call(x,N)&&$.push(A?N.slice(1):N);return Object.getOwnPropertySymbols?$.concat(Object.getOwnPropertySymbols(x)):$},D.prototype.listeners=function(x){var N=A?A+x:x,$=this._events[N];if(!$)return[];if($.fn)return[$.fn];for(var H=0,K=$.length,ce=new Array(K);H<K;H++)ce[H]=$[H].fn;return ce},D.prototype.listenerCount=function(x){var N=A?A+x:x,$=this._events[N];return $?$.fn?1:$.length:0},D.prototype.emit=function(x,N,$,H,K,ce){var Q=A?A+x:x;if(!this._events[Q])return!1;var Z,Se,G=this._events[Q],ie=arguments.length;if(G.fn){switch(G.once&&this.removeListener(x,G.fn,void 0,!0),ie){case 1:return G.fn.call(G.context),!0;case 2:return G.fn.call(G.context,N),!0;case 3:return G.fn.call(G.context,N,$),!0;case 4:return G.fn.call(G.context,N,$,H),!0;case 5:return G.fn.call(G.context,N,$,H,K),!0;case 6:return G.fn.call(G.context,N,$,H,K,ce),!0}for(Se=1,Z=new Array(ie-1);Se<ie;Se++)Z[Se-1]=arguments[Se];G.fn.apply(G.context,Z)}else{var de,ne=G.length;for(Se=0;Se<ne;Se++)switch(G[Se].once&&this.removeListener(x,G[Se].fn,void 0,!0),ie){case 1:G[Se].fn.call(G[Se].context);break;case 2:G[Se].fn.call(G[Se].context,N);break;case 3:G[Se].fn.call(G[Se].context,N,$);break;case 4:G[Se].fn.call(G[Se].context,N,$,H);break;default:if(!Z)for(de=1,Z=new Array(ie-1);de<ie;de++)Z[de-1]=arguments[de];G[Se].fn.apply(G[Se].context,Z)}}return!0},D.prototype.on=function(x,N,$){return O(this,x,N,$,!1)},D.prototype.once=function(x,N,$){return O(this,x,N,$,!0)},D.prototype.removeListener=function(x,N,$,H){var K=A?A+x:x;if(!this._events[K])return this;if(!N)return j(this,K),this;var ce=this._events[K];if(ce.fn)ce.fn!==N||H&&!ce.once||$&&ce.context!==$||j(this,K);else{for(var Q=0,Z=[],Se=ce.length;Q<Se;Q++)(ce[Q].fn!==N||H&&!ce[Q].once||$&&ce[Q].context!==$)&&Z.push(ce[Q]);Z.length?this._events[K]=Z.length===1?Z[0]:Z:j(this,K)}return this},D.prototype.removeAllListeners=function(x){var N;return x?(N=A?A+x:x,this._events[N]&&j(this,N)):(this._events=new C,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=A,D.EventEmitter=D,I.exports=D},543:function(I,_,A){var C;I=A.nmd(I),(function(){var v,O="Expected a function",j="__lodash_hash_undefined__",D="__lodash_placeholder__",x=32,N=128,$=1/0,H=9007199254740991,K=NaN,ce=4294967295,Q=[["ary",N],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",x],["partialRight",64],["rearg",256]],Z="[object Arguments]",Se="[object Array]",G="[object Boolean]",ie="[object Date]",de="[object Error]",ne="[object Function]",J="[object GeneratorFunction]",W="[object Map]",X="[object Number]",se="[object Object]",he="[object Promise]",Ie="[object RegExp]",we="[object Set]",Qe="[object String]",Tt="[object Symbol]",vt="[object WeakMap]",Ut="[object ArrayBuffer]",Vt="[object DataView]",Ht="[object Float32Array]",Ge="[object Float64Array]",At="[object Int8Array]",rn="[object Int16Array]",gn="[object Int32Array]",Dn="[object Uint8Array]",ur="[object Uint8ClampedArray]",it="[object Uint16Array]",Ar="[object Uint32Array]",ra=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,xi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Di=/&(?:amp|lt|gt|quot|#39);/g,oi=/[&<>"']/g,Qi=RegExp(Di.source),lr=RegExp(oi.source),Wr=/<%-([\s\S]+?)%>/g,me=/<%([\s\S]+?)%>/g,Ee=/<%=([\s\S]+?)%>/g,ke=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$e=/^\w*$/,Te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,lt=RegExp(tt.source),Ve=/^\s+/,Be=/\s/,Hn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dt=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,Ke=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pr=/[()=,{}\[\]\/\s]/,xr=/\\(\\)?/g,Mo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Mi=/\w*$/,mi=/^[-+]0x[0-9a-f]+$/i,Zi=/^0b[01]+$/i,oe=/^\[object .+?Constructor\]$/,fe=/^0o[0-7]+$/i,Ce=/^(?:0|[1-9]\d*)$/,xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dt=/($^)/,vn=/['\n\r\u2028\u2029\\]/g,bt="\\ud800-\\udfff",nt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ye="\\u2700-\\u27bf",je="a-z\\xdf-\\xf6\\xf8-\\xff",Ze="A-Z\\xc0-\\xd6\\xd8-\\xde",at="\\ufe0e\\ufe0f",jt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",dn="["+bt+"]",yn="["+jt+"]",Xn="["+nt+"]",us="\\d+",ls="["+Ye+"]",nu="["+je+"]",dc="[^"+bt+jt+us+Ye+je+Ze+"]",hc="\\ud83c[\\udffb-\\udfff]",fc="[^"+bt+"]",ds="(?:\\ud83c[\\udde6-\\uddff]){2}",No="[\\ud800-\\udbff][\\udc00-\\udfff]",Oa="["+Ze+"]",Qu="\\u200d",hs="(?:"+nu+"|"+dc+")",fs="(?:"+Oa+"|"+dc+")",Aa="(?:['’](?:d|ll|m|re|s|t|ve))?",Pa="(?:['’](?:D|LL|M|RE|S|T|VE))?",xa="(?:"+Xn+"|"+hc+")?",ps="["+at+"]?",pc=ps+xa+"(?:"+Qu+"(?:"+[fc,ds,No].join("|")+")"+ps+xa+")*",ru="(?:"+[ls,ds,No].join("|")+")"+pc,Zu="(?:"+[fc+Xn+"?",Xn,ds,No,dn].join("|")+")",Ni=RegExp("['’]","g"),Li=RegExp(Xn,"g"),ms=RegExp(hc+"(?="+hc+")|"+Zu+pc,"g"),Kl=RegExp([Oa+"?"+nu+"+"+Aa+"(?="+[yn,Oa,"$"].join("|")+")",fs+"+"+Pa+"(?="+[yn,Oa+hs,"$"].join("|")+")",Oa+"?"+hs+"+"+Aa,Oa+"+"+Pa,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",us,ru].join("|"),"g"),rh=RegExp("["+Qu+bt+nt+at+"]"),mc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,el=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],bn=-1,ft={};ft[Ht]=ft[Ge]=ft[At]=ft[rn]=ft[gn]=ft[Dn]=ft[ur]=ft[it]=ft[Ar]=!0,ft[Z]=ft[Se]=ft[Ut]=ft[G]=ft[Vt]=ft[ie]=ft[de]=ft[ne]=ft[W]=ft[X]=ft[se]=ft[Ie]=ft[we]=ft[Qe]=ft[vt]=!1;var hn={};hn[Z]=hn[Se]=hn[Ut]=hn[Vt]=hn[G]=hn[ie]=hn[Ht]=hn[Ge]=hn[At]=hn[rn]=hn[gn]=hn[W]=hn[X]=hn[se]=hn[Ie]=hn[we]=hn[Qe]=hn[Tt]=hn[Dn]=hn[ur]=hn[it]=hn[Ar]=!0,hn[de]=hn[ne]=hn[vt]=!1;var tl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nl=parseFloat,rl=parseInt,Yl=typeof A.g=="object"&&A.g&&A.g.Object===Object&&A.g,et=typeof self=="object"&&self&&self.Object===Object&&self,Qn=Yl||et||Function("return this")(),Et=_&&!_.nodeType&&_,ia=Et&&I&&!I.nodeType&&I,Da=ia&&ia.exports===Et,fr=Da&&Yl.process,jn=function(){try{return ia&&ia.require&&ia.require("util").types||fr&&fr.binding&&fr.binding("util")}catch{}}(),gc=jn&&jn.isArrayBuffer,iu=jn&&jn.isDate,ou=jn&&jn.isMap,vc=jn&&jn.isRegExp,gs=jn&&jn.isSet,Gr=jn&&jn.isTypedArray;function gi(V,ee,te){switch(te.length){case 0:return V.call(ee);case 1:return V.call(ee,te[0]);case 2:return V.call(ee,te[0],te[1]);case 3:return V.call(ee,te[0],te[1],te[2])}return V.apply(ee,te)}function vi(V,ee,te,ge){for(var De=-1,We=V==null?0:V.length;++De<We;){var mt=V[De];ee(ge,mt,te(mt),V)}return ge}function yi(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge&&ee(V[te],te,V)!==!1;);return V}function au(V,ee){for(var te=V==null?0:V.length;te--&&ee(V[te],te,V)!==!1;);return V}function eo(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge;)if(!ee(V[te],te,V))return!1;return!0}function Bi(V,ee){for(var te=-1,ge=V==null?0:V.length,De=0,We=[];++te<ge;){var mt=V[te];ee(mt,te,V)&&(We[De++]=mt)}return We}function Ma(V,ee){return!(V==null||!V.length)&&ys(V,ee,0)>-1}function wn(V,ee,te){for(var ge=-1,De=V==null?0:V.length;++ge<De;)if(te(ee,V[ge]))return!0;return!1}function It(V,ee){for(var te=-1,ge=V==null?0:V.length,De=Array(ge);++te<ge;)De[te]=ee(V[te],te,V);return De}function to(V,ee){for(var te=-1,ge=ee.length,De=V.length;++te<ge;)V[De+te]=ee[te];return V}function il(V,ee,te,ge){var De=-1,We=V==null?0:V.length;for(ge&&We&&(te=V[++De]);++De<We;)te=ee(te,V[De],De,V);return te}function ol(V,ee,te,ge){var De=V==null?0:V.length;for(ge&&De&&(te=V[--De]);De--;)te=ee(te,V[De],De,V);return te}function vs(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge;)if(ee(V[te],te,V))return!0;return!1}var Zn=bs("length");function yc(V,ee,te){var ge;return te(V,function(De,We,mt){if(ee(De,We,mt))return ge=We,!1}),ge}function no(V,ee,te,ge){for(var De=V.length,We=te+(ge?1:-1);ge?We--:++We<De;)if(ee(V[We],We,V))return We;return-1}function ys(V,ee,te){return ee==ee?function(ge,De,We){for(var mt=We-1,Mn=ge.length;++mt<Mn;)if(ge[mt]===De)return mt;return-1}(V,ee,te):no(V,al,te)}function Jl(V,ee,te,ge){for(var De=te-1,We=V.length;++De<We;)if(ge(V[De],ee))return De;return-1}function al(V){return V!=V}function Hr(V,ee){var te=V==null?0:V.length;return te?Sc(V,ee)/te:K}function bs(V){return function(ee){return ee==null?v:ee[V]}}function bc(V){return function(ee){return V==null?v:V[ee]}}function su(V,ee,te,ge,De){return De(V,function(We,mt,Mn){te=ge?(ge=!1,We):ee(te,We,mt,Mn)}),te}function Sc(V,ee){for(var te,ge=-1,De=V.length;++ge<De;){var We=ee(V[ge]);We!==v&&(te=te===v?We:te+We)}return te}function cu(V,ee){for(var te=-1,ge=Array(V);++te<V;)ge[te]=ee(te);return ge}function zr(V){return V&&V.slice(0,Un(V)+1).replace(Ve,"")}function Dr(V){return function(ee){return V(ee)}}function oa(V,ee){return It(ee,function(te){return V[te]})}function Ss(V,ee){return V.has(ee)}function sl(V,ee){for(var te=-1,ge=V.length;++te<ge&&ys(ee,V[te],0)>-1;);return te}function Xl(V,ee){for(var te=V.length;te--&&ys(ee,V[te],0)>-1;);return te}var ih=bc({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),oh=bc({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Es(V){return"\\"+tl[V]}function aa(V){return rh.test(V)}function uu(V){var ee=-1,te=Array(V.size);return V.forEach(function(ge,De){te[++ee]=[De,ge]}),te}function Lo(V,ee){return function(te){return V(ee(te))}}function ji(V,ee){for(var te=-1,ge=V.length,De=0,We=[];++te<ge;){var mt=V[te];mt!==ee&&mt!==D||(V[te]=D,We[De++]=te)}return We}function lu(V){var ee=-1,te=Array(V.size);return V.forEach(function(ge){te[++ee]=ge}),te}function ro(V){return aa(V)?function(ee){for(var te=ms.lastIndex=0;ms.test(ee);)++te;return te}(V):Zn(V)}function zn(V){return aa(V)?function(ee){return ee.match(ms)||[]}(V):function(ee){return ee.split("")}(V)}function Un(V){for(var ee=V.length;ee--&&Be.test(V.charAt(ee)););return ee}var du=bc({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Na=function V(ee){var te,ge=(ee=ee==null?Qn:Na.defaults(Qn.Object(),ee,Na.pick(Qn,el))).Array,De=ee.Date,We=ee.Error,mt=ee.Function,Mn=ee.Math,pt=ee.Object,Ec=ee.RegExp,ai=ee.String,Kt=ee.TypeError,Bo=ge.prototype,sa=mt.prototype,bi=pt.prototype,Ui=ee["__core-js_shared__"],Je=sa.toString,rt=bi.hasOwnProperty,cl=0,_c=(te=/[^.]+$/.exec(Ui&&Ui.keys&&Ui.keys.IE_PROTO||""))?"Symbol(src)_1."+te:"",ht=bi.toString,ah=Je.call(pt),sh=Qn._,ch=Ec("^"+Je.call(rt).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=Da?ee.Buffer:v,Er=ee.Symbol,ca=ee.Uint8Array,ul=er?er.allocUnsafe:v,La=Lo(pt.getPrototypeOf,pt),ll=pt.create,Cc=bi.propertyIsEnumerable,io=Bo.splice,dl=Er?Er.isConcatSpreadable:v,jo=Er?Er.iterator:v,Mr=Er?Er.toStringTag:v,Ba=function(){try{var e=Ko(pt,"defineProperty");return e({},"",{}),e}catch{}}(),uh=ee.clearTimeout!==Qn.clearTimeout&&ee.clearTimeout,_s=De&&De.now!==Qn.Date.now&&De.now,Ql=ee.setTimeout!==Qn.setTimeout&&ee.setTimeout,ja=Mn.ceil,Ua=Mn.floor,Cs=pt.getOwnPropertySymbols,lh=er?er.isBuffer:v,Fa=ee.isFinite,dh=Bo.join,Zl=Lo(pt.keys,pt),Nt=Mn.max,Yt=Mn.min,hu=De.now,hh=ee.parseInt,Tc=Mn.random,ed=Bo.reverse,Ts=Ko(ee,"DataView"),Oe=Ko(ee,"Map"),Sn=Ko(ee,"Promise"),oo=Ko(ee,"Set"),Uo=Ko(ee,"WeakMap"),Fo=Ko(pt,"create"),$a=Uo&&new Uo,Fi={},fh=va(Ts),Va=va(Oe),td=va(Sn),Nr=va(oo),nd=va(Uo),Lr=Er?Er.prototype:v,bo=Lr?Lr.valueOf:v,ua=Lr?Lr.toString:v;function k(e){if(Vn(e)&&!wt(e)&&!(e instanceof Fe)){if(e instanceof In)return e;if(rt.call(e,"__wrapped__"))return ad(e)}return new In(e)}var ct=function(){function e(){}return function(t){if(!Ct(t))return{};if(ll)return ll(t);e.prototype=t;var o=new e;return e.prototype=v,o}}();function ao(){}function In(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=v}function Fe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function qr(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}function Zt(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}function Fn(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var s=e[t];this.set(s[0],s[1])}}function si(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new Fn;++t<o;)this.add(e[t])}function Jt(e){var t=this.__data__=new Zt(e);this.size=t.size}function _e(e,t){var o=wt(e),s=!o&&Xe(e),h=!o&&!s&&Yo(e),y=!o&&!s&&!h&&qs(e),T=o||s||h||y,P=T?cu(e.length,ai):[],M=P.length;for(var L in e)!t&&!rt.call(e,L)||T&&(L=="length"||h&&(L=="offset"||L=="parent")||y&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Oo(L,M))||P.push(L);return P}function Kr(e){var t=e.length;return t?e[Ac(0,t-1)]:v}function ph(e,t){return Ao(Zr(e),ci(t,0,e.length))}function fu(e){return Ao(Zr(e))}function la(e,t,o){(o!==v&&!zi(e[t],o)||o===v&&!(t in e))&&qn(e,t,o)}function so(e,t,o){var s=e[t];rt.call(e,t)&&zi(s,o)&&(o!==v||t in e)||qn(e,t,o)}function So(e,t){for(var o=e.length;o--;)if(zi(e[o][0],t))return o;return-1}function hl(e,t,o,s){return _r(e,function(h,y,T){t(s,h,o(h),T)}),s}function fl(e,t){return e&&$n(t,Rt(t),e)}function qn(e,t,o){t=="__proto__"&&Ba?Ba(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function Rs(e,t){for(var o=-1,s=t.length,h=ge(s),y=e==null;++o<s;)h[o]=y?v:Gc(e,t[o]);return h}function ci(e,t,o){return e==e&&(o!==v&&(e=e<=o?e:o),t!==v&&(e=e>=t?e:t)),e}function Nn(e,t,o,s,h,y){var T,P=1&t,M=2&t,L=4&t;if(o&&(T=h?o(e,s,h,y):o(e)),T!==v)return T;if(!Ct(e))return e;var B=wt(e);if(B){if(T=function(z){var re=z.length,ue=new z.constructor(re);return re&&typeof z[0]=="string"&&rt.call(z,"index")&&(ue.index=z.index,ue.input=z.input),ue}(e),!P)return Zr(e,T)}else{var U=Wn(e),F=U==ne||U==J;if(Yo(e))return xc(e,P);if(U==se||U==Z||F&&!h){if(T=M||F?{}:Iu(e),!P)return M?function(z,re){return $n(z,Lc(z),re)}(e,function(z,re){return z&&$n(re,Gn(re),z)}(T,e)):function(z,re){return $n(z,Ti(z),re)}(e,fl(T,e))}else{if(!hn[U])return h?e:{};T=function(z,re,ue){var le,ve=z.constructor;switch(re){case Ut:return qa(z);case G:case ie:return new ve(+z);case Vt:return function(be,ye){var pe=ye?qa(be.buffer):be.buffer;return new be.constructor(pe,be.byteOffset,be.byteLength)}(z,ue);case Ht:case Ge:case At:case rn:case gn:case Dn:case ur:case it:case Ar:return ma(z,ue);case W:return new ve;case X:case Qe:return new ve(z);case Ie:return function(be){var ye=new be.constructor(be.source,Mi.exec(be));return ye.lastIndex=be.lastIndex,ye}(z);case we:return new ve;case Tt:return le=z,bo?pt(bo.call(le)):{}}}(e,U,P)}}y||(y=new Jt);var q=y.get(e);if(q)return q;y.set(e,T),ya(e)?e.forEach(function(z){T.add(Nn(z,t,o,z,e,y))}):kl(e)&&e.forEach(function(z,re){T.set(re,Nn(z,t,o,re,e,y))});var Y=B?v:(L?M?ko:Tr:M?Gn:Rt)(e);return yi(Y||e,function(z,re){Y&&(z=e[re=z]),so(T,re,Nn(z,t,o,re,e,y))}),T}function Rc(e,t,o){var s=o.length;if(e==null)return!s;for(e=pt(e);s--;){var h=o[s],y=t[h],T=e[h];if(T===v&&!(h in e)||!y(T))return!1}return!0}function wc(e,t,o){if(typeof e!="function")throw new Kt(O);return es(function(){e.apply(v,o)},t)}function co(e,t,o,s){var h=-1,y=Ma,T=!0,P=e.length,M=[],L=t.length;if(!P)return M;o&&(t=It(t,Dr(o))),s?(y=wn,T=!1):t.length>=200&&(y=Ss,T=!1,t=new si(t));e:for(;++h<P;){var B=e[h],U=o==null?B:o(B);if(B=s||B!==0?B:0,T&&U==U){for(var F=L;F--;)if(t[F]===U)continue e;M.push(B)}else y(t,U,s)||M.push(B)}return M}k.templateSettings={escape:Wr,evaluate:me,interpolate:Ee,variable:"",imports:{_:k}},k.prototype=ao.prototype,k.prototype.constructor=k,In.prototype=ct(ao.prototype),In.prototype.constructor=In,Fe.prototype=ct(ao.prototype),Fe.prototype.constructor=Fe,qr.prototype.clear=function(){this.__data__=Fo?Fo(null):{},this.size=0},qr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qr.prototype.get=function(e){var t=this.__data__;if(Fo){var o=t[e];return o===j?v:o}return rt.call(t,e)?t[e]:v},qr.prototype.has=function(e){var t=this.__data__;return Fo?t[e]!==v:rt.call(t,e)},qr.prototype.set=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Fo&&t===v?j:t,this},Zt.prototype.clear=function(){this.__data__=[],this.size=0},Zt.prototype.delete=function(e){var t=this.__data__,o=So(t,e);return!(o<0||(o==t.length-1?t.pop():io.call(t,o,1),--this.size,0))},Zt.prototype.get=function(e){var t=this.__data__,o=So(t,e);return o<0?v:t[o][1]},Zt.prototype.has=function(e){return So(this.__data__,e)>-1},Zt.prototype.set=function(e,t){var o=this.__data__,s=So(o,e);return s<0?(++this.size,o.push([e,t])):o[s][1]=t,this},Fn.prototype.clear=function(){this.size=0,this.__data__={hash:new qr,map:new(Oe||Zt),string:new qr}},Fn.prototype.delete=function(e){var t=ot(this,e).delete(e);return this.size-=t?1:0,t},Fn.prototype.get=function(e){return ot(this,e).get(e)},Fn.prototype.has=function(e){return ot(this,e).has(e)},Fn.prototype.set=function(e,t){var o=ot(this,e),s=o.size;return o.set(e,t),this.size+=o.size==s?0:1,this},si.prototype.add=si.prototype.push=function(e){return this.__data__.set(e,j),this},si.prototype.has=function(e){return this.__data__.has(e)},Jt.prototype.clear=function(){this.__data__=new Zt,this.size=0},Jt.prototype.delete=function(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o},Jt.prototype.get=function(e){return this.__data__.get(e)},Jt.prototype.has=function(e){return this.__data__.has(e)},Jt.prototype.set=function(e,t){var o=this.__data__;if(o instanceof Zt){var s=o.__data__;if(!Oe||s.length<199)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new Fn(s)}return o.set(e,t),this.size=o.size,this};var _r=To(tr),pu=To(ks,!0);function pl(e,t){var o=!0;return _r(e,function(s,h,y){return o=!!t(s,h,y)}),o}function da(e,t,o){for(var s=-1,h=e.length;++s<h;){var y=e[s],T=t(y);if(T!=null&&(P===v?T==T&&!kn(T):o(T,P)))var P=T,M=y}return M}function mu(e,t){var o=[];return _r(e,function(s,h,y){t(s,h,y)&&o.push(s)}),o}function Gt(e,t,o,s,h){var y=-1,T=e.length;for(o||(o=El),h||(h=[]);++y<T;){var P=e[y];t>0&&o(P)?t>1?Gt(P,t-1,o,s,h):to(h,P):s||(h[h.length]=P)}return h}var ws=yl(),Is=yl(!0);function tr(e,t){return e&&ws(e,t,Rt)}function ks(e,t){return e&&Is(e,t,Rt)}function Yr(e,t){return Bi(t,function(o){return En(e[o])})}function Jr(e,t){for(var o=0,s=(t=pr(t,e)).length;e!=null&&o<s;)e=e[Br(t[o++])];return o&&o==s?e:v}function Ic(e,t,o){var s=t(e);return wt(e)?s:to(s,o(e))}function on(e){return e==null?e===v?"[object Undefined]":"[object Null]":Mr&&Mr in pt(e)?function(t){var o=rt.call(t,Mr),s=t[Mr];try{t[Mr]=v;var h=!0}catch{}var y=ht.call(t);return h&&(o?t[Mr]=s:delete t[Mr]),y}(e):function(t){return ht.call(t)}(e)}function Os(e,t){return e>t}function rd(e,t){return e!=null&&rt.call(e,t)}function id(e,t){return e!=null&&t in pt(e)}function As(e,t,o){for(var s=o?wn:Ma,h=e[0].length,y=e.length,T=y,P=ge(y),M=1/0,L=[];T--;){var B=e[T];T&&t&&(B=It(B,Dr(t))),M=Yt(B.length,M),P[T]=!o&&(t||h>=120&&B.length>=120)?new si(T&&B):v}B=e[0];var U=-1,F=P[0];e:for(;++U<h&&L.length<M;){var q=B[U],Y=t?t(q):q;if(q=o||q!==0?q:0,!(F?Ss(F,Y):s(L,Y,o))){for(T=y;--T;){var z=P[T];if(!(z?Ss(z,Y):s(e[T],Y,o)))continue e}F&&F.push(Y),L.push(q)}}return L}function $o(e,t,o){var s=(e=rr(e,t=pr(t,e)))==null?e:e[Br(ti(t))];return s==null?v:gi(s,e,o)}function gu(e){return Vn(e)&&on(e)==Z}function Eo(e,t,o,s,h){return e===t||(e==null||t==null||!Vn(e)&&!Vn(t)?e!=e&&t!=t:function(y,T,P,M,L,B){var U=wt(y),F=wt(T),q=U?Se:Wn(y),Y=F?Se:Wn(T),z=(q=q==Z?se:q)==se,re=(Y=Y==Z?se:Y)==se,ue=q==Y;if(ue&&Yo(y)){if(!Yo(T))return!1;U=!0,z=!1}if(ue&&!z)return B||(B=new Jt),U||qs(y)?Ja(y,T,P,M,L,B):function(pe,Re,Me,Le,Ae,Pe,qe){switch(Me){case Vt:if(pe.byteLength!=Re.byteLength||pe.byteOffset!=Re.byteOffset)return!1;pe=pe.buffer,Re=Re.buffer;case Ut:return!(pe.byteLength!=Re.byteLength||!Pe(new ca(pe),new ca(Re)));case G:case ie:case X:return zi(+pe,+Re);case de:return pe.name==Re.name&&pe.message==Re.message;case Ie:case Qe:return pe==Re+"";case W:var gt=uu;case we:var Bt=1&Le;if(gt||(gt=lu),pe.size!=Re.size&&!Bt)return!1;var Ft=qe.get(pe);if(Ft)return Ft==Re;Le|=2,qe.set(pe,Re);var Lt=Ja(gt(pe),gt(Re),Le,Ae,Pe,qe);return qe.delete(pe),Lt;case Tt:if(bo)return bo.call(pe)==bo.call(Re)}return!1}(y,T,q,P,M,L,B);if(!(1&P)){var le=z&&rt.call(y,"__wrapped__"),ve=re&&rt.call(T,"__wrapped__");if(le||ve){var be=le?y.value():y,ye=ve?T.value():T;return B||(B=new Jt),L(be,ye,P,M,B)}}return!!ue&&(B||(B=new Jt),function(pe,Re,Me,Le,Ae,Pe){var qe=1&Me,gt=Tr(pe),Bt=gt.length;if(Bt!=Tr(Re).length&&!qe)return!1;for(var Ft=Bt;Ft--;){var Lt=gt[Ft];if(!(qe?Lt in Re:rt.call(Re,Lt)))return!1}var qt=Pe.get(pe),On=Pe.get(Re);if(qt&&On)return qt==Re&&On==pe;var pn=!0;Pe.set(pe,Re),Pe.set(Re,pe);for(var un=qe;++Ft<Bt;){var sn=pe[Lt=gt[Ft]],tn=Re[Lt];if(Le)var ln=qe?Le(tn,sn,Lt,Re,pe,Pe):Le(sn,tn,Lt,pe,Re,Pe);if(!(ln===v?sn===tn||Ae(sn,tn,Me,Le,Pe):ln)){pn=!1;break}un||(un=Lt=="constructor")}if(pn&&!un){var Pn=pe.constructor,Xt=Re.constructor;Pn==Xt||!("constructor"in pe)||!("constructor"in Re)||typeof Pn=="function"&&Pn instanceof Pn&&typeof Xt=="function"&&Xt instanceof Xt||(pn=!1)}return Pe.delete(pe),Pe.delete(Re),pn}(y,T,P,M,L,B))}(e,t,o,s,Eo,h))}function kc(e,t,o,s){var h=o.length,y=h,T=!s;if(e==null)return!y;for(e=pt(e);h--;){var P=o[h];if(T&&P[2]?P[1]!==e[P[0]]:!(P[0]in e))return!1}for(;++h<y;){var M=(P=o[h])[0],L=e[M],B=P[1];if(T&&P[2]){if(L===v&&!(M in e))return!1}else{var U=new Jt;if(s)var F=s(L,B,M,e,t,U);if(!(F===v?Eo(B,L,3,s,U):F))return!1}}return!0}function Ue(e){return!(!Ct(e)||(t=e,_c&&_c in t))&&(En(e)?ch:oe).test(va(e));var t}function vu(e){return typeof e=="function"?e:e==null?jr:typeof e=="object"?wt(e)?ml(e[0],e[1]):yu(e):Ll(e)}function ha(e){if(!Qa(e))return Zl(e);var t=[];for(var o in pt(e))rt.call(e,o)&&o!="constructor"&&t.push(o);return t}function nr(e,t){return e<t}function Oc(e,t){var o=-1,s=Wt(e)?ge(e.length):[];return _r(e,function(h,y,T){s[++o]=t(h,y,T)}),s}function yu(e){var t=Fs(e);return t.length==1&&t[0][2]?Ou(t[0][0],t[0][1]):function(o){return o===e||kc(o,e,t)}}function ml(e,t){return gr(e)&&Za(t)?Ou(Br(e),t):function(o){var s=Gc(o,e);return s===v&&s===t?Ol(o,e):Eo(t,s,3)}}function Wa(e,t,o,s,h){e!==t&&ws(t,function(y,T){if(h||(h=new Jt),Ct(y))(function(M,L,B,U,F,q,Y){var z=$s(M,B),re=$s(L,B),ue=Y.get(re);if(ue)la(M,B,ue);else{var le=q?q(z,re,B+"",M,L,Y):v,ve=le===v;if(ve){var be=wt(re),ye=!be&&Yo(re),pe=!be&&!ye&&qs(re);le=re,be||ye||pe?wt(z)?le=z:Pt(z)?le=Zr(z):ye?(ve=!1,le=xc(re,!0)):pe?(ve=!1,le=ma(re,!0)):le=[]:po(re)||Xe(re)?(le=z,Xe(z)?le=xt(z):Ct(z)&&!En(z)||(le=Iu(re))):ve=!1}ve&&(Y.set(re,le),F(le,re,U,q,Y),Y.delete(re)),la(M,B,le)}})(e,t,T,o,Wa,s,h);else{var P=s?s($s(e,T),y,T+"",e,t,h):v;P===v&&(P=y),la(e,T,P)}},Gn)}function Ps(e,t){var o=e.length;if(o)return Oo(t+=t<0?o:0,o)?e[t]:v}function bu(e,t,o){t=t.length?It(t,function(y){return wt(y)?function(T){return Jr(T,y.length===1?y[0]:y)}:y}):[jr];var s=-1;t=It(t,Dr(st()));var h=Oc(e,function(y,T,P){var M=It(t,function(L){return L(y)});return{criteria:M,index:++s,value:y}});return function(y){var T=y.length;for(y.sort(function(P,M){return function(L,B,U){for(var F=-1,q=L.criteria,Y=B.criteria,z=q.length,re=U.length;++F<z;){var ue=Tu(q[F],Y[F]);if(ue)return F>=re?ue:ue*(U[F]=="desc"?-1:1)}return L.index-B.index}(P,M,o)});T--;)y[T]=y[T].value;return y}(h)}function fa(e,t,o){for(var s=-1,h=t.length,y={};++s<h;){var T=t[s],P=Jr(e,T);o(P,T)&&Xr(y,pr(T,e),P)}return y}function Su(e,t,o,s){var h=s?Jl:ys,y=-1,T=t.length,P=e;for(e===t&&(t=Zr(t)),o&&(P=It(e,Dr(o)));++y<T;)for(var M=0,L=t[y],B=o?o(L):L;(M=h(P,B,M,s))>-1;)P!==e&&io.call(P,M,1),io.call(e,M,1);return e}function Eu(e,t){for(var o=e?t.length:0,s=o-1;o--;){var h=t[o];if(o==s||h!==y){var y=h;Oo(h)?io.call(e,h,1):_i(e,h)}}return e}function Ac(e,t){return e+Ua(Tc()*(t-e+1))}function xs(e,t){var o="";if(!e||t<1||t>H)return o;do t%2&&(o+=e),(t=Ua(t/2))&&(e+=e);while(t);return o}function Ot(e,t){return ga(Au(e,t,jr),e+"")}function _t(e){return Kr(as(e))}function Ds(e,t){var o=as(e);return Ao(o,ci(t,0,o.length))}function Xr(e,t,o,s){if(!Ct(e))return e;for(var h=-1,y=(t=pr(t,e)).length,T=y-1,P=e;P!=null&&++h<y;){var M=Br(t[h]),L=o;if(M==="__proto__"||M==="constructor"||M==="prototype")return e;if(h!=T){var B=P[M];(L=s?s(B,M,P):v)===v&&(L=Ct(B)?B:Oo(t[h+1])?[]:{})}so(P,M,L),P=P[M]}return e}var Vo=$a?function(e,t){return $a.set(e,t),e}:jr,Cr=Ba?function(e,t){return Ba(e,"toString",{configurable:!0,enumerable:!1,value:Hc(t),writable:!0})}:jr;function pa(e){return Ao(as(e))}function kt(e,t,o){var s=-1,h=e.length;t<0&&(t=-t>h?0:h+t),(o=o>h?h:o)<0&&(o+=h),h=t>o?0:o-t>>>0,t>>>=0;for(var y=ge(h);++s<h;)y[s]=e[s+t];return y}function Si(e,t){var o;return _r(e,function(s,h,y){return!(o=t(s,h,y))}),!!o}function Ei(e,t,o){var s=0,h=e==null?s:e.length;if(typeof t=="number"&&t==t&&h<=2147483647){for(;s<h;){var y=s+h>>>1,T=e[y];T!==null&&!kn(T)&&(o?T<=t:T<t)?s=y+1:h=y}return h}return Ga(e,t,jr,o)}function Ga(e,t,o,s){var h=0,y=e==null?0:e.length;if(y===0)return 0;for(var T=(t=o(t))!=t,P=t===null,M=kn(t),L=t===v;h<y;){var B=Ua((h+y)/2),U=o(e[B]),F=U!==v,q=U===null,Y=U==U,z=kn(U);if(T)var re=s||Y;else re=L?Y&&(s||F):P?Y&&F&&(s||!q):M?Y&&F&&!q&&(s||!z):!q&&!z&&(s?U<=t:U<t);re?h=B+1:y=B}return Yt(y,4294967294)}function Pc(e,t){for(var o=-1,s=e.length,h=0,y=[];++o<s;){var T=e[o],P=t?t(T):T;if(!o||!zi(P,M)){var M=P;y[h++]=T===0?0:T}}return y}function _u(e){return typeof e=="number"?e:kn(e)?K:+e}function Qr(e){if(typeof e=="string")return e;if(wt(e))return It(e,Qr)+"";if(kn(e))return ua?ua.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function en(e,t,o){var s=-1,h=Ma,y=e.length,T=!0,P=[],M=P;if(o)T=!1,h=wn;else if(y>=200){var L=t?null:Sl(e);if(L)return lu(L);T=!1,h=Ss,M=new si}else M=t?[]:P;e:for(;++s<y;){var B=e[s],U=t?t(B):B;if(B=o||B!==0?B:0,T&&U==U){for(var F=M.length;F--;)if(M[F]===U)continue e;t&&M.push(U),P.push(B)}else h(M,U,o)||(M!==P&&M.push(U),P.push(B))}return P}function _i(e,t){return(e=rr(e,t=pr(t,e)))==null||delete e[Br(ti(t))]}function Ha(e,t,o,s){return Xr(e,t,o(Jr(e,t)),s)}function Wo(e,t,o,s){for(var h=e.length,y=s?h:-1;(s?y--:++y<h)&&t(e[y],y,e););return o?kt(e,s?0:y,s?y+1:h):kt(e,s?y+1:0,s?h:y)}function za(e,t){var o=e;return o instanceof Fe&&(o=o.value()),il(t,function(s,h){return h.func.apply(h.thisArg,to([s],h.args))},o)}function Cu(e,t,o){var s=e.length;if(s<2)return s?en(e[0]):[];for(var h=-1,y=ge(s);++h<s;)for(var T=e[h],P=-1;++P<s;)P!=h&&(y[h]=co(y[h]||T,e[P],t,o));return en(Gt(y,1),t,o)}function _o(e,t,o){for(var s=-1,h=e.length,y=t.length,T={};++s<h;){var P=s<y?t[s]:v;o(T,e[s],P)}return T}function $i(e){return Pt(e)?e:[]}function Go(e){return typeof e=="function"?e:jr}function pr(e,t){return wt(e)?e:gr(e,t)?[e]:lo(ze(e))}var uo=Ot;function Ci(e,t,o){var s=e.length;return o=o===v?s:o,!t&&o>=s?e:kt(e,t,o)}var Ho=uh||function(e){return Qn.clearTimeout(e)};function xc(e,t){if(t)return e.slice();var o=e.length,s=ul?ul(o):new e.constructor(o);return e.copy(s),s}function qa(e){var t=new e.constructor(e.byteLength);return new ca(t).set(new ca(e)),t}function ma(e,t){var o=t?qa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Tu(e,t){if(e!==t){var o=e!==v,s=e===null,h=e==e,y=kn(e),T=t!==v,P=t===null,M=t==t,L=kn(t);if(!P&&!L&&!y&&e>t||y&&T&&M&&!P&&!L||s&&T&&M||!o&&M||!h)return 1;if(!s&&!y&&!L&&e<t||L&&o&&h&&!s&&!y||P&&o&&h||!T&&h||!M)return-1}return 0}function gl(e,t,o,s){for(var h=-1,y=e.length,T=o.length,P=-1,M=t.length,L=Nt(y-T,0),B=ge(M+L),U=!s;++P<M;)B[P]=t[P];for(;++h<T;)(U||h<y)&&(B[o[h]]=e[h]);for(;L--;)B[P++]=e[h++];return B}function vl(e,t,o,s){for(var h=-1,y=e.length,T=-1,P=o.length,M=-1,L=t.length,B=Nt(y-P,0),U=ge(B+L),F=!s;++h<B;)U[h]=e[h];for(var q=h;++M<L;)U[q+M]=t[M];for(;++T<P;)(F||h<y)&&(U[q+o[T]]=e[h++]);return U}function Zr(e,t){var o=-1,s=e.length;for(t||(t=ge(s));++o<s;)t[o]=e[o];return t}function $n(e,t,o,s){var h=!o;o||(o={});for(var y=-1,T=t.length;++y<T;){var P=t[y],M=s?s(o[P],e[P],P,o,e):v;M===v&&(M=e[P]),h?qn(o,P,M):so(o,P,M)}return o}function ui(e,t){return function(o,s){var h=wt(o)?vi:hl,y=t?t():{};return h(o,e,st(s,2),y)}}function Co(e){return Ot(function(t,o){var s=-1,h=o.length,y=h>1?o[h-1]:v,T=h>2?o[2]:v;for(y=e.length>3&&typeof y=="function"?(h--,y):v,T&&Ln(o[0],o[1],T)&&(y=h<3?v:y,h=1),t=pt(t);++s<h;){var P=o[s];P&&e(t,P,s,y)}return t})}function To(e,t){return function(o,s){if(o==null)return o;if(!Wt(o))return e(o,s);for(var h=o.length,y=t?h:-1,T=pt(o);(t?y--:++y<h)&&s(T[y],y,T)!==!1;);return o}}function yl(e){return function(t,o,s){for(var h=-1,y=pt(t),T=s(t),P=T.length;P--;){var M=T[e?P:++h];if(o(y[M],M,y)===!1)break}return t}}function bl(e){return function(t){var o=aa(t=ze(t))?zn(t):v,s=o?o[0]:t.charAt(0),h=o?Ci(o,1).join(""):t.slice(1);return s[e]()+h}}function Ka(e){return function(t){return il(Ml(xl(t).replace(Ni,"")),e,"")}}function Ro(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var o=ct(e.prototype),s=e.apply(o,t);return Ct(s)?s:o}}function Ms(e){return function(t,o,s){var h=pt(t);if(!Wt(t)){var y=st(o,3);t=Rt(t),o=function(P){return y(h[P],P,h)}}var T=e(t,o,s);return T>-1?h[y?t[T]:T]:v}}function Ru(e){return ei(function(t){var o=t.length,s=o,h=In.prototype.thru;for(e&&t.reverse();s--;){var y=t[s];if(typeof y!="function")throw new Kt(O);if(h&&!T&&zo(y)=="wrapper")var T=new In([],!0)}for(s=T?s:o;++s<o;){var P=zo(y=t[s]),M=P=="wrapper"?Vi(y):v;T=M&&Xa(M[0])&&M[1]==424&&!M[4].length&&M[9]==1?T[zo(M[0])].apply(T,M[3]):y.length==1&&Xa(y)?T[P]():T.thru(y)}return function(){var L=arguments,B=L[0];if(T&&L.length==1&&wt(B))return T.plant(B).value();for(var U=0,F=o?t[U].apply(this,L):B;++U<o;)F=t[U].call(this,F);return F}})}function Ns(e,t,o,s,h,y,T,P,M,L){var B=t&N,U=1&t,F=2&t,q=24&t,Y=512&t,z=F?v:Ro(e);return function re(){for(var ue=arguments.length,le=ge(ue),ve=ue;ve--;)le[ve]=arguments[ve];if(q)var be=qo(re),ye=function(Le,Ae){for(var Pe=Le.length,qe=0;Pe--;)Le[Pe]===Ae&&++qe;return qe}(le,be);if(s&&(le=gl(le,s,h,q)),y&&(le=vl(le,y,T,q)),ue-=ye,q&&ue<L){var pe=ji(le,be);return Nc(e,t,Ns,re.placeholder,o,le,pe,P,M,L-ue)}var Re=U?o:this,Me=F?Re[e]:e;return ue=le.length,P?le=function(Le,Ae){for(var Pe=Le.length,qe=Yt(Ae.length,Pe),gt=Zr(Le);qe--;){var Bt=Ae[qe];Le[qe]=Oo(Bt,Pe)?gt[Bt]:v}return Le}(le,P):Y&&ue>1&&le.reverse(),B&&M<ue&&(le.length=M),this&&this!==Qn&&this instanceof re&&(Me=z||Ro(Me)),Me.apply(Re,le)}}function li(e,t){return function(o,s){return function(h,y,T,P){return tr(h,function(M,L,B){y(P,T(M),L,B)}),P}(o,e,t(s),{})}}function Ls(e,t){return function(o,s){var h;if(o===v&&s===v)return t;if(o!==v&&(h=o),s!==v){if(h===v)return s;typeof o=="string"||typeof s=="string"?(o=Qr(o),s=Qr(s)):(o=_u(o),s=_u(s)),h=e(o,s)}return h}}function Ya(e){return ei(function(t){return t=It(t,Dr(st())),Ot(function(o){var s=this;return e(t,function(h){return gi(h,s,o)})})})}function Bs(e,t){var o=(t=t===v?" ":Qr(t)).length;if(o<2)return o?xs(t,e):t;var s=xs(t,ja(e/ro(t)));return aa(t)?Ci(zn(s),0,e).join(""):s.slice(0,e)}function Dc(e){return function(t,o,s){return s&&typeof s!="number"&&Ln(t,o,s)&&(o=s=v),t=He(t),o===v?(o=t,t=0):o=He(o),function(h,y,T,P){for(var M=-1,L=Nt(ja((y-h)/(T||1)),0),B=ge(L);L--;)B[P?L:++M]=h,h+=T;return B}(t,o,s=s===v?t<o?1:-1:He(s),e)}}function Mc(e){return function(t,o){return typeof t=="string"&&typeof o=="string"||(t=Ri(t),o=Ri(o)),e(t,o)}}function Nc(e,t,o,s,h,y,T,P,M,L){var B=8&t;t|=B?x:64,4&(t&=~(B?64:x))||(t&=-4);var U=[e,t,h,B?y:v,B?T:v,B?v:y,B?v:T,P,M,L],F=o.apply(v,U);return Xa(e)&&Pu(F,U),F.placeholder=s,Vs(F,e,t)}function wu(e){var t=Mn[e];return function(o,s){if(o=Ri(o),(s=s==null?0:Yt(St(s),292))&&Fa(o)){var h=(ze(o)+"e").split("e");return+((h=(ze(t(h[0]+"e"+(+h[1]+s)))+"e").split("e"))[0]+"e"+(+h[1]-s))}return t(o)}}var Sl=oo&&1/lu(new oo([,-0]))[1]==$?function(e){return new oo(e)}:Ur;function od(e){return function(t){var o=Wn(t);return o==W?uu(t):o==we?function(s){var h=-1,y=Array(s.size);return s.forEach(function(T){y[++h]=[T,T]}),y}(t):function(s,h){return It(h,function(y){return[y,s[y]]})}(t,e(t))}}function wo(e,t,o,s,h,y,T,P){var M=2&t;if(!M&&typeof e!="function")throw new Kt(O);var L=s?s.length:0;if(L||(t&=-97,s=h=v),T=T===v?T:Nt(St(T),0),P=P===v?P:St(P),L-=h?h.length:0,64&t){var B=s,U=h;s=h=v}var F=M?v:Vi(e),q=[e,t,o,s,h,B,U,y,T,P];if(F&&function(z,re){var ue=z[1],le=re[1],ve=ue|le,be=ve<131,ye=le==N&&ue==8||le==N&&ue==256&&z[7].length<=re[8]||le==384&&re[7].length<=re[8]&&ue==8;if(!be&&!ye)return z;1&le&&(z[2]=re[2],ve|=1&ue?0:4);var pe=re[3];if(pe){var Re=z[3];z[3]=Re?gl(Re,pe,re[4]):pe,z[4]=Re?ji(z[3],D):re[4]}(pe=re[5])&&(Re=z[5],z[5]=Re?vl(Re,pe,re[6]):pe,z[6]=Re?ji(z[5],D):re[6]),(pe=re[7])&&(z[7]=pe),le&N&&(z[8]=z[8]==null?re[8]:Yt(z[8],re[8])),z[9]==null&&(z[9]=re[9]),z[0]=re[0],z[1]=ve}(q,F),e=q[0],t=q[1],o=q[2],s=q[3],h=q[4],!(P=q[9]=q[9]===v?M?0:e.length:Nt(q[9]-L,0))&&24&t&&(t&=-25),t&&t!=1)Y=t==8||t==16?function(z,re,ue){var le=Ro(z);return function ve(){for(var be=arguments.length,ye=ge(be),pe=be,Re=qo(ve);pe--;)ye[pe]=arguments[pe];var Me=be<3&&ye[0]!==Re&&ye[be-1]!==Re?[]:ji(ye,Re);return(be-=Me.length)<ue?Nc(z,re,Ns,ve.placeholder,v,ye,Me,v,v,ue-be):gi(this&&this!==Qn&&this instanceof ve?le:z,this,ye)}}(e,t,P):t!=x&&t!=33||h.length?Ns.apply(v,q):function(z,re,ue,le){var ve=1&re,be=Ro(z);return function ye(){for(var pe=-1,Re=arguments.length,Me=-1,Le=le.length,Ae=ge(Le+Re),Pe=this&&this!==Qn&&this instanceof ye?be:z;++Me<Le;)Ae[Me]=le[Me];for(;Re--;)Ae[Me++]=arguments[++pe];return gi(Pe,ve?ue:this,Ae)}}(e,t,o,s);else var Y=function(z,re,ue){var le=1&re,ve=Ro(z);return function be(){return(this&&this!==Qn&&this instanceof be?ve:z).apply(le?ue:this,arguments)}}(e,t,o);return Vs((F?Vo:Pu)(Y,q),e,t)}function Io(e,t,o,s){return e===v||zi(e,bi[o])&&!rt.call(s,o)?t:e}function js(e,t,o,s,h,y){return Ct(e)&&Ct(t)&&(y.set(t,e),Wa(e,t,v,js,y),y.delete(t)),e}function Us(e){return po(e)?v:e}function Ja(e,t,o,s,h,y){var T=1&o,P=e.length,M=t.length;if(P!=M&&!(T&&M>P))return!1;var L=y.get(e),B=y.get(t);if(L&&B)return L==t&&B==e;var U=-1,F=!0,q=2&o?new si:v;for(y.set(e,t),y.set(t,e);++U<P;){var Y=e[U],z=t[U];if(s)var re=T?s(z,Y,U,t,e,y):s(Y,z,U,e,t,y);if(re!==v){if(re)continue;F=!1;break}if(q){if(!vs(t,function(ue,le){if(!Ss(q,le)&&(Y===ue||h(Y,ue,o,s,y)))return q.push(le)})){F=!1;break}}else if(Y!==z&&!h(Y,z,o,s,y)){F=!1;break}}return y.delete(e),y.delete(t),F}function ei(e){return ga(Au(e,v,Cl),e+"")}function Tr(e){return Ic(e,Rt,Ti)}function ko(e){return Ic(e,Gn,Lc)}var Vi=$a?function(e){return $a.get(e)}:Ur;function zo(e){for(var t=e.name+"",o=Fi[t],s=rt.call(Fi,t)?o.length:0;s--;){var h=o[s],y=h.func;if(y==null||y==e)return h.name}return t}function qo(e){return(rt.call(k,"placeholder")?k:e).placeholder}function st(){var e=k.iteratee||qu;return e=e===qu?vu:e,arguments.length?e(arguments[0],arguments[1]):e}function ot(e,t){var o,s,h=e.__data__;return((s=typeof(o=t))=="string"||s=="number"||s=="symbol"||s=="boolean"?o!=="__proto__":o===null)?h[typeof t=="string"?"string":"hash"]:h.map}function Fs(e){for(var t=Rt(e),o=t.length;o--;){var s=t[o],h=e[s];t[o]=[s,h,Za(h)]}return t}function Ko(e,t){var o=function(s,h){return s==null?v:s[h]}(e,t);return Ue(o)?o:v}var Ti=Cs?function(e){return e==null?[]:(e=pt(e),Bi(Cs(e),function(t){return Cc.call(e,t)}))}:Js,Lc=Cs?function(e){for(var t=[];e;)to(t,Ti(e)),e=La(e);return t}:Js,Wn=on;function mr(e,t,o){for(var s=-1,h=(t=pr(t,e)).length,y=!1;++s<h;){var T=Br(t[s]);if(!(y=e!=null&&o(e,T)))break;e=e[T]}return y||++s!=h?y:!!(h=e==null?0:e.length)&&_n(h)&&Oo(T,h)&&(wt(e)||Xe(e))}function Iu(e){return typeof e.constructor!="function"||Qa(e)?{}:ct(La(e))}function El(e){return wt(e)||Xe(e)||!!(dl&&e&&e[dl])}function Oo(e,t){var o=typeof e;return!!(t=t??H)&&(o=="number"||o!="symbol"&&Ce.test(e))&&e>-1&&e%1==0&&e<t}function Ln(e,t,o){if(!Ct(o))return!1;var s=typeof t;return!!(s=="number"?Wt(o)&&Oo(t,o.length):s=="string"&&t in o)&&zi(o[t],e)}function gr(e,t){if(wt(e))return!1;var o=typeof e;return!(o!="number"&&o!="symbol"&&o!="boolean"&&e!=null&&!kn(e))||$e.test(e)||!ke.test(e)||t!=null&&e in pt(t)}function Xa(e){var t=zo(e),o=k[t];if(typeof o!="function"||!(t in Fe.prototype))return!1;if(e===o)return!0;var s=Vi(o);return!!s&&e===s[0]}(Ts&&Wn(new Ts(new ArrayBuffer(1)))!=Vt||Oe&&Wn(new Oe)!=W||Sn&&Wn(Sn.resolve())!=he||oo&&Wn(new oo)!=we||Uo&&Wn(new Uo)!=vt)&&(Wn=function(e){var t=on(e),o=t==se?e.constructor:v,s=o?va(o):"";if(s)switch(s){case fh:return Vt;case Va:return W;case td:return he;case Nr:return we;case nd:return vt}return t});var ku=Ui?En:Bl;function Qa(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||bi)}function Za(e){return e==e&&!Ct(e)}function Ou(e,t){return function(o){return o!=null&&o[e]===t&&(t!==v||e in pt(o))}}function Au(e,t,o){return t=Nt(t===v?e.length-1:t,0),function(){for(var s=arguments,h=-1,y=Nt(s.length-t,0),T=ge(y);++h<y;)T[h]=s[t+h];h=-1;for(var P=ge(t+1);++h<t;)P[h]=s[h];return P[t]=o(T),gi(e,this,P)}}function rr(e,t){return t.length<2?e:Jr(e,kt(t,0,-1))}function $s(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]}var Pu=xu(Vo),es=Ql||function(e,t){return Qn.setTimeout(e,t)},ga=xu(Cr);function Vs(e,t,o){var s=t+"";return ga(e,function(h,y){var T=y.length;if(!T)return h;var P=T-1;return y[P]=(T>1?"& ":"")+y[P],y=y.join(T>2?", ":" "),h.replace(Hn,`{
/* [wrapped with `+y+`] */
`)}(s,function(h,y){return yi(Q,function(T){var P="_."+T[0];y&T[1]&&!Ma(h,P)&&h.push(P)}),h.sort()}(function(h){var y=h.match(Dt);return y?y[1].split(Mt):[]}(s),o)))}function xu(e){var t=0,o=0;return function(){var s=hu(),h=16-(s-o);if(o=s,h>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(v,arguments)}}function Ao(e,t){var o=-1,s=e.length,h=s-1;for(t=t===v?s:t;++o<t;){var y=Ac(o,h),T=e[y];e[y]=e[o],e[o]=T}return e.length=t,e}var Ws,Du,lo=(Ws=rs(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Te,function(o,s,h,y){t.push(h?y.replace(xr,"$1"):s||o)}),t},function(e){return Du.size===500&&Du.clear(),e}),Du=Ws.cache,Ws);function Br(e){if(typeof e=="string"||kn(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function va(e){if(e!=null){try{return Je.call(e)}catch{}try{return e+""}catch{}}return""}function ad(e){if(e instanceof Fe)return e.clone();var t=new In(e.__wrapped__,e.__chain__);return t.__actions__=Zr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var mh=Ot(function(e,t){return Pt(e)?co(e,Gt(t,1,Pt,!0)):[]}),_l=Ot(function(e,t){var o=ti(t);return Pt(o)&&(o=v),Pt(e)?co(e,Gt(t,1,Pt,!0),st(o,2)):[]}),Mu=Ot(function(e,t){var o=ti(t);return Pt(o)&&(o=v),Pt(e)?co(e,Gt(t,1,Pt,!0),v,o):[]});function Nu(e,t,o){var s=e==null?0:e.length;if(!s)return-1;var h=o==null?0:St(o);return h<0&&(h=Nt(s+h,0)),no(e,st(t,3),h)}function Bc(e,t,o){var s=e==null?0:e.length;if(!s)return-1;var h=s-1;return o!==v&&(h=St(o),h=o<0?Nt(s+h,0):Yt(h,s-1)),no(e,st(t,3),h,!0)}function Cl(e){return e!=null&&e.length?Gt(e,1):[]}function sd(e){return e&&e.length?e[0]:v}var gh=Ot(function(e){var t=It(e,$i);return t.length&&t[0]===e[0]?As(t):[]}),cd=Ot(function(e){var t=ti(e),o=It(e,$i);return t===ti(o)?t=v:o.pop(),o.length&&o[0]===e[0]?As(o,st(t,2)):[]}),Wi=Ot(function(e){var t=ti(e),o=It(e,$i);return(t=typeof t=="function"?t:v)&&o.pop(),o.length&&o[0]===e[0]?As(o,v,t):[]});function ti(e){var t=e==null?0:e.length;return t?e[t-1]:v}var ud=Ot(ld);function ld(e,t){return e&&e.length&&t&&t.length?Su(e,t):e}var ts=ei(function(e,t){var o=e==null?0:e.length,s=Rs(e,t);return Eu(e,It(t,function(h){return Oo(h,o)?+h:h}).sort(Tu)),s});function Gs(e){return e==null?e:ed.call(e)}var dd=Ot(function(e){return en(Gt(e,1,Pt,!0))}),vh=Ot(function(e){var t=ti(e);return Pt(t)&&(t=v),en(Gt(e,1,Pt,!0),st(t,2))}),Tl=Ot(function(e){var t=ti(e);return t=typeof t=="function"?t:v,en(Gt(e,1,Pt,!0),v,t)});function Lu(e){if(!e||!e.length)return[];var t=0;return e=Bi(e,function(o){if(Pt(o))return t=Nt(o.length,t),!0}),cu(t,function(o){return It(e,bs(o))})}function hd(e,t){if(!e||!e.length)return[];var o=Lu(e);return t==null?o:It(o,function(s){return gi(t,v,s)})}var yh=Ot(function(e,t){return Pt(e)?co(e,t):[]}),bh=Ot(function(e){return Cu(Bi(e,Pt))}),fd=Ot(function(e){var t=ti(e);return Pt(t)&&(t=v),Cu(Bi(e,Pt),st(t,2))}),Sh=Ot(function(e){var t=ti(e);return t=typeof t=="function"?t:v,Cu(Bi(e,Pt),v,t)}),Eh=Ot(Lu),Rl=Ot(function(e){var t=e.length,o=t>1?e[t-1]:v;return o=typeof o=="function"?(e.pop(),o):v,hd(e,o)});function jc(e){var t=k(e);return t.__chain__=!0,t}function Bu(e,t){return t(e)}var _h=ei(function(e){var t=e.length,o=t?e[0]:0,s=this.__wrapped__,h=function(y){return Rs(y,e)};return!(t>1||this.__actions__.length)&&s instanceof Fe&&Oo(o)?((s=s.slice(o,+o+(t?1:0))).__actions__.push({func:Bu,args:[h],thisArg:v}),new In(s,this.__chain__).thru(function(y){return t&&!y.length&&y.push(v),y})):this.thru(h)}),Ch=ui(function(e,t,o){rt.call(e,o)?++e[o]:qn(e,o,1)}),Th=Ms(Nu),pd=Ms(Bc);function wl(e,t){return(wt(e)?yi:_r)(e,st(t,3))}function md(e,t){return(wt(e)?au:pu)(e,st(t,3))}var Rh=ui(function(e,t,o){rt.call(e,o)?e[o].push(t):qn(e,o,[t])}),gd=Ot(function(e,t,o){var s=-1,h=typeof t=="function",y=Wt(e)?ge(e.length):[];return _r(e,function(T){y[++s]=h?gi(t,T,o):$o(T,t,o)}),y}),ns=ui(function(e,t,o){qn(e,o,t)});function Rr(e,t){return(wt(e)?It:Oc)(e,st(t,3))}var Gi=ui(function(e,t,o){e[o?0:1].push(t)},function(){return[[],[]]}),an=Ot(function(e,t){if(e==null)return[];var o=t.length;return o>1&&Ln(e,t[0],t[1])?t=[]:o>2&&Ln(t[0],t[1],t[2])&&(t=[t[0]]),bu(e,Gt(t,1),[])}),Uc=_s||function(){return Qn.Date.now()};function ju(e,t,o){return t=o?v:t,t=e&&t==null?e.length:t,wo(e,N,v,v,v,v,t)}function Uu(e,t){var o;if(typeof t!="function")throw new Kt(O);return e=St(e),function(){return--e>0&&(o=t.apply(this,arguments)),e<=1&&(t=v),o}}var Fc=Ot(function(e,t,o){var s=1;if(o.length){var h=ji(o,qo(Fc));s|=x}return wo(e,s,t,o,h)}),Fu=Ot(function(e,t,o){var s=3;if(o.length){var h=ji(o,qo(Fu));s|=x}return wo(t,s,e,o,h)});function vd(e,t,o){var s,h,y,T,P,M,L=0,B=!1,U=!1,F=!0;if(typeof e!="function")throw new Kt(O);function q(le){var ve=s,be=h;return s=h=v,L=le,T=e.apply(be,ve)}function Y(le){var ve=le-M;return M===v||ve>=t||ve<0||U&&le-L>=y}function z(){var le=Uc();if(Y(le))return re(le);P=es(z,function(ve){var be=t-(ve-M);return U?Yt(be,y-(ve-L)):be}(le))}function re(le){return P=v,F&&s?q(le):(s=h=v,T)}function ue(){var le=Uc(),ve=Y(le);if(s=arguments,h=this,M=le,ve){if(P===v)return function(be){return L=be,P=es(z,t),B?q(be):T}(M);if(U)return Ho(P),P=es(z,t),q(M)}return P===v&&(P=es(z,t)),T}return t=Ri(t)||0,Ct(o)&&(B=!!o.leading,y=(U="maxWait"in o)?Nt(Ri(o.maxWait)||0,t):y,F="trailing"in o?!!o.trailing:F),ue.cancel=function(){P!==v&&Ho(P),L=0,s=M=h=P=v},ue.flush=function(){return P===v?T:re(Uc())},ue}var wh=Ot(function(e,t){return wc(e,1,t)}),$u=Ot(function(e,t,o){return wc(e,Ri(t)||0,o)});function rs(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Kt(O);var o=function(){var s=arguments,h=t?t.apply(this,s):s[0],y=o.cache;if(y.has(h))return y.get(h);var T=e.apply(this,s);return o.cache=y.set(h,T)||y,T};return o.cache=new(rs.Cache||Fn),o}function Vu(e){if(typeof e!="function")throw new Kt(O);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}rs.Cache=Fn;var Il=uo(function(e,t){var o=(t=t.length==1&&wt(t[0])?It(t[0],Dr(st())):It(Gt(t,1),Dr(st()))).length;return Ot(function(s){for(var h=-1,y=Yt(s.length,o);++h<y;)s[h]=t[h].call(this,s[h]);return gi(e,this,s)})}),Hs=Ot(function(e,t){var o=ji(t,qo(Hs));return wo(e,x,v,t,o)}),wr=Ot(function(e,t){var o=ji(t,qo(wr));return wo(e,64,v,t,o)}),Hi=ei(function(e,t){return wo(e,256,v,v,v,t)});function zi(e,t){return e===t||e!=e&&t!=t}var Ih=Mc(Os),ho=Mc(function(e,t){return e>=t}),Xe=gu(function(){return arguments}())?gu:function(e){return Vn(e)&&rt.call(e,"callee")&&!Cc.call(e,"callee")},wt=ge.isArray,ni=gc?Dr(gc):function(e){return Vn(e)&&on(e)==Ut};function Wt(e){return e!=null&&_n(e.length)&&!En(e)}function Pt(e){return Vn(e)&&Wt(e)}var Yo=lh||Bl,Wu=iu?Dr(iu):function(e){return Vn(e)&&on(e)==ie};function fo(e){if(!Vn(e))return!1;var t=on(e);return t==de||t=="[object DOMException]"||typeof e.message=="string"&&typeof e.name=="string"&&!po(e)}function En(e){if(!Ct(e))return!1;var t=on(e);return t==ne||t==J||t=="[object AsyncFunction]"||t=="[object Proxy]"}function Jo(e){return typeof e=="number"&&e==St(e)}function _n(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function Ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Vn(e){return e!=null&&typeof e=="object"}var kl=ou?Dr(ou):function(e){return Vn(e)&&Wn(e)==W};function zs(e){return typeof e=="number"||Vn(e)&&on(e)==X}function po(e){if(!Vn(e)||on(e)!=se)return!1;var t=La(e);if(t===null)return!0;var o=rt.call(t,"constructor")&&t.constructor;return typeof o=="function"&&o instanceof o&&Je.call(o)==ah}var Kn=vc?Dr(vc):function(e){return Vn(e)&&on(e)==Ie},ya=gs?Dr(gs):function(e){return Vn(e)&&Wn(e)==we};function zt(e){return typeof e=="string"||!wt(e)&&Vn(e)&&on(e)==Qe}function kn(e){return typeof e=="symbol"||Vn(e)&&on(e)==Tt}var qs=Gr?Dr(Gr):function(e){return Vn(e)&&_n(e.length)&&!!ft[on(e)]},$c=Mc(nr),Vc=Mc(function(e,t){return e<=t});function An(e){if(!e)return[];if(Wt(e))return zt(e)?zn(e):Zr(e);if(jo&&e[jo])return function(o){for(var s,h=[];!(s=o.next()).done;)h.push(s.value);return h}(e[jo]());var t=Wn(e);return(t==W?uu:t==we?lu:as)(e)}function He(e){return e?(e=Ri(e))===$||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0}function St(e){var t=He(e),o=t%1;return t==t?o?t-o:t:0}function ri(e){return e?ci(St(e),0,ce):0}function Ri(e){if(typeof e=="number")return e;if(kn(e))return K;if(Ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=zr(e);var o=Zi.test(e);return o||fe.test(e)?rl(e.slice(2),o?2:8):mi.test(e)?K:+e}function xt(e){return $n(e,Gn(e))}function ze(e){return e==null?"":Qr(e)}var yd=Co(function(e,t){if(Qa(t)||Wt(t))$n(t,Rt(t),e);else for(var o in t)rt.call(t,o)&&so(e,o,t[o])}),Wc=Co(function(e,t){$n(t,Gn(t),e)}),Gu=Co(function(e,t,o,s){$n(t,Gn(t),e,s)}),kh=Co(function(e,t,o,s){$n(t,Rt(t),e,s)}),Hu=ei(Rs),ba=Ot(function(e,t){e=pt(e);var o=-1,s=t.length,h=s>2?t[2]:v;for(h&&Ln(t[0],t[1],h)&&(s=1);++o<s;)for(var y=t[o],T=Gn(y),P=-1,M=T.length;++P<M;){var L=T[P],B=e[L];(B===v||zi(B,bi[L])&&!rt.call(e,L))&&(e[L]=y[L])}return e}),is=Ot(function(e){return e.push(v,js),gi(mo,v,e)});function Gc(e,t,o){var s=e==null?v:Jr(e,t);return s===v?o:s}function Ol(e,t){return e!=null&&mr(e,t,id)}var Oh=li(function(e,t,o){t!=null&&typeof t.toString!="function"&&(t=ht.call(t)),e[t]=o},Hc(jr)),Ah=li(function(e,t,o){t!=null&&typeof t.toString!="function"&&(t=ht.call(t)),rt.call(e,t)?e[t].push(o):e[t]=[o]},st),cn=Ot($o);function Rt(e){return Wt(e)?_e(e):ha(e)}function Gn(e){return Wt(e)?_e(e,!0):function(t){if(!Ct(t))return function(y){var T=[];if(y!=null)for(var P in pt(y))T.push(P);return T}(t);var o=Qa(t),s=[];for(var h in t)(h!="constructor"||!o&&rt.call(t,h))&&s.push(h);return s}(e)}var os=Co(function(e,t,o){Wa(e,t,o)}),mo=Co(function(e,t,o,s){Wa(e,t,o,s)}),bd=ei(function(e,t){var o={};if(e==null)return o;var s=!1;t=It(t,function(y){return y=pr(y,e),s||(s=y.length>1),y}),$n(e,ko(e),o),s&&(o=Nn(o,7,Us));for(var h=t.length;h--;)_i(o,t[h]);return o}),zu=ei(function(e,t){return e==null?{}:function(o,s){return fa(o,s,function(h,y){return Ol(o,y)})}(e,t)});function go(e,t){if(e==null)return{};var o=It(ko(e),function(s){return[s]});return t=st(t),fa(e,o,function(s,h){return t(s,h[0])})}var Bn=od(Rt),Yn=od(Gn);function as(e){return e==null?[]:oa(e,Rt(e))}var Al=Ka(function(e,t,o){return t=t.toLowerCase(),e+(o?Pl(t):t)});function Pl(e){return Ys(ze(e).toLowerCase())}function xl(e){return(e=ze(e))&&e.replace(xe,ih).replace(Li,"")}var Sd=Ka(function(e,t,o){return e+(o?"-":"")+t.toLowerCase()}),Ph=Ka(function(e,t,o){return e+(o?" ":"")+t.toLowerCase()}),Ed=bl("toLowerCase"),Dl=Ka(function(e,t,o){return e+(o?"_":"")+t.toLowerCase()}),_d=Ka(function(e,t,o){return e+(o?" ":"")+Ys(t)}),Ks=Ka(function(e,t,o){return e+(o?" ":"")+t.toUpperCase()}),Ys=bl("toUpperCase");function Ml(e,t,o){return e=ze(e),(t=o?v:t)===v?function(s){return mc.test(s)}(e)?function(s){return s.match(Kl)||[]}(e):function(s){return s.match(Ke)||[]}(e):e.match(t)||[]}var Cd=Ot(function(e,t){try{return gi(e,v,t)}catch(o){return fo(o)?o:new We(o)}}),Ir=ei(function(e,t){return yi(t,function(o){o=Br(o),qn(e,o,Fc(e[o],e))}),e});function Hc(e){return function(){return e}}var Sa=Ru(),di=Ru(!0);function jr(e){return e}function qu(e){return vu(typeof e=="function"?e:Nn(e,1))}var Td=Ot(function(e,t){return function(o){return $o(o,e,t)}}),Nl=Ot(function(e,t){return function(o){return $o(e,o,t)}});function Jn(e,t,o){var s=Rt(t),h=Yr(t,s);o!=null||Ct(t)&&(h.length||!s.length)||(o=t,t=e,e=this,h=Yr(t,Rt(t)));var y=!(Ct(o)&&"chain"in o&&!o.chain),T=En(e);return yi(h,function(P){var M=t[P];e[P]=M,T&&(e.prototype[P]=function(){var L=this.__chain__;if(y||L){var B=e(this.__wrapped__);return(B.__actions__=Zr(this.__actions__)).push({func:M,args:arguments,thisArg:e}),B.__chain__=L,B}return M.apply(e,to([this.value()],arguments))})}),e}function Ur(){}var Ea=Ya(It),xh=Ya(eo),fn=Ya(vs);function Ll(e){return gr(e)?bs(Br(e)):function(t){return function(o){return Jr(o,t)}}(e)}var Dh=Dc(),ss=Dc(!0);function Js(){return[]}function Bl(){return!1}var _a,Mh=Ls(function(e,t){return e+t},0),u=wu("ceil"),i=Ls(function(e,t){return e/t},1),c=wu("floor"),l=Ls(function(e,t){return e*t},1),f=wu("round"),n=Ls(function(e,t){return e-t},0);return k.after=function(e,t){if(typeof t!="function")throw new Kt(O);return e=St(e),function(){if(--e<1)return t.apply(this,arguments)}},k.ary=ju,k.assign=yd,k.assignIn=Wc,k.assignInWith=Gu,k.assignWith=kh,k.at=Hu,k.before=Uu,k.bind=Fc,k.bindAll=Ir,k.bindKey=Fu,k.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return wt(e)?e:[e]},k.chain=jc,k.chunk=function(e,t,o){t=(o?Ln(e,t,o):t===v)?1:Nt(St(t),0);var s=e==null?0:e.length;if(!s||t<1)return[];for(var h=0,y=0,T=ge(ja(s/t));h<s;)T[y++]=kt(e,h,h+=t);return T},k.compact=function(e){for(var t=-1,o=e==null?0:e.length,s=0,h=[];++t<o;){var y=e[t];y&&(h[s++]=y)}return h},k.concat=function(){var e=arguments.length;if(!e)return[];for(var t=ge(e-1),o=arguments[0],s=e;s--;)t[s-1]=arguments[s];return to(wt(o)?Zr(o):[o],Gt(t,1))},k.cond=function(e){var t=e==null?0:e.length,o=st();return e=t?It(e,function(s){if(typeof s[1]!="function")throw new Kt(O);return[o(s[0]),s[1]]}):[],Ot(function(s){for(var h=-1;++h<t;){var y=e[h];if(gi(y[0],this,s))return gi(y[1],this,s)}})},k.conforms=function(e){return function(t){var o=Rt(t);return function(s){return Rc(s,t,o)}}(Nn(e,1))},k.constant=Hc,k.countBy=Ch,k.create=function(e,t){var o=ct(e);return t==null?o:fl(o,t)},k.curry=function e(t,o,s){var h=wo(t,8,v,v,v,v,v,o=s?v:o);return h.placeholder=e.placeholder,h},k.curryRight=function e(t,o,s){var h=wo(t,16,v,v,v,v,v,o=s?v:o);return h.placeholder=e.placeholder,h},k.debounce=vd,k.defaults=ba,k.defaultsDeep=is,k.defer=wh,k.delay=$u,k.difference=mh,k.differenceBy=_l,k.differenceWith=Mu,k.drop=function(e,t,o){var s=e==null?0:e.length;return s?kt(e,(t=o||t===v?1:St(t))<0?0:t,s):[]},k.dropRight=function(e,t,o){var s=e==null?0:e.length;return s?kt(e,0,(t=s-(t=o||t===v?1:St(t)))<0?0:t):[]},k.dropRightWhile=function(e,t){return e&&e.length?Wo(e,st(t,3),!0,!0):[]},k.dropWhile=function(e,t){return e&&e.length?Wo(e,st(t,3),!0):[]},k.fill=function(e,t,o,s){var h=e==null?0:e.length;return h?(o&&typeof o!="number"&&Ln(e,t,o)&&(o=0,s=h),function(y,T,P,M){var L=y.length;for((P=St(P))<0&&(P=-P>L?0:L+P),(M=M===v||M>L?L:St(M))<0&&(M+=L),M=P>M?0:ri(M);P<M;)y[P++]=T;return y}(e,t,o,s)):[]},k.filter=function(e,t){return(wt(e)?Bi:mu)(e,st(t,3))},k.flatMap=function(e,t){return Gt(Rr(e,t),1)},k.flatMapDeep=function(e,t){return Gt(Rr(e,t),$)},k.flatMapDepth=function(e,t,o){return o=o===v?1:St(o),Gt(Rr(e,t),o)},k.flatten=Cl,k.flattenDeep=function(e){return e!=null&&e.length?Gt(e,$):[]},k.flattenDepth=function(e,t){return e!=null&&e.length?Gt(e,t=t===v?1:St(t)):[]},k.flip=function(e){return wo(e,512)},k.flow=Sa,k.flowRight=di,k.fromPairs=function(e){for(var t=-1,o=e==null?0:e.length,s={};++t<o;){var h=e[t];s[h[0]]=h[1]}return s},k.functions=function(e){return e==null?[]:Yr(e,Rt(e))},k.functionsIn=function(e){return e==null?[]:Yr(e,Gn(e))},k.groupBy=Rh,k.initial=function(e){return e!=null&&e.length?kt(e,0,-1):[]},k.intersection=gh,k.intersectionBy=cd,k.intersectionWith=Wi,k.invert=Oh,k.invertBy=Ah,k.invokeMap=gd,k.iteratee=qu,k.keyBy=ns,k.keys=Rt,k.keysIn=Gn,k.map=Rr,k.mapKeys=function(e,t){var o={};return t=st(t,3),tr(e,function(s,h,y){qn(o,t(s,h,y),s)}),o},k.mapValues=function(e,t){var o={};return t=st(t,3),tr(e,function(s,h,y){qn(o,h,t(s,h,y))}),o},k.matches=function(e){return yu(Nn(e,1))},k.matchesProperty=function(e,t){return ml(e,Nn(t,1))},k.memoize=rs,k.merge=os,k.mergeWith=mo,k.method=Td,k.methodOf=Nl,k.mixin=Jn,k.negate=Vu,k.nthArg=function(e){return e=St(e),Ot(function(t){return Ps(t,e)})},k.omit=bd,k.omitBy=function(e,t){return go(e,Vu(st(t)))},k.once=function(e){return Uu(2,e)},k.orderBy=function(e,t,o,s){return e==null?[]:(wt(t)||(t=t==null?[]:[t]),wt(o=s?v:o)||(o=o==null?[]:[o]),bu(e,t,o))},k.over=Ea,k.overArgs=Il,k.overEvery=xh,k.overSome=fn,k.partial=Hs,k.partialRight=wr,k.partition=Gi,k.pick=zu,k.pickBy=go,k.property=Ll,k.propertyOf=function(e){return function(t){return e==null?v:Jr(e,t)}},k.pull=ud,k.pullAll=ld,k.pullAllBy=function(e,t,o){return e&&e.length&&t&&t.length?Su(e,t,st(o,2)):e},k.pullAllWith=function(e,t,o){return e&&e.length&&t&&t.length?Su(e,t,v,o):e},k.pullAt=ts,k.range=Dh,k.rangeRight=ss,k.rearg=Hi,k.reject=function(e,t){return(wt(e)?Bi:mu)(e,Vu(st(t,3)))},k.remove=function(e,t){var o=[];if(!e||!e.length)return o;var s=-1,h=[],y=e.length;for(t=st(t,3);++s<y;){var T=e[s];t(T,s,e)&&(o.push(T),h.push(s))}return Eu(e,h),o},k.rest=function(e,t){if(typeof e!="function")throw new Kt(O);return Ot(e,t=t===v?t:St(t))},k.reverse=Gs,k.sampleSize=function(e,t,o){return t=(o?Ln(e,t,o):t===v)?1:St(t),(wt(e)?ph:Ds)(e,t)},k.set=function(e,t,o){return e==null?e:Xr(e,t,o)},k.setWith=function(e,t,o,s){return s=typeof s=="function"?s:v,e==null?e:Xr(e,t,o,s)},k.shuffle=function(e){return(wt(e)?fu:pa)(e)},k.slice=function(e,t,o){var s=e==null?0:e.length;return s?(o&&typeof o!="number"&&Ln(e,t,o)?(t=0,o=s):(t=t==null?0:St(t),o=o===v?s:St(o)),kt(e,t,o)):[]},k.sortBy=an,k.sortedUniq=function(e){return e&&e.length?Pc(e):[]},k.sortedUniqBy=function(e,t){return e&&e.length?Pc(e,st(t,2)):[]},k.split=function(e,t,o){return o&&typeof o!="number"&&Ln(e,t,o)&&(t=o=v),(o=o===v?ce:o>>>0)?(e=ze(e))&&(typeof t=="string"||t!=null&&!Kn(t))&&!(t=Qr(t))&&aa(e)?Ci(zn(e),0,o):e.split(t,o):[]},k.spread=function(e,t){if(typeof e!="function")throw new Kt(O);return t=t==null?0:Nt(St(t),0),Ot(function(o){var s=o[t],h=Ci(o,0,t);return s&&to(h,s),gi(e,this,h)})},k.tail=function(e){var t=e==null?0:e.length;return t?kt(e,1,t):[]},k.take=function(e,t,o){return e&&e.length?kt(e,0,(t=o||t===v?1:St(t))<0?0:t):[]},k.takeRight=function(e,t,o){var s=e==null?0:e.length;return s?kt(e,(t=s-(t=o||t===v?1:St(t)))<0?0:t,s):[]},k.takeRightWhile=function(e,t){return e&&e.length?Wo(e,st(t,3),!1,!0):[]},k.takeWhile=function(e,t){return e&&e.length?Wo(e,st(t,3)):[]},k.tap=function(e,t){return t(e),e},k.throttle=function(e,t,o){var s=!0,h=!0;if(typeof e!="function")throw new Kt(O);return Ct(o)&&(s="leading"in o?!!o.leading:s,h="trailing"in o?!!o.trailing:h),vd(e,t,{leading:s,maxWait:t,trailing:h})},k.thru=Bu,k.toArray=An,k.toPairs=Bn,k.toPairsIn=Yn,k.toPath=function(e){return wt(e)?It(e,Br):kn(e)?[e]:Zr(lo(ze(e)))},k.toPlainObject=xt,k.transform=function(e,t,o){var s=wt(e),h=s||Yo(e)||qs(e);if(t=st(t,4),o==null){var y=e&&e.constructor;o=h?s?new y:[]:Ct(e)&&En(y)?ct(La(e)):{}}return(h?yi:tr)(e,function(T,P,M){return t(o,T,P,M)}),o},k.unary=function(e){return ju(e,1)},k.union=dd,k.unionBy=vh,k.unionWith=Tl,k.uniq=function(e){return e&&e.length?en(e):[]},k.uniqBy=function(e,t){return e&&e.length?en(e,st(t,2)):[]},k.uniqWith=function(e,t){return t=typeof t=="function"?t:v,e&&e.length?en(e,v,t):[]},k.unset=function(e,t){return e==null||_i(e,t)},k.unzip=Lu,k.unzipWith=hd,k.update=function(e,t,o){return e==null?e:Ha(e,t,Go(o))},k.updateWith=function(e,t,o,s){return s=typeof s=="function"?s:v,e==null?e:Ha(e,t,Go(o),s)},k.values=as,k.valuesIn=function(e){return e==null?[]:oa(e,Gn(e))},k.without=yh,k.words=Ml,k.wrap=function(e,t){return Hs(Go(t),e)},k.xor=bh,k.xorBy=fd,k.xorWith=Sh,k.zip=Eh,k.zipObject=function(e,t){return _o(e||[],t||[],so)},k.zipObjectDeep=function(e,t){return _o(e||[],t||[],Xr)},k.zipWith=Rl,k.entries=Bn,k.entriesIn=Yn,k.extend=Wc,k.extendWith=Gu,Jn(k,k),k.add=Mh,k.attempt=Cd,k.camelCase=Al,k.capitalize=Pl,k.ceil=u,k.clamp=function(e,t,o){return o===v&&(o=t,t=v),o!==v&&(o=(o=Ri(o))==o?o:0),t!==v&&(t=(t=Ri(t))==t?t:0),ci(Ri(e),t,o)},k.clone=function(e){return Nn(e,4)},k.cloneDeep=function(e){return Nn(e,5)},k.cloneDeepWith=function(e,t){return Nn(e,5,t=typeof t=="function"?t:v)},k.cloneWith=function(e,t){return Nn(e,4,t=typeof t=="function"?t:v)},k.conformsTo=function(e,t){return t==null||Rc(e,t,Rt(t))},k.deburr=xl,k.defaultTo=function(e,t){return e==null||e!=e?t:e},k.divide=i,k.endsWith=function(e,t,o){e=ze(e),t=Qr(t);var s=e.length,h=o=o===v?s:ci(St(o),0,s);return(o-=t.length)>=0&&e.slice(o,h)==t},k.eq=zi,k.escape=function(e){return(e=ze(e))&&lr.test(e)?e.replace(oi,oh):e},k.escapeRegExp=function(e){return(e=ze(e))&&lt.test(e)?e.replace(tt,"\\$&"):e},k.every=function(e,t,o){var s=wt(e)?eo:pl;return o&&Ln(e,t,o)&&(t=v),s(e,st(t,3))},k.find=Th,k.findIndex=Nu,k.findKey=function(e,t){return yc(e,st(t,3),tr)},k.findLast=pd,k.findLastIndex=Bc,k.findLastKey=function(e,t){return yc(e,st(t,3),ks)},k.floor=c,k.forEach=wl,k.forEachRight=md,k.forIn=function(e,t){return e==null?e:ws(e,st(t,3),Gn)},k.forInRight=function(e,t){return e==null?e:Is(e,st(t,3),Gn)},k.forOwn=function(e,t){return e&&tr(e,st(t,3))},k.forOwnRight=function(e,t){return e&&ks(e,st(t,3))},k.get=Gc,k.gt=Ih,k.gte=ho,k.has=function(e,t){return e!=null&&mr(e,t,rd)},k.hasIn=Ol,k.head=sd,k.identity=jr,k.includes=function(e,t,o,s){e=Wt(e)?e:as(e),o=o&&!s?St(o):0;var h=e.length;return o<0&&(o=Nt(h+o,0)),zt(e)?o<=h&&e.indexOf(t,o)>-1:!!h&&ys(e,t,o)>-1},k.indexOf=function(e,t,o){var s=e==null?0:e.length;if(!s)return-1;var h=o==null?0:St(o);return h<0&&(h=Nt(s+h,0)),ys(e,t,h)},k.inRange=function(e,t,o){return t=He(t),o===v?(o=t,t=0):o=He(o),function(s,h,y){return s>=Yt(h,y)&&s<Nt(h,y)}(e=Ri(e),t,o)},k.invoke=cn,k.isArguments=Xe,k.isArray=wt,k.isArrayBuffer=ni,k.isArrayLike=Wt,k.isArrayLikeObject=Pt,k.isBoolean=function(e){return e===!0||e===!1||Vn(e)&&on(e)==G},k.isBuffer=Yo,k.isDate=Wu,k.isElement=function(e){return Vn(e)&&e.nodeType===1&&!po(e)},k.isEmpty=function(e){if(e==null)return!0;if(Wt(e)&&(wt(e)||typeof e=="string"||typeof e.splice=="function"||Yo(e)||qs(e)||Xe(e)))return!e.length;var t=Wn(e);if(t==W||t==we)return!e.size;if(Qa(e))return!ha(e).length;for(var o in e)if(rt.call(e,o))return!1;return!0},k.isEqual=function(e,t){return Eo(e,t)},k.isEqualWith=function(e,t,o){var s=(o=typeof o=="function"?o:v)?o(e,t):v;return s===v?Eo(e,t,v,o):!!s},k.isError=fo,k.isFinite=function(e){return typeof e=="number"&&Fa(e)},k.isFunction=En,k.isInteger=Jo,k.isLength=_n,k.isMap=kl,k.isMatch=function(e,t){return e===t||kc(e,t,Fs(t))},k.isMatchWith=function(e,t,o){return o=typeof o=="function"?o:v,kc(e,t,Fs(t),o)},k.isNaN=function(e){return zs(e)&&e!=+e},k.isNative=function(e){if(ku(e))throw new We("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ue(e)},k.isNil=function(e){return e==null},k.isNull=function(e){return e===null},k.isNumber=zs,k.isObject=Ct,k.isObjectLike=Vn,k.isPlainObject=po,k.isRegExp=Kn,k.isSafeInteger=function(e){return Jo(e)&&e>=-9007199254740991&&e<=H},k.isSet=ya,k.isString=zt,k.isSymbol=kn,k.isTypedArray=qs,k.isUndefined=function(e){return e===v},k.isWeakMap=function(e){return Vn(e)&&Wn(e)==vt},k.isWeakSet=function(e){return Vn(e)&&on(e)=="[object WeakSet]"},k.join=function(e,t){return e==null?"":dh.call(e,t)},k.kebabCase=Sd,k.last=ti,k.lastIndexOf=function(e,t,o){var s=e==null?0:e.length;if(!s)return-1;var h=s;return o!==v&&(h=(h=St(o))<0?Nt(s+h,0):Yt(h,s-1)),t==t?function(y,T,P){for(var M=P+1;M--;)if(y[M]===T)return M;return M}(e,t,h):no(e,al,h,!0)},k.lowerCase=Ph,k.lowerFirst=Ed,k.lt=$c,k.lte=Vc,k.max=function(e){return e&&e.length?da(e,jr,Os):v},k.maxBy=function(e,t){return e&&e.length?da(e,st(t,2),Os):v},k.mean=function(e){return Hr(e,jr)},k.meanBy=function(e,t){return Hr(e,st(t,2))},k.min=function(e){return e&&e.length?da(e,jr,nr):v},k.minBy=function(e,t){return e&&e.length?da(e,st(t,2),nr):v},k.stubArray=Js,k.stubFalse=Bl,k.stubObject=function(){return{}},k.stubString=function(){return""},k.stubTrue=function(){return!0},k.multiply=l,k.nth=function(e,t){return e&&e.length?Ps(e,St(t)):v},k.noConflict=function(){return Qn._===this&&(Qn._=sh),this},k.noop=Ur,k.now=Uc,k.pad=function(e,t,o){e=ze(e);var s=(t=St(t))?ro(e):0;if(!t||s>=t)return e;var h=(t-s)/2;return Bs(Ua(h),o)+e+Bs(ja(h),o)},k.padEnd=function(e,t,o){e=ze(e);var s=(t=St(t))?ro(e):0;return t&&s<t?e+Bs(t-s,o):e},k.padStart=function(e,t,o){e=ze(e);var s=(t=St(t))?ro(e):0;return t&&s<t?Bs(t-s,o)+e:e},k.parseInt=function(e,t,o){return o||t==null?t=0:t&&(t=+t),hh(ze(e).replace(Ve,""),t||0)},k.random=function(e,t,o){if(o&&typeof o!="boolean"&&Ln(e,t,o)&&(t=o=v),o===v&&(typeof t=="boolean"?(o=t,t=v):typeof e=="boolean"&&(o=e,e=v)),e===v&&t===v?(e=0,t=1):(e=He(e),t===v?(t=e,e=0):t=He(t)),e>t){var s=e;e=t,t=s}if(o||e%1||t%1){var h=Tc();return Yt(e+h*(t-e+nl("1e-"+((h+"").length-1))),t)}return Ac(e,t)},k.reduce=function(e,t,o){var s=wt(e)?il:su,h=arguments.length<3;return s(e,st(t,4),o,h,_r)},k.reduceRight=function(e,t,o){var s=wt(e)?ol:su,h=arguments.length<3;return s(e,st(t,4),o,h,pu)},k.repeat=function(e,t,o){return t=(o?Ln(e,t,o):t===v)?1:St(t),xs(ze(e),t)},k.replace=function(){var e=arguments,t=ze(e[0]);return e.length<3?t:t.replace(e[1],e[2])},k.result=function(e,t,o){var s=-1,h=(t=pr(t,e)).length;for(h||(h=1,e=v);++s<h;){var y=e==null?v:e[Br(t[s])];y===v&&(s=h,y=o),e=En(y)?y.call(e):y}return e},k.round=f,k.runInContext=V,k.sample=function(e){return(wt(e)?Kr:_t)(e)},k.size=function(e){if(e==null)return 0;if(Wt(e))return zt(e)?ro(e):e.length;var t=Wn(e);return t==W||t==we?e.size:ha(e).length},k.snakeCase=Dl,k.some=function(e,t,o){var s=wt(e)?vs:Si;return o&&Ln(e,t,o)&&(t=v),s(e,st(t,3))},k.sortedIndex=function(e,t){return Ei(e,t)},k.sortedIndexBy=function(e,t,o){return Ga(e,t,st(o,2))},k.sortedIndexOf=function(e,t){var o=e==null?0:e.length;if(o){var s=Ei(e,t);if(s<o&&zi(e[s],t))return s}return-1},k.sortedLastIndex=function(e,t){return Ei(e,t,!0)},k.sortedLastIndexBy=function(e,t,o){return Ga(e,t,st(o,2),!0)},k.sortedLastIndexOf=function(e,t){if(e!=null&&e.length){var o=Ei(e,t,!0)-1;if(zi(e[o],t))return o}return-1},k.startCase=_d,k.startsWith=function(e,t,o){return e=ze(e),o=o==null?0:ci(St(o),0,e.length),t=Qr(t),e.slice(o,o+t.length)==t},k.subtract=n,k.sum=function(e){return e&&e.length?Sc(e,jr):0},k.sumBy=function(e,t){return e&&e.length?Sc(e,st(t,2)):0},k.template=function(e,t,o){var s=k.templateSettings;o&&Ln(e,t,o)&&(t=v),e=ze(e),t=Gu({},t,s,Io);var h,y,T=Gu({},t.imports,s.imports,Io),P=Rt(T),M=oa(T,P),L=0,B=t.interpolate||dt,U="__p += '",F=Ec((t.escape||dt).source+"|"+B.source+"|"+(B===Ee?Mo:dt).source+"|"+(t.evaluate||dt).source+"|$","g"),q="//# sourceURL="+(rt.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++bn+"]")+`
`;e.replace(F,function(re,ue,le,ve,be,ye){return le||(le=ve),U+=e.slice(L,ye).replace(vn,Es),ue&&(h=!0,U+=`' +
__e(`+ue+`) +
'`),be&&(y=!0,U+=`';
`+be+`;
__p += '`),le&&(U+=`' +
((__t = (`+le+`)) == null ? '' : __t) +
'`),L=ye+re.length,re}),U+=`';
`;var Y=rt.call(t,"variable")&&t.variable;if(Y){if(Pr.test(Y))throw new We("Invalid `variable` option passed into `_.template`")}else U=`with (obj) {
`+U+`
}
`;U=(y?U.replace(ra,""):U).replace(Qt,"$1").replace(xi,"$1;"),U="function("+(Y||"obj")+`) {
`+(Y?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(h?", __e = _.escape":"")+(y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var z=Cd(function(){return mt(P,q+"return "+U).apply(v,M)});if(z.source=U,fo(z))throw z;return z},k.times=function(e,t){if((e=St(e))<1||e>H)return[];var o=ce,s=Yt(e,ce);t=st(t),e-=ce;for(var h=cu(s,t);++o<e;)t(o);return h},k.toFinite=He,k.toInteger=St,k.toLength=ri,k.toLower=function(e){return ze(e).toLowerCase()},k.toNumber=Ri,k.toSafeInteger=function(e){return e?ci(St(e),-9007199254740991,H):e===0?e:0},k.toString=ze,k.toUpper=function(e){return ze(e).toUpperCase()},k.trim=function(e,t,o){if((e=ze(e))&&(o||t===v))return zr(e);if(!e||!(t=Qr(t)))return e;var s=zn(e),h=zn(t);return Ci(s,sl(s,h),Xl(s,h)+1).join("")},k.trimEnd=function(e,t,o){if((e=ze(e))&&(o||t===v))return e.slice(0,Un(e)+1);if(!e||!(t=Qr(t)))return e;var s=zn(e);return Ci(s,0,Xl(s,zn(t))+1).join("")},k.trimStart=function(e,t,o){if((e=ze(e))&&(o||t===v))return e.replace(Ve,"");if(!e||!(t=Qr(t)))return e;var s=zn(e);return Ci(s,sl(s,zn(t))).join("")},k.truncate=function(e,t){var o=30,s="...";if(Ct(t)){var h="separator"in t?t.separator:h;o="length"in t?St(t.length):o,s="omission"in t?Qr(t.omission):s}var y=(e=ze(e)).length;if(aa(e)){var T=zn(e);y=T.length}if(o>=y)return e;var P=o-ro(s);if(P<1)return s;var M=T?Ci(T,0,P).join(""):e.slice(0,P);if(h===v)return M+s;if(T&&(P+=M.length-P),Kn(h)){if(e.slice(P).search(h)){var L,B=M;for(h.global||(h=Ec(h.source,ze(Mi.exec(h))+"g")),h.lastIndex=0;L=h.exec(B);)var U=L.index;M=M.slice(0,U===v?P:U)}}else if(e.indexOf(Qr(h),P)!=P){var F=M.lastIndexOf(h);F>-1&&(M=M.slice(0,F))}return M+s},k.unescape=function(e){return(e=ze(e))&&Qi.test(e)?e.replace(Di,du):e},k.uniqueId=function(e){var t=++cl;return ze(e)+t},k.upperCase=Ks,k.upperFirst=Ys,k.each=wl,k.eachRight=md,k.first=sd,Jn(k,(_a={},tr(k,function(e,t){rt.call(k.prototype,t)||(_a[t]=e)}),_a),{chain:!1}),k.VERSION="4.17.21",yi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){k[e].placeholder=k}),yi(["drop","take"],function(e,t){Fe.prototype[e]=function(o){o=o===v?1:Nt(St(o),0);var s=this.__filtered__&&!t?new Fe(this):this.clone();return s.__filtered__?s.__takeCount__=Yt(o,s.__takeCount__):s.__views__.push({size:Yt(o,ce),type:e+(s.__dir__<0?"Right":"")}),s},Fe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),yi(["filter","map","takeWhile"],function(e,t){var o=t+1,s=o==1||o==3;Fe.prototype[e]=function(h){var y=this.clone();return y.__iteratees__.push({iteratee:st(h,3),type:o}),y.__filtered__=y.__filtered__||s,y}}),yi(["head","last"],function(e,t){var o="take"+(t?"Right":"");Fe.prototype[e]=function(){return this[o](1).value()[0]}}),yi(["initial","tail"],function(e,t){var o="drop"+(t?"":"Right");Fe.prototype[e]=function(){return this.__filtered__?new Fe(this):this[o](1)}}),Fe.prototype.compact=function(){return this.filter(jr)},Fe.prototype.find=function(e){return this.filter(e).head()},Fe.prototype.findLast=function(e){return this.reverse().find(e)},Fe.prototype.invokeMap=Ot(function(e,t){return typeof e=="function"?new Fe(this):this.map(function(o){return $o(o,e,t)})}),Fe.prototype.reject=function(e){return this.filter(Vu(st(e)))},Fe.prototype.slice=function(e,t){e=St(e);var o=this;return o.__filtered__&&(e>0||t<0)?new Fe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),t!==v&&(o=(t=St(t))<0?o.dropRight(-t):o.take(t-e)),o)},Fe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Fe.prototype.toArray=function(){return this.take(ce)},tr(Fe.prototype,function(e,t){var o=/^(?:filter|find|map|reject)|While$/.test(t),s=/^(?:head|last)$/.test(t),h=k[s?"take"+(t=="last"?"Right":""):t],y=s||/^find/.test(t);h&&(k.prototype[t]=function(){var T=this.__wrapped__,P=s?[1]:arguments,M=T instanceof Fe,L=P[0],B=M||wt(T),U=function(ue){var le=h.apply(k,to([ue],P));return s&&F?le[0]:le};B&&o&&typeof L=="function"&&L.length!=1&&(M=B=!1);var F=this.__chain__,q=!!this.__actions__.length,Y=y&&!F,z=M&&!q;if(!y&&B){T=z?T:new Fe(this);var re=e.apply(T,P);return re.__actions__.push({func:Bu,args:[U],thisArg:v}),new In(re,F)}return Y&&z?e.apply(this,P):(re=this.thru(U),Y?s?re.value()[0]:re.value():re)})}),yi(["pop","push","shift","sort","splice","unshift"],function(e){var t=Bo[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);k.prototype[e]=function(){var h=arguments;if(s&&!this.__chain__){var y=this.value();return t.apply(wt(y)?y:[],h)}return this[o](function(T){return t.apply(wt(T)?T:[],h)})}}),tr(Fe.prototype,function(e,t){var o=k[t];if(o){var s=o.name+"";rt.call(Fi,s)||(Fi[s]=[]),Fi[s].push({name:t,func:o})}}),Fi[Ns(v,2).name]=[{name:"wrapper",func:v}],Fe.prototype.clone=function(){var e=new Fe(this.__wrapped__);return e.__actions__=Zr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Zr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Zr(this.__views__),e},Fe.prototype.reverse=function(){if(this.__filtered__){var e=new Fe(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Fe.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,o=wt(e),s=t<0,h=o?e.length:0,y=function(ye,pe,Re){for(var Me=-1,Le=Re.length;++Me<Le;){var Ae=Re[Me],Pe=Ae.size;switch(Ae.type){case"drop":ye+=Pe;break;case"dropRight":pe-=Pe;break;case"take":pe=Yt(pe,ye+Pe);break;case"takeRight":ye=Nt(ye,pe-Pe)}}return{start:ye,end:pe}}(0,h,this.__views__),T=y.start,P=y.end,M=P-T,L=s?P:T-1,B=this.__iteratees__,U=B.length,F=0,q=Yt(M,this.__takeCount__);if(!o||!s&&h==M&&q==M)return za(e,this.__actions__);var Y=[];e:for(;M--&&F<q;){for(var z=-1,re=e[L+=t];++z<U;){var ue=B[z],le=ue.iteratee,ve=ue.type,be=le(re);if(ve==2)re=be;else if(!be){if(ve==1)continue e;break e}}Y[F++]=re}return Y},k.prototype.at=_h,k.prototype.chain=function(){return jc(this)},k.prototype.commit=function(){return new In(this.value(),this.__chain__)},k.prototype.next=function(){this.__values__===v&&(this.__values__=An(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?v:this.__values__[this.__index__++]}},k.prototype.plant=function(e){for(var t,o=this;o instanceof ao;){var s=ad(o);s.__index__=0,s.__values__=v,t?h.__wrapped__=s:t=s;var h=s;o=o.__wrapped__}return h.__wrapped__=e,t},k.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Fe){var t=e;return this.__actions__.length&&(t=new Fe(this)),(t=t.reverse()).__actions__.push({func:Bu,args:[Gs],thisArg:v}),new In(t,this.__chain__)}return this.thru(Gs)},k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=function(){return za(this.__wrapped__,this.__actions__)},k.prototype.first=k.prototype.head,jo&&(k.prototype[jo]=function(){return this}),k}();Qn._=Na,(C=(function(){return Na}).call(_,A,_,I))===v||(I.exports=C)}).call(this)},815:function(I,_){var A,C,v=this&&this.__extends||(A=function(J,W){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,se){X.__proto__=se}||function(X,se){for(var he in se)Object.prototype.hasOwnProperty.call(se,he)&&(X[he]=se[he])},A(J,W)},function(J,W){if(typeof W!="function"&&W!==null)throw new TypeError("Class extends value "+String(W)+" is not a constructor or null");function X(){this.constructor=J}A(J,W),J.prototype=W===null?Object.create(W):(X.prototype=W.prototype,new X)});function O(J){return 60*J*60}function j(J,W){var X={};return Object.assign(X,J),W&&Object.assign(X,W),X}Object.defineProperty(_,"__esModule",{value:!0}),_.DeviceConfigPropertyHolder=_.DeviceConfigManager=_.DeviceConfigEnv=void 0,function(J){J.BETA="beta",J.PROD="prod",J.CUSTOM="custom"}(C||(_.DeviceConfigEnv=C={}));var D=function(J){function W(X){return J.call(this,X)||this}return v(W,J),W}(Error),x="data",N=O(2),$="base64",H=function(){function J(W,X){var se,he,Ie,we,Qe,Tt,vt,Ut;if(!X.fileKey)throw new Error("options.fileKey cannot be empty");var Vt=(se=X.clock)!==null&&se!==void 0?se:new ie,Ht=Vt.getMillis();switch(this.context=W,this.fileKey=X.fileKey,this.env=X.standardEnv,X.standardEnv){case C.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case C.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case C.CUSTOM:if(!X.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=X.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(X.standardEnv))}this.trace=(he=X.trace)!==null&&he!==void 0?he:new Z(X.enableConsoleLog),this.fetch=(Ie=X.fetch)!==null&&Ie!==void 0?Ie:new Q(W),this.storage=new G("amazon_ivs_device_config_v1_"+X.fileKey,W.localStorage),this.state=new ne(this.storage,"state"),this.refresh={refreshIntervalSeconds:(we=X.refresh.refreshIntervalSeconds)!==null&&we!==void 0?we:900,retryCount:(Qe=X.refresh.retryCount)!==null&&Qe!==void 0?Qe:3,retryIntervalSeconds:(Tt=X.refresh.retryIntervalSeconds)!==null&&Tt!==void 0?Tt:10,maxCacheAgeSeconds:(vt=X.refresh.maxCacheAgeSeconds)!==null&&vt!==void 0?vt:259200,stopRefreshAfterSeconds:(Ut=X.refresh.stopRefreshAfterSeconds)!==null&&Ut!==void 0?Ut:N,canRefreshNow:X.refresh.canRefreshNow},this.emitMetrics=X.emitMetrics,this.analyticsProperties=X.analyticsProperties,this.enableConsoleLog=X.enableConsoleLog,this.clock=Vt,this.isInitialRefreshDone=!1;var Ge=0,At=this.state.getState();At&&At.fetchServer===this.fetchServer&&At.lastFetchWhenMs&&(Ge=At.lastFetchWhenMs);var rn,gn=Vt.getMillis(),Dn=(gn-Ge)/1e3;if(Dn<=this.refresh.maxCacheAgeSeconds){var ur=this.storage.getJson(x);ur&&ur.fetchServer===this.fetchServer&&this.setData(ur.json)}this.lastUseMs=gn,Dn>=this.refresh.refreshIntervalSeconds||Ge==0?rn=0:(rn=Math.round(this.refresh.refreshIntervalSeconds-Dn),this.isInitialRefreshDone=!0),rn<5&&(rn=5),this.trace.onTrace("Will start refresh in "+rn+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*rn);var it=Vt.getMillis();this.initialLoadTime=it-Ht}return J.getInstance=function(W,X){try{if(!(W.fetch&&W.setTimeout&&W.clearTimeout&&W.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(se){return void console.error("Error checking for context properties "+se)}if(this.gInstance){if(this.gInstance.fileKey!=X.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(X.fileKey));return this.gInstance}return this.gInstance=new J(W,X),this.gInstance},J.prototype.getConfigurationHolder=function(W){var X,se=this.clock.getMillis();this.lastUseMs=se;var he=(X=W.analytics)!==null&&X!==void 0?X:new Se(this.enableConsoleLog),Ie=0,we=this.state.getState();return we&&we.fetchServer===this.fetchServer&&we.lastFetchWhenMs&&(Ie=we.lastFetchWhenMs),(se-Ie)/1e3<=this.refresh.maxCacheAgeSeconds?new K(he,this.analyticsProperties,this.properties,Ie,this.clock):new K(he,void 0,void 0,0,this.clock)},J.prototype.getFetchUrl=function(){var W="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),X=new URL(W);return X.searchParams.set("version","1.0"),X},J.clearInstance=function(){var W;(W=this.gInstance)===null||W===void 0||W.clearInstanceImpl(),this.gInstance=void 0},J.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},J.prototype.startRefresh=function(){var W=this;this.trace.onTrace("Starting refresh request"),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds);var X=this.clock.getMillis();if((X-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds)this.trace.onTrace("Will not refresh due to refresh timeout");else if(!this.isInitialRefreshDone||this.refresh.canRefreshNow()){this.isInitialRefreshDone=!0;var se={};this.fetchData().then(function(he){W.processResponse(he,se,X),W.emitMetricsImpl(se)}).catch(function(he){W.exceptionMetrics(se,he),W.emitMetricsImpl(se),W.trace.onTrace("Fetch error: "+he),W.refresh.retryCount>0&&W.scheduleRetry(1)})}else this.trace.onTrace("Will not refresh due to callback having returned false")},J.prototype.fetchData=function(){var W=this.getFetchUrl(),X=new Headers,se=this.state.getState();return se.fetchServer===this.fetchServer&&(se.lastFetchWhenFullMs&&this.clock.getMillis()-se.lastFetchWhenFullMs>1e3*O(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&se.lastFetchEtagHeader&&X.set("If-None-Match",se.lastFetchEtagHeader)),this.fetch.fetchUrl(W,X)},J.prototype.processResponse=function(W,X,se){var he={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},Ie=W.headers.get("etag");if(Ie&&(he.lastFetchEtagHeader=Ie),W.status<300&&W.json)if(this.setData(W.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(x,{fetchServer:this.fetchServer,json:W.json});var we=this.clock.getMillis();he.lastFetchWhenFullMs=we,this.state.setState(he),X.success_new_data_count=1,X.fetch_duration_average=Math.max(0,we-se)}else X.fail_invalid_data_count=1;else{if(W.status!==304){var Qe="Unexpected http fetch status: "+W.status;throw this.trace.onTrace(Qe),new D(Qe)}this.trace.onTrace("Server said no change in data"),we=this.clock.getMillis(),he.lastFetchWhenMs=we,this.state.setState(he),X.success_no_change_count=1,X.fetch_duration_average=Math.max(0,we-se)}},J.prototype.scheduleRetry=function(W){var X=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var se=W*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout(function(){X.retryTask=void 0,X.fetchRetry(W)},1e3*se)},J.prototype.fetchRetry=function(W){var X=this;this.trace.onTrace("Starting retry request ".concat(W,"..."));var se={},he=this.clock.getMillis();this.fetchData().then(function(Ie){X.processResponse(Ie,se,he),X.emitMetricsImpl(se)}).catch(function(Ie){X.exceptionMetrics(se,Ie),X.emitMetricsImpl(se),X.trace.onTrace("Fetch error: "+Ie),X.refresh.retryCount>W&&X.scheduleRetry(W+1)})},J.prototype.setData=function(W){if(!W)return!1;if(W.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var X=W.properties;if(!X||!Array.isArray(X))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var se=new Map,he=0,Ie=X;he<Ie.length;he++){var we=Ie[he];if(we.name&&we.type&&this.isValidValueType(we.type)){if(we.value_string&&typeof we.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof we.value_string);continue}if(we.value_number&&typeof we.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof we.value_number);continue}if(we.value_boolean&&typeof we.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof we.value_boolean);continue}if(we.value_json&&typeof we.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof we.value_json);continue}if(we.value_analytics&&typeof we.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof we.value_analytics);continue}var Qe=new de(we.name,this.parseValueType(we.type),we.value_string,we.value_number,we.value_boolean,we.value_json,we.value_analytics,we.encoding);se.set(Qe.name,Qe)}}return se.size!=0&&(this.properties=se,!0)},J.prototype.isValidValueType=function(W){return W==="string"||W==="number"||W==="boolean"||W=="json"},J.prototype.parseValueType=function(W){switch(W){case"string":return ce.STRING;case"number":return ce.NUMBER;case"boolean":return ce.BOOLEAN;case"json":return ce.JSON;default:throw new Error("Unsupported value type ".concat(W))}},J.prototype.emitMetricsImpl=function(W){var X,se,he,Ie,we,Qe,Tt={initial_load_time:this.initialLoadTime,fetch_attempt_count:1,fetch_duration_average:(X=W.fetch_duration_average)!==null&&X!==void 0?X:0,success_no_change_count:(se=W.success_no_change_count)!==null&&se!==void 0?se:0,success_new_data_count:(he=W.success_new_data_count)!==null&&he!==void 0?he:0,fail_exception_count:(Ie=W.fail_exception_count)!==null&&Ie!==void 0?Ie:0,fail_http_error_count:(we=W.fail_http_error_count)!==null&&we!==void 0?we:0,fail_invalid_data_count:(Qe=W.fail_invalid_data_count)!==null&&Qe!==void 0?Qe:0};this.emitMetrics(j(Tt,this.analyticsProperties))},J.prototype.exceptionMetrics=function(W,X){var se;X instanceof D||!((se=X==null?void 0:X.message)===null||se===void 0)&&se.startsWith("http error")?W.fail_http_error_count=1:W.fail_exception_count=1},J}();_.DeviceConfigManager=H;var K=function(){function J(W,X,se,he,Ie){this.analytics=W,this.analyticsProperties=X,this.properties=se,this.dataFetchedWhenMs=he,this.clock=Ie}return J.prototype.getSize=function(){return this.properties?this.properties.size:-1},J.prototype.getStringValue=function(W){var X,se;if(this.properties){var he=this.properties.get(W);if(he){if(he.type===ce.STRING){var Ie=(X=he.valueString)!==null&&X!==void 0?X:"";return this.analytics.onValue(j({key_name:he.name,value:(se=he.valueAnalytics)!==null&&se!==void 0?se:Ie,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),Ie}this.analytics.onError(j({key_name:he.name,message:"Type is not string"},this.analyticsProperties))}}else this.analytics.onTrace(j({key_name:W,message:"Configuration is not available"},this.analyticsProperties))},J.prototype.getNumberValue=function(W){var X,se;if(this.properties){var he=this.properties.get(W);if(he){if(he.type===ce.NUMBER){var Ie=(X=he.valueNumber)!==null&&X!==void 0?X:0;return this.analytics.onValue(j({key_name:he.name,value:(se=he.valueAnalytics)!==null&&se!==void 0?se:Ie.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),Ie}this.analytics.onError(j({key_name:he.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(j({key_name:W,message:"Configuration is not available"},this.analyticsProperties))},J.prototype.getBooleanValue=function(W){var X,se;if(this.properties){var he=this.properties.get(W);if(he){if(he.type===ce.BOOLEAN){var Ie=(X=he.valueBoolean)!==null&&X!==void 0&&X;return this.analytics.onValue(j({key_name:he.name,value:(se=he.valueAnalytics)!==null&&se!==void 0?se:Ie.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),Ie}this.analytics.onError(j({key_name:he.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(j({key_name:W,message:"Configuration is not available"},this.analyticsProperties))},J.prototype.getJsonValue=function(W){var X,se;if(this.properties){var he=this.properties.get(W);if(he){if(he.type===ce.JSON){var Ie=he.valueJson;if(!Ie)return this.analytics.onValue(j({key_name:he.name,value:(X=he.valueAnalytics)!==null&&X!==void 0?X:"",fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),null;try{var we=JSON.parse(Ie);return this.analytics.onValue(j({key_name:he.name,value:(se=he.valueAnalytics)!==null&&se!==void 0?se:we,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),we}catch{return void this.analytics.onError(j({key_name:he.name,message:"JSON parse error"},this.analyticsProperties))}}this.analytics.onError(j({key_name:he.name,message:"Type is not JSON"},this.analyticsProperties))}}else this.analytics.onTrace(j({key_name:W,message:"Configuration is not available"},this.analyticsProperties))},J.prototype.getFetchedSecondsAgo=function(){if(this.dataFetchedWhenMs)return(this.clock.getMillis()-this.dataFetchedWhenMs)/1e3},J}();_.DeviceConfigPropertyHolder=K;var ce,Q=function(){function J(W){this.context=W}return J.prototype.fetchUrl=function(W,X){var se=this,he={headers:X,cache:"no-store"},Ie=null;if(typeof AbortController<"u"){var we=new AbortController;Ie=this.context.setTimeout(function(){return we.abort()},15e3),he.signal=we.signal}return new Promise(function(Qe,Tt){se.context.fetch(W,he).then(function(vt){if(vt.status>=400)Tt(new D("http error ".concat(vt.status,", ").concat(vt.statusText)));else{var Ut={status:vt.status,headers:vt.headers};vt.json().then(function(Vt){Ut.json=Vt,Qe(Ut)}).catch(function(){Qe(Ut)})}}).catch(function(vt){Tt(vt)}).finally(function(){Ie&&se.context.clearTimeout(Ie)})})},J}(),Z=function(){function J(W){this.enableConsoleLog=W}return J.prototype.onTrace=function(W){this.enableConsoleLog&&console.log("DeviceConfig trace: "+W)},J}(),Se=function(){function J(W){this.enableConsoleLog=W}return J.prototype.onValue=function(W){this.enableConsoleLog&&console.log("DeviceConfig analytics value:  ".concat(W))},J.prototype.onError=function(W){this.enableConsoleLog&&console.error("DeviceConfig analytics error: ".concat(W))},J.prototype.onTrace=function(W){this.enableConsoleLog&&console.log("DeviceConfig analytics trace: ".concat(W))},J}(),G=function(){function J(W,X){this.prefix=W,this.storage=X}return J.prototype.getJson=function(W){var X=this.prefix+"_"+W;try{var se=this.storage.getItem(X);if(se)return JSON.parse(se)}catch(he){console.error("Error getting local storage key ".concat(X)+he)}return null},J.prototype.setJson=function(W,X){var se=this.prefix+"_"+W;try{this.storage.setItem(se,JSON.stringify(X))}catch(he){console.error("Error setting local storage key ".concat(se,": ")+he)}},J}(),ie=function(){function J(){}return J.prototype.getMillis=function(){return Date.now()},J}();(function(J){J[J.STRING=0]="STRING",J[J.NUMBER=1]="NUMBER",J[J.BOOLEAN=2]="BOOLEAN",J[J.JSON=3]="JSON"})(ce||(ce={}));var de=function(J,W,X,se,he,Ie,we,Qe){switch(this.name=J,this.type=W,this.valueString=X,this.valueNumber=se,this.valueBoolean=he,this.valueJson=Ie,this.valueAnalytics=we,this.type){case ce.STRING:Qe===$&&X&&(this.valueString=atob(X));break;case ce.JSON:Qe===$&&Ie&&(this.valueJson=atob(Ie))}},ne=function(){function J(W,X){var se;this.storage=W,this.key=X,this.state=(se=W.getJson(X))!==null&&se!==void 0?se:{}}return J.prototype.getState=function(){return this.state},J.prototype.setState=function(W){Object.assign(this.state,W),this.storage.setJson(this.key,this.state)},J}()},456:function(I,_,A){var C=this&&this.__createBinding||(Object.create?function(O,j,D,x){x===void 0&&(x=D);var N=Object.getOwnPropertyDescriptor(j,D);N&&!("get"in N?!j.__esModule:N.writable||N.configurable)||(N={enumerable:!0,get:function(){return j[D]}}),Object.defineProperty(O,x,N)}:function(O,j,D,x){x===void 0&&(x=D),O[x]=j[D]}),v=this&&this.__exportStar||function(O,j){for(var D in O)D==="default"||Object.prototype.hasOwnProperty.call(j,D)||C(j,O,D)};Object.defineProperty(_,"__esModule",{value:!0}),v(A(903),_)},903:function(I,_,A){var C=this&&this.__spreadArray||function(j,D,x){if(x||arguments.length===2)for(var N,$=0,H=D.length;$<H;$++)!N&&$ in D||(N||(N=Array.prototype.slice.call(D,0,$)),N[$]=D[$]);return j.concat(N||Array.prototype.slice.call(D))};Object.defineProperty(_,"__esModule",{value:!0}),_.TypedEmitter=void 0;var v=A(228),O=function(){function j(D){var x=D.propagateErrors;this.emitter=new v.EventEmitter,this.propagateErrors=x!=null&&x}return j.prototype.on=function(D,x){x.call=this.wrapCall(D,x),this.emitter.on(D,x)},j.prototype.off=function(D,x){this.emitter.off(D,x)},j.prototype.emit=function(D){for(var x,N=[],$=1;$<arguments.length;$++)N[$-1]=arguments[$];(x=this.emitter).emit.apply(x,C([D],N,!1))},j.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},j.prototype.wrapCall=function(D,x){var N=this;return function($){for(var H=[],K=1;K<arguments.length;K++)H[K-1]=arguments[K];if(N.propagateErrors)x.apply($,H);else try{x.apply($,H)}catch(Z){var ce="Error in callback for ".concat(D),Q=x.name;return Q&&(ce+=" for function ".concat(Q)),void console.error(ce,Z)}}},j}();_.TypedEmitter=O},987:function(I,_,A){var C,v=this&&this.__extends||(C=function(H,K){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,Q){ce.__proto__=Q}||function(ce,Q){for(var Z in Q)Object.prototype.hasOwnProperty.call(Q,Z)&&(ce[Z]=Q[Z])},C(H,K)},function(H,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function ce(){this.constructor=H}C(H,K),H.prototype=K===null?Object.create(K):(ce.prototype=K.prototype,new ce)}),O=this&&this.__createBinding||(Object.create?function(H,K,ce,Q){Q===void 0&&(Q=ce);var Z=Object.getOwnPropertyDescriptor(K,ce);Z&&!("get"in Z?!K.__esModule:Z.writable||Z.configurable)||(Z={enumerable:!0,get:function(){return K[ce]}}),Object.defineProperty(H,Q,Z)}:function(H,K,ce,Q){Q===void 0&&(Q=ce),H[Q]=K[ce]}),j=this&&this.__setModuleDefault||(Object.create?function(H,K){Object.defineProperty(H,"default",{enumerable:!0,value:K})}:function(H,K){H.default=K}),D=this&&this.__importStar||function(H){if(H&&H.__esModule)return H;var K={};if(H!=null)for(var ce in H)ce!=="default"&&Object.prototype.hasOwnProperty.call(H,ce)&&O(K,H,ce);return j(K,H),K};Object.defineProperty(_,"__esModule",{value:!0}),_.createFsm=_.FsmWildcardState=_.RejectedTransitionError=_.InvalidStateTransitionError=void 0;var x=D(A(293)),N=function(H){function K(ce,Q){var Z=H.call(this,"Invalid transition from '".concat(Q,"' via event '").concat(ce,"'"))||this;return Z.name="InvalidStateTransitionError",Z}return v(K,H),K}(Error);_.InvalidStateTransitionError=N;var $=function(H){function K(ce,Q,Z){var Se=H.call(this,"Transition from '".concat(Q,"' via event '").concat(ce,"' was rejected for: ").concat(Z))||this;return Se.name="RejectedTransitionError",Se}return v(K,H),K}(Error);_.RejectedTransitionError=$,_.FsmWildcardState="*",_.createFsm=function(H){var K,ce=H.transitions,Q=H.callbacks,Z=H.initialState,Se=function(G){var ie,de=(ie=ce[G])===null||ie===void 0?void 0:ie.from;return!!de&&(typeof de=="string"?de===_.FsmWildcardState:de.includes(Z))};return{canTransition:Se,transition:function(G,ie){var de,ne,J,W,X,se;if(!Se(G))return x.err(new N(String(Z),String(G)));var he=ce[G];return he.shouldTransition===void 0||he.shouldTransition(Z)?((ne=(de=Q==null?void 0:Q[Z])===null||de===void 0?void 0:de.onExiting)===null||ne===void 0||ne.call(de),(J=Q==null?void 0:Q.onStateExiting)===null||J===void 0||J.call(Q,Z),K=Z,Z=he.to,(X=(W=Q==null?void 0:Q[Z])===null||W===void 0?void 0:W.onChanged)===null||X===void 0||X.call(W,K,ie),(se=Q==null?void 0:Q.onStateChanged)===null||se===void 0||se.call(Q,K,Z,ie),x.ok(Z)):x.err(new $(String(Z),String(G),"shouldTransition returned false"))},previousState:function(){return K},currentState:function(){return Z}}}},156:function(I,_,A){var C=this&&this.__createBinding||(Object.create?function(O,j,D,x){x===void 0&&(x=D);var N=Object.getOwnPropertyDescriptor(j,D);N&&!("get"in N?!j.__esModule:N.writable||N.configurable)||(N={enumerable:!0,get:function(){return j[D]}}),Object.defineProperty(O,x,N)}:function(O,j,D,x){x===void 0&&(x=D),O[x]=j[D]}),v=this&&this.__exportStar||function(O,j){for(var D in O)D==="default"||Object.prototype.hasOwnProperty.call(j,D)||C(j,O,D)};Object.defineProperty(_,"__esModule",{value:!0}),_.VERSION=void 0,_.VERSION="0.5.0",v(A(815),_),v(A(456),_),v(A(987),_),v(A(293),_),v(A(925),_)},925:function(I,_,A){var C=this&&this.__createBinding||(Object.create?function(O,j,D,x){x===void 0&&(x=D);var N=Object.getOwnPropertyDescriptor(j,D);N&&!("get"in N?!j.__esModule:N.writable||N.configurable)||(N={enumerable:!0,get:function(){return j[D]}}),Object.defineProperty(O,x,N)}:function(O,j,D,x){x===void 0&&(x=D),O[x]=j[D]}),v=this&&this.__exportStar||function(O,j){for(var D in O)D==="default"||Object.prototype.hasOwnProperty.call(j,D)||C(j,O,D)};Object.defineProperty(_,"__esModule",{value:!0}),v(A(166),_),v(A(612),_),v(A(56),_),v(A(139),_),v(A(877),_)},166:function(I,_,A){var C=this&&this.__assign||function(){return C=Object.assign||function(H){for(var K,ce=1,Q=arguments.length;ce<Q;ce++)for(var Z in K=arguments[ce])Object.prototype.hasOwnProperty.call(K,Z)&&(H[Z]=K[Z]);return H},C.apply(this,arguments)},v=this&&this.__spreadArray||function(H,K,ce){if(ce||arguments.length===2)for(var Q,Z=0,Se=K.length;Z<Se;Z++)!Q&&Z in K||(Q||(Q=Array.prototype.slice.call(K,0,Z)),Q[Z]=K[Z]);return H.concat(Q||Array.prototype.slice.call(K))};Object.defineProperty(_,"__esModule",{value:!0}),_.getLogConfig=_.setLogConfig=_.setLogConfigByLevel=_.extractLogConfig=void 0;var O=A(612),j=A(56),D=A(139),x=A(478),N={enabled:!1,levels:{debug:!0,log:!0,info:!0,warn:!0,error:!0},targets:[(0,j.createConsoleLogTarget)()],categories:{}},$=Object.keys(N);_.extractLogConfig=function(H){var K={};if(Object.keys(H).some(function(G){return $.includes(G)})){for(var ce=0,Q=$;ce<Q.length;ce++){var Z=Q[ce];if(H[Z]!==void 0){var Se=H[Z];K[Z]=Se}}return K}},_.setLogConfigByLevel=function(H){var K=H.enabled||N.enabled,ce=H.targets||N.targets,Q={debug:!1,log:!1,info:!1,warn:!1,error:!1},Z=function(Se,G){for(var ie=0,de=Se;ie<de.length;ie++){var ne=de[ie];Q[ne]=G}};switch(H.level){case"debug":Z(["debug","log","info","warn","error"],K);break;case"log":Z(["log","info","warn","error"],K);break;case"info":Z(["info","warn","error"],!0);break;case"warn":Z(["warn","error"],!0);break;case"error":Z(["error"],!0)}(0,_.setLogConfig)({enabled:K,levels:Q,targets:ce})},_.setLogConfig=function(H){var K=(0,x.mergeConfigs)(N,H);K&&(N=K,O.defaultLogEmitter.emit(D.LogEventType.CONFIG_UPDATED,N))},_.getLogConfig=function(){return{enabled:N.enabled,levels:C({},N.levels),targets:v([],N.targets,!0),categories:C({},N.categories)}}},612:(I,_,A)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.defaultLogEmitter=void 0;var C=A(456);_.defaultLogEmitter=new C.TypedEmitter({})},56:function(I,_,A){var C=this&&this.__spreadArray||function(O,j,D){if(D||arguments.length===2)for(var x,N=0,$=j.length;N<$;N++)!x&&N in j||(x||(x=Array.prototype.slice.call(j,0,N)),x[N]=j[N]);return O.concat(x||Array.prototype.slice.call(j))};Object.defineProperty(_,"__esModule",{value:!0}),_.createEventLogTarget=_.createConsoleLogTarget=void 0;var v=A(139);_.createConsoleLogTarget=function(){return{handleMessage:function(O){for(var j=[],D=1;D<arguments.length;D++)j[D-1]=arguments[D];console[O].apply(console,j)}}},_.createEventLogTarget=function(O){return{handleMessage:function(j){for(var D=[],x=1;x<arguments.length;x++)D[x-1]=arguments[x];O.emit.apply(O,C([v.LogEventType.MESSAGE_LOGGED,j],D,!1))}}}},139:(I,_)=>{var A;Object.defineProperty(_,"__esModule",{value:!0}),_.LogEventType=void 0,function(C){C.CONFIG_UPDATED="logConfigUpdated",C.MESSAGE_LOGGED="messageLogged"}(A||(_.LogEventType=A={}))},877:function(I,_,A){var C=this&&this.__assign||function(){return C=Object.assign||function($){for(var H,K=1,ce=arguments.length;K<ce;K++)for(var Q in H=arguments[K])Object.prototype.hasOwnProperty.call(H,Q)&&($[Q]=H[Q]);return $},C.apply(this,arguments)},v=this&&this.__spreadArray||function($,H,K){if(K||arguments.length===2)for(var ce,Q=0,Z=H.length;Q<Z;Q++)!ce&&Q in H||(ce||(ce=Array.prototype.slice.call(H,0,Q)),ce[Q]=H[Q]);return $.concat(ce||Array.prototype.slice.call(H))};Object.defineProperty(_,"__esModule",{value:!0}),_.createLogger=void 0;var O=A(478),j=A(166),D=A(612),x=A(139),N=function($,H){return(0,O.mergeConfigs)($,H)||$};_.createLogger=function($){var H=$.name,K=$.category,ce=$.parent,Q=(0,j.extractLogConfig)($)||{},Z=N((0,j.getLogConfig)(),Q);D.defaultLogEmitter.on(x.LogEventType.CONFIG_UPDATED,function(ne){Z=N(ne,Q||{})});var Se=function(ne){for(var J=[],W=1;W<arguments.length;W++)J[W-1]=arguments[W];if(ce&&!ce.canLog(ne)||!ie(ne))return!1;for(var X=G(),se=new Date().toTimeString().split(" ")[0],he=v(["".concat(se," - (").concat(X,")")],J,!0),Ie=0,we=Z.targets;Ie<we.length;Ie++){var Qe=we[Ie];Qe.handleMessage.apply(Qe,v([ne],he,!1))}return!0},G=function(){return ce?"".concat(ce.getName()," | ").concat(H):H},ie=function(ne){return!(!Z.enabled||!Z.levels[ne]||Z.targets.length===0||K!==void 0&&!Z.categories[K])},de={debug:function(){for(var ne=[],J=0;J<arguments.length;J++)ne[J]=arguments[J];return Se.apply(void 0,v(["debug"],ne,!1))},log:function(){for(var ne=[],J=0;J<arguments.length;J++)ne[J]=arguments[J];return Se.apply(void 0,v(["log"],ne,!1))},info:function(){for(var ne=[],J=0;J<arguments.length;J++)ne[J]=arguments[J];return Se.apply(void 0,v(["info"],ne,!1))},warn:function(){for(var ne=[],J=0;J<arguments.length;J++)ne[J]=arguments[J];return Se.apply(void 0,v(["warn"],ne,!1))},error:function(){for(var ne=[],J=0;J<arguments.length;J++)ne[J]=arguments[J];return Se.apply(void 0,v(["error"],ne,!1))},getName:G,canLog:ie,getChildLogger:function(ne){return(0,_.createLogger)(C(C({},ne),{parent:de}))},setConfig:function(ne){Z=N(Z,Q=ne)}};return de}},478:function(I,_,A){var C=this&&this.__spreadArray||function(j,D,x){if(x||arguments.length===2)for(var N,$=0,H=D.length;$<H;$++)!N&&$ in D||(N||(N=Array.prototype.slice.call(D,0,$)),N[$]=D[$]);return j.concat(N||Array.prototype.slice.call(D))};Object.defineProperty(_,"__esModule",{value:!0}),_.mergeConfigs=void 0;var v=A(543),O=function(j,D){if((0,v.isArray)(j))return D};_.mergeConfigs=function(j){for(var D=[],x=1;x<arguments.length;x++)D[x-1]=arguments[x];var N=D.map(function($){return $==null||typeof $!="object"}).filter(Boolean).length>0;if(typeof j=="object"&&!N)return v.mergeWith.apply(void 0,C(C([{},j],D,!1),[O],!1))}},293:(I,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.getErr=_.getOk_or=_.getOk=_.isNotOk=_.isOk=_.err=_.ok=void 0,_.ok=function(A){return{ok:!0,value:A}},_.err=function(A){return{ok:!1,error:A}},_.isOk=function(A){return A.ok===!0},_.isNotOk=function(A){return!(0,_.isOk)(A)},_.getOk=function(A){return A.ok===!0?A.value:void 0},_.getOk_or=function(A,C){return A.ok===!0?A.value:C},_.getErr=function(A){return A.ok===!0?void 0:A.error}}},S={};function b(I){var _=S[I];if(_!==void 0)return _.exports;var A=S[I]={id:I,loaded:!1,exports:{}};return m[I].call(A.exports,A,A.exports,b),A.loaded=!0,A.exports}return b.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),b.nmd=I=>(I.paths=[],I.children||(I.children=[]),I),b(156)})(),E.exports=w()},1549:(E,w,m)=>{var S=m(2032),b=m(3862),I=m(6721),_=m(2749),A=m(5749);function C(v){var O=-1,j=v==null?0:v.length;for(this.clear();++O<j;){var D=v[O];this.set(D[0],D[1])}}C.prototype.clear=S,C.prototype.delete=b,C.prototype.get=I,C.prototype.has=_,C.prototype.set=A,E.exports=C},79:(E,w,m)=>{var S=m(3702),b=m(80),I=m(4739),_=m(8655),A=m(1175);function C(v){var O=-1,j=v==null?0:v.length;for(this.clear();++O<j;){var D=v[O];this.set(D[0],D[1])}}C.prototype.clear=S,C.prototype.delete=b,C.prototype.get=I,C.prototype.has=_,C.prototype.set=A,E.exports=C},8223:(E,w,m)=>{var S=m(6110)(m(9325),"Map");E.exports=S},3661:(E,w,m)=>{var S=m(3040),b=m(7670),I=m(289),_=m(4509),A=m(2949);function C(v){var O=-1,j=v==null?0:v.length;for(this.clear();++O<j;){var D=v[O];this.set(D[0],D[1])}}C.prototype.clear=S,C.prototype.delete=b,C.prototype.get=I,C.prototype.has=_,C.prototype.set=A,E.exports=C},7217:(E,w,m)=>{var S=m(79),b=m(1420),I=m(938),_=m(3605),A=m(9817),C=m(945);function v(O){var j=this.__data__=new S(O);this.size=j.size}v.prototype.clear=b,v.prototype.delete=I,v.prototype.get=_,v.prototype.has=A,v.prototype.set=C,E.exports=v},1873:(E,w,m)=>{var S=m(9325).Symbol;E.exports=S},7828:(E,w,m)=>{var S=m(9325).Uint8Array;E.exports=S},1033:E=>{E.exports=function(w,m,S){switch(S.length){case 0:return w.call(m);case 1:return w.call(m,S[0]);case 2:return w.call(m,S[0],S[1]);case 3:return w.call(m,S[0],S[1],S[2])}return w.apply(m,S)}},695:(E,w,m)=>{var S=m(8096),b=m(2428),I=m(6449),_=m(3656),A=m(361),C=m(7167),v=Object.prototype.hasOwnProperty;E.exports=function(O,j){var D=I(O),x=!D&&b(O),N=!D&&!x&&_(O),$=!D&&!x&&!N&&C(O),H=D||x||N||$,K=H?S(O.length,String):[],ce=K.length;for(var Q in O)!j&&!v.call(O,Q)||H&&(Q=="length"||N&&(Q=="offset"||Q=="parent")||$&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||A(Q,ce))||K.push(Q);return K}},7805:(E,w,m)=>{var S=m(3360),b=m(5288);E.exports=function(I,_,A){(A!==void 0&&!b(I[_],A)||A===void 0&&!(_ in I))&&S(I,_,A)}},6547:(E,w,m)=>{var S=m(3360),b=m(5288),I=Object.prototype.hasOwnProperty;E.exports=function(_,A,C){var v=_[A];I.call(_,A)&&b(v,C)&&(C!==void 0||A in _)||S(_,A,C)}},6025:(E,w,m)=>{var S=m(5288);E.exports=function(b,I){for(var _=b.length;_--;)if(S(b[_][0],I))return _;return-1}},3360:(E,w,m)=>{var S=m(3243);E.exports=function(b,I,_){I=="__proto__"&&S?S(b,I,{configurable:!0,enumerable:!0,value:_,writable:!0}):b[I]=_}},9344:(E,w,m)=>{var S=m(3805),b=Object.create,I=function(){function _(){}return function(A){if(!S(A))return{};if(b)return b(A);_.prototype=A;var C=new _;return _.prototype=void 0,C}}();E.exports=I},6649:(E,w,m)=>{var S=m(3221)();E.exports=S},2552:(E,w,m)=>{var S=m(1873),b=m(659),I=m(9350),_=S?S.toStringTag:void 0;E.exports=function(A){return A==null?A===void 0?"[object Undefined]":"[object Null]":_&&_ in Object(A)?b(A):I(A)}},7534:(E,w,m)=>{var S=m(2552),b=m(346);E.exports=function(I){return b(I)&&S(I)=="[object Arguments]"}},5083:(E,w,m)=>{var S=m(1882),b=m(7296),I=m(3805),_=m(7473),A=/^\[object .+?Constructor\]$/,C=Function.prototype,v=Object.prototype,O=C.toString,j=v.hasOwnProperty,D=RegExp("^"+O.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");E.exports=function(x){return!(!I(x)||b(x))&&(S(x)?D:A).test(_(x))}},4901:(E,w,m)=>{var S=m(2552),b=m(294),I=m(346),_={};_["[object Float32Array]"]=_["[object Float64Array]"]=_["[object Int8Array]"]=_["[object Int16Array]"]=_["[object Int32Array]"]=_["[object Uint8Array]"]=_["[object Uint8ClampedArray]"]=_["[object Uint16Array]"]=_["[object Uint32Array]"]=!0,_["[object Arguments]"]=_["[object Array]"]=_["[object ArrayBuffer]"]=_["[object Boolean]"]=_["[object DataView]"]=_["[object Date]"]=_["[object Error]"]=_["[object Function]"]=_["[object Map]"]=_["[object Number]"]=_["[object Object]"]=_["[object RegExp]"]=_["[object Set]"]=_["[object String]"]=_["[object WeakMap]"]=!1,E.exports=function(A){return I(A)&&b(A.length)&&!!_[S(A)]}},2903:(E,w,m)=>{var S=m(3805),b=m(5527),I=m(181),_=Object.prototype.hasOwnProperty;E.exports=function(A){if(!S(A))return I(A);var C=b(A),v=[];for(var O in A)(O!="constructor"||!C&&_.call(A,O))&&v.push(O);return v}},5250:(E,w,m)=>{var S=m(7217),b=m(7805),I=m(6649),_=m(2824),A=m(3805),C=m(7241),v=m(4974);E.exports=function O(j,D,x,N,$){j!==D&&I(D,function(H,K){if($||($=new S),A(H))_(j,D,K,x,O,N,$);else{var ce=N?N(v(j,K),H,K+"",j,D,$):void 0;ce===void 0&&(ce=H),b(j,K,ce)}},C)}},2824:(E,w,m)=>{var S=m(7805),b=m(3290),I=m(1961),_=m(3007),A=m(5529),C=m(2428),v=m(6449),O=m(3693),j=m(3656),D=m(1882),x=m(3805),N=m(1331),$=m(7167),H=m(4974),K=m(9884);E.exports=function(ce,Q,Z,Se,G,ie,de){var ne=H(ce,Z),J=H(Q,Z),W=de.get(J);if(W)S(ce,Z,W);else{var X=ie?ie(ne,J,Z+"",ce,Q,de):void 0,se=X===void 0;if(se){var he=v(J),Ie=!he&&j(J),we=!he&&!Ie&&$(J);X=J,he||Ie||we?v(ne)?X=ne:O(ne)?X=_(ne):Ie?(se=!1,X=b(J,!0)):we?(se=!1,X=I(J,!0)):X=[]:N(J)||C(J)?(X=ne,C(ne)?X=K(ne):x(ne)&&!D(ne)||(X=A(J))):se=!1}se&&(de.set(J,X),G(X,J,Se,ie,de),de.delete(J)),S(ce,Z,X)}}},9302:(E,w,m)=>{var S=m(3488),b=m(6757),I=m(2865);E.exports=function(_,A){return I(b(_,A,S),_+"")}},9570:(E,w,m)=>{var S=m(7334),b=m(3243),I=m(3488),_=b?function(A,C){return b(A,"toString",{configurable:!0,enumerable:!1,value:S(C),writable:!0})}:I;E.exports=_},8096:E=>{E.exports=function(w,m){for(var S=-1,b=Array(w);++S<w;)b[S]=m(S);return b}},7301:E=>{E.exports=function(w){return function(m){return w(m)}}},9653:(E,w,m)=>{var S=m(7828);E.exports=function(b){var I=new b.constructor(b.byteLength);return new S(I).set(new S(b)),I}},3290:(E,w,m)=>{E=m.nmd(E);var S=m(9325),b=w&&!w.nodeType&&w,I=b&&E&&!E.nodeType&&E,_=I&&I.exports===b?S.Buffer:void 0,A=_?_.allocUnsafe:void 0;E.exports=function(C,v){if(v)return C.slice();var O=C.length,j=A?A(O):new C.constructor(O);return C.copy(j),j}},1961:(E,w,m)=>{var S=m(9653);E.exports=function(b,I){var _=I?S(b.buffer):b.buffer;return new b.constructor(_,b.byteOffset,b.length)}},3007:E=>{E.exports=function(w,m){var S=-1,b=w.length;for(m||(m=Array(b));++S<b;)m[S]=w[S];return m}},1791:(E,w,m)=>{var S=m(6547),b=m(3360);E.exports=function(I,_,A,C){var v=!A;A||(A={});for(var O=-1,j=_.length;++O<j;){var D=_[O],x=C?C(A[D],I[D],D,A,I):void 0;x===void 0&&(x=I[D]),v?b(A,D,x):S(A,D,x)}return A}},5481:(E,w,m)=>{var S=m(9325)["__core-js_shared__"];E.exports=S},999:(E,w,m)=>{var S=m(9302),b=m(6800);E.exports=function(I){return S(function(_,A){var C=-1,v=A.length,O=v>1?A[v-1]:void 0,j=v>2?A[2]:void 0;for(O=I.length>3&&typeof O=="function"?(v--,O):void 0,j&&b(A[0],A[1],j)&&(O=v<3?void 0:O,v=1),_=Object(_);++C<v;){var D=A[C];D&&I(_,D,C,O)}return _})}},3221:E=>{E.exports=function(w){return function(m,S,b){for(var I=-1,_=Object(m),A=b(m),C=A.length;C--;){var v=A[w?C:++I];if(S(_[v],v,_)===!1)break}return m}}},3243:(E,w,m)=>{var S=m(6110),b=function(){try{var I=S(Object,"defineProperty");return I({},"",{}),I}catch{}}();E.exports=b},4840:(E,w,m)=>{var S=typeof m.g=="object"&&m.g&&m.g.Object===Object&&m.g;E.exports=S},2651:(E,w,m)=>{var S=m(4218);E.exports=function(b,I){var _=b.__data__;return S(I)?_[typeof I=="string"?"string":"hash"]:_.map}},6110:(E,w,m)=>{var S=m(5083),b=m(392);E.exports=function(I,_){var A=b(I,_);return S(A)?A:void 0}},8879:(E,w,m)=>{var S=m(4335)(Object.getPrototypeOf,Object);E.exports=S},659:(E,w,m)=>{var S=m(1873),b=Object.prototype,I=b.hasOwnProperty,_=b.toString,A=S?S.toStringTag:void 0;E.exports=function(C){var v=I.call(C,A),O=C[A];try{C[A]=void 0;var j=!0}catch{}var D=_.call(C);return j&&(v?C[A]=O:delete C[A]),D}},392:E=>{E.exports=function(w,m){return w==null?void 0:w[m]}},2032:(E,w,m)=>{var S=m(1042);E.exports=function(){this.__data__=S?S(null):{},this.size=0}},3862:E=>{E.exports=function(w){var m=this.has(w)&&delete this.__data__[w];return this.size-=m?1:0,m}},6721:(E,w,m)=>{var S=m(1042),b=Object.prototype.hasOwnProperty;E.exports=function(I){var _=this.__data__;if(S){var A=_[I];return A==="__lodash_hash_undefined__"?void 0:A}return b.call(_,I)?_[I]:void 0}},2749:(E,w,m)=>{var S=m(1042),b=Object.prototype.hasOwnProperty;E.exports=function(I){var _=this.__data__;return S?_[I]!==void 0:b.call(_,I)}},5749:(E,w,m)=>{var S=m(1042);E.exports=function(b,I){var _=this.__data__;return this.size+=this.has(b)?0:1,_[b]=S&&I===void 0?"__lodash_hash_undefined__":I,this}},5529:(E,w,m)=>{var S=m(9344),b=m(8879),I=m(5527);E.exports=function(_){return typeof _.constructor!="function"||I(_)?{}:S(b(_))}},361:E=>{var w=/^(?:0|[1-9]\d*)$/;E.exports=function(m,S){var b=typeof m;return!!(S=S??9007199254740991)&&(b=="number"||b!="symbol"&&w.test(m))&&m>-1&&m%1==0&&m<S}},6800:(E,w,m)=>{var S=m(5288),b=m(4894),I=m(361),_=m(3805);E.exports=function(A,C,v){if(!_(v))return!1;var O=typeof C;return!!(O=="number"?b(v)&&I(C,v.length):O=="string"&&C in v)&&S(v[C],A)}},4218:E=>{E.exports=function(w){var m=typeof w;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?w!=="__proto__":w===null}},7296:(E,w,m)=>{var S,b=m(5481),I=(S=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"";E.exports=function(_){return!!I&&I in _}},5527:E=>{var w=Object.prototype;E.exports=function(m){var S=m&&m.constructor;return m===(typeof S=="function"&&S.prototype||w)}},3702:E=>{E.exports=function(){this.__data__=[],this.size=0}},80:(E,w,m)=>{var S=m(6025),b=Array.prototype.splice;E.exports=function(I){var _=this.__data__,A=S(_,I);return!(A<0)&&(A==_.length-1?_.pop():b.call(_,A,1),--this.size,!0)}},4739:(E,w,m)=>{var S=m(6025);E.exports=function(b){var I=this.__data__,_=S(I,b);return _<0?void 0:I[_][1]}},8655:(E,w,m)=>{var S=m(6025);E.exports=function(b){return S(this.__data__,b)>-1}},1175:(E,w,m)=>{var S=m(6025);E.exports=function(b,I){var _=this.__data__,A=S(_,b);return A<0?(++this.size,_.push([b,I])):_[A][1]=I,this}},3040:(E,w,m)=>{var S=m(1549),b=m(79),I=m(8223);E.exports=function(){this.size=0,this.__data__={hash:new S,map:new(I||b),string:new S}}},7670:(E,w,m)=>{var S=m(2651);E.exports=function(b){var I=S(this,b).delete(b);return this.size-=I?1:0,I}},289:(E,w,m)=>{var S=m(2651);E.exports=function(b){return S(this,b).get(b)}},4509:(E,w,m)=>{var S=m(2651);E.exports=function(b){return S(this,b).has(b)}},2949:(E,w,m)=>{var S=m(2651);E.exports=function(b,I){var _=S(this,b),A=_.size;return _.set(b,I),this.size+=_.size==A?0:1,this}},1042:(E,w,m)=>{var S=m(6110)(Object,"create");E.exports=S},181:E=>{E.exports=function(w){var m=[];if(w!=null)for(var S in Object(w))m.push(S);return m}},6009:(E,w,m)=>{E=m.nmd(E);var S=m(4840),b=w&&!w.nodeType&&w,I=b&&E&&!E.nodeType&&E,_=I&&I.exports===b&&S.process,A=function(){try{var C=I&&I.require&&I.require("util").types;return C||_&&_.binding&&_.binding("util")}catch{}}();E.exports=A},9350:E=>{var w=Object.prototype.toString;E.exports=function(m){return w.call(m)}},4335:E=>{E.exports=function(w,m){return function(S){return w(m(S))}}},6757:(E,w,m)=>{var S=m(1033),b=Math.max;E.exports=function(I,_,A){return _=b(_===void 0?I.length-1:_,0),function(){for(var C=arguments,v=-1,O=b(C.length-_,0),j=Array(O);++v<O;)j[v]=C[_+v];v=-1;for(var D=Array(_+1);++v<_;)D[v]=C[v];return D[_]=A(j),S(I,this,D)}}},9325:(E,w,m)=>{var S=m(4840),b=typeof self=="object"&&self&&self.Object===Object&&self,I=S||b||Function("return this")();E.exports=I},4974:E=>{E.exports=function(w,m){if((m!=="constructor"||typeof w[m]!="function")&&m!="__proto__")return w[m]}},2865:(E,w,m)=>{var S=m(9570),b=m(1811)(S);E.exports=b},1811:E=>{var w=Date.now;E.exports=function(m){var S=0,b=0;return function(){var I=w(),_=16-(I-b);if(b=I,_>0){if(++S>=800)return arguments[0]}else S=0;return m.apply(void 0,arguments)}}},1420:(E,w,m)=>{var S=m(79);E.exports=function(){this.__data__=new S,this.size=0}},938:E=>{E.exports=function(w){var m=this.__data__,S=m.delete(w);return this.size=m.size,S}},3605:E=>{E.exports=function(w){return this.__data__.get(w)}},9817:E=>{E.exports=function(w){return this.__data__.has(w)}},945:(E,w,m)=>{var S=m(79),b=m(8223),I=m(3661);E.exports=function(_,A){var C=this.__data__;if(C instanceof S){var v=C.__data__;if(!b||v.length<199)return v.push([_,A]),this.size=++C.size,this;C=this.__data__=new I(v)}return C.set(_,A),this.size=C.size,this}},7473:E=>{var w=Function.prototype.toString;E.exports=function(m){if(m!=null){try{return w.call(m)}catch{}try{return m+""}catch{}}return""}},7334:E=>{E.exports=function(w){return function(){return w}}},5288:E=>{E.exports=function(w,m){return w===m||w!=w&&m!=m}},3488:E=>{E.exports=function(w){return w}},2428:(E,w,m)=>{var S=m(7534),b=m(346),I=Object.prototype,_=I.hasOwnProperty,A=I.propertyIsEnumerable,C=S(function(){return arguments}())?S:function(v){return b(v)&&_.call(v,"callee")&&!A.call(v,"callee")};E.exports=C},6449:E=>{var w=Array.isArray;E.exports=w},4894:(E,w,m)=>{var S=m(1882),b=m(294);E.exports=function(I){return I!=null&&b(I.length)&&!S(I)}},3693:(E,w,m)=>{var S=m(4894),b=m(346);E.exports=function(I){return b(I)&&S(I)}},3656:(E,w,m)=>{E=m.nmd(E);var S=m(9325),b=m(9935),I=w&&!w.nodeType&&w,_=I&&E&&!E.nodeType&&E,A=_&&_.exports===I?S.Buffer:void 0,C=(A?A.isBuffer:void 0)||b;E.exports=C},1882:(E,w,m)=>{var S=m(2552),b=m(3805);E.exports=function(I){if(!b(I))return!1;var _=S(I);return _=="[object Function]"||_=="[object GeneratorFunction]"||_=="[object AsyncFunction]"||_=="[object Proxy]"}},294:E=>{E.exports=function(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=9007199254740991}},3805:E=>{E.exports=function(w){var m=typeof w;return w!=null&&(m=="object"||m=="function")}},346:E=>{E.exports=function(w){return w!=null&&typeof w=="object"}},1331:(E,w,m)=>{var S=m(2552),b=m(8879),I=m(346),_=Function.prototype,A=Object.prototype,C=_.toString,v=A.hasOwnProperty,O=C.call(Object);E.exports=function(j){if(!I(j)||S(j)!="[object Object]")return!1;var D=b(j);if(D===null)return!0;var x=v.call(D,"constructor")&&D.constructor;return typeof x=="function"&&x instanceof x&&C.call(x)==O}},7167:(E,w,m)=>{var S=m(4901),b=m(7301),I=m(6009),_=I&&I.isTypedArray,A=_?b(_):S;E.exports=A},7241:(E,w,m)=>{var S=m(695),b=m(2903),I=m(4894);E.exports=function(_){return I(_)?S(_,!0):b(_)}},2543:function(E,w,m){var S;E=m.nmd(E),(function(){var b,I="Expected a function",_="__lodash_hash_undefined__",A="__lodash_placeholder__",C=16,v=32,O=64,j=128,D=256,x=1/0,N=9007199254740991,$=NaN,H=4294967295,K=[["ary",j],["bind",1],["bindKey",2],["curry",8],["curryRight",C],["flip",512],["partial",v],["partialRight",O],["rearg",D]],ce="[object Arguments]",Q="[object Array]",Z="[object Boolean]",Se="[object Date]",G="[object Error]",ie="[object Function]",de="[object GeneratorFunction]",ne="[object Map]",J="[object Number]",W="[object Object]",X="[object Promise]",se="[object RegExp]",he="[object Set]",Ie="[object String]",we="[object Symbol]",Qe="[object WeakMap]",Tt="[object ArrayBuffer]",vt="[object DataView]",Ut="[object Float32Array]",Vt="[object Float64Array]",Ht="[object Int8Array]",Ge="[object Int16Array]",At="[object Int32Array]",rn="[object Uint8Array]",gn="[object Uint8ClampedArray]",Dn="[object Uint16Array]",ur="[object Uint32Array]",it=/\b__p \+= '';/g,Ar=/\b(__p \+=) '' \+/g,ra=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Qt=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,Di=RegExp(Qt.source),oi=RegExp(xi.source),Qi=/<%-([\s\S]+?)%>/g,lr=/<%([\s\S]+?)%>/g,Wr=/<%=([\s\S]+?)%>/g,me=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ee=/^\w*$/,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$e=/[\\^$.*+?()[\]{}|]/g,Te=RegExp($e.source),tt=/^\s+/,lt=/\s/,Ve=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Be=/\{\n\/\* \[wrapped with (.+)\] \*/,Hn=/,? & /,Dt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Mt=/[()=,{}\[\]\/\s]/,Ke=/\\(\\)?/g,Pr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Mo=/^[-+]0x[0-9a-f]+$/i,Mi=/^0b[01]+$/i,mi=/^\[object .+?Constructor\]$/,Zi=/^0o[0-7]+$/i,oe=/^(?:0|[1-9]\d*)$/,fe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ce=/($^)/,xe=/['\n\r\u2028\u2029\\]/g,dt="\\ud800-\\udfff",vn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",bt="\\u2700-\\u27bf",nt="a-z\\xdf-\\xf6\\xf8-\\xff",Ye="A-Z\\xc0-\\xd6\\xd8-\\xde",je="\\ufe0e\\ufe0f",Ze="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",at="['’]",jt="["+dt+"]",dn="["+Ze+"]",yn="["+vn+"]",Xn="\\d+",us="["+bt+"]",ls="["+nt+"]",nu="[^"+dt+Ze+Xn+bt+nt+Ye+"]",dc="\\ud83c[\\udffb-\\udfff]",hc="[^"+dt+"]",fc="(?:\\ud83c[\\udde6-\\uddff]){2}",ds="[\\ud800-\\udbff][\\udc00-\\udfff]",No="["+Ye+"]",Oa="\\u200d",Qu="(?:"+ls+"|"+nu+")",hs="(?:"+No+"|"+nu+")",fs="(?:['’](?:d|ll|m|re|s|t|ve))?",Aa="(?:['’](?:D|LL|M|RE|S|T|VE))?",Pa="(?:"+yn+"|"+dc+")?",xa="["+je+"]?",ps=xa+Pa+("(?:"+Oa+"(?:"+[hc,fc,ds].join("|")+")"+xa+Pa+")*"),pc="(?:"+[us,fc,ds].join("|")+")"+ps,ru="(?:"+[hc+yn+"?",yn,fc,ds,jt].join("|")+")",Zu=RegExp(at,"g"),Ni=RegExp(yn,"g"),Li=RegExp(dc+"(?="+dc+")|"+ru+ps,"g"),ms=RegExp([No+"?"+ls+"+"+fs+"(?="+[dn,No,"$"].join("|")+")",hs+"+"+Aa+"(?="+[dn,No+Qu,"$"].join("|")+")",No+"?"+Qu+"+"+fs,No+"+"+Aa,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xn,pc].join("|"),"g"),Kl=RegExp("["+Oa+dt+vn+je+"]"),rh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],el=-1,bn={};bn[Ut]=bn[Vt]=bn[Ht]=bn[Ge]=bn[At]=bn[rn]=bn[gn]=bn[Dn]=bn[ur]=!0,bn[ce]=bn[Q]=bn[Tt]=bn[Z]=bn[vt]=bn[Se]=bn[G]=bn[ie]=bn[ne]=bn[J]=bn[W]=bn[se]=bn[he]=bn[Ie]=bn[Qe]=!1;var ft={};ft[ce]=ft[Q]=ft[Tt]=ft[vt]=ft[Z]=ft[Se]=ft[Ut]=ft[Vt]=ft[Ht]=ft[Ge]=ft[At]=ft[ne]=ft[J]=ft[W]=ft[se]=ft[he]=ft[Ie]=ft[we]=ft[rn]=ft[gn]=ft[Dn]=ft[ur]=!0,ft[G]=ft[ie]=ft[Qe]=!1;var hn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tl=parseFloat,nl=parseInt,rl=typeof m.g=="object"&&m.g&&m.g.Object===Object&&m.g,Yl=typeof self=="object"&&self&&self.Object===Object&&self,et=rl||Yl||Function("return this")(),Qn=w&&!w.nodeType&&w,Et=Qn&&E&&!E.nodeType&&E,ia=Et&&Et.exports===Qn,Da=ia&&rl.process,fr=function(){try{var V=Et&&Et.require&&Et.require("util").types;return V||Da&&Da.binding&&Da.binding("util")}catch{}}(),jn=fr&&fr.isArrayBuffer,gc=fr&&fr.isDate,iu=fr&&fr.isMap,ou=fr&&fr.isRegExp,vc=fr&&fr.isSet,gs=fr&&fr.isTypedArray;function Gr(V,ee,te){switch(te.length){case 0:return V.call(ee);case 1:return V.call(ee,te[0]);case 2:return V.call(ee,te[0],te[1]);case 3:return V.call(ee,te[0],te[1],te[2])}return V.apply(ee,te)}function gi(V,ee,te,ge){for(var De=-1,We=V==null?0:V.length;++De<We;){var mt=V[De];ee(ge,mt,te(mt),V)}return ge}function vi(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge&&ee(V[te],te,V)!==!1;);return V}function yi(V,ee){for(var te=V==null?0:V.length;te--&&ee(V[te],te,V)!==!1;);return V}function au(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge;)if(!ee(V[te],te,V))return!1;return!0}function eo(V,ee){for(var te=-1,ge=V==null?0:V.length,De=0,We=[];++te<ge;){var mt=V[te];ee(mt,te,V)&&(We[De++]=mt)}return We}function Bi(V,ee){return!!(V!=null&&V.length)&&no(V,ee,0)>-1}function Ma(V,ee,te){for(var ge=-1,De=V==null?0:V.length;++ge<De;)if(te(ee,V[ge]))return!0;return!1}function wn(V,ee){for(var te=-1,ge=V==null?0:V.length,De=Array(ge);++te<ge;)De[te]=ee(V[te],te,V);return De}function It(V,ee){for(var te=-1,ge=ee.length,De=V.length;++te<ge;)V[De+te]=ee[te];return V}function to(V,ee,te,ge){var De=-1,We=V==null?0:V.length;for(ge&&We&&(te=V[++De]);++De<We;)te=ee(te,V[De],De,V);return te}function il(V,ee,te,ge){var De=V==null?0:V.length;for(ge&&De&&(te=V[--De]);De--;)te=ee(te,V[De],De,V);return te}function ol(V,ee){for(var te=-1,ge=V==null?0:V.length;++te<ge;)if(ee(V[te],te,V))return!0;return!1}var vs=Hr("length");function Zn(V,ee,te){var ge;return te(V,function(De,We,mt){if(ee(De,We,mt))return ge=We,!1}),ge}function yc(V,ee,te,ge){for(var De=V.length,We=te+(ge?1:-1);ge?We--:++We<De;)if(ee(V[We],We,V))return We;return-1}function no(V,ee,te){return ee==ee?function(ge,De,We){for(var mt=We-1,Mn=ge.length;++mt<Mn;)if(ge[mt]===De)return mt;return-1}(V,ee,te):yc(V,Jl,te)}function ys(V,ee,te,ge){for(var De=te-1,We=V.length;++De<We;)if(ge(V[De],ee))return De;return-1}function Jl(V){return V!=V}function al(V,ee){var te=V==null?0:V.length;return te?su(V,ee)/te:$}function Hr(V){return function(ee){return ee==null?b:ee[V]}}function bs(V){return function(ee){return V==null?b:V[ee]}}function bc(V,ee,te,ge,De){return De(V,function(We,mt,Mn){te=ge?(ge=!1,We):ee(te,We,mt,Mn)}),te}function su(V,ee){for(var te,ge=-1,De=V.length;++ge<De;){var We=ee(V[ge]);We!==b&&(te=te===b?We:te+We)}return te}function Sc(V,ee){for(var te=-1,ge=Array(V);++te<V;)ge[te]=ee(te);return ge}function cu(V){return V&&V.slice(0,Un(V)+1).replace(tt,"")}function zr(V){return function(ee){return V(ee)}}function Dr(V,ee){return wn(ee,function(te){return V[te]})}function oa(V,ee){return V.has(ee)}function Ss(V,ee){for(var te=-1,ge=V.length;++te<ge&&no(ee,V[te],0)>-1;);return te}function sl(V,ee){for(var te=V.length;te--&&no(ee,V[te],0)>-1;);return te}var Xl=bs({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),ih=bs({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function oh(V){return"\\"+hn[V]}function Es(V){return Kl.test(V)}function aa(V){var ee=-1,te=Array(V.size);return V.forEach(function(ge,De){te[++ee]=[De,ge]}),te}function uu(V,ee){return function(te){return V(ee(te))}}function Lo(V,ee){for(var te=-1,ge=V.length,De=0,We=[];++te<ge;){var mt=V[te];mt!==ee&&mt!==A||(V[te]=A,We[De++]=te)}return We}function ji(V){var ee=-1,te=Array(V.size);return V.forEach(function(ge){te[++ee]=ge}),te}function lu(V){var ee=-1,te=Array(V.size);return V.forEach(function(ge){te[++ee]=[ge,ge]}),te}function ro(V){return Es(V)?function(ee){for(var te=Li.lastIndex=0;Li.test(ee);)++te;return te}(V):vs(V)}function zn(V){return Es(V)?function(ee){return ee.match(Li)||[]}(V):function(ee){return ee.split("")}(V)}function Un(V){for(var ee=V.length;ee--&&lt.test(V.charAt(ee)););return ee}var du=bs({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Na=function V(ee){var te,ge=(ee=ee==null?et:Na.defaults(et.Object(),ee,Na.pick(et,mc))).Array,De=ee.Date,We=ee.Error,mt=ee.Function,Mn=ee.Math,pt=ee.Object,Ec=ee.RegExp,ai=ee.String,Kt=ee.TypeError,Bo=ge.prototype,sa=mt.prototype,bi=pt.prototype,Ui=ee["__core-js_shared__"],Je=sa.toString,rt=bi.hasOwnProperty,cl=0,_c=(te=/[^.]+$/.exec(Ui&&Ui.keys&&Ui.keys.IE_PROTO||""))?"Symbol(src)_1."+te:"",ht=bi.toString,ah=Je.call(pt),sh=et._,ch=Ec("^"+Je.call(rt).replace($e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=ia?ee.Buffer:b,Er=ee.Symbol,ca=ee.Uint8Array,ul=er?er.allocUnsafe:b,La=uu(pt.getPrototypeOf,pt),ll=pt.create,Cc=bi.propertyIsEnumerable,io=Bo.splice,dl=Er?Er.isConcatSpreadable:b,jo=Er?Er.iterator:b,Mr=Er?Er.toStringTag:b,Ba=function(){try{var n=Ti(pt,"defineProperty");return n({},"",{}),n}catch{}}(),uh=ee.clearTimeout!==et.clearTimeout&&ee.clearTimeout,_s=De&&De.now!==et.Date.now&&De.now,Ql=ee.setTimeout!==et.setTimeout&&ee.setTimeout,ja=Mn.ceil,Ua=Mn.floor,Cs=pt.getOwnPropertySymbols,lh=er?er.isBuffer:b,Fa=ee.isFinite,dh=Bo.join,Zl=uu(pt.keys,pt),Nt=Mn.max,Yt=Mn.min,hu=De.now,hh=ee.parseInt,Tc=Mn.random,ed=Bo.reverse,Ts=Ti(ee,"DataView"),Oe=Ti(ee,"Map"),Sn=Ti(ee,"Promise"),oo=Ti(ee,"Set"),Uo=Ti(ee,"WeakMap"),Fo=Ti(pt,"create"),$a=Uo&&new Uo,Fi={},fh=Br(Ts),Va=Br(Oe),td=Br(Sn),Nr=Br(oo),nd=Br(Uo),Lr=Er?Er.prototype:b,bo=Lr?Lr.valueOf:b,ua=Lr?Lr.toString:b;function k(n){if(Ct(n)&&!Xe(n)&&!(n instanceof Fe)){if(n instanceof In)return n;if(rt.call(n,"__wrapped__"))return va(n)}return new In(n)}var ct=function(){function n(){}return function(e){if(!_n(e))return{};if(ll)return ll(e);n.prototype=e;var t=new n;return n.prototype=b,t}}();function ao(){}function In(n,e){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=b}function Fe(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=H,this.__views__=[]}function qr(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}function Zt(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}function Fn(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}function si(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Fn;++e<t;)this.add(n[e])}function Jt(n){var e=this.__data__=new Zt(n);this.size=e.size}function _e(n,e){var t=Xe(n),o=!t&&ho(n),s=!t&&!o&&Pt(n),h=!t&&!o&&!s&&kn(n),y=t||o||s||h,T=y?Sc(n.length,ai):[],P=T.length;for(var M in n)!e&&!rt.call(n,M)||y&&(M=="length"||s&&(M=="offset"||M=="parent")||h&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||Ln(M,P))||T.push(M);return T}function Kr(n){var e=n.length;return e?n[xs(0,e-1)]:b}function ph(n,e){return Ws($n(n),ci(e,0,n.length))}function fu(n){return Ws($n(n))}function la(n,e,t){(t!==b&&!Hi(n[e],t)||t===b&&!(e in n))&&qn(n,e,t)}function so(n,e,t){var o=n[e];rt.call(n,e)&&Hi(o,t)&&(t!==b||e in n)||qn(n,e,t)}function So(n,e){for(var t=n.length;t--;)if(Hi(n[t][0],e))return t;return-1}function hl(n,e,t,o){return _r(n,function(s,h,y){e(o,s,t(s),y)}),o}function fl(n,e){return n&&ui(e,cn(e),n)}function qn(n,e,t){e=="__proto__"&&Ba?Ba(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function Rs(n,e){for(var t=-1,o=e.length,s=ge(o),h=n==null;++t<o;)s[t]=h?b:is(n,e[t]);return s}function ci(n,e,t){return n==n&&(t!==b&&(n=n<=t?n:t),e!==b&&(n=n>=e?n:e)),n}function Nn(n,e,t,o,s,h){var y,T=1&e,P=2&e,M=4&e;if(t&&(y=s?t(n,o,s,h):t(n)),y!==b)return y;if(!_n(n))return n;var L=Xe(n);if(L){if(y=function(Y){var z=Y.length,re=new Y.constructor(z);return z&&typeof Y[0]=="string"&&rt.call(Y,"index")&&(re.index=Y.index,re.input=Y.input),re}(n),!T)return $n(n,y)}else{var B=mr(n),U=B==ie||B==de;if(Pt(n))return qa(n,T);if(B==W||B==ce||U&&!s){if(y=P||U?{}:El(n),!T)return P?function(Y,z){return ui(Y,Wn(Y),z)}(n,function(Y,z){return Y&&ui(z,Rt(z),Y)}(y,n)):function(Y,z){return ui(Y,Lc(Y),z)}(n,fl(y,n))}else{if(!ft[B])return s?n:{};y=function(Y,z,re){var ue=Y.constructor;switch(z){case Tt:return ma(Y);case Z:case Se:return new ue(+Y);case vt:return function(ve,be){var ye=be?ma(ve.buffer):ve.buffer;return new ve.constructor(ye,ve.byteOffset,ve.byteLength)}(Y,re);case Ut:case Vt:case Ht:case Ge:case At:case rn:case gn:case Dn:case ur:return Tu(Y,re);case ne:return new ue;case J:case Ie:return new ue(Y);case se:return function(ve){var be=new ve.constructor(ve.source,xr.exec(ve));return be.lastIndex=ve.lastIndex,be}(Y);case he:return new ue;case we:return le=Y,bo?pt(bo.call(le)):{}}var le}(n,B,T)}}h||(h=new Jt);var F=h.get(n);if(F)return F;h.set(n,y),Kn(n)?n.forEach(function(Y){y.add(Nn(Y,e,t,Y,n,h))}):Vn(n)&&n.forEach(function(Y,z){y.set(z,Nn(Y,e,t,z,n,h))});var q=L?b:(M?P?Vi:ko:P?Rt:cn)(n);return vi(q||n,function(Y,z){q&&(Y=n[z=Y]),so(y,z,Nn(Y,e,t,z,n,h))}),y}function Rc(n,e,t){var o=t.length;if(n==null)return!o;for(n=pt(n);o--;){var s=t[o],h=e[s],y=n[s];if(y===b&&!(s in n)||!h(y))return!1}return!0}function wc(n,e,t){if(typeof n!="function")throw new Kt(I);return ga(function(){n.apply(b,t)},e)}function co(n,e,t,o){var s=-1,h=Bi,y=!0,T=n.length,P=[],M=e.length;if(!T)return P;t&&(e=wn(e,zr(t))),o?(h=Ma,y=!1):e.length>=200&&(h=oa,y=!1,e=new si(e));e:for(;++s<T;){var L=n[s],B=t==null?L:t(L);if(L=o||L!==0?L:0,y&&B==B){for(var U=M;U--;)if(e[U]===B)continue e;P.push(L)}else h(e,B,o)||P.push(L)}return P}k.templateSettings={escape:Qi,evaluate:lr,interpolate:Wr,variable:"",imports:{_:k}},k.prototype=ao.prototype,k.prototype.constructor=k,In.prototype=ct(ao.prototype),In.prototype.constructor=In,Fe.prototype=ct(ao.prototype),Fe.prototype.constructor=Fe,qr.prototype.clear=function(){this.__data__=Fo?Fo(null):{},this.size=0},qr.prototype.delete=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e},qr.prototype.get=function(n){var e=this.__data__;if(Fo){var t=e[n];return t===_?b:t}return rt.call(e,n)?e[n]:b},qr.prototype.has=function(n){var e=this.__data__;return Fo?e[n]!==b:rt.call(e,n)},qr.prototype.set=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Fo&&e===b?_:e,this},Zt.prototype.clear=function(){this.__data__=[],this.size=0},Zt.prototype.delete=function(n){var e=this.__data__,t=So(e,n);return!(t<0)&&(t==e.length-1?e.pop():io.call(e,t,1),--this.size,!0)},Zt.prototype.get=function(n){var e=this.__data__,t=So(e,n);return t<0?b:e[t][1]},Zt.prototype.has=function(n){return So(this.__data__,n)>-1},Zt.prototype.set=function(n,e){var t=this.__data__,o=So(t,n);return o<0?(++this.size,t.push([n,e])):t[o][1]=e,this},Fn.prototype.clear=function(){this.size=0,this.__data__={hash:new qr,map:new(Oe||Zt),string:new qr}},Fn.prototype.delete=function(n){var e=Fs(this,n).delete(n);return this.size-=e?1:0,e},Fn.prototype.get=function(n){return Fs(this,n).get(n)},Fn.prototype.has=function(n){return Fs(this,n).has(n)},Fn.prototype.set=function(n,e){var t=Fs(this,n),o=t.size;return t.set(n,e),this.size+=t.size==o?0:1,this},si.prototype.add=si.prototype.push=function(n){return this.__data__.set(n,_),this},si.prototype.has=function(n){return this.__data__.has(n)},Jt.prototype.clear=function(){this.__data__=new Zt,this.size=0},Jt.prototype.delete=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t},Jt.prototype.get=function(n){return this.__data__.get(n)},Jt.prototype.has=function(n){return this.__data__.has(n)},Jt.prototype.set=function(n,e){var t=this.__data__;if(t instanceof Zt){var o=t.__data__;if(!Oe||o.length<199)return o.push([n,e]),this.size=++t.size,this;t=this.__data__=new Fn(o)}return t.set(n,e),this.size=t.size,this};var _r=yl(tr),pu=yl(ks,!0);function pl(n,e){var t=!0;return _r(n,function(o,s,h){return t=!!e(o,s,h)}),t}function da(n,e,t){for(var o=-1,s=n.length;++o<s;){var h=n[o],y=e(h);if(y!=null&&(T===b?y==y&&!zt(y):t(y,T)))var T=y,P=h}return P}function mu(n,e){var t=[];return _r(n,function(o,s,h){e(o,s,h)&&t.push(o)}),t}function Gt(n,e,t,o,s){var h=-1,y=n.length;for(t||(t=Oo),s||(s=[]);++h<y;){var T=n[h];e>0&&t(T)?e>1?Gt(T,e-1,t,o,s):It(s,T):o||(s[s.length]=T)}return s}var ws=bl(),Is=bl(!0);function tr(n,e){return n&&ws(n,e,cn)}function ks(n,e){return n&&Is(n,e,cn)}function Yr(n,e){return eo(e,function(t){return fo(n[t])})}function Jr(n,e){for(var t=0,o=(e=uo(e,n)).length;n!=null&&t<o;)n=n[lo(e[t++])];return t&&t==o?n:b}function Ic(n,e,t){var o=e(n);return Xe(n)?o:It(o,t(n))}function on(n){return n==null?n===b?"[object Undefined]":"[object Null]":Mr&&Mr in pt(n)?function(e){var t=rt.call(e,Mr),o=e[Mr];try{e[Mr]=b;var s=!0}catch{}var h=ht.call(e);return s&&(t?e[Mr]=o:delete e[Mr]),h}(n):function(e){return ht.call(e)}(n)}function Os(n,e){return n>e}function rd(n,e){return n!=null&&rt.call(n,e)}function id(n,e){return n!=null&&e in pt(n)}function As(n,e,t){for(var o=t?Ma:Bi,s=n[0].length,h=n.length,y=h,T=ge(h),P=1/0,M=[];y--;){var L=n[y];y&&e&&(L=wn(L,zr(e))),P=Yt(L.length,P),T[y]=!t&&(e||s>=120&&L.length>=120)?new si(y&&L):b}L=n[0];var B=-1,U=T[0];e:for(;++B<s&&M.length<P;){var F=L[B],q=e?e(F):F;if(F=t||F!==0?F:0,!(U?oa(U,q):o(M,q,t))){for(y=h;--y;){var Y=T[y];if(!(Y?oa(Y,q):o(n[y],q,t)))continue e}U&&U.push(q),M.push(F)}}return M}function $o(n,e,t){var o=(n=$s(n,e=uo(e,n)))==null?n:n[lo(Wi(e))];return o==null?b:Gr(o,n,t)}function gu(n){return Ct(n)&&on(n)==ce}function Eo(n,e,t,o,s){return n===e||(n==null||e==null||!Ct(n)&&!Ct(e)?n!=n&&e!=e:function(h,y,T,P,M,L){var B=Xe(h),U=Xe(y),F=B?Q:mr(h),q=U?Q:mr(y),Y=(F=F==ce?W:F)==W,z=(q=q==ce?W:q)==W,re=F==q;if(re&&Pt(h)){if(!Pt(y))return!1;B=!0,Y=!1}if(re&&!Y)return L||(L=new Jt),B||kn(h)?ei(h,y,T,P,M,L):function(ye,pe,Re,Me,Le,Ae,Pe){switch(Re){case vt:if(ye.byteLength!=pe.byteLength||ye.byteOffset!=pe.byteOffset)return!1;ye=ye.buffer,pe=pe.buffer;case Tt:return!(ye.byteLength!=pe.byteLength||!Ae(new ca(ye),new ca(pe)));case Z:case Se:case J:return Hi(+ye,+pe);case G:return ye.name==pe.name&&ye.message==pe.message;case se:case Ie:return ye==pe+"";case ne:var qe=aa;case he:var gt=1&Me;if(qe||(qe=ji),ye.size!=pe.size&&!gt)return!1;var Bt=Pe.get(ye);if(Bt)return Bt==pe;Me|=2,Pe.set(ye,pe);var Ft=ei(qe(ye),qe(pe),Me,Le,Ae,Pe);return Pe.delete(ye),Ft;case we:if(bo)return bo.call(ye)==bo.call(pe)}return!1}(h,y,F,T,P,M,L);if(!(1&T)){var ue=Y&&rt.call(h,"__wrapped__"),le=z&&rt.call(y,"__wrapped__");if(ue||le){var ve=ue?h.value():h,be=le?y.value():y;return L||(L=new Jt),M(ve,be,T,P,L)}}return re?(L||(L=new Jt),function(ye,pe,Re,Me,Le,Ae){var Pe=1&Re,qe=ko(ye),gt=qe.length,Bt=ko(pe),Ft=Bt.length;if(gt!=Ft&&!Pe)return!1;for(var Lt=gt;Lt--;){var qt=qe[Lt];if(!(Pe?qt in pe:rt.call(pe,qt)))return!1}var On=Ae.get(ye),pn=Ae.get(pe);if(On&&pn)return On==pe&&pn==ye;var un=!0;Ae.set(ye,pe),Ae.set(pe,ye);for(var sn=Pe;++Lt<gt;){var tn=ye[qt=qe[Lt]],ln=pe[qt];if(Me)var Pn=Pe?Me(ln,tn,qt,pe,ye,Ae):Me(tn,ln,qt,ye,pe,Ae);if(!(Pn===b?tn===ln||Le(tn,ln,Re,Me,Ae):Pn)){un=!1;break}sn||(sn=qt=="constructor")}if(un&&!sn){var Xt=ye.constructor,dr=pe.constructor;Xt==dr||!("constructor"in ye)||!("constructor"in pe)||typeof Xt=="function"&&Xt instanceof Xt&&typeof dr=="function"&&dr instanceof dr||(un=!1)}return Ae.delete(ye),Ae.delete(pe),un}(h,y,T,P,M,L)):!1}(n,e,t,o,Eo,s))}function kc(n,e,t,o){var s=t.length,h=s,y=!o;if(n==null)return!h;for(n=pt(n);s--;){var T=t[s];if(y&&T[2]?T[1]!==n[T[0]]:!(T[0]in n))return!1}for(;++s<h;){var P=(T=t[s])[0],M=n[P],L=T[1];if(y&&T[2]){if(M===b&&!(P in n))return!1}else{var B=new Jt;if(o)var U=o(M,L,P,n,e,B);if(!(U===b?Eo(L,M,3,o,B):U))return!1}}return!0}function Ue(n){return!(!_n(n)||(e=n,_c&&_c in e))&&(fo(n)?ch:mi).test(Br(n));var e}function vu(n){return typeof n=="function"?n:n==null?di:typeof n=="object"?Xe(n)?Wa(n[0],n[1]):ml(n):fn(n)}function ha(n){if(!Za(n))return Zl(n);var e=[];for(var t in pt(n))rt.call(n,t)&&t!="constructor"&&e.push(t);return e}function nr(n){if(!_n(n))return function(s){var h=[];if(s!=null)for(var y in pt(s))h.push(y);return h}(n);var e=Za(n),t=[];for(var o in n)(o!="constructor"||!e&&rt.call(n,o))&&t.push(o);return t}function Oc(n,e){return n<e}function yu(n,e){var t=-1,o=ni(n)?ge(n.length):[];return _r(n,function(s,h,y){o[++t]=e(s,h,y)}),o}function ml(n){var e=Ko(n);return e.length==1&&e[0][2]?Au(e[0][0],e[0][1]):function(t){return t===n||kc(t,n,e)}}function Wa(n,e){return Xa(n)&&Ou(e)?Au(lo(n),e):function(t){var o=is(t,n);return o===b&&o===e?Gc(t,n):Eo(e,o,3)}}function Ps(n,e,t,o,s){n!==e&&ws(e,function(h,y){if(s||(s=new Jt),_n(h))(function(P,M,L,B,U,F,q){var Y=Pu(P,L),z=Pu(M,L),re=q.get(z);if(re)return void la(P,L,re);var ue=F?F(Y,z,L+"",P,M,q):b,le=ue===b;if(le){var ve=Xe(z),be=!ve&&Pt(z),ye=!ve&&!be&&kn(z);ue=z,ve||be||ye?Xe(Y)?ue=Y:Wt(Y)?ue=$n(Y):be?(le=!1,ue=qa(z,!0)):ye?(le=!1,ue=Tu(z,!0)):ue=[]:zs(z)||ho(z)?(ue=Y,ho(Y)?ue=Ri(Y):_n(Y)&&!fo(Y)||(ue=El(z))):le=!1}le&&(q.set(z,ue),U(ue,z,B,F,q),q.delete(z)),la(P,L,ue)})(n,e,y,t,Ps,o,s);else{var T=o?o(Pu(n,y),h,y+"",n,e,s):b;T===b&&(T=h),la(n,y,T)}},Rt)}function bu(n,e){var t=n.length;if(t)return Ln(e+=e<0?t:0,t)?n[e]:b}function fa(n,e,t){e=e.length?wn(e,function(h){return Xe(h)?function(y){return Jr(y,h.length===1?h[0]:h)}:h}):[di];var o=-1;e=wn(e,zr(ot()));var s=yu(n,function(h,y,T){var P=wn(e,function(M){return M(h)});return{criteria:P,index:++o,value:h}});return function(h,y){var T=h.length;for(h.sort(y);T--;)h[T]=h[T].value;return h}(s,function(h,y){return function(T,P,M){for(var L=-1,B=T.criteria,U=P.criteria,F=B.length,q=M.length;++L<F;){var Y=gl(B[L],U[L]);if(Y)return L>=q?Y:Y*(M[L]=="desc"?-1:1)}return T.index-P.index}(h,y,t)})}function Su(n,e,t){for(var o=-1,s=e.length,h={};++o<s;){var y=e[o],T=Jr(n,y);t(T,y)&&Vo(h,uo(y,n),T)}return h}function Eu(n,e,t,o){var s=o?ys:no,h=-1,y=e.length,T=n;for(n===e&&(e=$n(e)),t&&(T=wn(n,zr(t)));++h<y;)for(var P=0,M=e[h],L=t?t(M):M;(P=s(T,L,P,o))>-1;)T!==n&&io.call(T,P,1),io.call(n,P,1);return n}function Ac(n,e){for(var t=n?e.length:0,o=t-1;t--;){var s=e[t];if(t==o||s!==h){var h=s;Ln(s)?io.call(n,s,1):Ha(n,s)}}return n}function xs(n,e){return n+Ua(Tc()*(e-n+1))}function Ot(n,e){var t="";if(!n||e<1||e>N)return t;do e%2&&(t+=n),(e=Ua(e/2))&&(n+=n);while(e);return t}function _t(n,e){return Vs(rr(n,e,di),n+"")}function Ds(n){return Kr(Yn(n))}function Xr(n,e){var t=Yn(n);return Ws(t,ci(e,0,t.length))}function Vo(n,e,t,o){if(!_n(n))return n;for(var s=-1,h=(e=uo(e,n)).length,y=h-1,T=n;T!=null&&++s<h;){var P=lo(e[s]),M=t;if(P==="__proto__"||P==="constructor"||P==="prototype")return n;if(s!=y){var L=T[P];(M=o?o(L,P,T):b)===b&&(M=_n(L)?L:Ln(e[s+1])?[]:{})}so(T,P,M),T=T[P]}return n}var Cr=$a?function(n,e){return $a.set(n,e),n}:di,pa=Ba?function(n,e){return Ba(n,"toString",{configurable:!0,enumerable:!1,value:Ir(e),writable:!0})}:di;function kt(n){return Ws(Yn(n))}function Si(n,e,t){var o=-1,s=n.length;e<0&&(e=-e>s?0:s+e),(t=t>s?s:t)<0&&(t+=s),s=e>t?0:t-e>>>0,e>>>=0;for(var h=ge(s);++o<s;)h[o]=n[o+e];return h}function Ei(n,e){var t;return _r(n,function(o,s,h){return!(t=e(o,s,h))}),!!t}function Ga(n,e,t){var o=0,s=n==null?o:n.length;if(typeof e=="number"&&e==e&&s<=2147483647){for(;o<s;){var h=o+s>>>1,y=n[h];y!==null&&!zt(y)&&(t?y<=e:y<e)?o=h+1:s=h}return s}return Pc(n,e,di,t)}function Pc(n,e,t,o){var s=0,h=n==null?0:n.length;if(h===0)return 0;for(var y=(e=t(e))!=e,T=e===null,P=zt(e),M=e===b;s<h;){var L=Ua((s+h)/2),B=t(n[L]),U=B!==b,F=B===null,q=B==B,Y=zt(B);if(y)var z=o||q;else z=M?q&&(o||U):T?q&&U&&(o||!F):P?q&&U&&!F&&(o||!Y):!F&&!Y&&(o?B<=e:B<e);z?s=L+1:h=L}return Yt(h,4294967294)}function _u(n,e){for(var t=-1,o=n.length,s=0,h=[];++t<o;){var y=n[t],T=e?e(y):y;if(!t||!Hi(T,P)){var P=T;h[s++]=y===0?0:y}}return h}function Qr(n){return typeof n=="number"?n:zt(n)?$:+n}function en(n){if(typeof n=="string")return n;if(Xe(n))return wn(n,en)+"";if(zt(n))return ua?ua.call(n):"";var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}function _i(n,e,t){var o=-1,s=Bi,h=n.length,y=!0,T=[],P=T;if(t)y=!1,s=Ma;else if(h>=200){var M=e?null:od(n);if(M)return ji(M);y=!1,s=oa,P=new si}else P=e?[]:T;e:for(;++o<h;){var L=n[o],B=e?e(L):L;if(L=t||L!==0?L:0,y&&B==B){for(var U=P.length;U--;)if(P[U]===B)continue e;e&&P.push(B),T.push(L)}else s(P,B,t)||(P!==T&&P.push(B),T.push(L))}return T}function Ha(n,e){return(n=$s(n,e=uo(e,n)))==null||delete n[lo(Wi(e))]}function Wo(n,e,t,o){return Vo(n,e,t(Jr(n,e)),o)}function za(n,e,t,o){for(var s=n.length,h=o?s:-1;(o?h--:++h<s)&&e(n[h],h,n););return t?Si(n,o?0:h,o?h+1:s):Si(n,o?h+1:0,o?s:h)}function Cu(n,e){var t=n;return t instanceof Fe&&(t=t.value()),to(e,function(o,s){return s.func.apply(s.thisArg,It([o],s.args))},t)}function _o(n,e,t){var o=n.length;if(o<2)return o?_i(n[0]):[];for(var s=-1,h=ge(o);++s<o;)for(var y=n[s],T=-1;++T<o;)T!=s&&(h[s]=co(h[s]||y,n[T],e,t));return _i(Gt(h,1),e,t)}function $i(n,e,t){for(var o=-1,s=n.length,h=e.length,y={};++o<s;){var T=o<h?e[o]:b;t(y,n[o],T)}return y}function Go(n){return Wt(n)?n:[]}function pr(n){return typeof n=="function"?n:di}function uo(n,e){return Xe(n)?n:Xa(n,e)?[n]:Du(xt(n))}var Ci=_t;function Ho(n,e,t){var o=n.length;return t=t===b?o:t,!e&&t>=o?n:Si(n,e,t)}var xc=uh||function(n){return et.clearTimeout(n)};function qa(n,e){if(e)return n.slice();var t=n.length,o=ul?ul(t):new n.constructor(t);return n.copy(o),o}function ma(n){var e=new n.constructor(n.byteLength);return new ca(e).set(new ca(n)),e}function Tu(n,e){var t=e?ma(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}function gl(n,e){if(n!==e){var t=n!==b,o=n===null,s=n==n,h=zt(n),y=e!==b,T=e===null,P=e==e,M=zt(e);if(!T&&!M&&!h&&n>e||h&&y&&P&&!T&&!M||o&&y&&P||!t&&P||!s)return 1;if(!o&&!h&&!M&&n<e||M&&t&&s&&!o&&!h||T&&t&&s||!y&&s||!P)return-1}return 0}function vl(n,e,t,o){for(var s=-1,h=n.length,y=t.length,T=-1,P=e.length,M=Nt(h-y,0),L=ge(P+M),B=!o;++T<P;)L[T]=e[T];for(;++s<y;)(B||s<h)&&(L[t[s]]=n[s]);for(;M--;)L[T++]=n[s++];return L}function Zr(n,e,t,o){for(var s=-1,h=n.length,y=-1,T=t.length,P=-1,M=e.length,L=Nt(h-T,0),B=ge(L+M),U=!o;++s<L;)B[s]=n[s];for(var F=s;++P<M;)B[F+P]=e[P];for(;++y<T;)(U||s<h)&&(B[F+t[y]]=n[s++]);return B}function $n(n,e){var t=-1,o=n.length;for(e||(e=ge(o));++t<o;)e[t]=n[t];return e}function ui(n,e,t,o){var s=!t;t||(t={});for(var h=-1,y=e.length;++h<y;){var T=e[h],P=o?o(t[T],n[T],T,t,n):b;P===b&&(P=n[T]),s?qn(t,T,P):so(t,T,P)}return t}function Co(n,e){return function(t,o){var s=Xe(t)?gi:hl,h=e?e():{};return s(t,n,ot(o,2),h)}}function To(n){return _t(function(e,t){var o=-1,s=t.length,h=s>1?t[s-1]:b,y=s>2?t[2]:b;for(h=n.length>3&&typeof h=="function"?(s--,h):b,y&&gr(t[0],t[1],y)&&(h=s<3?b:h,s=1),e=pt(e);++o<s;){var T=t[o];T&&n(e,T,o,h)}return e})}function yl(n,e){return function(t,o){if(t==null)return t;if(!ni(t))return n(t,o);for(var s=t.length,h=e?s:-1,y=pt(t);(e?h--:++h<s)&&o(y[h],h,y)!==!1;);return t}}function bl(n){return function(e,t,o){for(var s=-1,h=pt(e),y=o(e),T=y.length;T--;){var P=y[n?T:++s];if(t(h[P],P,h)===!1)break}return e}}function Ka(n){return function(e){var t=Es(e=xt(e))?zn(e):b,o=t?t[0]:e.charAt(0),s=t?Ho(t,1).join(""):e.slice(1);return o[n]()+s}}function Ro(n){return function(e){return to(Ys(Pl(e).replace(Zu,"")),n,"")}}function Ms(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=ct(n.prototype),o=n.apply(t,e);return _n(o)?o:t}}function Ru(n){return function(e,t,o){var s=pt(e);if(!ni(e)){var h=ot(t,3);e=cn(e),t=function(T){return h(s[T],T,s)}}var y=n(e,t,o);return y>-1?s[h?e[y]:y]:b}}function Ns(n){return Tr(function(e){var t=e.length,o=t,s=In.prototype.thru;for(n&&e.reverse();o--;){var h=e[o];if(typeof h!="function")throw new Kt(I);if(s&&!y&&qo(h)=="wrapper")var y=new In([],!0)}for(o=y?o:t;++o<t;){var T=qo(h=e[o]),P=T=="wrapper"?zo(h):b;y=P&&ku(P[0])&&P[1]==424&&!P[4].length&&P[9]==1?y[qo(P[0])].apply(y,P[3]):h.length==1&&ku(h)?y[T]():y.thru(h)}return function(){var M=arguments,L=M[0];if(y&&M.length==1&&Xe(L))return y.plant(L).value();for(var B=0,U=t?e[B].apply(this,M):L;++B<t;)U=e[B].call(this,U);return U}})}function li(n,e,t,o,s,h,y,T,P,M){var L=e&j,B=1&e,U=2&e,F=24&e,q=512&e,Y=U?b:Ms(n);return function z(){for(var re=arguments.length,ue=ge(re),le=re;le--;)ue[le]=arguments[le];if(F)var ve=st(z),be=function(Me,Le){for(var Ae=Me.length,Pe=0;Ae--;)Me[Ae]===Le&&++Pe;return Pe}(ue,ve);if(o&&(ue=vl(ue,o,s,F)),h&&(ue=Zr(ue,h,y,F)),re-=be,F&&re<M){var ye=Lo(ue,ve);return wu(n,e,li,z.placeholder,t,ue,ye,T,P,M-re)}var pe=B?t:this,Re=U?pe[n]:n;return re=ue.length,T?ue=function(Me,Le){for(var Ae=Me.length,Pe=Yt(Le.length,Ae),qe=$n(Me);Pe--;){var gt=Le[Pe];Me[Pe]=Ln(gt,Ae)?qe[gt]:b}return Me}(ue,T):q&&re>1&&ue.reverse(),L&&P<re&&(ue.length=P),this&&this!==et&&this instanceof z&&(Re=Y||Ms(Re)),Re.apply(pe,ue)}}function Ls(n,e){return function(t,o){return function(s,h,y,T){return tr(s,function(P,M,L){h(T,y(P),M,L)}),T}(t,n,e(o),{})}}function Ya(n,e){return function(t,o){var s;if(t===b&&o===b)return e;if(t!==b&&(s=t),o!==b){if(s===b)return o;typeof t=="string"||typeof o=="string"?(t=en(t),o=en(o)):(t=Qr(t),o=Qr(o)),s=n(t,o)}return s}}function Bs(n){return Tr(function(e){return e=wn(e,zr(ot())),_t(function(t){var o=this;return n(e,function(s){return Gr(s,o,t)})})})}function Dc(n,e){var t=(e=e===b?" ":en(e)).length;if(t<2)return t?Ot(e,n):e;var o=Ot(e,ja(n/ro(e)));return Es(e)?Ho(zn(o),0,n).join(""):o.slice(0,n)}function Mc(n){return function(e,t,o){return o&&typeof o!="number"&&gr(e,t,o)&&(t=o=b),e=An(e),t===b?(t=e,e=0):t=An(t),function(s,h,y,T){for(var P=-1,M=Nt(ja((h-s)/(y||1)),0),L=ge(M);M--;)L[T?M:++P]=s,s+=y;return L}(e,t,o=o===b?e<t?1:-1:An(o),n)}}function Nc(n){return function(e,t){return typeof e=="string"&&typeof t=="string"||(e=ri(e),t=ri(t)),n(e,t)}}function wu(n,e,t,o,s,h,y,T,P,M){var L=8&e;e|=L?v:O,4&(e&=~(L?O:v))||(e&=-4);var B=[n,e,s,L?h:b,L?y:b,L?b:h,L?b:y,T,P,M],U=t.apply(b,B);return ku(n)&&es(U,B),U.placeholder=o,xu(U,n,e)}function Sl(n){var e=Mn[n];return function(t,o){if(t=ri(t),(o=o==null?0:Yt(He(o),292))&&Fa(t)){var s=(xt(t)+"e").split("e");return+((s=(xt(e(s[0]+"e"+(+s[1]+o)))+"e").split("e"))[0]+"e"+(+s[1]-o))}return e(t)}}var od=oo&&1/ji(new oo([,-0]))[1]==x?function(n){return new oo(n)}:Jn;function wo(n){return function(e){var t=mr(e);return t==ne?aa(e):t==he?lu(e):function(o,s){return wn(s,function(h){return[h,o[h]]})}(e,n(e))}}function Io(n,e,t,o,s,h,y,T){var P=2&e;if(!P&&typeof n!="function")throw new Kt(I);var M=o?o.length:0;if(M||(e&=-97,o=s=b),y=y===b?y:Nt(He(y),0),T=T===b?T:He(T),M-=s?s.length:0,e&O){var L=o,B=s;o=s=b}var U=P?b:zo(n),F=[n,e,t,o,s,L,B,h,y,T];if(U&&function(Y,z){var re=Y[1],ue=z[1],le=re|ue,ve=le<131,be=ue==j&&re==8||ue==j&&re==D&&Y[7].length<=z[8]||ue==384&&z[7].length<=z[8]&&re==8;if(!ve&&!be)return Y;1&ue&&(Y[2]=z[2],le|=1&re?0:4);var ye=z[3];if(ye){var pe=Y[3];Y[3]=pe?vl(pe,ye,z[4]):ye,Y[4]=pe?Lo(Y[3],A):z[4]}(ye=z[5])&&(pe=Y[5],Y[5]=pe?Zr(pe,ye,z[6]):ye,Y[6]=pe?Lo(Y[5],A):z[6]),(ye=z[7])&&(Y[7]=ye),ue&j&&(Y[8]=Y[8]==null?z[8]:Yt(Y[8],z[8])),Y[9]==null&&(Y[9]=z[9]),Y[0]=z[0],Y[1]=le}(F,U),n=F[0],e=F[1],t=F[2],o=F[3],s=F[4],!(T=F[9]=F[9]===b?P?0:n.length:Nt(F[9]-M,0))&&24&e&&(e&=-25),e&&e!=1)q=e==8||e==C?function(Y,z,re){var ue=Ms(Y);return function le(){for(var ve=arguments.length,be=ge(ve),ye=ve,pe=st(le);ye--;)be[ye]=arguments[ye];var Re=ve<3&&be[0]!==pe&&be[ve-1]!==pe?[]:Lo(be,pe);return(ve-=Re.length)<re?wu(Y,z,li,le.placeholder,b,be,Re,b,b,re-ve):Gr(this&&this!==et&&this instanceof le?ue:Y,this,be)}}(n,e,T):e!=v&&e!=33||s.length?li.apply(b,F):function(Y,z,re,ue){var le=1&z,ve=Ms(Y);return function be(){for(var ye=-1,pe=arguments.length,Re=-1,Me=ue.length,Le=ge(Me+pe),Ae=this&&this!==et&&this instanceof be?ve:Y;++Re<Me;)Le[Re]=ue[Re];for(;pe--;)Le[Re++]=arguments[++ye];return Gr(Ae,le?re:this,Le)}}(n,e,t,o);else var q=function(Y,z,re){var ue=1&z,le=Ms(Y);return function ve(){return(this&&this!==et&&this instanceof ve?le:Y).apply(ue?re:this,arguments)}}(n,e,t);return xu((U?Cr:es)(q,F),n,e)}function js(n,e,t,o){return n===b||Hi(n,bi[t])&&!rt.call(o,t)?e:n}function Us(n,e,t,o,s,h){return _n(n)&&_n(e)&&(h.set(e,n),Ps(n,e,b,Us,h),h.delete(e)),n}function Ja(n){return zs(n)?b:n}function ei(n,e,t,o,s,h){var y=1&t,T=n.length,P=e.length;if(T!=P&&!(y&&P>T))return!1;var M=h.get(n),L=h.get(e);if(M&&L)return M==e&&L==n;var B=-1,U=!0,F=2&t?new si:b;for(h.set(n,e),h.set(e,n);++B<T;){var q=n[B],Y=e[B];if(o)var z=y?o(Y,q,B,e,n,h):o(q,Y,B,n,e,h);if(z!==b){if(z)continue;U=!1;break}if(F){if(!ol(e,function(re,ue){if(!oa(F,ue)&&(q===re||s(q,re,t,o,h)))return F.push(ue)})){U=!1;break}}else if(q!==Y&&!s(q,Y,t,o,h)){U=!1;break}}return h.delete(n),h.delete(e),U}function Tr(n){return Vs(rr(n,b,Bc),n+"")}function ko(n){return Ic(n,cn,Lc)}function Vi(n){return Ic(n,Rt,Wn)}var zo=$a?function(n){return $a.get(n)}:Jn;function qo(n){for(var e=n.name+"",t=Fi[e],o=rt.call(Fi,e)?t.length:0;o--;){var s=t[o],h=s.func;if(h==null||h==n)return s.name}return e}function st(n){return(rt.call(k,"placeholder")?k:n).placeholder}function ot(){var n=k.iteratee||jr;return n=n===jr?vu:n,arguments.length?n(arguments[0],arguments[1]):n}function Fs(n,e){var t,o,s=n.__data__;return((o=typeof(t=e))=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null)?s[typeof e=="string"?"string":"hash"]:s.map}function Ko(n){for(var e=cn(n),t=e.length;t--;){var o=e[t],s=n[o];e[t]=[o,s,Ou(s)]}return e}function Ti(n,e){var t=function(o,s){return o==null?b:o[s]}(n,e);return Ue(t)?t:b}var Lc=Cs?function(n){return n==null?[]:(n=pt(n),eo(Cs(n),function(e){return Cc.call(n,e)}))}:ss,Wn=Cs?function(n){for(var e=[];n;)It(e,Lc(n)),n=La(n);return e}:ss,mr=on;function Iu(n,e,t){for(var o=-1,s=(e=uo(e,n)).length,h=!1;++o<s;){var y=lo(e[o]);if(!(h=n!=null&&t(n,y)))break;n=n[y]}return h||++o!=s?h:!!(s=n==null?0:n.length)&&Jo(s)&&Ln(y,s)&&(Xe(n)||ho(n))}function El(n){return typeof n.constructor!="function"||Za(n)?{}:ct(La(n))}function Oo(n){return Xe(n)||ho(n)||!!(dl&&n&&n[dl])}function Ln(n,e){var t=typeof n;return!!(e=e??N)&&(t=="number"||t!="symbol"&&oe.test(n))&&n>-1&&n%1==0&&n<e}function gr(n,e,t){if(!_n(t))return!1;var o=typeof e;return!!(o=="number"?ni(t)&&Ln(e,t.length):o=="string"&&e in t)&&Hi(t[e],n)}function Xa(n,e){if(Xe(n))return!1;var t=typeof n;return!(t!="number"&&t!="symbol"&&t!="boolean"&&n!=null&&!zt(n))||Ee.test(n)||!me.test(n)||e!=null&&n in pt(e)}function ku(n){var e=qo(n),t=k[e];if(typeof t!="function"||!(e in Fe.prototype))return!1;if(n===t)return!0;var o=zo(t);return!!o&&n===o[0]}(Ts&&mr(new Ts(new ArrayBuffer(1)))!=vt||Oe&&mr(new Oe)!=ne||Sn&&mr(Sn.resolve())!=X||oo&&mr(new oo)!=he||Uo&&mr(new Uo)!=Qe)&&(mr=function(n){var e=on(n),t=e==W?n.constructor:b,o=t?Br(t):"";if(o)switch(o){case fh:return vt;case Va:return ne;case td:return X;case Nr:return he;case nd:return Qe}return e});var Qa=Ui?fo:Js;function Za(n){var e=n&&n.constructor;return n===(typeof e=="function"&&e.prototype||bi)}function Ou(n){return n==n&&!_n(n)}function Au(n,e){return function(t){return t!=null&&t[n]===e&&(e!==b||n in pt(t))}}function rr(n,e,t){return e=Nt(e===b?n.length-1:e,0),function(){for(var o=arguments,s=-1,h=Nt(o.length-e,0),y=ge(h);++s<h;)y[s]=o[e+s];s=-1;for(var T=ge(e+1);++s<e;)T[s]=o[s];return T[e]=t(y),Gr(n,this,T)}}function $s(n,e){return e.length<2?n:Jr(n,Si(e,0,-1))}function Pu(n,e){if((e!=="constructor"||typeof n[e]!="function")&&e!="__proto__")return n[e]}var es=Ao(Cr),ga=Ql||function(n,e){return et.setTimeout(n,e)},Vs=Ao(pa);function xu(n,e,t){var o=e+"";return Vs(n,function(s,h){var y=h.length;if(!y)return s;var T=y-1;return h[T]=(y>1?"& ":"")+h[T],h=h.join(y>2?", ":" "),s.replace(Ve,`{
/* [wrapped with `+h+`] */
`)}(o,function(s,h){return vi(K,function(y){var T="_."+y[0];h&y[1]&&!Bi(s,T)&&s.push(T)}),s.sort()}(function(s){var h=s.match(Be);return h?h[1].split(Hn):[]}(o),t)))}function Ao(n){var e=0,t=0;return function(){var o=hu(),s=16-(o-t);if(t=o,s>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(b,arguments)}}function Ws(n,e){var t=-1,o=n.length,s=o-1;for(e=e===b?o:e;++t<e;){var h=xs(t,s),y=n[h];n[h]=n[t],n[t]=y}return n.length=e,n}var Du=function(n){var e=$u(n,function(o){return t.size===500&&t.clear(),o}),t=e.cache;return e}(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(ke,function(t,o,s,h){e.push(s?h.replace(Ke,"$1"):o||t)}),e});function lo(n){if(typeof n=="string"||zt(n))return n;var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}function Br(n){if(n!=null){try{return Je.call(n)}catch{}try{return n+""}catch{}}return""}function va(n){if(n instanceof Fe)return n.clone();var e=new In(n.__wrapped__,n.__chain__);return e.__actions__=$n(n.__actions__),e.__index__=n.__index__,e.__values__=n.__values__,e}var ad=_t(function(n,e){return Wt(n)?co(n,Gt(e,1,Wt,!0)):[]}),mh=_t(function(n,e){var t=Wi(e);return Wt(t)&&(t=b),Wt(n)?co(n,Gt(e,1,Wt,!0),ot(t,2)):[]}),_l=_t(function(n,e){var t=Wi(e);return Wt(t)&&(t=b),Wt(n)?co(n,Gt(e,1,Wt,!0),b,t):[]});function Mu(n,e,t){var o=n==null?0:n.length;if(!o)return-1;var s=t==null?0:He(t);return s<0&&(s=Nt(o+s,0)),yc(n,ot(e,3),s)}function Nu(n,e,t){var o=n==null?0:n.length;if(!o)return-1;var s=o-1;return t!==b&&(s=He(t),s=t<0?Nt(o+s,0):Yt(s,o-1)),yc(n,ot(e,3),s,!0)}function Bc(n){return n!=null&&n.length?Gt(n,1):[]}function Cl(n){return n&&n.length?n[0]:b}var sd=_t(function(n){var e=wn(n,Go);return e.length&&e[0]===n[0]?As(e):[]}),gh=_t(function(n){var e=Wi(n),t=wn(n,Go);return e===Wi(t)?e=b:t.pop(),t.length&&t[0]===n[0]?As(t,ot(e,2)):[]}),cd=_t(function(n){var e=Wi(n),t=wn(n,Go);return(e=typeof e=="function"?e:b)&&t.pop(),t.length&&t[0]===n[0]?As(t,b,e):[]});function Wi(n){var e=n==null?0:n.length;return e?n[e-1]:b}var ti=_t(ud);function ud(n,e){return n&&n.length&&e&&e.length?Eu(n,e):n}var ld=Tr(function(n,e){var t=n==null?0:n.length,o=Rs(n,e);return Ac(n,wn(e,function(s){return Ln(s,t)?+s:s}).sort(gl)),o});function ts(n){return n==null?n:ed.call(n)}var Gs=_t(function(n){return _i(Gt(n,1,Wt,!0))}),dd=_t(function(n){var e=Wi(n);return Wt(e)&&(e=b),_i(Gt(n,1,Wt,!0),ot(e,2))}),vh=_t(function(n){var e=Wi(n);return e=typeof e=="function"?e:b,_i(Gt(n,1,Wt,!0),b,e)});function Tl(n){if(!n||!n.length)return[];var e=0;return n=eo(n,function(t){if(Wt(t))return e=Nt(t.length,e),!0}),Sc(e,function(t){return wn(n,Hr(t))})}function Lu(n,e){if(!n||!n.length)return[];var t=Tl(n);return e==null?t:wn(t,function(o){return Gr(e,b,o)})}var hd=_t(function(n,e){return Wt(n)?co(n,e):[]}),yh=_t(function(n){return _o(eo(n,Wt))}),bh=_t(function(n){var e=Wi(n);return Wt(e)&&(e=b),_o(eo(n,Wt),ot(e,2))}),fd=_t(function(n){var e=Wi(n);return e=typeof e=="function"?e:b,_o(eo(n,Wt),b,e)}),Sh=_t(Tl),Eh=_t(function(n){var e=n.length,t=e>1?n[e-1]:b;return t=typeof t=="function"?(n.pop(),t):b,Lu(n,t)});function Rl(n){var e=k(n);return e.__chain__=!0,e}function jc(n,e){return e(n)}var Bu=Tr(function(n){var e=n.length,t=e?n[0]:0,o=this.__wrapped__,s=function(h){return Rs(h,n)};return!(e>1||this.__actions__.length)&&o instanceof Fe&&Ln(t)?((o=o.slice(t,+t+(e?1:0))).__actions__.push({func:jc,args:[s],thisArg:b}),new In(o,this.__chain__).thru(function(h){return e&&!h.length&&h.push(b),h})):this.thru(s)}),_h=Co(function(n,e,t){rt.call(n,t)?++n[t]:qn(n,t,1)}),Ch=Ru(Mu),Th=Ru(Nu);function pd(n,e){return(Xe(n)?vi:_r)(n,ot(e,3))}function wl(n,e){return(Xe(n)?yi:pu)(n,ot(e,3))}var md=Co(function(n,e,t){rt.call(n,t)?n[t].push(e):qn(n,t,[e])}),Rh=_t(function(n,e,t){var o=-1,s=typeof e=="function",h=ni(n)?ge(n.length):[];return _r(n,function(y){h[++o]=s?Gr(e,y,t):$o(y,e,t)}),h}),gd=Co(function(n,e,t){qn(n,t,e)});function ns(n,e){return(Xe(n)?wn:yu)(n,ot(e,3))}var Rr=Co(function(n,e,t){n[t?0:1].push(e)},function(){return[[],[]]}),Gi=_t(function(n,e){if(n==null)return[];var t=e.length;return t>1&&gr(n,e[0],e[1])?e=[]:t>2&&gr(e[0],e[1],e[2])&&(e=[e[0]]),fa(n,Gt(e,1),[])}),an=_s||function(){return et.Date.now()};function Uc(n,e,t){return e=t?b:e,e=n&&e==null?n.length:e,Io(n,j,b,b,b,b,e)}function ju(n,e){var t;if(typeof e!="function")throw new Kt(I);return n=He(n),function(){return--n>0&&(t=e.apply(this,arguments)),n<=1&&(e=b),t}}var Uu=_t(function(n,e,t){var o=1;if(t.length){var s=Lo(t,st(Uu));o|=v}return Io(n,o,e,t,s)}),Fc=_t(function(n,e,t){var o=3;if(t.length){var s=Lo(t,st(Fc));o|=v}return Io(e,o,n,t,s)});function Fu(n,e,t){var o,s,h,y,T,P,M=0,L=!1,B=!1,U=!0;if(typeof n!="function")throw new Kt(I);function F(ue){var le=o,ve=s;return o=s=b,M=ue,y=n.apply(ve,le)}function q(ue){var le=ue-P;return P===b||le>=e||le<0||B&&ue-M>=h}function Y(){var ue=an();if(q(ue))return z(ue);T=ga(Y,function(le){var ve=e-(le-P);return B?Yt(ve,h-(le-M)):ve}(ue))}function z(ue){return T=b,U&&o?F(ue):(o=s=b,y)}function re(){var ue=an(),le=q(ue);if(o=arguments,s=this,P=ue,le){if(T===b)return function(ve){return M=ve,T=ga(Y,e),L?F(ve):y}(P);if(B)return xc(T),T=ga(Y,e),F(P)}return T===b&&(T=ga(Y,e)),y}return e=ri(e)||0,_n(t)&&(L=!!t.leading,h=(B="maxWait"in t)?Nt(ri(t.maxWait)||0,e):h,U="trailing"in t?!!t.trailing:U),re.cancel=function(){T!==b&&xc(T),M=0,o=P=s=T=b},re.flush=function(){return T===b?y:z(an())},re}var vd=_t(function(n,e){return wc(n,1,e)}),wh=_t(function(n,e,t){return wc(n,ri(e)||0,t)});function $u(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new Kt(I);var t=function(){var o=arguments,s=e?e.apply(this,o):o[0],h=t.cache;if(h.has(s))return h.get(s);var y=n.apply(this,o);return t.cache=h.set(s,y)||h,y};return t.cache=new($u.Cache||Fn),t}function rs(n){if(typeof n!="function")throw new Kt(I);return function(){var e=arguments;switch(e.length){case 0:return!n.call(this);case 1:return!n.call(this,e[0]);case 2:return!n.call(this,e[0],e[1]);case 3:return!n.call(this,e[0],e[1],e[2])}return!n.apply(this,e)}}$u.Cache=Fn;var Vu=Ci(function(n,e){var t=(e=e.length==1&&Xe(e[0])?wn(e[0],zr(ot())):wn(Gt(e,1),zr(ot()))).length;return _t(function(o){for(var s=-1,h=Yt(o.length,t);++s<h;)o[s]=e[s].call(this,o[s]);return Gr(n,this,o)})}),Il=_t(function(n,e){var t=Lo(e,st(Il));return Io(n,v,b,e,t)}),Hs=_t(function(n,e){var t=Lo(e,st(Hs));return Io(n,O,b,e,t)}),wr=Tr(function(n,e){return Io(n,D,b,b,b,e)});function Hi(n,e){return n===e||n!=n&&e!=e}var zi=Nc(Os),Ih=Nc(function(n,e){return n>=e}),ho=gu(function(){return arguments}())?gu:function(n){return Ct(n)&&rt.call(n,"callee")&&!Cc.call(n,"callee")},Xe=ge.isArray,wt=jn?zr(jn):function(n){return Ct(n)&&on(n)==Tt};function ni(n){return n!=null&&Jo(n.length)&&!fo(n)}function Wt(n){return Ct(n)&&ni(n)}var Pt=lh||Js,Yo=gc?zr(gc):function(n){return Ct(n)&&on(n)==Se};function Wu(n){if(!Ct(n))return!1;var e=on(n);return e==G||e=="[object DOMException]"||typeof n.message=="string"&&typeof n.name=="string"&&!zs(n)}function fo(n){if(!_n(n))return!1;var e=on(n);return e==ie||e==de||e=="[object AsyncFunction]"||e=="[object Proxy]"}function En(n){return typeof n=="number"&&n==He(n)}function Jo(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=N}function _n(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}function Ct(n){return n!=null&&typeof n=="object"}var Vn=iu?zr(iu):function(n){return Ct(n)&&mr(n)==ne};function kl(n){return typeof n=="number"||Ct(n)&&on(n)==J}function zs(n){if(!Ct(n)||on(n)!=W)return!1;var e=La(n);if(e===null)return!0;var t=rt.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Je.call(t)==ah}var po=ou?zr(ou):function(n){return Ct(n)&&on(n)==se},Kn=vc?zr(vc):function(n){return Ct(n)&&mr(n)==he};function ya(n){return typeof n=="string"||!Xe(n)&&Ct(n)&&on(n)==Ie}function zt(n){return typeof n=="symbol"||Ct(n)&&on(n)==we}var kn=gs?zr(gs):function(n){return Ct(n)&&Jo(n.length)&&!!bn[on(n)]},qs=Nc(Oc),$c=Nc(function(n,e){return n<=e});function Vc(n){if(!n)return[];if(ni(n))return ya(n)?zn(n):$n(n);if(jo&&n[jo])return function(t){for(var o,s=[];!(o=t.next()).done;)s.push(o.value);return s}(n[jo]());var e=mr(n);return(e==ne?aa:e==he?ji:Yn)(n)}function An(n){return n?(n=ri(n))===x||n===-1/0?17976931348623157e292*(n<0?-1:1):n==n?n:0:n===0?n:0}function He(n){var e=An(n),t=e%1;return e==e?t?e-t:e:0}function St(n){return n?ci(He(n),0,H):0}function ri(n){if(typeof n=="number")return n;if(zt(n))return $;if(_n(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=_n(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=cu(n);var t=Mi.test(n);return t||Zi.test(n)?nl(n.slice(2),t?2:8):Mo.test(n)?$:+n}function Ri(n){return ui(n,Rt(n))}function xt(n){return n==null?"":en(n)}var ze=To(function(n,e){if(Za(e)||ni(e))ui(e,cn(e),n);else for(var t in e)rt.call(e,t)&&so(n,t,e[t])}),yd=To(function(n,e){ui(e,Rt(e),n)}),Wc=To(function(n,e,t,o){ui(e,Rt(e),n,o)}),Gu=To(function(n,e,t,o){ui(e,cn(e),n,o)}),kh=Tr(Rs),Hu=_t(function(n,e){n=pt(n);var t=-1,o=e.length,s=o>2?e[2]:b;for(s&&gr(e[0],e[1],s)&&(o=1);++t<o;)for(var h=e[t],y=Rt(h),T=-1,P=y.length;++T<P;){var M=y[T],L=n[M];(L===b||Hi(L,bi[M])&&!rt.call(n,M))&&(n[M]=h[M])}return n}),ba=_t(function(n){return n.push(b,Us),Gr(os,b,n)});function is(n,e,t){var o=n==null?b:Jr(n,e);return o===b?t:o}function Gc(n,e){return n!=null&&Iu(n,e,id)}var Ol=Ls(function(n,e,t){e!=null&&typeof e.toString!="function"&&(e=ht.call(e)),n[e]=t},Ir(di)),Oh=Ls(function(n,e,t){e!=null&&typeof e.toString!="function"&&(e=ht.call(e)),rt.call(n,e)?n[e].push(t):n[e]=[t]},ot),Ah=_t($o);function cn(n){return ni(n)?_e(n):ha(n)}function Rt(n){return ni(n)?_e(n,!0):nr(n)}var Gn=To(function(n,e,t){Ps(n,e,t)}),os=To(function(n,e,t,o){Ps(n,e,t,o)}),mo=Tr(function(n,e){var t={};if(n==null)return t;var o=!1;e=wn(e,function(h){return h=uo(h,n),o||(o=h.length>1),h}),ui(n,Vi(n),t),o&&(t=Nn(t,7,Ja));for(var s=e.length;s--;)Ha(t,e[s]);return t}),bd=Tr(function(n,e){return n==null?{}:function(t,o){return Su(t,o,function(s,h){return Gc(t,h)})}(n,e)});function zu(n,e){if(n==null)return{};var t=wn(Vi(n),function(o){return[o]});return e=ot(e),Su(n,t,function(o,s){return e(o,s[0])})}var go=wo(cn),Bn=wo(Rt);function Yn(n){return n==null?[]:Dr(n,cn(n))}var as=Ro(function(n,e,t){return e=e.toLowerCase(),n+(t?Al(e):e)});function Al(n){return Ks(xt(n).toLowerCase())}function Pl(n){return(n=xt(n))&&n.replace(fe,Xl).replace(Ni,"")}var xl=Ro(function(n,e,t){return n+(t?"-":"")+e.toLowerCase()}),Sd=Ro(function(n,e,t){return n+(t?" ":"")+e.toLowerCase()}),Ph=Ka("toLowerCase"),Ed=Ro(function(n,e,t){return n+(t?"_":"")+e.toLowerCase()}),Dl=Ro(function(n,e,t){return n+(t?" ":"")+Ks(e)}),_d=Ro(function(n,e,t){return n+(t?" ":"")+e.toUpperCase()}),Ks=Ka("toUpperCase");function Ys(n,e,t){return n=xt(n),(e=t?b:e)===b?function(o){return rh.test(o)}(n)?function(o){return o.match(ms)||[]}(n):function(o){return o.match(Dt)||[]}(n):n.match(e)||[]}var Ml=_t(function(n,e){try{return Gr(n,b,e)}catch(t){return Wu(t)?t:new We(t)}}),Cd=Tr(function(n,e){return vi(e,function(t){t=lo(t),qn(n,t,Uu(n[t],n))}),n});function Ir(n){return function(){return n}}var Hc=Ns(),Sa=Ns(!0);function di(n){return n}function jr(n){return vu(typeof n=="function"?n:Nn(n,1))}var qu=_t(function(n,e){return function(t){return $o(t,n,e)}}),Td=_t(function(n,e){return function(t){return $o(n,t,e)}});function Nl(n,e,t){var o=cn(e),s=Yr(e,o);t!=null||_n(e)&&(s.length||!o.length)||(t=e,e=n,n=this,s=Yr(e,cn(e)));var h=!(_n(t)&&"chain"in t&&!t.chain),y=fo(n);return vi(s,function(T){var P=e[T];n[T]=P,y&&(n.prototype[T]=function(){var M=this.__chain__;if(h||M){var L=n(this.__wrapped__);return(L.__actions__=$n(this.__actions__)).push({func:P,args:arguments,thisArg:n}),L.__chain__=M,L}return P.apply(n,It([this.value()],arguments))})}),n}function Jn(){}var Ur=Bs(wn),Ea=Bs(au),xh=Bs(ol);function fn(n){return Xa(n)?Hr(lo(n)):function(e){return function(t){return Jr(t,e)}}(n)}var Ll=Mc(),Dh=Mc(!0);function ss(){return[]}function Js(){return!1}var Bl=Ya(function(n,e){return n+e},0),_a=Sl("ceil"),Mh=Ya(function(n,e){return n/e},1),u=Sl("floor"),i,c=Ya(function(n,e){return n*e},1),l=Sl("round"),f=Ya(function(n,e){return n-e},0);return k.after=function(n,e){if(typeof e!="function")throw new Kt(I);return n=He(n),function(){if(--n<1)return e.apply(this,arguments)}},k.ary=Uc,k.assign=ze,k.assignIn=yd,k.assignInWith=Wc,k.assignWith=Gu,k.at=kh,k.before=ju,k.bind=Uu,k.bindAll=Cd,k.bindKey=Fc,k.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return Xe(n)?n:[n]},k.chain=Rl,k.chunk=function(n,e,t){e=(t?gr(n,e,t):e===b)?1:Nt(He(e),0);var o=n==null?0:n.length;if(!o||e<1)return[];for(var s=0,h=0,y=ge(ja(o/e));s<o;)y[h++]=Si(n,s,s+=e);return y},k.compact=function(n){for(var e=-1,t=n==null?0:n.length,o=0,s=[];++e<t;){var h=n[e];h&&(s[o++]=h)}return s},k.concat=function(){var n=arguments.length;if(!n)return[];for(var e=ge(n-1),t=arguments[0],o=n;o--;)e[o-1]=arguments[o];return It(Xe(t)?$n(t):[t],Gt(e,1))},k.cond=function(n){var e=n==null?0:n.length,t=ot();return n=e?wn(n,function(o){if(typeof o[1]!="function")throw new Kt(I);return[t(o[0]),o[1]]}):[],_t(function(o){for(var s=-1;++s<e;){var h=n[s];if(Gr(h[0],this,o))return Gr(h[1],this,o)}})},k.conforms=function(n){return function(e){var t=cn(e);return function(o){return Rc(o,e,t)}}(Nn(n,1))},k.constant=Ir,k.countBy=_h,k.create=function(n,e){var t=ct(n);return e==null?t:fl(t,e)},k.curry=function n(e,t,o){var s=Io(e,8,b,b,b,b,b,t=o?b:t);return s.placeholder=n.placeholder,s},k.curryRight=function n(e,t,o){var s=Io(e,C,b,b,b,b,b,t=o?b:t);return s.placeholder=n.placeholder,s},k.debounce=Fu,k.defaults=Hu,k.defaultsDeep=ba,k.defer=vd,k.delay=wh,k.difference=ad,k.differenceBy=mh,k.differenceWith=_l,k.drop=function(n,e,t){var o=n==null?0:n.length;return o?Si(n,(e=t||e===b?1:He(e))<0?0:e,o):[]},k.dropRight=function(n,e,t){var o=n==null?0:n.length;return o?Si(n,0,(e=o-(e=t||e===b?1:He(e)))<0?0:e):[]},k.dropRightWhile=function(n,e){return n&&n.length?za(n,ot(e,3),!0,!0):[]},k.dropWhile=function(n,e){return n&&n.length?za(n,ot(e,3),!0):[]},k.fill=function(n,e,t,o){var s=n==null?0:n.length;return s?(t&&typeof t!="number"&&gr(n,e,t)&&(t=0,o=s),function(h,y,T,P){var M=h.length;for((T=He(T))<0&&(T=-T>M?0:M+T),(P=P===b||P>M?M:He(P))<0&&(P+=M),P=T>P?0:St(P);T<P;)h[T++]=y;return h}(n,e,t,o)):[]},k.filter=function(n,e){return(Xe(n)?eo:mu)(n,ot(e,3))},k.flatMap=function(n,e){return Gt(ns(n,e),1)},k.flatMapDeep=function(n,e){return Gt(ns(n,e),x)},k.flatMapDepth=function(n,e,t){return t=t===b?1:He(t),Gt(ns(n,e),t)},k.flatten=Bc,k.flattenDeep=function(n){return n!=null&&n.length?Gt(n,x):[]},k.flattenDepth=function(n,e){return n!=null&&n.length?Gt(n,e=e===b?1:He(e)):[]},k.flip=function(n){return Io(n,512)},k.flow=Hc,k.flowRight=Sa,k.fromPairs=function(n){for(var e=-1,t=n==null?0:n.length,o={};++e<t;){var s=n[e];o[s[0]]=s[1]}return o},k.functions=function(n){return n==null?[]:Yr(n,cn(n))},k.functionsIn=function(n){return n==null?[]:Yr(n,Rt(n))},k.groupBy=md,k.initial=function(n){return n!=null&&n.length?Si(n,0,-1):[]},k.intersection=sd,k.intersectionBy=gh,k.intersectionWith=cd,k.invert=Ol,k.invertBy=Oh,k.invokeMap=Rh,k.iteratee=jr,k.keyBy=gd,k.keys=cn,k.keysIn=Rt,k.map=ns,k.mapKeys=function(n,e){var t={};return e=ot(e,3),tr(n,function(o,s,h){qn(t,e(o,s,h),o)}),t},k.mapValues=function(n,e){var t={};return e=ot(e,3),tr(n,function(o,s,h){qn(t,s,e(o,s,h))}),t},k.matches=function(n){return ml(Nn(n,1))},k.matchesProperty=function(n,e){return Wa(n,Nn(e,1))},k.memoize=$u,k.merge=Gn,k.mergeWith=os,k.method=qu,k.methodOf=Td,k.mixin=Nl,k.negate=rs,k.nthArg=function(n){return n=He(n),_t(function(e){return bu(e,n)})},k.omit=mo,k.omitBy=function(n,e){return zu(n,rs(ot(e)))},k.once=function(n){return ju(2,n)},k.orderBy=function(n,e,t,o){return n==null?[]:(Xe(e)||(e=e==null?[]:[e]),Xe(t=o?b:t)||(t=t==null?[]:[t]),fa(n,e,t))},k.over=Ur,k.overArgs=Vu,k.overEvery=Ea,k.overSome=xh,k.partial=Il,k.partialRight=Hs,k.partition=Rr,k.pick=bd,k.pickBy=zu,k.property=fn,k.propertyOf=function(n){return function(e){return n==null?b:Jr(n,e)}},k.pull=ti,k.pullAll=ud,k.pullAllBy=function(n,e,t){return n&&n.length&&e&&e.length?Eu(n,e,ot(t,2)):n},k.pullAllWith=function(n,e,t){return n&&n.length&&e&&e.length?Eu(n,e,b,t):n},k.pullAt=ld,k.range=Ll,k.rangeRight=Dh,k.rearg=wr,k.reject=function(n,e){return(Xe(n)?eo:mu)(n,rs(ot(e,3)))},k.remove=function(n,e){var t=[];if(!n||!n.length)return t;var o=-1,s=[],h=n.length;for(e=ot(e,3);++o<h;){var y=n[o];e(y,o,n)&&(t.push(y),s.push(o))}return Ac(n,s),t},k.rest=function(n,e){if(typeof n!="function")throw new Kt(I);return _t(n,e=e===b?e:He(e))},k.reverse=ts,k.sampleSize=function(n,e,t){return e=(t?gr(n,e,t):e===b)?1:He(e),(Xe(n)?ph:Xr)(n,e)},k.set=function(n,e,t){return n==null?n:Vo(n,e,t)},k.setWith=function(n,e,t,o){return o=typeof o=="function"?o:b,n==null?n:Vo(n,e,t,o)},k.shuffle=function(n){return(Xe(n)?fu:kt)(n)},k.slice=function(n,e,t){var o=n==null?0:n.length;return o?(t&&typeof t!="number"&&gr(n,e,t)?(e=0,t=o):(e=e==null?0:He(e),t=t===b?o:He(t)),Si(n,e,t)):[]},k.sortBy=Gi,k.sortedUniq=function(n){return n&&n.length?_u(n):[]},k.sortedUniqBy=function(n,e){return n&&n.length?_u(n,ot(e,2)):[]},k.split=function(n,e,t){return t&&typeof t!="number"&&gr(n,e,t)&&(e=t=b),(t=t===b?H:t>>>0)?(n=xt(n))&&(typeof e=="string"||e!=null&&!po(e))&&!(e=en(e))&&Es(n)?Ho(zn(n),0,t):n.split(e,t):[]},k.spread=function(n,e){if(typeof n!="function")throw new Kt(I);return e=e==null?0:Nt(He(e),0),_t(function(t){var o=t[e],s=Ho(t,0,e);return o&&It(s,o),Gr(n,this,s)})},k.tail=function(n){var e=n==null?0:n.length;return e?Si(n,1,e):[]},k.take=function(n,e,t){return n&&n.length?Si(n,0,(e=t||e===b?1:He(e))<0?0:e):[]},k.takeRight=function(n,e,t){var o=n==null?0:n.length;return o?Si(n,(e=o-(e=t||e===b?1:He(e)))<0?0:e,o):[]},k.takeRightWhile=function(n,e){return n&&n.length?za(n,ot(e,3),!1,!0):[]},k.takeWhile=function(n,e){return n&&n.length?za(n,ot(e,3)):[]},k.tap=function(n,e){return e(n),n},k.throttle=function(n,e,t){var o=!0,s=!0;if(typeof n!="function")throw new Kt(I);return _n(t)&&(o="leading"in t?!!t.leading:o,s="trailing"in t?!!t.trailing:s),Fu(n,e,{leading:o,maxWait:e,trailing:s})},k.thru=jc,k.toArray=Vc,k.toPairs=go,k.toPairsIn=Bn,k.toPath=function(n){return Xe(n)?wn(n,lo):zt(n)?[n]:$n(Du(xt(n)))},k.toPlainObject=Ri,k.transform=function(n,e,t){var o=Xe(n),s=o||Pt(n)||kn(n);if(e=ot(e,4),t==null){var h=n&&n.constructor;t=s?o?new h:[]:_n(n)&&fo(h)?ct(La(n)):{}}return(s?vi:tr)(n,function(y,T,P){return e(t,y,T,P)}),t},k.unary=function(n){return Uc(n,1)},k.union=Gs,k.unionBy=dd,k.unionWith=vh,k.uniq=function(n){return n&&n.length?_i(n):[]},k.uniqBy=function(n,e){return n&&n.length?_i(n,ot(e,2)):[]},k.uniqWith=function(n,e){return e=typeof e=="function"?e:b,n&&n.length?_i(n,b,e):[]},k.unset=function(n,e){return n==null||Ha(n,e)},k.unzip=Tl,k.unzipWith=Lu,k.update=function(n,e,t){return n==null?n:Wo(n,e,pr(t))},k.updateWith=function(n,e,t,o){return o=typeof o=="function"?o:b,n==null?n:Wo(n,e,pr(t),o)},k.values=Yn,k.valuesIn=function(n){return n==null?[]:Dr(n,Rt(n))},k.without=hd,k.words=Ys,k.wrap=function(n,e){return Il(pr(e),n)},k.xor=yh,k.xorBy=bh,k.xorWith=fd,k.zip=Sh,k.zipObject=function(n,e){return $i(n||[],e||[],so)},k.zipObjectDeep=function(n,e){return $i(n||[],e||[],Vo)},k.zipWith=Eh,k.entries=go,k.entriesIn=Bn,k.extend=yd,k.extendWith=Wc,Nl(k,k),k.add=Bl,k.attempt=Ml,k.camelCase=as,k.capitalize=Al,k.ceil=_a,k.clamp=function(n,e,t){return t===b&&(t=e,e=b),t!==b&&(t=(t=ri(t))==t?t:0),e!==b&&(e=(e=ri(e))==e?e:0),ci(ri(n),e,t)},k.clone=function(n){return Nn(n,4)},k.cloneDeep=function(n){return Nn(n,5)},k.cloneDeepWith=function(n,e){return Nn(n,5,e=typeof e=="function"?e:b)},k.cloneWith=function(n,e){return Nn(n,4,e=typeof e=="function"?e:b)},k.conformsTo=function(n,e){return e==null||Rc(n,e,cn(e))},k.deburr=Pl,k.defaultTo=function(n,e){return n==null||n!=n?e:n},k.divide=Mh,k.endsWith=function(n,e,t){n=xt(n),e=en(e);var o=n.length,s=t=t===b?o:ci(He(t),0,o);return(t-=e.length)>=0&&n.slice(t,s)==e},k.eq=Hi,k.escape=function(n){return(n=xt(n))&&oi.test(n)?n.replace(xi,ih):n},k.escapeRegExp=function(n){return(n=xt(n))&&Te.test(n)?n.replace($e,"\\$&"):n},k.every=function(n,e,t){var o=Xe(n)?au:pl;return t&&gr(n,e,t)&&(e=b),o(n,ot(e,3))},k.find=Ch,k.findIndex=Mu,k.findKey=function(n,e){return Zn(n,ot(e,3),tr)},k.findLast=Th,k.findLastIndex=Nu,k.findLastKey=function(n,e){return Zn(n,ot(e,3),ks)},k.floor=u,k.forEach=pd,k.forEachRight=wl,k.forIn=function(n,e){return n==null?n:ws(n,ot(e,3),Rt)},k.forInRight=function(n,e){return n==null?n:Is(n,ot(e,3),Rt)},k.forOwn=function(n,e){return n&&tr(n,ot(e,3))},k.forOwnRight=function(n,e){return n&&ks(n,ot(e,3))},k.get=is,k.gt=zi,k.gte=Ih,k.has=function(n,e){return n!=null&&Iu(n,e,rd)},k.hasIn=Gc,k.head=Cl,k.identity=di,k.includes=function(n,e,t,o){n=ni(n)?n:Yn(n),t=t&&!o?He(t):0;var s=n.length;return t<0&&(t=Nt(s+t,0)),ya(n)?t<=s&&n.indexOf(e,t)>-1:!!s&&no(n,e,t)>-1},k.indexOf=function(n,e,t){var o=n==null?0:n.length;if(!o)return-1;var s=t==null?0:He(t);return s<0&&(s=Nt(o+s,0)),no(n,e,s)},k.inRange=function(n,e,t){return e=An(e),t===b?(t=e,e=0):t=An(t),function(o,s,h){return o>=Yt(s,h)&&o<Nt(s,h)}(n=ri(n),e,t)},k.invoke=Ah,k.isArguments=ho,k.isArray=Xe,k.isArrayBuffer=wt,k.isArrayLike=ni,k.isArrayLikeObject=Wt,k.isBoolean=function(n){return n===!0||n===!1||Ct(n)&&on(n)==Z},k.isBuffer=Pt,k.isDate=Yo,k.isElement=function(n){return Ct(n)&&n.nodeType===1&&!zs(n)},k.isEmpty=function(n){if(n==null)return!0;if(ni(n)&&(Xe(n)||typeof n=="string"||typeof n.splice=="function"||Pt(n)||kn(n)||ho(n)))return!n.length;var e=mr(n);if(e==ne||e==he)return!n.size;if(Za(n))return!ha(n).length;for(var t in n)if(rt.call(n,t))return!1;return!0},k.isEqual=function(n,e){return Eo(n,e)},k.isEqualWith=function(n,e,t){var o=(t=typeof t=="function"?t:b)?t(n,e):b;return o===b?Eo(n,e,b,t):!!o},k.isError=Wu,k.isFinite=function(n){return typeof n=="number"&&Fa(n)},k.isFunction=fo,k.isInteger=En,k.isLength=Jo,k.isMap=Vn,k.isMatch=function(n,e){return n===e||kc(n,e,Ko(e))},k.isMatchWith=function(n,e,t){return t=typeof t=="function"?t:b,kc(n,e,Ko(e),t)},k.isNaN=function(n){return kl(n)&&n!=+n},k.isNative=function(n){if(Qa(n))throw new We("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ue(n)},k.isNil=function(n){return n==null},k.isNull=function(n){return n===null},k.isNumber=kl,k.isObject=_n,k.isObjectLike=Ct,k.isPlainObject=zs,k.isRegExp=po,k.isSafeInteger=function(n){return En(n)&&n>=-9007199254740991&&n<=N},k.isSet=Kn,k.isString=ya,k.isSymbol=zt,k.isTypedArray=kn,k.isUndefined=function(n){return n===b},k.isWeakMap=function(n){return Ct(n)&&mr(n)==Qe},k.isWeakSet=function(n){return Ct(n)&&on(n)=="[object WeakSet]"},k.join=function(n,e){return n==null?"":dh.call(n,e)},k.kebabCase=xl,k.last=Wi,k.lastIndexOf=function(n,e,t){var o=n==null?0:n.length;if(!o)return-1;var s=o;return t!==b&&(s=(s=He(t))<0?Nt(o+s,0):Yt(s,o-1)),e==e?function(h,y,T){for(var P=T+1;P--;)if(h[P]===y)return P;return P}(n,e,s):yc(n,Jl,s,!0)},k.lowerCase=Sd,k.lowerFirst=Ph,k.lt=qs,k.lte=$c,k.max=function(n){return n&&n.length?da(n,di,Os):b},k.maxBy=function(n,e){return n&&n.length?da(n,ot(e,2),Os):b},k.mean=function(n){return al(n,di)},k.meanBy=function(n,e){return al(n,ot(e,2))},k.min=function(n){return n&&n.length?da(n,di,Oc):b},k.minBy=function(n,e){return n&&n.length?da(n,ot(e,2),Oc):b},k.stubArray=ss,k.stubFalse=Js,k.stubObject=function(){return{}},k.stubString=function(){return""},k.stubTrue=function(){return!0},k.multiply=c,k.nth=function(n,e){return n&&n.length?bu(n,He(e)):b},k.noConflict=function(){return et._===this&&(et._=sh),this},k.noop=Jn,k.now=an,k.pad=function(n,e,t){n=xt(n);var o=(e=He(e))?ro(n):0;if(!e||o>=e)return n;var s=(e-o)/2;return Dc(Ua(s),t)+n+Dc(ja(s),t)},k.padEnd=function(n,e,t){n=xt(n);var o=(e=He(e))?ro(n):0;return e&&o<e?n+Dc(e-o,t):n},k.padStart=function(n,e,t){n=xt(n);var o=(e=He(e))?ro(n):0;return e&&o<e?Dc(e-o,t)+n:n},k.parseInt=function(n,e,t){return t||e==null?e=0:e&&(e=+e),hh(xt(n).replace(tt,""),e||0)},k.random=function(n,e,t){if(t&&typeof t!="boolean"&&gr(n,e,t)&&(e=t=b),t===b&&(typeof e=="boolean"?(t=e,e=b):typeof n=="boolean"&&(t=n,n=b)),n===b&&e===b?(n=0,e=1):(n=An(n),e===b?(e=n,n=0):e=An(e)),n>e){var o=n;n=e,e=o}if(t||n%1||e%1){var s=Tc();return Yt(n+s*(e-n+tl("1e-"+((s+"").length-1))),e)}return xs(n,e)},k.reduce=function(n,e,t){var o=Xe(n)?to:bc,s=arguments.length<3;return o(n,ot(e,4),t,s,_r)},k.reduceRight=function(n,e,t){var o=Xe(n)?il:bc,s=arguments.length<3;return o(n,ot(e,4),t,s,pu)},k.repeat=function(n,e,t){return e=(t?gr(n,e,t):e===b)?1:He(e),Ot(xt(n),e)},k.replace=function(){var n=arguments,e=xt(n[0]);return n.length<3?e:e.replace(n[1],n[2])},k.result=function(n,e,t){var o=-1,s=(e=uo(e,n)).length;for(s||(s=1,n=b);++o<s;){var h=n==null?b:n[lo(e[o])];h===b&&(o=s,h=t),n=fo(h)?h.call(n):h}return n},k.round=l,k.runInContext=V,k.sample=function(n){return(Xe(n)?Kr:Ds)(n)},k.size=function(n){if(n==null)return 0;if(ni(n))return ya(n)?ro(n):n.length;var e=mr(n);return e==ne||e==he?n.size:ha(n).length},k.snakeCase=Ed,k.some=function(n,e,t){var o=Xe(n)?ol:Ei;return t&&gr(n,e,t)&&(e=b),o(n,ot(e,3))},k.sortedIndex=function(n,e){return Ga(n,e)},k.sortedIndexBy=function(n,e,t){return Pc(n,e,ot(t,2))},k.sortedIndexOf=function(n,e){var t=n==null?0:n.length;if(t){var o=Ga(n,e);if(o<t&&Hi(n[o],e))return o}return-1},k.sortedLastIndex=function(n,e){return Ga(n,e,!0)},k.sortedLastIndexBy=function(n,e,t){return Pc(n,e,ot(t,2),!0)},k.sortedLastIndexOf=function(n,e){if(n!=null&&n.length){var t=Ga(n,e,!0)-1;if(Hi(n[t],e))return t}return-1},k.startCase=Dl,k.startsWith=function(n,e,t){return n=xt(n),t=t==null?0:ci(He(t),0,n.length),e=en(e),n.slice(t,t+e.length)==e},k.subtract=f,k.sum=function(n){return n&&n.length?su(n,di):0},k.sumBy=function(n,e){return n&&n.length?su(n,ot(e,2)):0},k.template=function(n,e,t){var o=k.templateSettings;t&&gr(n,e,t)&&(e=b),n=xt(n),e=Wc({},e,o,js);var s,h,y=Wc({},e.imports,o.imports,js),T=cn(y),P=Dr(y,T),M=0,L=e.interpolate||Ce,B="__p += '",U=Ec((e.escape||Ce).source+"|"+L.source+"|"+(L===Wr?Pr:Ce).source+"|"+(e.evaluate||Ce).source+"|$","g"),F="//# sourceURL="+(rt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++el+"]")+`
`;n.replace(U,function(z,re,ue,le,ve,be){return ue||(ue=le),B+=n.slice(M,be).replace(xe,oh),re&&(s=!0,B+=`' +
__e(`+re+`) +
'`),ve&&(h=!0,B+=`';
`+ve+`;
__p += '`),ue&&(B+=`' +
((__t = (`+ue+`)) == null ? '' : __t) +
'`),M=be+z.length,z}),B+=`';
`;var q=rt.call(e,"variable")&&e.variable;if(q){if(Mt.test(q))throw new We("Invalid `variable` option passed into `_.template`")}else B=`with (obj) {
`+B+`
}
`;B=(h?B.replace(it,""):B).replace(Ar,"$1").replace(ra,"$1;"),B="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(s?", __e = _.escape":"")+(h?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var Y=Ml(function(){return mt(T,F+"return "+B).apply(b,P)});if(Y.source=B,Wu(Y))throw Y;return Y},k.times=function(n,e){if((n=He(n))<1||n>N)return[];var t=H,o=Yt(n,H);e=ot(e),n-=H;for(var s=Sc(o,e);++t<n;)e(t);return s},k.toFinite=An,k.toInteger=He,k.toLength=St,k.toLower=function(n){return xt(n).toLowerCase()},k.toNumber=ri,k.toSafeInteger=function(n){return n?ci(He(n),-9007199254740991,N):n===0?n:0},k.toString=xt,k.toUpper=function(n){return xt(n).toUpperCase()},k.trim=function(n,e,t){if((n=xt(n))&&(t||e===b))return cu(n);if(!n||!(e=en(e)))return n;var o=zn(n),s=zn(e);return Ho(o,Ss(o,s),sl(o,s)+1).join("")},k.trimEnd=function(n,e,t){if((n=xt(n))&&(t||e===b))return n.slice(0,Un(n)+1);if(!n||!(e=en(e)))return n;var o=zn(n);return Ho(o,0,sl(o,zn(e))+1).join("")},k.trimStart=function(n,e,t){if((n=xt(n))&&(t||e===b))return n.replace(tt,"");if(!n||!(e=en(e)))return n;var o=zn(n);return Ho(o,Ss(o,zn(e))).join("")},k.truncate=function(n,e){var t=30,o="...";if(_n(e)){var s="separator"in e?e.separator:s;t="length"in e?He(e.length):t,o="omission"in e?en(e.omission):o}var h=(n=xt(n)).length;if(Es(n)){var y=zn(n);h=y.length}if(t>=h)return n;var T=t-ro(o);if(T<1)return o;var P=y?Ho(y,0,T).join(""):n.slice(0,T);if(s===b)return P+o;if(y&&(T+=P.length-T),po(s)){if(n.slice(T).search(s)){var M,L=P;for(s.global||(s=Ec(s.source,xt(xr.exec(s))+"g")),s.lastIndex=0;M=s.exec(L);)var B=M.index;P=P.slice(0,B===b?T:B)}}else if(n.indexOf(en(s),T)!=T){var U=P.lastIndexOf(s);U>-1&&(P=P.slice(0,U))}return P+o},k.unescape=function(n){return(n=xt(n))&&Di.test(n)?n.replace(Qt,du):n},k.uniqueId=function(n){var e=++cl;return xt(n)+e},k.upperCase=_d,k.upperFirst=Ks,k.each=pd,k.eachRight=wl,k.first=Cl,Nl(k,(i={},tr(k,function(n,e){rt.call(k.prototype,e)||(i[e]=n)}),i),{chain:!1}),k.VERSION="4.17.21",vi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){k[n].placeholder=k}),vi(["drop","take"],function(n,e){Fe.prototype[n]=function(t){t=t===b?1:Nt(He(t),0);var o=this.__filtered__&&!e?new Fe(this):this.clone();return o.__filtered__?o.__takeCount__=Yt(t,o.__takeCount__):o.__views__.push({size:Yt(t,H),type:n+(o.__dir__<0?"Right":"")}),o},Fe.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),vi(["filter","map","takeWhile"],function(n,e){var t=e+1,o=t==1||t==3;Fe.prototype[n]=function(s){var h=this.clone();return h.__iteratees__.push({iteratee:ot(s,3),type:t}),h.__filtered__=h.__filtered__||o,h}}),vi(["head","last"],function(n,e){var t="take"+(e?"Right":"");Fe.prototype[n]=function(){return this[t](1).value()[0]}}),vi(["initial","tail"],function(n,e){var t="drop"+(e?"":"Right");Fe.prototype[n]=function(){return this.__filtered__?new Fe(this):this[t](1)}}),Fe.prototype.compact=function(){return this.filter(di)},Fe.prototype.find=function(n){return this.filter(n).head()},Fe.prototype.findLast=function(n){return this.reverse().find(n)},Fe.prototype.invokeMap=_t(function(n,e){return typeof n=="function"?new Fe(this):this.map(function(t){return $o(t,n,e)})}),Fe.prototype.reject=function(n){return this.filter(rs(ot(n)))},Fe.prototype.slice=function(n,e){n=He(n);var t=this;return t.__filtered__&&(n>0||e<0)?new Fe(t):(n<0?t=t.takeRight(-n):n&&(t=t.drop(n)),e!==b&&(t=(e=He(e))<0?t.dropRight(-e):t.take(e-n)),t)},Fe.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Fe.prototype.toArray=function(){return this.take(H)},tr(Fe.prototype,function(n,e){var t=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),s=k[o?"take"+(e=="last"?"Right":""):e],h=o||/^find/.test(e);s&&(k.prototype[e]=function(){var y=this.__wrapped__,T=o?[1]:arguments,P=y instanceof Fe,M=T[0],L=P||Xe(y),B=function(re){var ue=s.apply(k,It([re],T));return o&&U?ue[0]:ue};L&&t&&typeof M=="function"&&M.length!=1&&(P=L=!1);var U=this.__chain__,F=!!this.__actions__.length,q=h&&!U,Y=P&&!F;if(!h&&L){y=Y?y:new Fe(this);var z=n.apply(y,T);return z.__actions__.push({func:jc,args:[B],thisArg:b}),new In(z,U)}return q&&Y?n.apply(this,T):(z=this.thru(B),q?o?z.value()[0]:z.value():z)})}),vi(["pop","push","shift","sort","splice","unshift"],function(n){var e=Bo[n],t=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",o=/^(?:pop|shift)$/.test(n);k.prototype[n]=function(){var s=arguments;if(o&&!this.__chain__){var h=this.value();return e.apply(Xe(h)?h:[],s)}return this[t](function(y){return e.apply(Xe(y)?y:[],s)})}}),tr(Fe.prototype,function(n,e){var t=k[e];if(t){var o=t.name+"";rt.call(Fi,o)||(Fi[o]=[]),Fi[o].push({name:e,func:t})}}),Fi[li(b,2).name]=[{name:"wrapper",func:b}],Fe.prototype.clone=function(){var n=new Fe(this.__wrapped__);return n.__actions__=$n(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=$n(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=$n(this.__views__),n},Fe.prototype.reverse=function(){if(this.__filtered__){var n=new Fe(this);n.__dir__=-1,n.__filtered__=!0}else(n=this.clone()).__dir__*=-1;return n},Fe.prototype.value=function(){var n=this.__wrapped__.value(),e=this.__dir__,t=Xe(n),o=e<0,s=t?n.length:0,h=function(be,ye,pe){for(var Re=-1,Me=pe.length;++Re<Me;){var Le=pe[Re],Ae=Le.size;switch(Le.type){case"drop":be+=Ae;break;case"dropRight":ye-=Ae;break;case"take":ye=Yt(ye,be+Ae);break;case"takeRight":be=Nt(be,ye-Ae)}}return{start:be,end:ye}}(0,s,this.__views__),y=h.start,T=h.end,P=T-y,M=o?T:y-1,L=this.__iteratees__,B=L.length,U=0,F=Yt(P,this.__takeCount__);if(!t||!o&&s==P&&F==P)return Cu(n,this.__actions__);var q=[];e:for(;P--&&U<F;){for(var Y=-1,z=n[M+=e];++Y<B;){var re=L[Y],ue=re.iteratee,le=re.type,ve=ue(z);if(le==2)z=ve;else if(!ve){if(le==1)continue e;break e}}q[U++]=z}return q},k.prototype.at=Bu,k.prototype.chain=function(){return Rl(this)},k.prototype.commit=function(){return new In(this.value(),this.__chain__)},k.prototype.next=function(){this.__values__===b&&(this.__values__=Vc(this.value()));var n=this.__index__>=this.__values__.length;return{done:n,value:n?b:this.__values__[this.__index__++]}},k.prototype.plant=function(n){for(var e,t=this;t instanceof ao;){var o=va(t);o.__index__=0,o.__values__=b,e?s.__wrapped__=o:e=o;var s=o;t=t.__wrapped__}return s.__wrapped__=n,e},k.prototype.reverse=function(){var n=this.__wrapped__;if(n instanceof Fe){var e=n;return this.__actions__.length&&(e=new Fe(this)),(e=e.reverse()).__actions__.push({func:jc,args:[ts],thisArg:b}),new In(e,this.__chain__)}return this.thru(ts)},k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=function(){return Cu(this.__wrapped__,this.__actions__)},k.prototype.first=k.prototype.head,jo&&(k.prototype[jo]=function(){return this}),k}();et._=Na,(S=(function(){return Na}).call(w,m,w,E))===b||(E.exports=S)}).call(this)},5364:(E,w,m)=>{var S=m(5250),b=m(999)(function(I,_,A){S(I,_,A)});E.exports=b},9935:E=>{E.exports=function(){return!1}},9884:(E,w,m)=>{var S=m(1791),b=m(7241);E.exports=function(I){return S(I,b(I))}},5602:E=>{var w=E.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(m){return m.encoding?"rtpmap:%d %s/%s/%s":m.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(m){return m.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(m){return m.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(m){return"extmap:%d"+(m.direction?"/%s":"%v")+(m["encrypt-uri"]?" %s":"%v")+" %s"+(m.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(m){return m.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(m){var S="candidate:%s %d %s %d %s %d typ %s";return S+=m.raddr!=null?" raddr %s rport %d":"%v%v",S+=m.tcptype!=null?" tcptype %s":"%v",m.generation!=null&&(S+=" generation %d"),S+=m["network-id"]!=null?" network-id %d":"%v",S+=m["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(m){var S="ssrc:%d";return m.attribute!=null&&(S+=" %s",m.value!=null&&(S+=":%s")),S}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(m){return m.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(m){return m.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(m){return"imageattr:%s %s %s"+(m.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(m){return"simulcast:%s %s"+(m.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(m){return"ts-refclk:%s"+(m.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(m){var S="mediaclk:";return S+=m.id!=null?"id=%s %s":"%v%s",S+=m.mediaClockValue!=null?"=%s":"",S+=m.rateNumerator!=null?" rate=%s":"",S+=m.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(w).forEach(function(m){w[m].forEach(function(S){S.reg||(S.reg=/(.*)/),S.format||(S.format="%s")})})},7363:(E,w,m)=>{var S=m(5020),b=m(3804);w.M9=b,w.qg=S.parse,w.Sl=S.parseParams,S.parseFmtpConfig,S.parsePayloads,S.parseRemoteCandidates,S.parseImageAttributes,S.parseSimulcastStreamList},5020:(E,w,m)=>{var S=function(C){return String(Number(C))===C?Number(C):C},b=function(C,v,O){var j=C.name&&C.names;C.push&&!v[C.push]?v[C.push]=[]:j&&!v[C.name]&&(v[C.name]={});var D=C.push?{}:j?v[C.name]:v;(function(x,N,$,H){if(H&&!$)N[H]=S(x[1]);else for(var K=0;K<$.length;K+=1)x[K+1]!=null&&(N[$[K]]=S(x[K+1]))})(O.match(C.reg),D,C.names,C.name),C.push&&v[C.push].push(D)},I=m(5602),_=RegExp.prototype.test.bind(/^([a-z])=(.*)/);w.parse=function(C){var v={},O=[],j=v;return C.split(/(\r\n|\r|\n)/).filter(_).forEach(function(D){var x=D[0],N=D.slice(2);x==="m"&&(O.push({rtp:[],fmtp:[]}),j=O[O.length-1]);for(var $=0;$<(I[x]||[]).length;$+=1){var H=I[x][$];if(H.reg.test(N))return b(H,j,N)}}),v.media=O,v};var A=function(C,v){var O=v.split(/=(.+)/,2);return O.length===2?C[O[0]]=S(O[1]):O.length===1&&v.length>1&&(C[O[0]]=void 0),C};w.parseParams=function(C){return C.split(/;\s?/).reduce(A,{})},w.parseFmtpConfig=w.parseParams,w.parsePayloads=function(C){return C.toString().split(" ").map(Number)},w.parseRemoteCandidates=function(C){for(var v=[],O=C.split(" ").map(S),j=0;j<O.length;j+=3)v.push({component:O[j],ip:O[j+1],port:O[j+2]});return v},w.parseImageAttributes=function(C){return C.split(" ").map(function(v){return v.substring(1,v.length-1).split(",").reduce(A,{})})},w.parseSimulcastStreamList=function(C){return C.split(";").map(function(v){return v.split(",").map(function(O){var j,D=!1;return O[0]!=="~"?j=S(O):(j=S(O.substring(1,O.length)),D=!0),{scid:j,paused:D}})})}},3804:(E,w,m)=>{var S=m(5602),b=/%[sdv%]/g,I=function(v){var O=1,j=arguments,D=j.length;return v.replace(b,function(x){if(O>=D)return x;var N=j[O];switch(O+=1,x){case"%%":return"%";case"%s":return String(N);case"%d":return Number(N);case"%v":return""}})},_=function(v,O,j){var D=[v+"="+(O.format instanceof Function?O.format(O.push?j:j[O.name]):O.format)];if(O.names)for(var x=0;x<O.names.length;x+=1){var N=O.names[x];O.name?D.push(j[O.name][N]):D.push(j[O.names[x]])}else D.push(j[O.name]);return I.apply(null,D)},A=["v","o","s","i","u","e","p","c","b","t","r","z","a"],C=["i","c","b","a"];E.exports=function(v,O){O=O||{},v.version==null&&(v.version=0),v.name==null&&(v.name=" "),v.media.forEach(function(N){N.payloads==null&&(N.payloads="")});var j=O.outerOrder||A,D=O.innerOrder||C,x=[];return j.forEach(function(N){S[N].forEach(function($){$.name in v&&v[$.name]!=null?x.push(_(N,$,v)):$.push in v&&v[$.push]!=null&&v[$.push].forEach(function(H){x.push(_(N,$,H))})})}),v.media.forEach(function(N){x.push(_("m",S.m[0],N)),D.forEach(function($){S[$].forEach(function(H){H.name in N&&N[H.name]!=null?x.push(_($,H,N)):H.push in N&&N[H.push]!=null&&N[H.push].forEach(function(K){x.push(_($,H,K))})})})}),x.join(`\r
`)+`\r
`}},7963:E=>{const w={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};w.localCName=w.generateIdentifier(),w.splitLines=function(m){return m.trim().split(`
`).map(S=>S.trim())},w.splitSections=function(m){return m.split(`
m=`).map((S,b)=>(b>0?"m="+S:S).trim()+`\r
`)},w.getDescription=function(m){const S=w.splitSections(m);return S&&S[0]},w.getMediaSections=function(m){const S=w.splitSections(m);return S.shift(),S},w.matchPrefix=function(m,S){return w.splitLines(m).filter(b=>b.indexOf(S)===0)},w.parseCandidate=function(m){let S;S=m.indexOf("a=candidate:")===0?m.substring(12).split(" "):m.substring(10).split(" ");const b={foundation:S[0],component:{1:"rtp",2:"rtcp"}[S[1]]||S[1],protocol:S[2].toLowerCase(),priority:parseInt(S[3],10),ip:S[4],address:S[4],port:parseInt(S[5],10),type:S[7]};for(let I=8;I<S.length;I+=2)switch(S[I]){case"raddr":b.relatedAddress=S[I+1];break;case"rport":b.relatedPort=parseInt(S[I+1],10);break;case"tcptype":b.tcpType=S[I+1];break;case"ufrag":b.ufrag=S[I+1],b.usernameFragment=S[I+1];break;default:b[S[I]]===void 0&&(b[S[I]]=S[I+1])}return b},w.writeCandidate=function(m){const S=[];S.push(m.foundation);const b=m.component;b==="rtp"?S.push(1):b==="rtcp"?S.push(2):S.push(b),S.push(m.protocol.toUpperCase()),S.push(m.priority),S.push(m.address||m.ip),S.push(m.port);const I=m.type;return S.push("typ"),S.push(I),I!=="host"&&m.relatedAddress&&m.relatedPort&&(S.push("raddr"),S.push(m.relatedAddress),S.push("rport"),S.push(m.relatedPort)),m.tcpType&&m.protocol.toLowerCase()==="tcp"&&(S.push("tcptype"),S.push(m.tcpType)),(m.usernameFragment||m.ufrag)&&(S.push("ufrag"),S.push(m.usernameFragment||m.ufrag)),"candidate:"+S.join(" ")},w.parseIceOptions=function(m){return m.substring(14).split(" ")},w.parseRtpMap=function(m){let S=m.substring(9).split(" ");const b={payloadType:parseInt(S.shift(),10)};return S=S[0].split("/"),b.name=S[0],b.clockRate=parseInt(S[1],10),b.channels=S.length===3?parseInt(S[2],10):1,b.numChannels=b.channels,b},w.writeRtpMap=function(m){let S=m.payloadType;m.preferredPayloadType!==void 0&&(S=m.preferredPayloadType);const b=m.channels||m.numChannels||1;return"a=rtpmap:"+S+" "+m.name+"/"+m.clockRate+(b!==1?"/"+b:"")+`\r
`},w.parseExtmap=function(m){const S=m.substring(9).split(" ");return{id:parseInt(S[0],10),direction:S[0].indexOf("/")>0?S[0].split("/")[1]:"sendrecv",uri:S[1],attributes:S.slice(2).join(" ")}},w.writeExtmap=function(m){return"a=extmap:"+(m.id||m.preferredId)+(m.direction&&m.direction!=="sendrecv"?"/"+m.direction:"")+" "+m.uri+(m.attributes?" "+m.attributes:"")+`\r
`},w.parseFmtp=function(m){const S={};let b;const I=m.substring(m.indexOf(" ")+1).split(";");for(let _=0;_<I.length;_++)b=I[_].trim().split("="),S[b[0].trim()]=b[1];return S},w.writeFmtp=function(m){let S="",b=m.payloadType;if(m.preferredPayloadType!==void 0&&(b=m.preferredPayloadType),m.parameters&&Object.keys(m.parameters).length){const I=[];Object.keys(m.parameters).forEach(_=>{m.parameters[_]!==void 0?I.push(_+"="+m.parameters[_]):I.push(_)}),S+="a=fmtp:"+b+" "+I.join(";")+`\r
`}return S},w.parseRtcpFb=function(m){const S=m.substring(m.indexOf(" ")+1).split(" ");return{type:S.shift(),parameter:S.join(" ")}},w.writeRtcpFb=function(m){let S="",b=m.payloadType;return m.preferredPayloadType!==void 0&&(b=m.preferredPayloadType),m.rtcpFeedback&&m.rtcpFeedback.length&&m.rtcpFeedback.forEach(I=>{S+="a=rtcp-fb:"+b+" "+I.type+(I.parameter&&I.parameter.length?" "+I.parameter:"")+`\r
`}),S},w.parseSsrcMedia=function(m){const S=m.indexOf(" "),b={ssrc:parseInt(m.substring(7,S),10)},I=m.indexOf(":",S);return I>-1?(b.attribute=m.substring(S+1,I),b.value=m.substring(I+1)):b.attribute=m.substring(S+1),b},w.parseSsrcGroup=function(m){const S=m.substring(13).split(" ");return{semantics:S.shift(),ssrcs:S.map(b=>parseInt(b,10))}},w.getMid=function(m){const S=w.matchPrefix(m,"a=mid:")[0];if(S)return S.substring(6)},w.parseFingerprint=function(m){const S=m.substring(14).split(" ");return{algorithm:S[0].toLowerCase(),value:S[1].toUpperCase()}},w.getDtlsParameters=function(m,S){return{role:"auto",fingerprints:w.matchPrefix(m+S,"a=fingerprint:").map(w.parseFingerprint)}},w.writeDtlsParameters=function(m,S){let b="a=setup:"+S+`\r
`;return m.fingerprints.forEach(I=>{b+="a=fingerprint:"+I.algorithm+" "+I.value+`\r
`}),b},w.parseCryptoLine=function(m){const S=m.substring(9).split(" ");return{tag:parseInt(S[0],10),cryptoSuite:S[1],keyParams:S[2],sessionParams:S.slice(3)}},w.writeCryptoLine=function(m){return"a=crypto:"+m.tag+" "+m.cryptoSuite+" "+(typeof m.keyParams=="object"?w.writeCryptoKeyParams(m.keyParams):m.keyParams)+(m.sessionParams?" "+m.sessionParams.join(" "):"")+`\r
`},w.parseCryptoKeyParams=function(m){if(m.indexOf("inline:")!==0)return null;const S=m.substring(7).split("|");return{keyMethod:"inline",keySalt:S[0],lifeTime:S[1],mkiValue:S[2]?S[2].split(":")[0]:void 0,mkiLength:S[2]?S[2].split(":")[1]:void 0}},w.writeCryptoKeyParams=function(m){return m.keyMethod+":"+m.keySalt+(m.lifeTime?"|"+m.lifeTime:"")+(m.mkiValue&&m.mkiLength?"|"+m.mkiValue+":"+m.mkiLength:"")},w.getCryptoParameters=function(m,S){return w.matchPrefix(m+S,"a=crypto:").map(w.parseCryptoLine)},w.getIceParameters=function(m,S){const b=w.matchPrefix(m+S,"a=ice-ufrag:")[0],I=w.matchPrefix(m+S,"a=ice-pwd:")[0];return b&&I?{usernameFragment:b.substring(12),password:I.substring(10)}:null},w.writeIceParameters=function(m){let S="a=ice-ufrag:"+m.usernameFragment+`\r
a=ice-pwd:`+m.password+`\r
`;return m.iceLite&&(S+=`a=ice-lite\r
`),S},w.parseRtpParameters=function(m){const S={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},b=w.splitLines(m)[0].split(" ");S.profile=b[2];for(let _=3;_<b.length;_++){const A=b[_],C=w.matchPrefix(m,"a=rtpmap:"+A+" ")[0];if(C){const v=w.parseRtpMap(C),O=w.matchPrefix(m,"a=fmtp:"+A+" ");switch(v.parameters=O.length?w.parseFmtp(O[0]):{},v.rtcpFeedback=w.matchPrefix(m,"a=rtcp-fb:"+A+" ").map(w.parseRtcpFb),S.codecs.push(v),v.name.toUpperCase()){case"RED":case"ULPFEC":S.fecMechanisms.push(v.name.toUpperCase())}}}w.matchPrefix(m,"a=extmap:").forEach(_=>{S.headerExtensions.push(w.parseExtmap(_))});const I=w.matchPrefix(m,"a=rtcp-fb:* ").map(w.parseRtcpFb);return S.codecs.forEach(_=>{I.forEach(A=>{_.rtcpFeedback.find(C=>C.type===A.type&&C.parameter===A.parameter)||_.rtcpFeedback.push(A)})}),S},w.writeRtpDescription=function(m,S){let b="";b+="m="+m+" ",b+=S.codecs.length>0?"9":"0",b+=" "+(S.profile||"UDP/TLS/RTP/SAVPF")+" ",b+=S.codecs.map(_=>_.preferredPayloadType!==void 0?_.preferredPayloadType:_.payloadType).join(" ")+`\r
`,b+=`c=IN IP4 0.0.0.0\r
`,b+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,S.codecs.forEach(_=>{b+=w.writeRtpMap(_),b+=w.writeFmtp(_),b+=w.writeRtcpFb(_)});let I=0;return S.codecs.forEach(_=>{_.maxptime>I&&(I=_.maxptime)}),I>0&&(b+="a=maxptime:"+I+`\r
`),S.headerExtensions&&S.headerExtensions.forEach(_=>{b+=w.writeExtmap(_)}),b},w.parseRtpEncodingParameters=function(m){const S=[],b=w.parseRtpParameters(m),I=b.fecMechanisms.indexOf("RED")!==-1,_=b.fecMechanisms.indexOf("ULPFEC")!==-1,A=w.matchPrefix(m,"a=ssrc:").map(D=>w.parseSsrcMedia(D)).filter(D=>D.attribute==="cname"),C=A.length>0&&A[0].ssrc;let v;const O=w.matchPrefix(m,"a=ssrc-group:FID").map(D=>D.substring(17).split(" ").map(x=>parseInt(x,10)));O.length>0&&O[0].length>1&&O[0][0]===C&&(v=O[0][1]),b.codecs.forEach(D=>{if(D.name.toUpperCase()==="RTX"&&D.parameters.apt){let x={ssrc:C,codecPayloadType:parseInt(D.parameters.apt,10)};C&&v&&(x.rtx={ssrc:v}),S.push(x),I&&(x=JSON.parse(JSON.stringify(x)),x.fec={ssrc:C,mechanism:_?"red+ulpfec":"red"},S.push(x))}}),S.length===0&&C&&S.push({ssrc:C});let j=w.matchPrefix(m,"b=");return j.length&&(j=j[0].indexOf("b=TIAS:")===0?parseInt(j[0].substring(7),10):j[0].indexOf("b=AS:")===0?1e3*parseInt(j[0].substring(5),10)*.95-16e3:void 0,S.forEach(D=>{D.maxBitrate=j})),S},w.parseRtcpParameters=function(m){const S={},b=w.matchPrefix(m,"a=ssrc:").map(A=>w.parseSsrcMedia(A)).filter(A=>A.attribute==="cname")[0];b&&(S.cname=b.value,S.ssrc=b.ssrc);const I=w.matchPrefix(m,"a=rtcp-rsize");S.reducedSize=I.length>0,S.compound=I.length===0;const _=w.matchPrefix(m,"a=rtcp-mux");return S.mux=_.length>0,S},w.writeRtcpParameters=function(m){let S="";return m.reducedSize&&(S+=`a=rtcp-rsize\r
`),m.mux&&(S+=`a=rtcp-mux\r
`),m.ssrc!==void 0&&m.cname&&(S+="a=ssrc:"+m.ssrc+" cname:"+m.cname+`\r
`),S},w.parseMsid=function(m){let S;const b=w.matchPrefix(m,"a=msid:");if(b.length===1)return S=b[0].substring(7).split(" "),{stream:S[0],track:S[1]};const I=w.matchPrefix(m,"a=ssrc:").map(_=>w.parseSsrcMedia(_)).filter(_=>_.attribute==="msid");return I.length>0?(S=I[0].value.split(" "),{stream:S[0],track:S[1]}):void 0},w.parseSctpDescription=function(m){const S=w.parseMLine(m),b=w.matchPrefix(m,"a=max-message-size:");let I;b.length>0&&(I=parseInt(b[0].substring(19),10)),isNaN(I)&&(I=65536);const _=w.matchPrefix(m,"a=sctp-port:");if(_.length>0)return{port:parseInt(_[0].substring(12),10),protocol:S.fmt,maxMessageSize:I};const A=w.matchPrefix(m,"a=sctpmap:");if(A.length>0){const C=A[0].substring(10).split(" ");return{port:parseInt(C[0],10),protocol:C[1],maxMessageSize:I}}},w.writeSctpDescription=function(m,S){let b=[];return b=m.protocol!=="DTLS/SCTP"?["m="+m.kind+" 9 "+m.protocol+" "+S.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+S.port+`\r
`]:["m="+m.kind+" 9 "+m.protocol+" "+S.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+S.port+" "+S.protocol+` 65535\r
`],S.maxMessageSize!==void 0&&b.push("a=max-message-size:"+S.maxMessageSize+`\r
`),b.join("")},w.generateSessionId=function(){return Math.random().toString().substr(2,22)},w.writeSessionBoilerplate=function(m,S,b){let I;const _=S!==void 0?S:2;return I=m||w.generateSessionId(),`v=0\r
o=`+(b||"thisisadapterortc")+" "+I+" "+_+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},w.getDirection=function(m,S){const b=w.splitLines(m);for(let I=0;I<b.length;I++)switch(b[I]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return b[I].substring(2)}return S?w.getDirection(S):"sendrecv"},w.getKind=function(m){return w.splitLines(m)[0].split(" ")[0].substring(2)},w.isRejected=function(m){return m.split(" ",2)[1]==="0"},w.parseMLine=function(m){const S=w.splitLines(m)[0].substring(2).split(" ");return{kind:S[0],port:parseInt(S[1],10),protocol:S[2],fmt:S.slice(3).join(" ")}},w.parseOLine=function(m){const S=w.matchPrefix(m,"o=")[0].substring(2).split(" ");return{username:S[0],sessionId:S[1],sessionVersion:parseInt(S[2],10),netType:S[3],addressType:S[4],address:S[5]}},w.isValidSDP=function(m){if(typeof m!="string"||m.length===0)return!1;const S=w.splitLines(m);for(let b=0;b<S.length;b++)if(S[b].length<2||S[b].charAt(1)!=="=")return!1;return!0},E.exports=w},5512:E=>{E.exports=function(w,m,S,b){var I=self||window;try{try{var _;try{_=new I.Blob([w])}catch{(_=new(I.BlobBuilder||I.WebKitBlobBuilder||I.MozBlobBuilder||I.MSBlobBuilder)).append(w),_=_.getBlob()}var A=I.URL||I.webkitURL,C=A.createObjectURL(_),v=new I[m](C,S);return A.revokeObjectURL(C),v}catch{return new I[m]("data:application/javascript,".concat(encodeURIComponent(w)),S)}}catch{if(!b)throw Error("Inline worker is not supported");return new I[m](b,S)}}},8630:(E,w,m)=>{var S;(function(b){(function(){var I=typeof globalThis=="object"?globalThis:typeof m.g=="object"?m.g:typeof self=="object"?self:typeof this=="object"?this:function(){try{return Function("return this;")()}catch{}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch{}}(),_=A(b);function A(C,v){return function(O,j){Object.defineProperty(C,O,{configurable:!0,writable:!0,value:j}),v&&v(O,j)}}I.Reflect!==void 0&&(_=A(I.Reflect,_)),function(C,v){var O=Object.prototype.hasOwnProperty,j=typeof Symbol=="function",D=j&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",x=j&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",N=typeof Object.create=="function",$={__proto__:[]}instanceof Array,H=!N&&!$,K={create:N?function(){return Zi(Object.create(null))}:$?function(){return Zi({__proto__:null})}:function(){return Zi({})},has:H?function(oe,fe){return O.call(oe,fe)}:function(oe,fe){return fe in oe},get:H?function(oe,fe){return O.call(oe,fe)?oe[fe]:void 0}:function(oe,fe){return oe[fe]}},ce=Object.getPrototypeOf(Function),Q=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Mo(),Z=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Mi(),Se=typeof WeakMap=="function"?WeakMap:mi(),G=j?Symbol.for("@reflect-metadata:registry"):void 0,ie=Mt(),de=Ke(ie);function ne(oe,fe,Ce,xe){if(it(Ce)){if(!Wr(oe))throw new TypeError;if(!Ee(fe))throw new TypeError;return vt(oe,fe)}if(!Wr(oe))throw new TypeError;if(!Qt(fe))throw new TypeError;if(!Qt(xe)&&!it(xe)&&!Ar(xe))throw new TypeError;return Ar(xe)&&(xe=void 0),Ut(oe,fe,Ce=lr(Ce),xe)}function J(oe,fe){function Ce(xe,dt){if(!Qt(xe))throw new TypeError;if(!it(dt)&&!ke(dt))throw new TypeError;rn(oe,fe,xe,dt)}return Ce}function W(oe,fe,Ce,xe){if(!Qt(Ce))throw new TypeError;return it(xe)||(xe=lr(xe)),rn(oe,fe,Ce,xe)}function X(oe,fe,Ce){if(!Qt(fe))throw new TypeError;return it(Ce)||(Ce=lr(Ce)),Vt(oe,fe,Ce)}function se(oe,fe,Ce){if(!Qt(fe))throw new TypeError;return it(Ce)||(Ce=lr(Ce)),Ht(oe,fe,Ce)}function he(oe,fe,Ce){if(!Qt(fe))throw new TypeError;return it(Ce)||(Ce=lr(Ce)),Ge(oe,fe,Ce)}function Ie(oe,fe,Ce){if(!Qt(fe))throw new TypeError;return it(Ce)||(Ce=lr(Ce)),At(oe,fe,Ce)}function we(oe,fe){if(!Qt(oe))throw new TypeError;return it(fe)||(fe=lr(fe)),gn(oe,fe)}function Qe(oe,fe){if(!Qt(oe))throw new TypeError;return it(fe)||(fe=lr(fe)),Dn(oe,fe)}function Tt(oe,fe,Ce){if(!Qt(fe))throw new TypeError;if(it(Ce)||(Ce=lr(Ce)),!Qt(fe))throw new TypeError;it(Ce)||(Ce=lr(Ce));var xe=xr(fe,Ce,!1);return!it(xe)&&xe.OrdinaryDeleteMetadata(oe,fe,Ce)}function vt(oe,fe){for(var Ce=oe.length-1;Ce>=0;--Ce){var xe=(0,oe[Ce])(fe);if(!it(xe)&&!Ar(xe)){if(!Ee(xe))throw new TypeError;fe=xe}}return fe}function Ut(oe,fe,Ce,xe){for(var dt=oe.length-1;dt>=0;--dt){var vn=(0,oe[dt])(fe,Ce,xe);if(!it(vn)&&!Ar(vn)){if(!Qt(vn))throw new TypeError;xe=vn}}return xe}function Vt(oe,fe,Ce){if(Ht(oe,fe,Ce))return!0;var xe=Hn(fe);return!Ar(xe)&&Vt(oe,xe,Ce)}function Ht(oe,fe,Ce){var xe=xr(fe,Ce,!1);return!it(xe)&&oi(xe.OrdinaryHasOwnMetadata(oe,fe,Ce))}function Ge(oe,fe,Ce){if(Ht(oe,fe,Ce))return At(oe,fe,Ce);var xe=Hn(fe);return Ar(xe)?void 0:Ge(oe,xe,Ce)}function At(oe,fe,Ce){var xe=xr(fe,Ce,!1);if(!it(xe))return xe.OrdinaryGetOwnMetadata(oe,fe,Ce)}function rn(oe,fe,Ce,xe){xr(Ce,xe,!0).OrdinaryDefineOwnMetadata(oe,fe,Ce,xe)}function gn(oe,fe){var Ce=Dn(oe,fe),xe=Hn(oe);if(xe===null)return Ce;var dt=gn(xe,fe);if(dt.length<=0)return Ce;if(Ce.length<=0)return dt;for(var vn=new Z,bt=[],nt=0,Ye=Ce;nt<Ye.length;nt++){var je=Ye[nt];vn.has(je)||(vn.add(je),bt.push(je))}for(var Ze=0,at=dt;Ze<at.length;Ze++)je=at[Ze],vn.has(je)||(vn.add(je),bt.push(je));return bt}function Dn(oe,fe){var Ce=xr(oe,fe,!1);return Ce?Ce.OrdinaryOwnMetadataKeys(oe,fe):[]}function ur(oe){if(oe===null)return 1;switch(typeof oe){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return oe===null?1:6;default:return 6}}function it(oe){return oe===void 0}function Ar(oe){return oe===null}function ra(oe){return typeof oe=="symbol"}function Qt(oe){return typeof oe=="object"?oe!==null:typeof oe=="function"}function xi(oe,fe){switch(ur(oe)){case 0:case 1:case 2:case 3:case 4:case 5:return oe}var Ce="string",xe=Te(oe,D);if(xe!==void 0){var dt=xe.call(oe,Ce);if(Qt(dt))throw new TypeError;return dt}return Di(oe)}function Di(oe,fe){var Ce,xe;{var dt=oe.toString;if(me(dt)&&!Qt(xe=dt.call(oe))||me(Ce=oe.valueOf)&&!Qt(xe=Ce.call(oe)))return xe}throw new TypeError}function oi(oe){return!!oe}function Qi(oe){return""+oe}function lr(oe){var fe=xi(oe);return ra(fe)?fe:Qi(fe)}function Wr(oe){return Array.isArray?Array.isArray(oe):oe instanceof Object?oe instanceof Array:Object.prototype.toString.call(oe)==="[object Array]"}function me(oe){return typeof oe=="function"}function Ee(oe){return typeof oe=="function"}function ke(oe){switch(ur(oe)){case 3:case 4:return!0;default:return!1}}function $e(oe,fe){return oe===fe||oe!=oe&&fe!=fe}function Te(oe,fe){var Ce=oe[fe];if(Ce!=null){if(!me(Ce))throw new TypeError;return Ce}}function tt(oe){var fe=Te(oe,x);if(!me(fe))throw new TypeError;var Ce=fe.call(oe);if(!Qt(Ce))throw new TypeError;return Ce}function lt(oe){return oe.value}function Ve(oe){var fe=oe.next();return!fe.done&&fe}function Be(oe){var fe=oe.return;fe&&fe.call(oe)}function Hn(oe){var fe=Object.getPrototypeOf(oe);if(typeof oe!="function"||oe===ce||fe!==ce)return fe;var Ce=oe.prototype,xe=Ce&&Object.getPrototypeOf(Ce);if(xe==null||xe===Object.prototype)return fe;var dt=xe.constructor;return typeof dt!="function"||dt===oe?fe:dt}function Dt(){var oe,fe,Ce,xe;it(G)||v.Reflect===void 0||G in v.Reflect||typeof v.Reflect.defineMetadata!="function"||(oe=Pr(v.Reflect));var dt=new Se,vn={registerProvider:bt,getProvider:Ye,setProvider:Ze};return vn;function bt(at){if(!Object.isExtensible(vn))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case oe===at:break;case it(fe):fe=at;break;case fe===at:break;case it(Ce):Ce=at;break;case Ce===at:break;default:xe===void 0&&(xe=new Z),xe.add(at)}}function nt(at,jt){if(!it(fe)){if(fe.isProviderFor(at,jt))return fe;if(!it(Ce)){if(Ce.isProviderFor(at,jt))return fe;if(!it(xe))for(var dn=tt(xe);;){var yn=Ve(dn);if(!yn)return;var Xn=lt(yn);if(Xn.isProviderFor(at,jt))return Be(dn),Xn}}}if(!it(oe)&&oe.isProviderFor(at,jt))return oe}function Ye(at,jt){var dn,yn=dt.get(at);return it(yn)||(dn=yn.get(jt)),it(dn)&&(it(dn=nt(at,jt))||(it(yn)&&(yn=new Q,dt.set(at,yn)),yn.set(jt,dn))),dn}function je(at){if(it(at))throw new TypeError;return fe===at||Ce===at||!it(xe)&&xe.has(at)}function Ze(at,jt,dn){if(!je(dn))throw new Error("Metadata provider not registered.");var yn=Ye(at,jt);if(yn!==dn){if(!it(yn))return!1;var Xn=dt.get(at);it(Xn)&&(Xn=new Q,dt.set(at,Xn)),Xn.set(jt,dn)}return!0}}function Mt(){var oe;return!it(G)&&Qt(v.Reflect)&&Object.isExtensible(v.Reflect)&&(oe=v.Reflect[G]),it(oe)&&(oe=Dt()),!it(G)&&Qt(v.Reflect)&&Object.isExtensible(v.Reflect)&&Object.defineProperty(v.Reflect,G,{enumerable:!1,configurable:!1,writable:!1,value:oe}),oe}function Ke(oe){var fe=new Se,Ce={isProviderFor:function(je,Ze){var at=fe.get(je);return!it(at)&&at.has(Ze)},OrdinaryDefineOwnMetadata:bt,OrdinaryHasOwnMetadata:dt,OrdinaryGetOwnMetadata:vn,OrdinaryOwnMetadataKeys:nt,OrdinaryDeleteMetadata:Ye};return ie.registerProvider(Ce),Ce;function xe(je,Ze,at){var jt=fe.get(je),dn=!1;if(it(jt)){if(!at)return;jt=new Q,fe.set(je,jt),dn=!0}var yn=jt.get(Ze);if(it(yn)){if(!at)return;if(yn=new Q,jt.set(Ze,yn),!oe.setProvider(je,Ze,Ce))throw jt.delete(Ze),dn&&fe.delete(je),new Error("Wrong provider for target.")}return yn}function dt(je,Ze,at){var jt=xe(Ze,at,!1);return!it(jt)&&oi(jt.has(je))}function vn(je,Ze,at){var jt=xe(Ze,at,!1);if(!it(jt))return jt.get(je)}function bt(je,Ze,at,jt){xe(at,jt,!0).set(je,Ze)}function nt(je,Ze){var at=[],jt=xe(je,Ze,!1);if(it(jt))return at;for(var dn=tt(jt.keys()),yn=0;;){var Xn=Ve(dn);if(!Xn)return at.length=yn,at;var us=lt(Xn);try{at[yn]=us}catch(ls){try{Be(dn)}finally{throw ls}}yn++}}function Ye(je,Ze,at){var jt=xe(Ze,at,!1);if(it(jt)||!jt.delete(je))return!1;if(jt.size===0){var dn=fe.get(Ze);it(dn)||(dn.delete(at),dn.size===0&&fe.delete(dn))}return!0}}function Pr(oe){var fe=oe.defineMetadata,Ce=oe.hasOwnMetadata,xe=oe.getOwnMetadata,dt=oe.getOwnMetadataKeys,vn=oe.deleteMetadata,bt=new Se;return{isProviderFor:function(nt,Ye){var je=bt.get(nt);return!(it(je)||!je.has(Ye))||!!dt(nt,Ye).length&&(it(je)&&(je=new Z,bt.set(nt,je)),je.add(Ye),!0)},OrdinaryDefineOwnMetadata:fe,OrdinaryHasOwnMetadata:Ce,OrdinaryGetOwnMetadata:xe,OrdinaryOwnMetadataKeys:dt,OrdinaryDeleteMetadata:vn}}function xr(oe,fe,Ce){var xe=ie.getProvider(oe,fe);if(!it(xe))return xe;if(Ce){if(ie.setProvider(oe,fe,de))return de;throw new Error("Illegal state.")}}function Mo(){var oe={},fe=[],Ce=function(){function bt(nt,Ye,je){this._index=0,this._keys=nt,this._values=Ye,this._selector=je}return bt.prototype["@@iterator"]=function(){return this},bt.prototype[x]=function(){return this},bt.prototype.next=function(){var nt=this._index;if(nt>=0&&nt<this._keys.length){var Ye=this._selector(this._keys[nt],this._values[nt]);return nt+1>=this._keys.length?(this._index=-1,this._keys=fe,this._values=fe):this._index++,{value:Ye,done:!1}}return{value:void 0,done:!0}},bt.prototype.throw=function(nt){throw this._index>=0&&(this._index=-1,this._keys=fe,this._values=fe),nt},bt.prototype.return=function(nt){return this._index>=0&&(this._index=-1,this._keys=fe,this._values=fe),{value:nt,done:!0}},bt}();return function(){function bt(){this._keys=[],this._values=[],this._cacheKey=oe,this._cacheIndex=-2}return Object.defineProperty(bt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),bt.prototype.has=function(nt){return this._find(nt,!1)>=0},bt.prototype.get=function(nt){var Ye=this._find(nt,!1);return Ye>=0?this._values[Ye]:void 0},bt.prototype.set=function(nt,Ye){var je=this._find(nt,!0);return this._values[je]=Ye,this},bt.prototype.delete=function(nt){var Ye=this._find(nt,!1);if(Ye>=0){for(var je=this._keys.length,Ze=Ye+1;Ze<je;Ze++)this._keys[Ze-1]=this._keys[Ze],this._values[Ze-1]=this._values[Ze];return this._keys.length--,this._values.length--,$e(nt,this._cacheKey)&&(this._cacheKey=oe,this._cacheIndex=-2),!0}return!1},bt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=oe,this._cacheIndex=-2},bt.prototype.keys=function(){return new Ce(this._keys,this._values,xe)},bt.prototype.values=function(){return new Ce(this._keys,this._values,dt)},bt.prototype.entries=function(){return new Ce(this._keys,this._values,vn)},bt.prototype["@@iterator"]=function(){return this.entries()},bt.prototype[x]=function(){return this.entries()},bt.prototype._find=function(nt,Ye){if(!$e(this._cacheKey,nt)){this._cacheIndex=-1;for(var je=0;je<this._keys.length;je++)if($e(this._keys[je],nt)){this._cacheIndex=je;break}}return this._cacheIndex<0&&Ye&&(this._cacheIndex=this._keys.length,this._keys.push(nt),this._values.push(void 0)),this._cacheIndex},bt}();function xe(bt,nt){return bt}function dt(bt,nt){return nt}function vn(bt,nt){return[bt,nt]}}function Mi(){return function(){function oe(){this._map=new Q}return Object.defineProperty(oe.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),oe.prototype.has=function(fe){return this._map.has(fe)},oe.prototype.add=function(fe){return this._map.set(fe,fe),this},oe.prototype.delete=function(fe){return this._map.delete(fe)},oe.prototype.clear=function(){this._map.clear()},oe.prototype.keys=function(){return this._map.keys()},oe.prototype.values=function(){return this._map.keys()},oe.prototype.entries=function(){return this._map.entries()},oe.prototype["@@iterator"]=function(){return this.keys()},oe.prototype[x]=function(){return this.keys()},oe}()}function mi(){var oe=16,fe=K.create(),Ce=xe();return function(){function Ye(){this._key=xe()}return Ye.prototype.has=function(je){var Ze=dt(je,!1);return Ze!==void 0&&K.has(Ze,this._key)},Ye.prototype.get=function(je){var Ze=dt(je,!1);return Ze!==void 0?K.get(Ze,this._key):void 0},Ye.prototype.set=function(je,Ze){return dt(je,!0)[this._key]=Ze,this},Ye.prototype.delete=function(je){var Ze=dt(je,!1);return Ze!==void 0&&delete Ze[this._key]},Ye.prototype.clear=function(){this._key=xe()},Ye}();function xe(){var Ye;do Ye="@@WeakMap@@"+nt();while(K.has(fe,Ye));return fe[Ye]=!0,Ye}function dt(Ye,je){if(!O.call(Ye,Ce)){if(!je)return;Object.defineProperty(Ye,Ce,{value:K.create()})}return Ye[Ce]}function vn(Ye,je){for(var Ze=0;Ze<je;++Ze)Ye[Ze]=255*Math.random()|0;return Ye}function bt(Ye){if(typeof Uint8Array=="function"){var je=new Uint8Array(Ye);return typeof crypto<"u"?crypto.getRandomValues(je):typeof msCrypto<"u"?msCrypto.getRandomValues(je):vn(je,Ye),je}return vn(new Array(Ye),Ye)}function nt(){var Ye=bt(oe);Ye[6]=79&Ye[6]|64,Ye[8]=191&Ye[8]|128;for(var je="",Ze=0;Ze<oe;++Ze){var at=Ye[Ze];Ze!==4&&Ze!==6&&Ze!==8||(je+="-"),at<16&&(je+="0"),je+=at.toString(16).toLowerCase()}return je}}function Zi(oe){return oe.__=void 0,delete oe.__,oe}C("decorate",ne),C("metadata",J),C("defineMetadata",W),C("hasMetadata",X),C("hasOwnMetadata",se),C("getMetadata",he),C("getOwnMetadata",Ie),C("getMetadataKeys",we),C("getOwnMetadataKeys",Qe),C("deleteMetadata",Tt)}(_,I),I.Reflect===void 0&&(I.Reflect=b)})()})(S||(S={}))}},p={};function g(E){var w=p[E];if(w!==void 0)return w.exports;var m=p[E]={id:E,loaded:!1,exports:{}};return d[E].call(m.exports,m,m.exports,g),m.loaded=!0,m.exports}g.n=E=>{var w=E&&E.__esModule?()=>E.default:()=>E;return g.d(w,{a:w}),w},g.d=(E,w)=>{for(var m in w)g.o(w,m)&&!g.o(E,m)&&Object.defineProperty(E,m,{enumerable:!0,get:w[m]})},g.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),g.o=(E,w)=>Object.prototype.hasOwnProperty.call(E,w),g.r=E=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})},g.nmd=E=>(E.paths=[],E.children||(E.children=[]),E);var R={};return(()=>{g.r(R),g.d(R,{BASIC_FULL_HD_LANDSCAPE:()=>bn,BASIC_FULL_HD_PORTRAIT:()=>ft,BASIC_LANDSCAPE:()=>mc,BASIC_PORTRAIT:()=>el,BroadcastClientError:()=>Ke,BroadcastClientEvents:()=>ai,ConnectionState:()=>Je,Errors:()=>b,InitialLayerPreference:()=>Ds,JitterBufferMinDelay:()=>Cr,LOG_LEVEL:()=>Ve,LocalStageStream:()=>Al,LocalStageStreamEvents:()=>mo,LogLevels:()=>Ve,RemoteStageStream:()=>_d,RemoteStageStreamEvents:()=>Gn,SIMULCAST_DUPLICATE_LAYERS_CONFIGURED:()=>Iu,SIMULCAST_LAYER_CONFIGURATION_CONFLICT:()=>Qa,SIMULCAST_LAYER_INPUT_FRAMERATE_INSUFFICIENT:()=>Au,SIMULCAST_LAYER_INPUT_RESOLUTION_INSUFFICIENT:()=>Ou,SIMULCAST_LAYER_INVALID_TYPE:()=>Wn,SIMULCAST_LAYER_ORIENTATION_MISMATCH:()=>Za,SIMULCAST_MAX_LAYERS_EXCEEDED:()=>mr,SIMULCAST_MAX_LAYER_BITRATE_EXCEEDED:()=>El,SIMULCAST_MAX_LAYER_DIMENSIONS_EXCEEDED:()=>Xa,SIMULCAST_MAX_LAYER_FRAMERATE_EXCEEDED:()=>Ln,SIMULCAST_MIN_LAYER_BITRATE_EXCEEDED:()=>Oo,SIMULCAST_MIN_LAYER_DIMENSIONS_EXCEEDED:()=>ku,SIMULCAST_MIN_LAYER_FRAMERATE_EXCEEDED:()=>gr,SIMULCAST_UNSUPPORTED:()=>Lc,STAGE_MAX_AUDIO_BITRATE_KBPS:()=>ma,STAGE_MAX_AUDIO_BITRATE_KBPS_DEFAULT:()=>Tu,STAGE_MAX_BITRATE:()=>$i,STAGE_MAX_FRAMERATE:()=>pr,STAGE_MAX_RESOLUTION:()=>Ci,STAGE_MIN_AUDIO_BITRATE_KBPS:()=>qa,STAGE_MIN_BITRATE:()=>_o,STAGE_MIN_FRAMERATE:()=>Go,STAGE_MIN_RESOLUTION:()=>uo,STANDARD_LANDSCAPE:()=>hn,STANDARD_PORTRAIT:()=>tl,SimulcastLayerPresets:()=>Ha,Stage:()=>Bl,StageConnectionState:()=>an,StageErrorCategory:()=>xt,StageErrorCode:()=>ze,StageEvents:()=>fn,StageLeftReason:()=>_a,StageParticipantPublishState:()=>Bn,StageParticipantSubscribeState:()=>Yn,StageStream:()=>zu,StageStreamLayerSelectedReason:()=>os,StreamType:()=>ht,SubscribeType:()=>He,__version:()=>Ts,create:()=>ed,default:()=>Mh,isSupported:()=>lt});var E={};g.r(E),g.d(E,{fixNegotiationNeeded:()=>se,shimAddTrackRemoveTrack:()=>W,shimAddTrackRemoveTrackWithNative:()=>J,shimGetDisplayMedia:()=>Z,shimGetSendersWithDtmf:()=>ie,shimGetStats:()=>de,shimGetUserMedia:()=>Q,shimMediaStream:()=>Se,shimOnTrack:()=>G,shimPeerConnection:()=>X,shimSenderReceiverGetStats:()=>ne});var w={};g.r(w),g.d(w,{shimAddTransceiver:()=>Ht,shimCreateAnswer:()=>rn,shimCreateOffer:()=>At,shimGetDisplayMedia:()=>Ie,shimGetParameters:()=>Ge,shimGetUserMedia:()=>he,shimOnTrack:()=>we,shimPeerConnection:()=>Qe,shimRTCDataChannel:()=>Vt,shimReceiverGetStats:()=>vt,shimRemoveStream:()=>Ut,shimSenderGetStats:()=>Tt});var m={};g.r(m),g.d(m,{shimAudioContext:()=>Di,shimCallbacksAPI:()=>ur,shimConstraints:()=>Ar,shimCreateOfferLegacy:()=>xi,shimGetUserMedia:()=>it,shimLocalStreamsAPI:()=>gn,shimRTCIceServerUrls:()=>ra,shimRemoteStreamsAPI:()=>Dn,shimTrackEventTransceiver:()=>Qt});var S={};g.r(S),g.d(S,{removeExtmapAllowMixed:()=>$e,shimAddIceCandidateNullOrEmpty:()=>Te,shimConnectionState:()=>ke,shimMaxMessageSize:()=>me,shimParameterlessSetLocalDescription:()=>tt,shimRTCIceCandidate:()=>lr,shimRTCIceCandidateRelayProtocol:()=>Wr,shimSendThrowTypeError:()=>Ee});var b={};g.r(b),g.d(b,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>oe,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>Zi,ADD_DEVICE_CONSTRAINTS_ERROR:()=>xe,ADD_DEVICE_DEVICE_ERROR:()=>Mi,ADD_DEVICE_NAME_EXISTS_ERROR:()=>mi,ADD_DEVICE_NAME_MISSING_ERROR:()=>fe,ADD_DEVICE_UNSUPPORTED:()=>Ce,BROADCAST_CONFIGURATION_ERROR:()=>yn,BROADCAST_ERROR:()=>Pr,CAMERA_ERROR:()=>xr,CLIENT_INVALID_ERROR:()=>hc,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>je,FAILED_TO_ADD_IMAGE_ERROR:()=>Ze,INGEST_ENDPOINT_TYPE_ERROR:()=>us,INGEST_ENDPOINT_URL_ERROR:()=>ls,INPUT_ERROR:()=>Mo,INVALID_STREAM_KEY:()=>dn,LOGGER_TYPE_ERROR:()=>dc,LOG_LEVEL_TYPE_ERROR:()=>nu,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>fc,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>ds,PEER_CONNECTION_ERROR:()=>jt,PEER_SETUP_ERROR:()=>at,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>dt,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>vn,STAGE_TOKEN_TYPE_ERROR:()=>Oa,STAGE_WHIP_OVERRIDE_ERROR:()=>Qu,STREAM_CONFIGURATION_ERROR:()=>Xn,STREAM_KEY_INVALID_CHAR_ERROR:()=>No,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>nt,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>bt,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>Ye});var I={};g.r(I),g.d(I,{BASIC_FULL_HD_LANDSCAPE:()=>bn,BASIC_FULL_HD_PORTRAIT:()=>ft,BASIC_LANDSCAPE:()=>mc,BASIC_PORTRAIT:()=>el,BroadcastClientError:()=>Ke,BroadcastClientEvents:()=>ai,ConnectionState:()=>Je,Errors:()=>b,LOG_LEVEL:()=>Ve,LogLevels:()=>Ve,STANDARD_LANDSCAPE:()=>hn,STANDARD_PORTRAIT:()=>tl,__version:()=>Ts,create:()=>ed,isSupported:()=>lt});let _=!0,A=!0;function C(u,i,c){const l=u.match(i);return l&&l.length>=c&&parseInt(l[c],10)}function v(u,i,c){if(!u.RTCPeerConnection)return;const l=u.RTCPeerConnection.prototype,f=l.addEventListener;l.addEventListener=function(e,t){if(e!==i)return f.apply(this,arguments);const o=s=>{const h=c(s);h&&(t.handleEvent?t.handleEvent(h):t(h))};return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(t,o),f.apply(this,[e,o])};const n=l.removeEventListener;l.removeEventListener=function(e,t){if(e!==i||!this._eventMap||!this._eventMap[i])return n.apply(this,arguments);if(!this._eventMap[i].has(t))return n.apply(this,arguments);const o=this._eventMap[i].get(t);return this._eventMap[i].delete(t),this._eventMap[i].size===0&&delete this._eventMap[i],Object.keys(this._eventMap).length===0&&delete this._eventMap,n.apply(this,[e,o])},Object.defineProperty(l,"on"+i,{get(){return this["_on"+i]},set(e){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),e&&this.addEventListener(i,this["_on"+i]=e)},enumerable:!0,configurable:!0})}function O(u){return typeof u!="boolean"?new Error("Argument type: "+typeof u+". Please use a boolean."):(_=u,u?"adapter.js logging disabled":"adapter.js logging enabled")}function j(u){return typeof u!="boolean"?new Error("Argument type: "+typeof u+". Please use a boolean."):(A=!u,"adapter.js deprecation warnings "+(u?"disabled":"enabled"))}function D(){if(typeof window=="object"){if(_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function x(u,i){A&&console.warn(u+" is deprecated, please use "+i+" instead.")}function N(u){return Object.prototype.toString.call(u)==="[object Object]"}function $(u){return N(u)?Object.keys(u).reduce(function(i,c){const l=N(u[c]),f=l?$(u[c]):u[c],n=l&&!Object.keys(f).length;return f===void 0||n?i:Object.assign(i,{[c]:f})},{}):u}function H(u,i,c){i&&!c.has(i.id)&&(c.set(i.id,i),Object.keys(i).forEach(l=>{l.endsWith("Id")?H(u,u.get(i[l]),c):l.endsWith("Ids")&&i[l].forEach(f=>{H(u,u.get(f),c)})}))}function K(u,i,c){const l=c?"outbound-rtp":"inbound-rtp",f=new Map;if(i===null)return f;const n=[];return u.forEach(e=>{e.type==="track"&&e.trackIdentifier===i.id&&n.push(e)}),n.forEach(e=>{u.forEach(t=>{t.type===l&&t.trackId===e.id&&H(u,t,f)})}),f}const ce=D;function Q(u,i){const c=u&&u.navigator;if(!c.mediaDevices)return;const l=function(e){if(typeof e!="object"||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(o=>{if(o==="require"||o==="advanced"||o==="mediaSource")return;const s=typeof e[o]=="object"?e[o]:{ideal:e[o]};s.exact!==void 0&&typeof s.exact=="number"&&(s.min=s.max=s.exact);const h=function(y,T){return y?y+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(s.ideal!==void 0){t.optional=t.optional||[];let y={};typeof s.ideal=="number"?(y[h("min",o)]=s.ideal,t.optional.push(y),y={},y[h("max",o)]=s.ideal,t.optional.push(y)):(y[h("",o)]=s.ideal,t.optional.push(y))}s.exact!==void 0&&typeof s.exact!="number"?(t.mandatory=t.mandatory||{},t.mandatory[h("",o)]=s.exact):["min","max"].forEach(y=>{s[y]!==void 0&&(t.mandatory=t.mandatory||{},t.mandatory[h(y,o)]=s[y])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},f=function(e,t){if(i.version>=61)return t(e);if((e=JSON.parse(JSON.stringify(e)))&&typeof e.audio=="object"){const o=function(s,h,y){h in s&&!(y in s)&&(s[y]=s[h],delete s[h])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=l(e.audio)}if(e&&typeof e.video=="object"){let o=e.video.facingMode;o=o&&(typeof o=="object"?o:{ideal:o});const s=i.version<66;if(o&&(o.exact==="user"||o.exact==="environment"||o.ideal==="user"||o.ideal==="environment")&&(!c.mediaDevices.getSupportedConstraints||!c.mediaDevices.getSupportedConstraints().facingMode||s)){let h;if(delete e.video.facingMode,o.exact==="environment"||o.ideal==="environment"?h=["back","rear"]:o.exact!=="user"&&o.ideal!=="user"||(h=["front"]),h)return c.mediaDevices.enumerateDevices().then(y=>{let T=(y=y.filter(P=>P.kind==="videoinput")).find(P=>h.some(M=>P.label.toLowerCase().includes(M)));return!T&&y.length&&h.includes("back")&&(T=y[y.length-1]),T&&(e.video.deviceId=o.exact?{exact:T.deviceId}:{ideal:T.deviceId}),e.video=l(e.video),ce("chrome: "+JSON.stringify(e)),t(e)})}e.video=l(e.video)}return ce("chrome: "+JSON.stringify(e)),t(e)},n=function(e){return i.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(c.getUserMedia=(function(e,t,o){f(e,s=>{c.webkitGetUserMedia(s,t,h=>{o&&o(n(h))})})}).bind(c),c.mediaDevices.getUserMedia){const e=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(t){return f(t,o=>e(o).then(s=>{if(o.audio&&!s.getAudioTracks().length||o.video&&!s.getVideoTracks().length)throw s.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return s},s=>Promise.reject(n(s))))}}}function Z(u,i){u.navigator.mediaDevices&&"getDisplayMedia"in u.navigator.mediaDevices||u.navigator.mediaDevices&&(typeof i=="function"?u.navigator.mediaDevices.getDisplayMedia=function(c){return i(c).then(l=>{const f=c.video&&c.video.width,n=c.video&&c.video.height,e=c.video&&c.video.frameRate;return c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l,maxFrameRate:e||3}},f&&(c.video.mandatory.maxWidth=f),n&&(c.video.mandatory.maxHeight=n),u.navigator.mediaDevices.getUserMedia(c)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function Se(u){u.MediaStream=u.MediaStream||u.webkitMediaStream}function G(u){if(typeof u=="object"&&u.RTCPeerConnection&&!("ontrack"in u.RTCPeerConnection.prototype)){Object.defineProperty(u.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(c){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=c)},enumerable:!0,configurable:!0});const i=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=c=>{c.stream.addEventListener("addtrack",l=>{let f;f=u.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===l.track.id):{track:l.track};const n=new Event("track");n.track=l.track,n.receiver=f,n.transceiver={receiver:f},n.streams=[c.stream],this.dispatchEvent(n)}),c.stream.getTracks().forEach(l=>{let f;f=u.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===l.id):{track:l};const n=new Event("track");n.track=l,n.receiver=f,n.transceiver={receiver:f},n.streams=[c.stream],this.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),i.apply(this,arguments)}}else v(u,"track",i=>(i.transceiver||Object.defineProperty(i,"transceiver",{value:{receiver:i.receiver}}),i))}function ie(u){if(typeof u=="object"&&u.RTCPeerConnection&&!("getSenders"in u.RTCPeerConnection.prototype)&&"createDTMFSender"in u.RTCPeerConnection.prototype){const i=function(f,n){return{track:n,get dtmf(){return this._dtmf===void 0&&(n.kind==="audio"?this._dtmf=f.createDTMFSender(n):this._dtmf=null),this._dtmf},_pc:f}};if(!u.RTCPeerConnection.prototype.getSenders){u.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const f=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addTrack=function(e,t){let o=f.apply(this,arguments);return o||(o=i(this,e),this._senders.push(o)),o};const n=u.RTCPeerConnection.prototype.removeTrack;u.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);t!==-1&&this._senders.splice(t,1)}}const c=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(f){this._senders=this._senders||[],c.apply(this,[f]),f.getTracks().forEach(n=>{this._senders.push(i(this,n))})};const l=u.RTCPeerConnection.prototype.removeStream;u.RTCPeerConnection.prototype.removeStream=function(f){this._senders=this._senders||[],l.apply(this,[f]),f.getTracks().forEach(n=>{const e=this._senders.find(t=>t.track===n);e&&this._senders.splice(this._senders.indexOf(e),1)})}}else if(typeof u=="object"&&u.RTCPeerConnection&&"getSenders"in u.RTCPeerConnection.prototype&&"createDTMFSender"in u.RTCPeerConnection.prototype&&u.RTCRtpSender&&!("dtmf"in u.RTCRtpSender.prototype)){const i=u.RTCPeerConnection.prototype.getSenders;u.RTCPeerConnection.prototype.getSenders=function(){const c=i.apply(this,[]);return c.forEach(l=>l._pc=this),c},Object.defineProperty(u.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function de(u){if(!u.RTCPeerConnection)return;const i=u.RTCPeerConnection.prototype.getStats;u.RTCPeerConnection.prototype.getStats=function(){const[c,l,f]=arguments;if(arguments.length>0&&typeof c=="function")return i.apply(this,arguments);if(i.length===0&&(arguments.length===0||typeof c!="function"))return i.apply(this,[]);const n=function(t){const o={};return t.result().forEach(s=>{const h={id:s.id,timestamp:s.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[s.type]||s.type};s.names().forEach(y=>{h[y]=s.stat(y)}),o[h.id]=h}),o},e=function(t){return new Map(Object.keys(t).map(o=>[o,t[o]]))};if(arguments.length>=2){const t=function(o){l(e(n(o)))};return i.apply(this,[t,c])}return new Promise((t,o)=>{i.apply(this,[function(s){t(e(n(s)))},o])}).then(l,f)}}function ne(u){if(!(typeof u=="object"&&u.RTCPeerConnection&&u.RTCRtpSender&&u.RTCRtpReceiver))return;if(!("getStats"in u.RTCRtpSender.prototype)){const c=u.RTCPeerConnection.prototype.getSenders;c&&(u.RTCPeerConnection.prototype.getSenders=function(){const f=c.apply(this,[]);return f.forEach(n=>n._pc=this),f});const l=u.RTCPeerConnection.prototype.addTrack;l&&(u.RTCPeerConnection.prototype.addTrack=function(){const f=l.apply(this,arguments);return f._pc=this,f}),u.RTCRtpSender.prototype.getStats=function(){const f=this;return this._pc.getStats().then(n=>K(n,f.track,!0))}}if(!("getStats"in u.RTCRtpReceiver.prototype)){const c=u.RTCPeerConnection.prototype.getReceivers;c&&(u.RTCPeerConnection.prototype.getReceivers=function(){const l=c.apply(this,[]);return l.forEach(f=>f._pc=this),l}),v(u,"track",l=>(l.receiver._pc=l.srcElement,l)),u.RTCRtpReceiver.prototype.getStats=function(){const l=this;return this._pc.getStats().then(f=>K(f,l.track,!1))}}if(!("getStats"in u.RTCRtpSender.prototype)||!("getStats"in u.RTCRtpReceiver.prototype))return;const i=u.RTCPeerConnection.prototype.getStats;u.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof u.MediaStreamTrack){const c=arguments[0];let l,f,n;return this.getSenders().forEach(e=>{e.track===c&&(l?n=!0:l=e)}),this.getReceivers().forEach(e=>(e.track===c&&(f?n=!0:f=e),e.track===c)),n||l&&f?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():f?f.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}function J(u){u.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(n=>this._shimmedLocalStreams[n][0])};const i=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addTrack=function(n,e){if(!e)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const t=i.apply(this,arguments);return this._shimmedLocalStreams[e.id]?this._shimmedLocalStreams[e.id].indexOf(t)===-1&&this._shimmedLocalStreams[e.id].push(t):this._shimmedLocalStreams[e.id]=[e,t],t};const c=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(n){this._shimmedLocalStreams=this._shimmedLocalStreams||{},n.getTracks().forEach(o=>{if(this.getSenders().find(s=>s.track===o))throw new DOMException("Track already exists.","InvalidAccessError")});const e=this.getSenders();c.apply(this,arguments);const t=this.getSenders().filter(o=>e.indexOf(o)===-1);this._shimmedLocalStreams[n.id]=[n].concat(t)};const l=u.RTCPeerConnection.prototype.removeStream;u.RTCPeerConnection.prototype.removeStream=function(n){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[n.id],l.apply(this,arguments)};const f=u.RTCPeerConnection.prototype.removeTrack;u.RTCPeerConnection.prototype.removeTrack=function(n){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(e=>{const t=this._shimmedLocalStreams[e].indexOf(n);t!==-1&&this._shimmedLocalStreams[e].splice(t,1),this._shimmedLocalStreams[e].length===1&&delete this._shimmedLocalStreams[e]}),f.apply(this,arguments)}}function W(u,i){if(!u.RTCPeerConnection)return;if(u.RTCPeerConnection.prototype.addTrack&&i.version>=65)return J(u);const c=u.RTCPeerConnection.prototype.getLocalStreams;u.RTCPeerConnection.prototype.getLocalStreams=function(){const o=c.apply(this);return this._reverseStreams=this._reverseStreams||{},o.map(s=>this._reverseStreams[s.id])};const l=u.RTCPeerConnection.prototype.addStream;u.RTCPeerConnection.prototype.addStream=function(o){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.getTracks().forEach(s=>{if(this.getSenders().find(h=>h.track===s))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[o.id]){const s=new u.MediaStream(o.getTracks());this._streams[o.id]=s,this._reverseStreams[s.id]=o,o=s}l.apply(this,[o])};const f=u.RTCPeerConnection.prototype.removeStream;function n(o,s){let h=s.sdp;return Object.keys(o._reverseStreams||[]).forEach(y=>{const T=o._reverseStreams[y],P=o._streams[T.id];h=h.replace(new RegExp(P.id,"g"),T.id)}),new RTCSessionDescription({type:s.type,sdp:h})}u.RTCPeerConnection.prototype.removeStream=function(o){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.apply(this,[this._streams[o.id]||o]),delete this._reverseStreams[this._streams[o.id]?this._streams[o.id].id:o.id],delete this._streams[o.id]},u.RTCPeerConnection.prototype.addTrack=function(o,s){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(T=>T===o))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(T=>T.track===o))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const y=this._streams[s.id];if(y)y.addTrack(o),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const T=new u.MediaStream([o]);this._streams[s.id]=T,this._reverseStreams[T.id]=s,this.addStream(T)}return this.getSenders().find(T=>T.track===o)},["createOffer","createAnswer"].forEach(function(o){const s=u.RTCPeerConnection.prototype[o],h={[o](){const y=arguments;return arguments.length&&typeof arguments[0]=="function"?s.apply(this,[T=>{const P=n(this,T);y[0].apply(null,[P])},T=>{y[1]&&y[1].apply(null,T)},arguments[2]]):s.apply(this,arguments).then(T=>n(this,T))}};u.RTCPeerConnection.prototype[o]=h[o]});const e=u.RTCPeerConnection.prototype.setLocalDescription;u.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(o,s){let h=s.sdp;return Object.keys(o._reverseStreams||[]).forEach(y=>{const T=o._reverseStreams[y],P=o._streams[T.id];h=h.replace(new RegExp(T.id,"g"),P.id)}),new RTCSessionDescription({type:s.type,sdp:h})}(this,arguments[0]),e.apply(this,arguments)):e.apply(this,arguments)};const t=Object.getOwnPropertyDescriptor(u.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(u.RTCPeerConnection.prototype,"localDescription",{get(){const o=t.get.apply(this);return o.type===""?o:n(this,o)}}),u.RTCPeerConnection.prototype.removeTrack=function(o){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!o._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(o._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let s;this._streams=this._streams||{},Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(y=>o.track===y)&&(s=this._streams[h])}),s&&(s.getTracks().length===1?this.removeStream(this._reverseStreams[s.id]):s.removeTrack(o.track),this.dispatchEvent(new Event("negotiationneeded")))}}function X(u,i){!u.RTCPeerConnection&&u.webkitRTCPeerConnection&&(u.RTCPeerConnection=u.webkitRTCPeerConnection),u.RTCPeerConnection&&i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const l=u.RTCPeerConnection.prototype[c],f={[c](){return arguments[0]=new(c==="addIceCandidate"?u.RTCIceCandidate:u.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};u.RTCPeerConnection.prototype[c]=f[c]})}function se(u,i){v(u,"negotiationneeded",c=>{const l=c.target;if(!(i.version<72||l.getConfiguration&&l.getConfiguration().sdpSemantics==="plan-b")||l.signalingState==="stable")return c})}function he(u,i){const c=u&&u.navigator,l=u&&u.MediaStreamTrack;if(c.getUserMedia=function(f,n,e){x("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),c.mediaDevices.getUserMedia(f).then(n,e)},!(i.version>55&&"autoGainControl"in c.mediaDevices.getSupportedConstraints())){const f=function(e,t,o){t in e&&!(o in e)&&(e[o]=e[t],delete e[t])},n=c.mediaDevices.getUserMedia.bind(c.mediaDevices);if(c.mediaDevices.getUserMedia=function(e){return typeof e=="object"&&typeof e.audio=="object"&&(e=JSON.parse(JSON.stringify(e)),f(e.audio,"autoGainControl","mozAutoGainControl"),f(e.audio,"noiseSuppression","mozNoiseSuppression")),n(e)},l&&l.prototype.getSettings){const e=l.prototype.getSettings;l.prototype.getSettings=function(){const t=e.apply(this,arguments);return f(t,"mozAutoGainControl","autoGainControl"),f(t,"mozNoiseSuppression","noiseSuppression"),t}}if(l&&l.prototype.applyConstraints){const e=l.prototype.applyConstraints;l.prototype.applyConstraints=function(t){return this.kind==="audio"&&typeof t=="object"&&(t=JSON.parse(JSON.stringify(t)),f(t,"autoGainControl","mozAutoGainControl"),f(t,"noiseSuppression","mozNoiseSuppression")),e.apply(this,[t])}}}}function Ie(u,i){u.navigator.mediaDevices&&"getDisplayMedia"in u.navigator.mediaDevices||u.navigator.mediaDevices&&(u.navigator.mediaDevices.getDisplayMedia=function(c){if(!c||!c.video){const l=new DOMException("getDisplayMedia without video constraints is undefined");return l.name="NotFoundError",l.code=8,Promise.reject(l)}return c.video===!0?c.video={mediaSource:i}:c.video.mediaSource=i,u.navigator.mediaDevices.getUserMedia(c)})}function we(u){typeof u=="object"&&u.RTCTrackEvent&&"receiver"in u.RTCTrackEvent.prototype&&!("transceiver"in u.RTCTrackEvent.prototype)&&Object.defineProperty(u.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qe(u,i){if(typeof u!="object"||!u.RTCPeerConnection&&!u.mozRTCPeerConnection)return;!u.RTCPeerConnection&&u.mozRTCPeerConnection&&(u.RTCPeerConnection=u.mozRTCPeerConnection),i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(f){const n=u.RTCPeerConnection.prototype[f],e={[f](){return arguments[0]=new(f==="addIceCandidate"?u.RTCIceCandidate:u.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};u.RTCPeerConnection.prototype[f]=e[f]});const c={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=u.RTCPeerConnection.prototype.getStats;u.RTCPeerConnection.prototype.getStats=function(){const[f,n,e]=arguments;return l.apply(this,[f||null]).then(t=>{if(i.version<53&&!n)try{t.forEach(o=>{o.type=c[o.type]||o.type})}catch(o){if(o.name!=="TypeError")throw o;t.forEach((s,h)=>{t.set(h,Object.assign({},s,{type:c[s.type]||s.type}))})}return t}).then(n,e)}}function Tt(u){if(typeof u!="object"||!u.RTCPeerConnection||!u.RTCRtpSender||u.RTCRtpSender&&"getStats"in u.RTCRtpSender.prototype)return;const i=u.RTCPeerConnection.prototype.getSenders;i&&(u.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(f=>f._pc=this),l});const c=u.RTCPeerConnection.prototype.addTrack;c&&(u.RTCPeerConnection.prototype.addTrack=function(){const l=c.apply(this,arguments);return l._pc=this,l}),u.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function vt(u){if(typeof u!="object"||!u.RTCPeerConnection||!u.RTCRtpSender||u.RTCRtpSender&&"getStats"in u.RTCRtpReceiver.prototype)return;const i=u.RTCPeerConnection.prototype.getReceivers;i&&(u.RTCPeerConnection.prototype.getReceivers=function(){const c=i.apply(this,[]);return c.forEach(l=>l._pc=this),c}),v(u,"track",c=>(c.receiver._pc=c.srcElement,c)),u.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ut(u){u.RTCPeerConnection&&!("removeStream"in u.RTCPeerConnection.prototype)&&(u.RTCPeerConnection.prototype.removeStream=function(i){x("removeStream","removeTrack"),this.getSenders().forEach(c=>{c.track&&i.getTracks().includes(c.track)&&this.removeTrack(c)})})}function Vt(u){u.DataChannel&&!u.RTCDataChannel&&(u.RTCDataChannel=u.DataChannel)}function Ht(u){if(typeof u!="object"||!u.RTCPeerConnection)return;const i=u.RTCPeerConnection.prototype.addTransceiver;i&&(u.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let c=arguments[1]&&arguments[1].sendEncodings;c===void 0&&(c=[]),c=[...c];const l=c.length>0;l&&c.forEach(n=>{if("rid"in n&&!/^[a-z0-9]{0,16}$/i.test(n.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in n&&!(parseFloat(n.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in n&&!(parseFloat(n.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const f=i.apply(this,arguments);if(l){const{sender:n}=f,e=n.getParameters();(!("encodings"in e)||e.encodings.length===1&&Object.keys(e.encodings[0]).length===0)&&(e.encodings=c,n.sendEncodings=c,this.setParametersPromises.push(n.setParameters(e).then(()=>{delete n.sendEncodings}).catch(()=>{delete n.sendEncodings})))}return f})}function Ge(u){if(typeof u!="object"||!u.RTCRtpSender)return;const i=u.RTCRtpSender.prototype.getParameters;i&&(u.RTCRtpSender.prototype.getParameters=function(){const c=i.apply(this,arguments);return"encodings"in c||(c.encodings=[].concat(this.sendEncodings||[{}])),c})}function At(u){if(typeof u!="object"||!u.RTCPeerConnection)return;const i=u.RTCPeerConnection.prototype.createOffer;u.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}function rn(u){if(typeof u!="object"||!u.RTCPeerConnection)return;const i=u.RTCPeerConnection.prototype.createAnswer;u.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}function gn(u){if(typeof u=="object"&&u.RTCPeerConnection){if("getLocalStreams"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in u.RTCPeerConnection.prototype)){const i=u.RTCPeerConnection.prototype.addTrack;u.RTCPeerConnection.prototype.addStream=function(c){this._localStreams||(this._localStreams=[]),this._localStreams.includes(c)||this._localStreams.push(c),c.getAudioTracks().forEach(l=>i.call(this,l,c)),c.getVideoTracks().forEach(l=>i.call(this,l,c))},u.RTCPeerConnection.prototype.addTrack=function(c,...l){return l&&l.forEach(f=>{this._localStreams?this._localStreams.includes(f)||this._localStreams.push(f):this._localStreams=[f]}),i.apply(this,arguments)}}"removeStream"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const c=this._localStreams.indexOf(i);if(c===-1)return;this._localStreams.splice(c,1);const l=i.getTracks();this.getSenders().forEach(f=>{l.includes(f.track)&&this.removeTrack(f)})})}}function Dn(u){if(typeof u=="object"&&u.RTCPeerConnection&&("getRemoteStreams"in u.RTCPeerConnection.prototype||(u.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in u.RTCPeerConnection.prototype))){Object.defineProperty(u.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(c){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=c),this.addEventListener("track",this._onaddstreampoly=l=>{l.streams.forEach(f=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(f))return;this._remoteStreams.push(f);const n=new Event("addstream");n.stream=f,this.dispatchEvent(n)})})}});const i=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){const c=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(f=>{if(c._remoteStreams||(c._remoteStreams=[]),c._remoteStreams.indexOf(f)>=0)return;c._remoteStreams.push(f);const n=new Event("addstream");n.stream=f,c.dispatchEvent(n)})}),i.apply(c,arguments)}}}function ur(u){if(typeof u!="object"||!u.RTCPeerConnection)return;const i=u.RTCPeerConnection.prototype,c=i.createOffer,l=i.createAnswer,f=i.setLocalDescription,n=i.setRemoteDescription,e=i.addIceCandidate;i.createOffer=function(o,s){const h=arguments.length>=2?arguments[2]:arguments[0],y=c.apply(this,[h]);return s?(y.then(o,s),Promise.resolve()):y},i.createAnswer=function(o,s){const h=arguments.length>=2?arguments[2]:arguments[0],y=l.apply(this,[h]);return s?(y.then(o,s),Promise.resolve()):y};let t=function(o,s,h){const y=f.apply(this,[o]);return h?(y.then(s,h),Promise.resolve()):y};i.setLocalDescription=t,t=function(o,s,h){const y=n.apply(this,[o]);return h?(y.then(s,h),Promise.resolve()):y},i.setRemoteDescription=t,t=function(o,s,h){const y=e.apply(this,[o]);return h?(y.then(s,h),Promise.resolve()):y},i.addIceCandidate=t}function it(u){const i=u&&u.navigator;if(i.mediaDevices&&i.mediaDevices.getUserMedia){const c=i.mediaDevices,l=c.getUserMedia.bind(c);i.mediaDevices.getUserMedia=f=>l(Ar(f))}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=(function(c,l,f){i.mediaDevices.getUserMedia(c).then(l,f)}).bind(i))}function Ar(u){return u&&u.video!==void 0?Object.assign({},u,{video:$(u.video)}):u}function ra(u){if(!u.RTCPeerConnection)return;const i=u.RTCPeerConnection;u.RTCPeerConnection=function(c,l){if(c&&c.iceServers){const f=[];for(let n=0;n<c.iceServers.length;n++){let e=c.iceServers[n];e.urls===void 0&&e.url?(x("RTCIceServer.url","RTCIceServer.urls"),e=JSON.parse(JSON.stringify(e)),e.urls=e.url,delete e.url,f.push(e)):f.push(c.iceServers[n])}c.iceServers=f}return new i(c,l)},u.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i&&Object.defineProperty(u.RTCPeerConnection,"generateCertificate",{get:()=>i.generateCertificate})}function Qt(u){typeof u=="object"&&u.RTCTrackEvent&&"receiver"in u.RTCTrackEvent.prototype&&!("transceiver"in u.RTCTrackEvent.prototype)&&Object.defineProperty(u.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function xi(u){const i=u.RTCPeerConnection.prototype.createOffer;u.RTCPeerConnection.prototype.createOffer=function(c){if(c){c.offerToReceiveAudio!==void 0&&(c.offerToReceiveAudio=!!c.offerToReceiveAudio);const l=this.getTransceivers().find(n=>n.receiver.track.kind==="audio");c.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):c.offerToReceiveAudio!==!0||l||this.addTransceiver("audio",{direction:"recvonly"}),c.offerToReceiveVideo!==void 0&&(c.offerToReceiveVideo=!!c.offerToReceiveVideo);const f=this.getTransceivers().find(n=>n.receiver.track.kind==="video");c.offerToReceiveVideo===!1&&f?f.direction==="sendrecv"?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":f.direction==="recvonly"&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):c.offerToReceiveVideo!==!0||f||this.addTransceiver("video",{direction:"recvonly"})}return i.apply(this,arguments)}}function Di(u){typeof u!="object"||u.AudioContext||(u.AudioContext=u.webkitAudioContext)}var oi=g(7963),Qi=g.n(oi);function lr(u){if(!u.RTCIceCandidate||u.RTCIceCandidate&&"foundation"in u.RTCIceCandidate.prototype)return;const i=u.RTCIceCandidate;u.RTCIceCandidate=function(c){if(typeof c=="object"&&c.candidate&&c.candidate.indexOf("a=")===0&&((c=JSON.parse(JSON.stringify(c))).candidate=c.candidate.substring(2)),c.candidate&&c.candidate.length){const l=new i(c),f=Qi().parseCandidate(c.candidate);for(const n in f)n in l||Object.defineProperty(l,n,{value:f[n]});return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new i(c)},u.RTCIceCandidate.prototype=i.prototype,v(u,"icecandidate",c=>(c.candidate&&Object.defineProperty(c,"candidate",{value:new u.RTCIceCandidate(c.candidate),writable:"false"}),c))}function Wr(u){!u.RTCIceCandidate||u.RTCIceCandidate&&"relayProtocol"in u.RTCIceCandidate.prototype||v(u,"icecandidate",i=>{if(i.candidate){const c=Qi().parseCandidate(i.candidate.candidate);c.type==="relay"&&(i.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[c.priority>>24])}return i})}function me(u,i){if(!u.RTCPeerConnection)return;"sctp"in u.RTCPeerConnection.prototype||Object.defineProperty(u.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const c=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,i.browser==="chrome"&&i.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(l){if(!l||!l.sdp)return!1;const f=Qi().splitSections(l.sdp);return f.shift(),f.some(n=>{const e=Qi().parseMLine(n);return e&&e.kind==="application"&&e.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const l=function(o){const s=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(s===null||s.length<2)return-1;const h=parseInt(s[1],10);return h!=h?-1:h}(arguments[0]),f=function(o){let s=65536;return i.browser==="firefox"&&(s=i.version<57?o===-1?16384:2147483637:i.version<60?i.version===57?65535:65536:2147483637),s}(l),n=function(o,s){let h=65536;i.browser==="firefox"&&i.version===57&&(h=65535);const y=Qi().matchPrefix(o.sdp,"a=max-message-size:");return y.length>0?h=parseInt(y[0].substring(19),10):i.browser==="firefox"&&s!==-1&&(h=2147483637),h}(arguments[0],l);let e;e=f===0&&n===0?Number.POSITIVE_INFINITY:f===0||n===0?Math.max(f,n):Math.min(f,n);const t={};Object.defineProperty(t,"maxMessageSize",{get:()=>e}),this._sctp=t}return c.apply(this,arguments)}}function Ee(u){if(!u.RTCPeerConnection||!("createDataChannel"in u.RTCPeerConnection.prototype))return;function i(l,f){const n=l.send;l.send=function(){const e=arguments[0],t=e.length||e.size||e.byteLength;if(l.readyState==="open"&&f.sctp&&t>f.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+f.sctp.maxMessageSize+" bytes)");return n.apply(l,arguments)}}const c=u.RTCPeerConnection.prototype.createDataChannel;u.RTCPeerConnection.prototype.createDataChannel=function(){const l=c.apply(this,arguments);return i(l,this),l},v(u,"datachannel",l=>(i(l.channel,l.target),l))}function ke(u){if(!u.RTCPeerConnection||"connectionState"in u.RTCPeerConnection.prototype)return;const i=u.RTCPeerConnection.prototype;Object.defineProperty(i,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(i,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(c){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),c&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=c)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(c=>{const l=i[c];i[c]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=f=>{const n=f.target;if(n._lastConnectionState!==n.connectionState){n._lastConnectionState=n.connectionState;const e=new Event("connectionstatechange",f);n.dispatchEvent(e)}return f},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),l.apply(this,arguments)}})}function $e(u,i){if(!u.RTCPeerConnection||i.browser==="chrome"&&i.version>=71||i.browser==="safari"&&i.version>=605)return;const c=u.RTCPeerConnection.prototype.setRemoteDescription;u.RTCPeerConnection.prototype.setRemoteDescription=function(l){if(l&&l.sdp&&l.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const f=l.sdp.split(`
`).filter(n=>n.trim()!=="a=extmap-allow-mixed").join(`
`);u.RTCSessionDescription&&l instanceof u.RTCSessionDescription?arguments[0]=new u.RTCSessionDescription({type:l.type,sdp:f}):l.sdp=f}return c.apply(this,arguments)}}function Te(u,i){if(!u.RTCPeerConnection||!u.RTCPeerConnection.prototype)return;const c=u.RTCPeerConnection.prototype.addIceCandidate;c&&c.length!==0&&(u.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(i.browser==="chrome"&&i.version<78||i.browser==="firefox"&&i.version<68||i.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function tt(u,i){if(!u.RTCPeerConnection||!u.RTCPeerConnection.prototype)return;const c=u.RTCPeerConnection.prototype.setLocalDescription;c&&c.length!==0&&(u.RTCPeerConnection.prototype.setLocalDescription=function(){let l=arguments[0]||{};if(typeof l!="object"||l.type&&l.sdp)return c.apply(this,arguments);if(l={type:l.type,sdp:l.sdp},!l.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":l.type="offer";break;default:l.type="answer"}return l.sdp||l.type!=="offer"&&l.type!=="answer"?c.apply(this,[l]):(l.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(f=>c.apply(this,[f]))})}(function({window:u}={},i={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const c=D,l=function(n){const e={browser:null,version:null};if(n===void 0||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.mozGetUserMedia)e.browser="firefox",e.version=C(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=C(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!n.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=C(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype}return e}(u),f={browserDetails:l,commonShim:S,extractVersion:C,disableLog:O,disableWarnings:j,sdp:oi};switch(l.browser){case"chrome":if(!E||!X||!i.shimChrome)return c("Chrome shim is not included in this adapter release."),f;if(l.version===null)return c("Chrome shim can not determine version, not shimming."),f;c("adapter.js shimming chrome."),f.browserShim=E,Te(u,l),tt(u),Q(u,l),Se(u),X(u,l),G(u),W(u,l),ie(u),de(u),ne(u),se(u,l),lr(u),Wr(u),ke(u),me(u,l),Ee(u),$e(u,l);break;case"firefox":if(!w||!Qe||!i.shimFirefox)return c("Firefox shim is not included in this adapter release."),f;c("adapter.js shimming firefox."),f.browserShim=w,Te(u,l),tt(u),he(u,l),Qe(u,l),we(u),Ut(u),Tt(u),vt(u),Vt(u),Ht(u),Ge(u),At(u),rn(u),lr(u),ke(u),me(u,l),Ee(u);break;case"safari":if(!m||!i.shimSafari)return c("Safari shim is not included in this adapter release."),f;c("adapter.js shimming safari."),f.browserShim=m,Te(u,l),tt(u),ra(u),xi(u),ur(u),gn(u),Dn(u),Qt(u),it(u),Di(u),lr(u),Wr(u),me(u,l),Ee(u),$e(u,l);break;default:c("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),g(8630);const lt=()=>typeof RTCPeerConnection=="function";var Ve,Be;(function(u){u[u.TRACE=0]="TRACE",u[u.DEBUG=1]="DEBUG",u[u.INFO=2]="INFO",u[u.WARN=3]="WARN",u[u.ERROR=4]="ERROR",u[u.SILENT=5]="SILENT"})(Ve||(Ve={})),function(u){u.TIME="Time",u.WEBRTC="WebRTC",u.EMITTER="Emitter",u.MEDIA="Media",u.SUBSCRIPTION="StageSubscription",u.PUBLICATION="StagePublication",u.CONNECTION="StageConnection",u.SOCKET="StageSocket",u.BROADCAST_STAGE_CLIENT="BroadcastStageClient",u.STAGE="Stage",u.REMOTE_PARTICIPANT="RemoteParticipant",u.LOCAL_PARTICIPANT="LocalParticipant",u.CONFIGURATION="Configuration",u.REMOTE_PLAYBACK="RemotePlaybackController",u.REMOTE_STAGE_STREAM="RemoteStageStream"}(Be||(Be={}));const Hn=12e4,Dt=3e5,Mt="no-rid";class Ke extends Error{constructor({name:i,message:c,code:l,details:f,cause:n,params:e}){super(c),Error.captureStackTrace&&Error.captureStackTrace(this,Ke),this.name=i||"BroadcastClientError",this.message=c,this.code=l,this.details=f,this.cause=n,this.params=e}}const Pr={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},xr={name:"CameraError",code:2e3,message:"Camera could not be captured"},Mo={name:"InputError",code:3e3,message:"Input could not be attached"},Mi={name:"AddDeviceError",code:4e3,message:"Device is missing"},mi={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},Zi={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},oe={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},fe={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},Ce={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},xe={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},dt={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},vn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},bt={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},nt={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},Ye={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},je={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},Ze={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},at={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},jt={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},dn={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},yn={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},Xn={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},us={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},ls={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},nu={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},dc={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},hc={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},fc={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},ds={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},No={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},Oa={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},Qu={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var hs,fs,Aa,Pa,xa,ps,pc,ru,Zu,Ni=function(u,i,c,l){if(c==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?u!==i||!l:!i.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?l:c==="a"?l.call(u):l?l.value:i.get(u)},Li=function(u,i,c,l,f){if(typeof i=="function"?u!==i||!f:!i.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i.set(u,c),c};const ms=1920,Kl=1080,rh=Ve.ERROR,mc={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},el={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},bn={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},ft={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},hn={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},tl={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},nl={reconnect:!1,timeout:Hn};function rl(u){var i,c;if(typeof u!="string"&&u!==void 0)throw new Ke(us);if(u){if(u.startsWith("https"))return u;{const l=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(u);if(((i=l==null?void 0:l.groups)===null||i===void 0?void 0:i.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(c=l==null?void 0:l.groups)===null||c===void 0?void 0:c.id)return`https://${l.groups.id}.webrtc.live-video.net:4443`;throw new Ke(ls)}}return""}class Yl{constructor(i,c,l=mc,f,n=nl){this.LOG_LEVEL=Ve,this.BASIC_LANDSCAPE=mc,this.BASIC_PORTRAIT=el,this.BASIC_FULL_HD_LANDSCAPE=bn,this.BASIC_FULL_HD_PORTRAIT=ft,this.STANDARD_LANDSCAPE=hn,this.STANDARD_PORTRAIT=tl,hs.set(this,void 0),fs.set(this,void 0),Aa.set(this,mc),Pa.set(this,void 0),xa.set(this,nl),ps.set(this,e=>{if(!e)throw new Ke(Object.assign(Object.assign({},Xn),{details:"missing stream configuration"}));if(!(e.maxBitrate<=8500&&e.maxBitrate>=200))throw new Ke(Object.assign(Object.assign({},Xn),{details:"maxBitrate must be between 200 and 8500"}));if(!(e.maxFramerate<=60&&e.maxFramerate>=10))throw new Ke(Object.assign(Object.assign({},Xn),{details:"maxFramerate must be between 10 and 60"}));const t=e.maxResolution.width,o=e.maxResolution.height;if(t>ms||o>ms||t<160||o<160||t===ms&&o>Kl||o===ms&&t>Kl)throw new Ke(Object.assign(Object.assign({},Xn),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))}),pc.set(this,e=>{if(!e)return;const t=Number(e),o=Number.isInteger(t),s=t>=Ve.TRACE,h=t<=Ve.SILENT;if(!o||!s||!h)throw new Ke(nu)}),ru.set(this,e=>{if(e&&typeof e!="object")throw new Ke(dc)}),Zu.set(this,e=>{if(!e)return;if(typeof e!="object"||typeof e.reconnect!="boolean")throw new Ke(fc);const{timeout:t}=e;if(t!==void 0&&(Number.isNaN(t)||typeof t!="number"||t<1e4||t>Dt))throw new Ke(ds)}),Ni(this,ru,"f").call(this,f),Ni(this,pc,"f").call(this,c),Ni(this,ps,"f").call(this,l),Li(this,hs,i),Li(this,fs,c),Li(this,Aa,l),Li(this,Pa,f),Li(this,xa,n)}get ingestEndpoint(){return Ni(this,hs,"f")}set ingestEndpoint(i){Li(this,hs,rl(i))}get streamConfig(){return Ni(this,Aa,"f")}set streamConfig(i){Ni(this,ps,"f").call(this,i),Li(this,Aa,i)}get logLevel(){return Ni(this,fs,"f")}set logLevel(i){Ni(this,pc,"f").call(this,i),Li(this,fs,i)}get logger(){return Ni(this,Pa,"f")}set logger(i){Ni(this,ru,"f").call(this,i),Li(this,Pa,i)}get networkReconnectConfig(){return Ni(this,xa,"f")}set networkReconnectConfig(i){Ni(this,Zu,"f").call(this,i),Li(this,xa,i)}}hs=new WeakMap,fs=new WeakMap,Aa=new WeakMap,Pa=new WeakMap,xa=new WeakMap,ps=new WeakMap,pc=new WeakMap,ru=new WeakMap,Zu=new WeakMap;var et,Qn=g(228);(function(u){u.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",u.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",u.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",u.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",u.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",u.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",u.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",u.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",u.PUBLISH="ivs_broadcast_multihost_publish",u.UNPUBLISH="ivs_broadcast_multihost_unpublish",u.SUBSCRIBE="ivs_broadcast_multihost_subscribe",u.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",u.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",u.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",u.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",u.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",u.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",u.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",u.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",u.FIRST_FRAME="ivs_broadcast_multihost_first_frame",u.JOIN="ivs_broadcast_multihost_join",u.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",u.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",u.JOIN_ENDED="ivs_broadcast_multihost_join_ended",u.LEAVE="ivs_broadcast_multihost_leave",u.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",u.SERVER_REQUEST="ivs_broadcast_multihost_server_request",u.TRACE="ivs_broadcast_stage_trace",u.ERROR="ivs_broadcast_error",u.MINUTE="ivs_broadcast_multihost_minute",u.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",u.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",u.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",u.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",u.EDP_PONG="ivs_broadcast_multihost_edp_rtt",u.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",u.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",u.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",u.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",u.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state",u.SELECTED_PAIR_CHANGE="ivs_broadcast_webrtc_selected_pair_change",u.ANALYTICS_HEALTH_REPORT="ivs_broadcast_analytics_health_report",u.DEVCONF_ERROR="ivs_devconf_error",u.DEVCONF_OPS_METRICS="ivs_devconf_ops_metrics",u.DEVCONF_TRACE="ivs_devconf_trace",u.DEVCONF_VALUE="ivs_devconf_value"})(et||(et={}));class Et{constructor(i,c,l,f){this.event=i,this.properties={client_time:new Date().toISOString(),customer_id:c.customerId,device_software:window.navigator.userAgent,multihost_id:c.stageARN,participant_id:c.participantID,participant_user_id:c.userID,platform:"web",sdk_version:"1.28.0",stage_arn:c.stageARN,trace_id:l.value},c.attrGsRole&&(this.properties.token_attribute_0=c.attrGsRole),c.attrGsSessionId&&(this.properties.token_attribute_1=c.attrGsSessionId),this.critical=f}}class ia extends Et{constructor(i){super(et.ERROR,i.token,i.traceId,!0),Object.assign(this.properties,{code:i.code,tag:i.tag,description:i.message,remote_participant_id:i.remoteParticipantId,request_uuid:i.requestUUID,is_nominal:i.nominal,is_fatal:i.fatal,details:i.details,location:i.location,event_count:i.count})}}function Da(u){const i=window.IVS_CLIENT_OVERRIDES;return typeof i=="object"?i[u]:u==="logLevel"?window.STAGES_LOG_LEVEL:u==="appLabel"?window.IVS_APP_LABEL:u==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function fr(u){const i=Da(u);if(typeof i=="string")return i}function jn(u){const i=Da(u);if(typeof i=="boolean")return i}function gc(u){const i=Da(u);if(typeof i=="number")return i;if(typeof i=="string"){const c=parseFloat(i);if(!isNaN(c))return c}}function iu(){const u=Da("logLevel");if(typeof u=="number"&&Object.values(Ve).includes(u))return u}function ou(){return jn("disableXdp")}function vc(){return jn("preferMainProfile")}function gs(){return jn("enableInitialLayerOnSdp")}function Gr(){return jn("disableAudioRtcpRsize")}var gi=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};function vi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,u=>{const i=16*Math.random()|0;return(u==="x"?i:3&i|8).toString(16)})}function yi(u,i=c=>{}){gi(this,void 0,void 0,function*(){try{yield u()}catch(c){i(c)}})}var au=g(6880),eo=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};function Bi(u,i,c={},l=""){return eo(this,void 0,void 0,function*(){const f=new XMLHttpRequest;return f.open(u,i,!0),c&&Object.keys(c).forEach(n=>{c.hasOwnProperty(n)&&f.setRequestHeader(n,c[n])}),new Promise((n,e)=>{f.onreadystatechange=()=>{f.readyState===4&&(f.status>=200&&f.status<300?n(f.responseText):e(new Error(`Ingest ${u} ${i} responded ${f.status}
${f.responseText}`)))},f.send(l)})})}function Ma(u){const i=Date.now();for(const l of u)l.properties.batch_time_millis=i;var c;return{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`data=${c=JSON.stringify(u),btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(l,f)=>String.fromCharCode(+`0x${f}`)))}`}}class wn{send(i,c=!1){return eo(this,void 0,void 0,function*(){const{currentEndpoint:l}=Hr,{headers:f,body:n}=Ma(i),e="eventSenderResult",t=i.length;if(c){const o=navigator.sendBeacon(l,n);Hr.trackEvent({type:e,success:o,count:t})}else yi(()=>eo(this,void 0,void 0,function*(){yield Bi("POST",l,f,n),Hr.trackEvent({type:e,success:!0,count:t})}),()=>{Hr.trackEvent({type:e,success:!1,count:t})})})}}class It{constructor(){this.emitter=new Qn}hasListenersFor(i){return this.emitter.listenerCount(i)>0}on(i,c,l){c.call=function(f,n){return function(e,...t){try{n.apply(e,t)}catch(o){let s=`Error in callback for ${f}`;const h=n.name;return h&&(s+=` for function ${h}`),void console.error(`${s}
`,o)}}}(i,c),this.emitter.on(i,c,l)}off(i,c,l){this.emitter.off(i,c,l)}emit(i,...c){this.emitter.emit(i,...c)}removeAllListeners(){this.emitter.removeAllListeners()}}const to="https://broadcast.stats.live-video.net/";class il{constructor({totalEvents:i,totalEventsLost:c,windowedEvents:l,windowedEventsLost:f,currentEndpoint:n}){this.transformProperties=(t,o,s,h,y)=>({total_events:t,total_events_lost:o,windowed_events:s,windowed_events_lost:h,current_endpoint:y??to});const e=this.transformProperties(i,c,l,f,n);this.data={event:et.ANALYTICS_HEALTH_REPORT,properties:Object.assign({},e)}}}const ol={totalEvents:0,totalEventsSent:0,totalEventsLost:0,windowedEvents:0,windowedEventsSent:0,windowedEventsLost:0};var vs,Zn;(function(u){u.ANALYTICS_EVENT="ANALYTICS_EVENT"})(vs||(vs={}));class yc extends It{constructor(){super(),this.eventSenderMetrics=Object.assign({},ol),this.scheduleHealthReport=()=>{this.reportTimer=window.setTimeout(this.onHealthReportInterval,6e4)},this.onHealthReportInterval=()=>{const i=Object.assign({},this.eventSenderMetrics);if(this.eventSenderMetrics.windowedEvents===0?this.emptyWindows++:this.emptyWindows=0,this.emptyWindows>3)return window.clearTimeout(this.reportTimer),void(this.reportTimer=void 0);this.postHealthReport(i),this.eventSenderMetrics.windowedEvents=0,this.eventSenderMetrics.windowedEventsSent=0,this.eventSenderMetrics.windowedEventsLost=0,this.scheduleHealthReport()},this.emptyWindows=0}trackEventSendResult(i){const{count:c,success:l}=i;this.eventSenderMetrics.totalEvents+=c,this.eventSenderMetrics.windowedEvents+=c,l?(this.eventSenderMetrics.totalEventsSent+=c,this.eventSenderMetrics.windowedEventsSent+=c):(this.eventSenderMetrics.totalEventsLost+=c,this.eventSenderMetrics.windowedEventsLost+=c),this.isHealthReportScheduled()||this.scheduleHealthReport()}isHealthReportScheduled(){return typeof this.reportTimer=="number"}postHealthReport(i){const c=new il(i);this.emit(vs.ANALYTICS_EVENT,c)}}(function(u){u[u.EXCELLENT=4]="EXCELLENT",u[u.GOOD=3]="GOOD",u[u.NORMAL=2]="NORMAL",u[u.POOR=1]="POOR",u[u.DOWN=0]="DOWN"})(Zn||(Zn={}));var no;(function(u){u.NETWORK_QUALITY_CHANGE="networkQualityChange"})(no||(no={}));class ys extends It{constructor(){super(),this.lastNetworkStatus={},this.networkAssessment={networkQuality:Zn.NORMAL,reason:"no-data"},this.checkNetworkStatus=()=>{var i,c;const l=(i=navigator==null?void 0:navigator.connection)!==null&&i!==void 0?i:{},f={downlink:l.downlink,effectiveType:l.effectiveType,rtt:l.rtt,isOnline:(c=navigator.onLine)===null||c===void 0||c};if(!this.isChangedNetworkStatus(this.lastNetworkStatus,f))return;this.lastNetworkStatus=f;const n=this.networkAssessment,e=function(t){const{rtt:o,downlink:s,isOnline:h}=t;if(!h)return{networkQuality:Zn.DOWN,reason:"offline"};if(typeof o!="number"||typeof s!="number")return{networkQuality:Zn.NORMAL,reason:"no-data"};let y=0;o>800?y+=2:o>300&&(y+=1),s<2.5?y+=2:s<5&&(y+=1);const T="score";switch(y){case 4:return{networkQuality:Zn.POOR,reason:T};case 0:return{networkQuality:Zn.EXCELLENT,reason:T};default:return{networkQuality:y<=2?Zn.GOOD:Zn.NORMAL,reason:T}}}(f);n.networkQuality!==e.networkQuality&&this.emit(no.NETWORK_QUALITY_CHANGE,n.networkQuality,e.networkQuality),this.networkAssessment=e},this.getNetworkQuality=()=>this.networkAssessment.networkQuality,this.setupWindowListeners(),this.checkNetworkStatus()}setupWindowListeners(){window.addEventListener("online",()=>{this.checkNetworkStatus()}),window.addEventListener("offline",()=>{this.checkNetworkStatus()}),window.navigator.connection&&window.navigator.connection.addEventListener("change",()=>{this.checkNetworkStatus()})}isChangedNetworkStatus(i,c){const{downlink:l,effectiveType:f,rtt:n,isOnline:e}=c;return i.effectiveType!==f||i.downlink!==l||i.rtt!==n||i.isOnline!==e}}var Jl=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class al{constructor(){this.globalSessionId=vi(),this.currentGlobalEndpoint=to,this.healthReporter=new yc,this.networkMonitor=new ys,this.healthReporter.on(vs.ANALYTICS_EVENT,l=>{this.trackGlobalEvent(l)});const i=au.getParser(navigator.userAgent),c=function(l){const f=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(l)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(l)||/^(\d+)$/.exec(l)||[];return{major:parseInt(f[1],10)||0,minor:parseInt(f[2],10)||0,patch:parseInt(f[3],10)||0}}(String(i.getBrowserVersion()));this.globalProperties={browser:navigator.appVersion,browser_family:i.getBrowserName().toLowerCase(),browser_version:`${c.major}.${c.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:i.getOSName(),os_version:String(i.getOSVersion()),platform:"web",global_session_id:this.getGlobalSessionId(),sdk_version:"1.28.0",user_agent:navigator.userAgent,is_backgrounded:(document==null?void 0:document.visibilityState)==="hidden"}}trackGlobalEvent(i){const c=this.getGlobalProperties();i.data.properties=Object.assign(Object.assign(Object.assign({},c),i.data.properties),{current_endpoint:this.currentEndpoint});const{headers:l,body:f}=Ma([i.data]);yi(()=>Jl(this,void 0,void 0,function*(){yield Bi("POST",this.currentEndpoint,l,f)}))}updateGlobalProperties(){this.globalProperties=Object.assign(Object.assign({},this.globalProperties),{is_backgrounded:(document==null?void 0:document.visibilityState)==="hidden"})}getGlobalSessionId(){return this.globalSessionId}getGlobalProperties(){return this.updateGlobalProperties(),this.globalProperties}set currentEndpoint(i){this.currentGlobalEndpoint=i}get currentEndpoint(){var i;return!((i=window.IVS_CLIENT_OVERRIDES)===null||i===void 0)&&i.analyticsPostUrl?window.IVS_CLIENT_OVERRIDES.analyticsPostUrl:this.currentGlobalEndpoint}trackEvent(i){i.type==="eventSenderResult"&&this.healthReporter.trackEventSendResult(i)}getNetworkQuality(){return this.networkMonitor.getNetworkQuality()}}window.IVS_CLIENT_GLOBAL_STATE||(window.IVS_CLIENT_GLOBAL_STATE={}),window.IVS_CLIENT_GLOBAL_STATE.session||(window.IVS_CLIENT_GLOBAL_STATE.session=new al);const Hr=window.IVS_CLIENT_GLOBAL_STATE.session;function bs(u){if(!u)throw new Error("eventSender is not defined")}class bc{constructor(){this.sharedProperties={},this.eventSender={},this.queuedEvents=[],this.genSessionId();const i=function(){const c=fr("appLabel");if(c!==void 0)return c.substring(0,64)}();this.eventSender=new wn,this.initSharedProperties({appLabel:i}),this.errorReports=new Map}start(){this.flushInterval||(this.flushInterval=window.setInterval(()=>{this.queueAggregateErrors({force:!1}),this.flushEvents()},1e3))}stop(i){let c=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,this.queueAggregateErrors({force:!0}),i&&(this.queuedEvents=this.queuedEvents.filter(l=>l.critical),c=!0),this.flushEvents(c),this.genSessionId()}trackEvent(i,c=!1){let l=this.sharedProperties;c&&(l={global_session_id:this.sharedProperties.global_session_id,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version,is_backgrounded:this.sharedProperties.is_backgrounded}),(document==null?void 0:document.visibilityState)==="hidden"&&(l.is_backgrounded=!0),"data"in i?(i.data.properties=Object.assign({},l,i.data.properties),this.queuedEvents.push(i.data)):(i.properties=Object.assign({},l,i.properties),this.queuedEvents.push(i))}trackEventNoSharedProps(i){this.trackEvent(i,!0)}trackErrorAndThrow(i){throw this.trackError(i),i}trackError(i){const c=`${i.code}${i.fatal}${i.nominal}${i.tag}${i.traceId.value}`,l=this.errorReports.get(c),f={error:i,queuedAt:Date.now(),count:0};return l?(l.count===0&&(l.error=i),l.count+=1,l.queuedAt+6e4<=Date.now()?(this.trackErrorReportIfNeeded(l),void this.errorReports.set(c,f)):void 0):(this.errorReports.set(c,f),void this.trackEvent(new ia(i)))}queueAggregateErrors({force:i=!1}){this.errorReports.forEach((c,l)=>{const f=c.queuedAt+6e4;!i&&f>Date.now()||(this.trackErrorReportIfNeeded(c),this.errorReports.delete(l))})}trackErrorReportIfNeeded(i){if(i.count===0)return;const c=i.error;c.count=i.count,this.trackEvent(new ia(c))}batchEvents(i){bs(this.eventSender);const c=i.map(l=>(l.data.properties=Object.assign({},this.sharedProperties,l.data.properties),l.data));this.eventSender.send(c)}initSharedProperties({appLabel:i}){const c=Hr.getGlobalProperties();this.sharedProperties=Object.assign(Object.assign({},c),{session_id:this.sessionId}),i&&(this.sharedProperties.app_label=i)}genSessionId(){this.sessionId=vi(),this.sharedProperties.session_id=this.sessionId}flushEvents(i=!1){bs(this.eventSender),this.queuedEvents.length>0&&this.eventSender.send(this.queuedEvents,i),this.queuedEvents=[]}getSessionId(){return this.sessionId}}class su{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.CONGESTION_TIME,properties:l}}}class Sc{constructor(i,c,l){this.transformProperties=(n,e,t)=>({duration:(n.getTime()-((e==null?void 0:e.getTime())||0))/1e3,ecn_negotiated:!1,ingest_session_id:t});const f=this.transformProperties(i,c,l);this.data={event:Un.CONNECTION_ESTABLISHED,properties:f}}}class cu{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.CONNECTION_RTT,properties:l}}}class zr{constructor(i){this.transformProperties=l=>{var f;return{is_fatal:(f=l.isFatal)!==null&&f!==void 0&&f,value:l.value,code:l.code,description:l.description}};const c=this.transformProperties(i);this.data={event:Un.ERROR,properties:c}}}class Dr{constructor(i,c){this.transformProperties=(f,n)=>({type:f,input_device_id:n.deviceId,position:n.facingMode||"unknown"});const l=this.transformProperties(i,c);this.data={event:Un.INPUT_DEVICE_ATTACHED,properties:l}}}class oa{constructor(i,c){this.transformProperties=(f,n)=>({type:f,input_device_id:n.deviceId,position:n.facingMode||"unknown"});const l=this.transformProperties(i,c);this.data={event:Un.INPUT_DEVICE_DETACHED,properties:l}}}class Ss{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.MEASURED_BITRATE,properties:l}}}class sl{constructor(i,c){this.transformProperties=(f,n)=>({minutes_logged:Math.round((f.timestamp-n)/6e4)});const l=this.transformProperties(i,c);this.data={event:Un.MINUTE_BROADCAST,properties:l}}}class Xl{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.RECOMMENDED_BITRATE,properties:l}}}class ih{constructor(i){this.transformProperties=l=>({codec:l.mimeType,bitrate:0,sample_rate:l.clockRate,channel_count:l.channels});const c=this.transformProperties(i);this.data={event:Un.SESSION_AUDIO_ENCODER_CONFIGURED,properties:c}}}class oh{constructor(i){this.transformProperties=l=>({codec:"audio",bitrate:32e3,sample_rate:l.sampleRate,channel_count:l.channelCount});const c=this.transformProperties(i);this.data={event:Un.SESSION_AUDIO_PROPERTIES,properties:c}}}class Es{constructor(i,c,l){this.transformProperties=(n,e,t)=>({codec:t.mimeType,codec_profile:e.profile,codec_level:e.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:n.width,height:n.height,bframe_count:0,target_fps:n.frameRate});const f=this.transformProperties(i,c,l);this.data={event:Un.SESSION_VIDEO_ENCODER_CONFIGURED,properties:f}}}class aa{constructor(i){this.transformProperties=l=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:l.width,height:l.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:l.frameRate});const c=this.transformProperties(i);this.data={event:Un.SESSION_VIDEO_PROPERTIES,properties:c}}}class uu{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.SOURCE_AUDIO_LATENCY,properties:l}}}class Lo{constructor(i,c){this.transformProperties=(f,n)=>({sum:f.sum,median:f.median(),min:f.min,max:f.max,p90:f.percentile(.9),event_count:f.data.length,period:n});const l=this.transformProperties(i,c);this.data={event:Un.SOURCE_VIDEO_LATENCY,properties:l}}}class ji{constructor(i,c){this.transformProperties=({protocol:f,hostname:n,port:e},t)=>({protocol:f,endpoint_host:n,endpoint_port:e,reason:t});const l=this.transformProperties(i,c);this.data={event:Un.START_BROADCAST,properties:l}}}class lu{constructor(i){this.transformProperties=({protocol:l,hostname:f,port:n})=>({protocol:l,endpoint_host:f,endpoint_port:n});const c=this.transformProperties(i);this.data={event:Un.STOP_BROADCAST,properties:c}}}class ro{constructor(i){this.transformProperties=l=>({bytes_sent:l.bytesSent,header_bytes_sent:l.headerBytesSent,nack_count:l.nackCount,packets_sent:l.packetsSent,retransmitted_bytes_sent:l.retransmittedBytesSent,retransmitted_packets_sent:l.retransmittedPacketsSent});const c=this.transformProperties(i);this.data={event:Un.WEBRTC_AUDIO_STATS,properties:c}}}class zn{constructor(i){this.transformProperties=l=>({bytes_sent:l.bytesSent,fir_count:l.firCount,frames_encoded:l.framesEncoded,frames_sent:l.framesSent,header_bytes_sent:l.headerBytesSent,huge_frames_sent:l.hugeFramesSent,key_frames_encoded:l.keyFramesEncoded,nack_count:l.nackCount,packets_sent:l.packetsSent,pli_count:l.pliCount,quality_limitation_reason:l.qualityLimitationReason,quality_limitation_resolution_changes:l.qualityLimitationResolutionChanges,retransmitted_bytes_sent:l.retransmittedBytesSent,retransmitted_packets_sent:l.retransmittedPacketsSent,total_encode_time:l.totalEncodeTime,total_encoded_bytes_target:l.totalEncodedBytesTarget,total_packet_send_delay:l.totalPacketSendDelay});const c=this.transformProperties(i);this.data={event:Un.WEBRTC_VIDEO_STATS,properties:c}}}var Un,du;(function(u){u.START_BROADCAST="ivs_broadcast_start_broadcast",u.STOP_BROADCAST="ivs_broadcast_stop_broadcast",u.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",u.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",u.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",u.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",u.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",u.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",u.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",u.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",u.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",u.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",u.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",u.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",u.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",u.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",u.CONGESTION_TIME="ivs_broadcast_congestion_time",u.BUFFER_DURATION="ivs_broadcast_buffer_duration",u.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",u.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",u.CONNECTION_RTT="ivs_broadcast_connection_rtt",u.ERROR="ivs_broadcast_error"})(Un||(Un={})),function(u){u.USER_INITIATED="user-initiated",u.NETWORK_DISCONNECT="network-disconnect"}(du||(du={}));const Na={[Ve.INFO]:"#528bff",[Ve.WARN]:"#ffb31a",[Ve.DEBUG]:"#00f593",[Ve.ERROR]:"#ff4f4d",[Ve.TRACE]:"",[Ve.SILENT]:"",[Be.TIME]:"#53535f",[Be.WEBRTC]:"#0e9bd8",[Be.SUBSCRIPTION]:"#ffc400",[Be.CONNECTION]:"#ff5edb",[Be.SOCKET]:"#8585ff",[Be.EMITTER]:"#adadb8",[Be.LOCAL_PARTICIPANT]:"#1DD21D",[Be.STAGE]:"#EC9806",[Be.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},V=({label:u})=>`background: ${Na[u]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,ee=Object.entries(Ve),te=(u,i,c)=>{const l=V({label:u}),[f]=ee.find(([,M])=>M===Number(u))||[],n=`%c${f}`,e=V({label:i}),t=`%c${i}`,o=V({label:Be.TIME}),s=`%c[${new Date().toISOString()}]`,h=V({label:"details"}),y=`%c[${c}]`,T=[s,n,t],P=[o,l,e];return c&&(T.push(y),P.push(h)),[T.join(""),...P]},ge={debug(u){console.groupCollapsed(...te(Ve.DEBUG,u.scope,u.label)),console.debug(u.msg,Object.assign(Object.assign({},u),{level:"debug"})),console.groupEnd()},info(u){console.groupCollapsed(...te(Ve.INFO,u.scope,u.label)),console.info(u.msg,Object.assign(Object.assign({},u),{level:"info"})),console.groupEnd()},warn(u){console.groupCollapsed(...te(Ve.WARN,u.scope,u.label)),console.warn(u.msg,Object.assign(Object.assign({},u),{level:"warn"})),console.groupEnd()},error(u){console.groupCollapsed(...te(Ve.ERROR,u.scope,u.label)),console.error(u),console.groupEnd()}};var De=function(u,i){var c={};for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&i.indexOf(l)<0&&(c[l]=u[l]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var f=0;for(l=Object.getOwnPropertySymbols(u);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(u,l[f])&&(c[l[f]]=u[l[f]])}return c};Object.entries(Ve);class We{constructor(i=rh,c=ge){this.logLevel=i,this.loggerInstance=c}debug(i){var c,l;this.logLevel>Ve.DEBUG||(l=(c=this.loggerInstance).debug)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{level:"debug"}))))}info(i){var c,l;this.logLevel>Ve.INFO||(l=(c=this.loggerInstance).info)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{level:"info"}))))}warn(i){var c,l;this.logLevel>Ve.WARN||(l=(c=this.loggerInstance).warn)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{level:"warn"}))))}error(i){var c,l,{err:f}=i,n=De(i,["err"]);this.logLevel>Ve.ERROR||(l=(c=this.loggerInstance).error)===null||l===void 0||l.call(c,Object.assign({err:f},n))}}class mt{constructor(i,c){this.logger=i,this.scope=c}debug(i){var c,l;(l=(c=this.logger).debug)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{scope:this.scope}))))}info(i){var c,l;(l=(c=this.logger).info)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{scope:this.scope}))))}warn(i){var c,l;(l=(c=this.logger).warn)===null||l===void 0||l.call(c,JSON.parse(JSON.stringify(Object.assign(Object.assign({},i),{scope:this.scope}))))}error(i){var c,l,{err:f}=i,n=De(i,["err"]);(l=(c=this.logger).error)===null||l===void 0||l.call(c,Object.assign(Object.assign({err:f},n),{scope:this.scope}))}unwrap(){return this.logger}}class Mn{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(i){(this.min===0||i<this.min)&&(this.min=i),i>=this.max&&(this.max=i),this.data.push(i),this.sum+=i}median(){this.data.sort();const i=this.data.length>>1;return this.data.length%2==0?this.data[i-1]+this.data[i]>>1:this.data[i]}percentile(i){if(this.data.length===0)return 0;if(i<=0)return this.data[0];if(i>=1)return this.data[this.data.length-1];const c=(this.data.length-1)*i,l=Math.floor(c),f=l+1,n=c%1;return f>=this.data.length?this.data[l]:this.data[l]*(1-n)+this.data[f]*n}}var pt=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Ec{constructor(i,c,l,f){this.peerClient=i,this.broadcastCanvasManager=c,this.analyticsTracker=f,this.logger=new mt(l,Be.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval(()=>{this.collectSamples()},1e3),this.trackSamplesTimerId=window.setInterval(()=>{this.trackSamples()},3e4),this.trackPeerConnectionStatsTimerId=window.setInterval(()=>{this.trackPeerConnectionStats()},6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return pt(this,void 0,void 0,function*(){(yield this.peerClient.getReports()).forEach(i=>{if(i.type==="outbound-rtp")switch(i.kind){case"audio":this.analyticsTracker.trackEvent(new ro(i));break;case"video":{const c=new zn(i),l=new sl(i,this.startTimestamp);this.analyticsTracker.batchEvents([c,l]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:i.kind})}})})}collectSamples(){return pt(this,void 0,void 0,function*(){let i=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach(l=>{switch(l.type){case"candidate-pair":l.nominated&&(this.rttSamples.push(l.currentRoundTripTime),this.recommendedBitrateSamples.push(l.availableOutgoingBitrate));break;case"outbound-rtp":i+=l.bytesSent||0,this.startTimestamp===0&&l.kind==="video"&&(this.startTimestamp=l.timestamp)}});const c=8*Math.round(i-this.previousBytesSent);this.previousBytesSent=i,this.measuredBitrateSamples.push(c)})}trackSamples(){const c=new uu(this.audioLatencySamples,30),l=new Lo(this.videoLatencySamples,30),f=new su(this.congestionTimeSamples,30),n=new Ss(this.measuredBitrateSamples,30),e=new Xl(this.recommendedBitrateSamples,30),t=new cu(this.rttSamples,30);this.analyticsTracker.batchEvents([c,l,f,n,e,t]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new Mn,this.videoLatencySamples=new Mn,this.congestionTimeSamples=new Mn,this.measuredBitrateSamples=new Mn,this.recommendedBitrateSamples=new Mn,this.rttSamples=new Mn}}const ai={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},Kt="connectionStateChange",Bo="sdpNegotiated",sa="clientError",bi="seiMessageReceived",Ui="transformError";var Je;(function(u){u.CLOSED="closed",u.COMPLETED="completed",u.CONNECTED="connected",u.CONNECTING="connecting",u.DISCONNECTED="disconnected",u.FAILED="failed",u.IDLE="idle",u.NEW="new",u.NONE="none"})(Je||(Je={}));const rt=u=>{const i=n=>{var e;return!((e=n.deviceId)===null||e===void 0)&&e.startsWith("web-contents-media-stream")?"tab":void 0},c=n=>{var e;return!((e=n.deviceId)===null||e===void 0)&&e.startsWith("window")&&n.displaySurface==="window"?"window":void 0},l=n=>{var e;return!((e=n.deviceId)===null||e===void 0)&&e.startsWith("screen")&&n.displaySurface==="monitor"?"screen":void 0};return(i(f=u)||c(f)||l(f)?void 0:"camera")||l(u)||c(u)||i(u)||"unknown";var f};function cl(u,i){return u.find(c=>c.kind===i)}function _c(u){return(u==null?void 0:u.readyState)==="live"}var ht;(function(u){u.VIDEO="video",u.AUDIO="audio"})(ht||(ht={}));class ah{constructor(){this.mediaTracks=new Map([[ht.VIDEO,void 0],[ht.AUDIO,void 0]])}setTrack(i,c){this.mediaTracks.set(i,c)}getTrack(i){return this.mediaTracks.get(i)}}class sh{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(i){return i?(i.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map(c=>c.trim()).filter(Boolean).forEach(c=>{const l=c.split("=");if(l.length===2)switch(l[0]){case"level-asymmetry-allowed":l[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":l[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(l[1]),this.level=this.getLevelFromId(l[1])}}),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(i){const c=i.substr(0,2),l=i.substr(2,2);switch(c.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return l==="00"?"high 10":"high 10 intra";case"7a":return l==="00"?"high 42":"high 42 intra";case"f4":return l==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(i){return parseInt(i.substr(4,2),16)}}function ch(u){return btoa(JSON.stringify(u))}var er,Er=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};(function(u){u.IDLE="idle",u.EXECUTING="executing",u.RECONNECTING="reconnecting"})(er||(er={}));class ca{constructor(i,c=12e4,l,f){this.state=er.IDLE,this.failureCallback=()=>{},this.peerClient=i,this.timeout=c,this.logger=l,this.emitter=f}onFailure(i){this.failureCallback=i}setStartConfig(i,c){this.ingestEndpoint=i,this.streamKey=c}execute(){const{id:i}=this;this.state===er.IDLE&&(this.state=er.EXECUTING,this.emitter.emit(ai.CONNECTION_STATE_CHANGE,Je.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:i}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(i){this.timeoutTimerId=window.setTimeout(()=>{this.state!==er.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(ai.CONNECTION_STATE_CHANGE,Je.FAILED),this.failureCallback())},i)}stop(){this.state=er.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return Er(this,void 0,void 0,function*(){if(this.ingestEndpoint&&this.streamKey){const i=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),i===Je.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(c){throw this.logger.error({err:c}),c}}})}isActive(){return this.state!==er.IDLE}}class ul extends ca{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let i=5e3;const c=()=>Er(this,void 0,void 0,function*(){if(this.state===er.EXECUTING)try{this.state=er.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:i}),this.state=er.EXECUTING,this.currentTimeoutId=window.setTimeout(c,i),i*=2}});this.currentTimeoutId=window.setTimeout(c,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class La extends ca{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>Er(this,void 0,void 0,function*(){if(navigator.onLine&&this.state===er.EXECUTING){this.state=er.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=er.EXECUTING}}})}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class ll{static create(i,c=nl,l,f){const{reconnect:n,timeout:e}=c;if(n){const t=au.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(t)&&navigator.connection?new La(i,e,l,f):new ul(i,e,l,f)}}}var Cc,io=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})},dl=function(u,i,c,l){if(c==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?u!==i||!l:!i.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?l:c==="a"?l.call(u):l?l.value:i.get(u)};const jo=u=>!!u;function Mr(u){if(!u)throw new Error("PeerConnection is not defined")}const Ba={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class uh{constructor(i,c,l,f,n){this.config=i,this.emitter=c,this.mediaStreamManager=l,this.analyticsTracker=n,this.establishConnection=(e,t)=>io(this,void 0,void 0,function*(){var o,s,h;Mr(this.peerConnection);try{const y=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(y),yield this.sendSetupRequest(e,t,y)}catch(y){if(y instanceof Error){(o=(h=y).code)!==null&&o!==void 0||(h.code=at.code);const T=new Ke(Object.assign(Object.assign({},at),{name:y.name,message:y.message,code:y==null?void 0:y.code,cause:y}));throw!((s=this.reconnectStrategy)===null||s===void 0)&&s.isActive()||this.handleError(y.code,y.message),this.stop(),T}}}),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var e;if(!this.peerConnection)return Je.NONE;const t=(e=this.reconnectStrategy)===null||e===void 0?void 0:e.isActive(),o=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(o){case"new":return Je.NEW;case"closed":return Je.CLOSED;case"disconnected":return t?Je.CONNECTING:Je.DISCONNECTED;case"failed":return t?Je.CONNECTING:Je.FAILED;case"idle":return Je.IDLE;case"checking":case"connecting":return Je.CONNECTING;case"completed":case"connected":return Je.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:o}),Je.IDLE}},this.onConnectionStateChange=()=>{var e;const t=this.getConnectionState();switch(t){case Je.CONNECTED:{this.emitter.emit(ai.CONNECTION_STATE_CHANGE,t);const o=new Date;this.analyticsTracker.trackEvent(new Sc(o,this.connectionStartDate,this.ingestSessionId));const s=this.mediaStreamManager.getTrack(ht.AUDIO),h=this.mediaStreamManager.getTrack(ht.VIDEO);if(h){const y=h.getSettings();this.analyticsTracker.trackEvent(new aa(y))}if(s){const y=s.getSettings();this.analyticsTracker.trackEvent(new oh(y))}(((e=this.peerConnection)===null||e===void 0?void 0:e.getSenders())||[]).forEach(y=>{var T;(((T=y.getParameters())===null||T===void 0?void 0:T.codecs)||[]).forEach(P=>{var M;switch((M=y.track)===null||M===void 0?void 0:M.kind){case"video":{if(!h)break;const L=new sh().extractVideoSdpFmtpLine(P.sdpFmtpLine),B=h.getSettings();this.analyticsTracker.trackEvent(new Es(B,L,P));break}case"audio":if(!s)break;this.analyticsTracker.trackEvent(new ih(P))}})});break}case Je.CONNECTING:this.emitter.emit(ai.CONNECTION_STATE_CHANGE,t),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case Je.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(ai.CONNECTION_STATE_CHANGE,t),this.handleTerminalConnectionFailure());break;case Je.DISCONNECTED:this.emitter.emit(ai.CONNECTION_STATE_CHANGE,t),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(ai.CONNECTION_STATE_CHANGE,t)}},this.handleLocalDescription=e=>io(this,void 0,void 0,function*(){var t;return(t=this.peerConnection)===null||t===void 0?void 0:t.setLocalDescription(e)}),Cc.set(this,e=>{if(typeof e!="string")throw new Ke(us);try{new URL(e)}catch{throw new Ke(ls)}}),this.logger=new mt(f,Be.WEBRTC),this.createReconnectStrategy(i)}start(i,c){var l;return io(this,void 0,void 0,function*(){dl(this,Cc,"f").call(this,i);const f=[this.mediaStreamManager.getTrack(ht.VIDEO),this.mediaStreamManager.getTrack(ht.AUDIO)].filter(jo);if(this.createPeerConnection(),this.addTracks({tracks:f}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(i,c),yield this.establishConnection(i,c),!((l=this.reconnectStrategy)===null||l===void 0)&&l.isActive()){const n=new URL(i);this.analyticsTracker.trackEvent(new ji({protocol:"webrtc",hostname:n.hostname,port:n.port},du.NETWORK_DISCONNECT))}})}stop(){var i,c,l,f;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[Je.NEW,Je.CONNECTING,Je.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(ai.CONNECTION_STATE_CHANGE,Je.CLOSED),(i=this.peerConnection)===null||i===void 0||i.close(),(c=this.peerConnection)===null||c===void 0||c.removeEventListener("connectionstatechange",this.onConnectionStateChange),(l=this.peerConnection)===null||l===void 0||l.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(f=this.reconnectStrategy)===null||f===void 0||f.stop()}addTracks(i){var c;if(Mr(this.peerConnection),!i)return;const l=this.peerConnection.getSenders().map(n=>{var e;return(e=n.track)===null||e===void 0?void 0:e.id}),f=i.tracks.filter(n=>!l.includes(n.id));for(const n of f)(c=this.peerConnection)===null||c===void 0||c.addTrack(n)}getReports(){var i;return io(this,void 0,void 0,function*(){try{const c=(yield(i=this.peerConnection)===null||i===void 0?void 0:i.getStats())||[],l=[];return c.forEach(f=>{l.push(f)}),l}catch{return[]}})}sendSetupRequest(i,c,l){var f;return io(this,void 0,void 0,function*(){const n=yield fetch(`${i}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:ch(l),streamKey:c},this.config.streamConfig))});if(!n.ok)throw function(t){let o=new Ke(Object.assign({},at));return(t==null?void 0:t.code)===1007&&(o=new Ke(Object.assign({},dn))),t!=null&&t.message&&(o.message=t.message),o}(yield n.json());const e=yield n.json();e!=null&&e.answer&&(yield(f=this.peerConnection)===null||f===void 0?void 0:f.setRemoteDescription(function(t){return JSON.parse(atob(t))}(e.answer)),this.ingestSessionId=e.ingestSessionId)})}handleTerminalConnectionFailure(){const i=new Ke(jt);this.handleError(i.code,i.message)}handleError(i,c){this.analyticsTracker.trackEvent(new zr({code:i,description:c,isFatal:!0})),this.emitter.emit(ai.ERROR,{code:i,message:c})}createPeerConnection(){var i;const c=this.getConnectionState(),l=c!==Je.NONE,f=c!==Je.CLOSED,n=(i=this.reconnectStrategy)===null||i===void 0?void 0:i.isActive();l&&f&&!n||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval(()=>{const e=this.getConnectionState();if(this.reconnectStrategy&&e===Je.DISCONNECTED&&this.disconnectionStartDate){const t=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:t}),t>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else e===Je.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)},1e3),this.peerConnection=new RTCPeerConnection(Ba),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(i){if(this.reconnectStrategy=ll.create(this,i.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const c=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:c})}}}Cc=new WeakMap;var _s,Ql,ja=g(5364);(function(u){u.CONFIG="config",u.UPDATE="update",u.START="start",u.STOP="stop"})(_s||(_s={})),function(u){u.VIDEO_SEND="video/send",u.VIDEO_RECEIVE="video/receive",u.INSERT_SEI="insertSei"}(Ql||(Ql={}));var Ua=g(5512),Cs=g.n(Ua);function lh(){return Cs()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var i,t;!function(i){i.CONFIG="config",i.UPDATE="update",i.START="start",i.STOP="stop"}(i||(i={})),function(i){i.VIDEO_SEND="video/send",i.VIDEO_RECEIVE="video/receive",i.INSERT_SEI="insertSei"}(t||(t={}));const s=self;const n=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(i){this.config=Object.assign(Object.assign({},this.config),i),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{s.postMessage({type:i.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};s.addEventListener("message",(function(t){var s;if(null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.type)switch(t.data.type){case i.CONFIG:n.setConfig(t.data.payload||{});break;case i.START:n.start();break;case i.STOP:n.stop()}}))})();`,"Worker",void 0,void 0)}var Fa=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class dh{constructor(i,c,l){this.config=i,this.mediaStreamManager=c,this.analyticsTracker=l,this.handleWorkerEvent=t=>{var o;((o=t.data)===null||o===void 0?void 0:o.type)===_s.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new lh,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const f=this.compositeEl.getContext("2d");if(f===null)throw new Ke(Object.assign({},Pr));this.compositeContext=f,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const n=cl(this.compositeStream.getTracks(),ht.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const e=cl(this.audioDestination.stream.getTracks(),ht.AUDIO);n&&this.mediaStreamManager.setTrack(ht.VIDEO,n),e&&this.mediaStreamManager.setTrack(ht.AUDIO,e),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:_s.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(i){this.previewElement=i;const{width:c,height:l}=this.config.streamConfig.maxResolution;this.previewElement.width=c,this.previewElement.height=l,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const i=this.audioContext.createConstantSource(),c=this.audioContext.createGain();c.gain.value=.001,i.connect(c),c.connect(this.audioDestination),i.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const i=document.body,c=["touchstart","touchend","mousedown","keydown"],l=()=>{c.forEach(n=>{i.removeEventListener(n,f)})},f=()=>{this.audioContext.resume().then(l)};c.forEach(n=>{i.addEventListener(n,f,!1)})}getTracks(){return[this.mediaStreamManager.getTrack(ht.VIDEO),this.mediaStreamManager.getTrack(ht.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(ht.VIDEO)}getAudioInputDevice(i){if(typeof i!="string")return;const c=this.mixer.audio.find(l=>{if(l.name===i)return l.source});return c==null?void 0:c.source}getVideoInputDevice(i){if(typeof i=="string")return this.mixer.video.find(c=>c.name===i)}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(i,c,l){var f;return Fa(this,void 0,void 0,function*(){if(typeof i!="object")throw new Ke(Object.assign({},Mi));if(!c||typeof c!="string")throw new Ke(Object.assign({},fe));if(this.mixer.video.some(T=>T.name===c))throw new Ke(Object.assign({},mi));if(!l)throw new Ke(Object.assign({},Zi));if(typeof l.index!="number")throw new Ke(Object.assign({},oe));const n=function(){const T=document.createElement("video");return T.autoplay=!0,T.muted=!0,T.setAttribute("playsinline",""),T.setAttribute("webkit-playsinline",""),T}(),e=i.getVideoTracks(),[t]=e;if(!e.length)throw new Ke(Object.assign({},xr));const o=t.getConstraints(),s=ja({},o,{frameRate:this.config.streamConfig.maxFramerate});try{yield t.applyConstraints(s)}catch(T){let P="Unknown constraints error";T instanceof Error&&(P=T.message),this.analyticsTracker.trackEvent(new zr({description:`${xe.message}: ${P}`,isFatal:!1,code:xe.code}))}const h=()=>Fa(this,void 0,void 0,function*(){let T=0;for(;T<5;)try{return void(yield n.play())}catch(P){if(!(P instanceof Error))throw new Error("unknown error trying to add video to broadcast");T++,yield new Promise(M=>setTimeout(M,150))}throw new Error("Error playing video, tries exceeded")}),y=new MediaStream([t]);n.srcObject=y;try{yield h();const T={name:c,element:n,position:l,source:y,render:!0},P=((f=t.getSettings)===null||f===void 0?void 0:f.call(t))||{};this.analyticsTracker.trackEvent(new Dr(rt(P),P)),this.mixer.video.push(T)}catch(T){throw new Ke(Object.assign(Object.assign({},xr),{cause:T}))}})}addImageSource(i,c,l){var f;return Fa(this,void 0,void 0,function*(){if(!i)throw new Ke(Object.assign({},Mi));if(!c||typeof c!="string")throw new Ke(Object.assign({},fe));if(i.tagName==="image")throw new Ke(Object.assign({},Ce));if(this.mixer.video.some(e=>e.name===c))throw new Ke(Object.assign({},mi));if(!l)throw new Ke(Object.assign({},Zi));if(typeof l.index!="number")throw new Ke(Object.assign({},oe));if(i instanceof Image){const e=(f=i.src)===null||f===void 0?void 0:f.slice();try{const t=i.src?new URL(i.src):{};if(t.host&&t.hostname){const o=yield fetch(i.src).then(h=>Fa(this,void 0,void 0,function*(){return h.blob()})),s=yield new Promise(h=>{const y=new FileReader;y.onload=()=>{h(y.result)},y.readAsDataURL(o)});i.src=s}}catch{throw new Ke(Object.assign(Object.assign({},Ze),{params:{details:`Image URL: ${e}`}}))}}const n={name:c,element:i,position:l,render:!0};this.mixer.video.push(n)})}addAudioInputDevice(i,c){return Fa(this,void 0,void 0,function*(){if(typeof i!="object")throw new Ke(Object.assign({},Mi));if(!c||typeof c!="string")throw new Ke(Object.assign({},fe));if(this.mixer.audio.some(t=>t.name===c))throw new Ke(Object.assign({},mi));const l=i.getAudioTracks();if(!l.length)throw new Ke(Object.assign({},Mo));const f=this.audioContext.createMediaStreamSource(new MediaStream(l)),n=this.audioContext.createGain();n.gain.value=1,f.connect(n),n.connect(this.audioDestination);const e={name:c,source:i,audioTrackSource:f,gainNode:n};this.analyticsTracker.trackEvent(new Dr("audio",{deviceId:i.id})),this.mixer.audio.push(e)})}removeImage(i){const c=this.mixer.video.findIndex(l=>l.name===i);if(c<0)throw new Ke(Object.assign({},vn));this.mixer.video.splice(c,1)}removeVideoInputDevice(i){var c;const l=this.removeDevice(i,this.mixer.video);if(!l)throw new Ke(Object.assign({},dt));{const f=cl(l.source.getTracks(),ht.VIDEO);if(!f)throw new Ke(Object.assign({},dt));l.element.srcObject=null,f.stop();const n=((c=f==null?void 0:f.getSettings)===null||c===void 0?void 0:c.call(f))||{};this.analyticsTracker.trackEvent(new oa(rt(n),n))}}removeAudioInputDevice(i){const c=this.removeDevice(i,this.mixer.audio);if(c!=null&&c.audioTrackSource){for(const l of c.source.getTracks())l.stop(),this.analyticsTracker.trackEvent(new oa("audio",{deviceId:l.id}));c.gainNode.disconnect(this.audioDestination)}else if(!c)throw new Ke(Object.assign({},dt))}updateVideoDeviceComposition(i,c){if(!i||typeof i!="string")throw new Ke(Object.assign({},Ye));if(!c)throw new Ke(Object.assign({},bt));if(typeof c.index!="number")throw new Ke(Object.assign({},nt));this.mixer.video.forEach((l,f)=>{l.name===i&&(l.position=c)})}exchangeVideoDevicePositions(i,c){const l=this.getVideoInputDevice(i),f=this.getVideoInputDevice(c);if(!l)throw new Ke(Object.assign(Object.assign({},je),{params:{details:`device with name: "${i}" not found`}}));if(!f)throw new Ke(Object.assign(Object.assign({},je),{params:{details:`device with name: "${c}" not found`}}));const n=Object.assign({},l.position),e=Object.assign({},f.position);for(const t of this.mixer.video)t.name===i&&(Zl(e.x)?t.position=Object.assign(Object.assign({},t.position),e):t.position={index:e.index}),t.name===c&&(Zl(n.x)?t.position=Object.assign(Object.assign({},t.position),n):t.position={index:n.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:_s.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:_s.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var i;return((i=this.mediaStreamManager.getTrack(ht.VIDEO))===null||i===void 0?void 0:i.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach(i=>{i.render=!1})}enableVideo(){this.mixer.video.forEach(i=>{i.render=!0})}disableAudio(){this.mixer.audio.forEach(i=>{i.audioTrackSource&&(i.gainNode.gain.value=0)})}enableAudio(){this.mixer.audio.forEach(i=>{i.audioTrackSource&&(i.gainNode.gain.value=1)})}getDrawRegion(i,c,l){var f,n,e,t;let o=(f=i.position.x)!==null&&f!==void 0?f:0,s=(n=i.position.y)!==null&&n!==void 0?n:0;const h=(e=i.position.width)!==null&&e!==void 0?e:c-o,y=(t=i.position.height)!==null&&t!==void 0?t:l-s,T=h/y;let P=i.element.width,M=i.element.height;i.element instanceof HTMLVideoElement&&(P=i.element.videoWidth,M=i.element.videoHeight);const L=P/M;let B=h,U=y;return L>T?(B=h,U=2*Math.round(h/L/2),s+=(y-U)/2):L<T&&(U=y,B=2*Math.round(y*L/2),o+=(h-B)/2),{x:o,y:s,width:B,height:U}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const i=this.mixer.video.filter(c=>c.render);i.sort((c,l)=>c.position.index-l.position.index);for(const c of i){const{x:l,y:f,width:n,height:e}=this.getDrawRegion(c,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(c.element,l,f,n,e)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(ht.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(i,c){const l=c.findIndex(f=>(n=>n.name===i)(f));if(!(l<0))return c.splice(l,1)[0]}shouldMix(i){if(i.getTime()<this.nextMix)return!1;for(;this.nextMix<=i.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function Zl(u){return Number.isSafeInteger(u)}var Nt,Yt,hu=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})},hh=function(u,i,c,l){if(c==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?u!==i||!l:!i.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?l:c==="a"?l.call(u):l?l.value:i.get(u)};class Tc{constructor(i){this.config=i,Nt.add(this),this.emitter=new Qn,this.isValid=!0,this.emitter.on(ai.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new bc,this.mediaStreamManager=new ah;const c=new We(i.logLevel,i.logger);this.peerClient=new uh(this.config,this.emitter,this.mediaStreamManager,c,this.analyticsTracker),this.broadcastCanvasManager=new dh(i,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new Ec(this.peerClient,this.broadcastCanvasManager,c,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(Tc.prototype).forEach(l=>{this[l]=new Proxy(this[l],{apply:(f,n,e)=>{if(!n.isValid)throw new Ke(Object.assign({},hc));return Reflect.apply(f,n,e)}})}),window.addEventListener("beforeunload",()=>{this.analyticsTracker.stop(!0)})}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(i,c){return hu(this,void 0,void 0,function*(){hh(this,Nt,"m",Yt).call(this,i);const l=rl(c||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(l,i),this.emitter.emit(ai.ACTIVE_STATE_CHANGE,!0),this.url=new URL(l),this.url&&this.analyticsTracker.trackEvent(new ji({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},du.USER_INITIATED))})}stopBroadcast(){var i,c,l;this.url&&this.analyticsTracker.trackEvent(new lu({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(i=this.peerStatsTracker)===null||i===void 0||i.stop(),(c=this.peerClient)===null||c===void 0||c.stop(),(l=this.emitter)===null||l===void 0||l.emit(ai.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(i,c,l){return hu(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addVideoInputDevice(i,c,l)})}addImageSource(i,c,l){return hu(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addImageSource(i,c,l)})}addAudioInputDevice(i,c){return hu(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addAudioInputDevice(i,c)})}removeVideoInputDevice(i){this.broadcastCanvasManager.removeVideoInputDevice(i)}removeAudioInputDevice(i){this.broadcastCanvasManager.removeAudioInputDevice(i)}removeImage(i){this.broadcastCanvasManager.removeImage(i)}updateVideoDeviceComposition(i,c){this.broadcastCanvasManager.updateVideoDeviceComposition(i,c)}exchangeVideoDevicePositions(i,c){this.broadcastCanvasManager.exchangeVideoDevicePositions(i,c)}getAudioInputDevice(i){return this.broadcastCanvasManager.getAudioInputDevice(i)}getVideoInputDevice(i){return this.broadcastCanvasManager.getVideoInputDevice(i)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(i,c){this.emitter.on(i,c)}off(i,c){this.emitter.off(i,c)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(i){this.broadcastCanvasManager.attachPreview(i)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function ed(u){return new Tc(function(i){const c=new Yl;return c.streamConfig=i.streamConfig,c.ingestEndpoint=i.ingestEndpoint,c.logger=i.logger,c.logLevel=i.logLevel,c.networkReconnectConfig=i.networkReconnectConfig,c}(u))}Nt=new WeakSet,Yt=function(u){if(typeof u!="string"||!/^[a-zA-Z0-9_-]+$/.test(u))throw new Ke(No)};const Ts="1.28.0";var Oe,Sn=g(2543);(function(u){u.PUBLISH="publish",u.SUBSCRIBE="subscribe",u.JOIN="join",u.LEAVE="leave"})(Oe||(Oe={}));const oo=2,Uo="X-Stages-Options",Fo="cap";class $a extends Et{constructor(i){super(et.LEAVE,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.LEAVE,event_endpoint:i.eventEndpoint,whip_endpoint:i.whipEndpoint,reason:i.reason}),this.critical=!0}}function Fi(u){const i="0123456789abcdef";let c="";for(let l=0;l<u;l+=1)c+=i.charAt(Math.floor(16*Math.random()));return c}class fh{constructor(){const i=Fi;this.value=`${i(8)}-${i(4)}-${i(4)}-${i(4)}-${i(12)}`}}function Va(){return new fh}class td{constructor(){const i=(Date.now()/1e3|0).toString(16);this.value=`1-${i}-${Fi(24)}`}}function Nr(){return new td}var nd,Lr,bo,ua=g(2505),k=g.n(ua);(function(u){u.MESSAGE="message",u.RESPONSE="response"})(nd||(nd={})),function(u){u.STAGE_DELETED="STAGE_DELETED",u.PARTICIPANT_DISCONNECTED="PARTICIPANT_DISCONNECTED",u.TOKEN_INVALID="TOKEN_INVALID",u.TOKEN_EXPIRED="TOKEN_EXPIRED",u.TOKEN_INVALID_SIGNATURE="TOKEN_INVALID_SIGNATURE",u.TOKEN_MISSING="TOKEN_MISSING",u.INTERNAL="INTERNAL",u.BAD_REQUEST="BAD_REQUEST"}(Lr||(Lr={})),function(u){u[u.BAD_REQUEST=400]="BAD_REQUEST",u[u.UNAUTHORIZED=401]="UNAUTHORIZED",u[u.FORBIDDEN=403]="FORBIDDEN",u[u.NOT_FOUND=404]="NOT_FOUND",u[u.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"}(bo||(bo={}));class ct extends Ke{constructor({token:i,traceId:c,code:l,tag:f,location:n,message:e,details:t,remoteParticipantId:o,requestUUID:s,fatal:h,nominal:y,action:T,count:P=1}){super({name:"StageClientError",message:e,code:l}),Error.captureStackTrace&&Error.captureStackTrace(this,ct),this.action=T,this.token=i,this.traceId=c,this.code=l,this.tag=f,this.location=n,this.message=e,this.details=t,this.remoteParticipantId=o,this.requestUUID=s,this.fatal=h,this.nominal=y,this.count=P}}const ao="signalling_session",In="webrtc_sink",Fe="webrtc_unsink",qr="webrtc_source";function Zt(u,i){switch(u){case Oe.PUBLISH:return In;case Oe.SUBSCRIBE:return`webrtc_source:${i}`;default:return"unknown"}}function Fn(u,i){var c,l,f,n;const e={code:u.code,message:`${u.message}: ${i.name} ${i.message}`,fatal:(c=u.fatal)!==null&&c!==void 0&&c,nominal:(l=u.nominal)!==null&&l!==void 0&&l};return i instanceof ct&&(e.fatal=(f=i.fatal)!==null&&f!==void 0&&f,e.nominal=(n=i.nominal)!==null&&n!==void 0&&n),e}function si(u,i){if(u===0)return _e.UNKNOWN_SERVER_ERROR;if(!(u<400))if(u>=400&&u<=403)switch(i){case Jt.TokenExpired:return _e.EXPIRED_TOKEN;case Jt.NoPermissions:return _e.TOKEN_PERMISSIONS_DENIED;case Jt.StageAtCapacity:return _e.STAGE_AT_CAPACITY;case Jt.NoMatchingCodec:return _e.NO_MATCHING_CODEC;default:return _e.UNKNOWN_SERVER_ERROR}else{if(u===404)return i===Jt.RemoteStreamNotFound?_e.REMOTE_STREAM_NOT_FOUND:_e.UNKNOWN_SERVER_ERROR;if(u===412)return i===Jt.AbortedMHCPError?_e.MHCP_ABORTED:_e.UNKNOWN_SERVER_ERROR;if(u===429)return i===Jt.StageAuthThrottled?_e.STAGE_AUTH_THROTTLED:_e.WHIP_TOO_MANY_REQUESTS;if(u!==500)return _e.UNKNOWN_SERVER_ERROR;switch(i){case Jt.InternalMHCPError:return _e.INTERNAL_MHCP_ERROR;case Jt.UnreachableMHCP:return _e.UNREACHABLE_MHCP;case Jt.InvalidSessionStatus:return _e.INVALID_SESSION_STATUS;default:return _e.INTERNAL_SERVER_ERROR}}}var Jt;(function(u){u[u.Unspecified=2001]="Unspecified",u[u.TokenExpired=2002]="TokenExpired",u[u.NoPermissions=2003]="NoPermissions",u[u.RemoteStreamNotFound=2004]="RemoteStreamNotFound",u[u.StageAtCapacity=2005]="StageAtCapacity",u[u.InternalMHCPError=2006]="InternalMHCPError",u[u.UncategorizedMHCPError=2007]="UncategorizedMHCPError",u[u.UnreachableMHCP=2008]="UnreachableMHCP",u[u.InvalidSessionStatus=2010]="InvalidSessionStatus",u[u.PostWithoutOptions=2011]="PostWithoutOptions",u[u.AbortedMHCPError=2012]="AbortedMHCPError",u[u.StageAuthThrottled=2013]="StageAuthThrottled",u[u.NoMatchingCodec=2014]="NoMatchingCodec"})(Jt||(Jt={}));const _e={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},STAGE_DELETED:{code:1037,message:"Stage has been deleted",fatal:!0,nominal:!0},PARTICIPANT_DISCONNECTED:{code:1038,message:"Participant has been disconnected",fatal:!0,nominal:!0},JOIN_SERVER_INTERNAL_ERROR:{code:1039,message:"Internal server error during join",fatal:!1,nominal:!1},JOIN_SERVER_BAD_REQUEST:{code:1040,message:"Bad request during join",fatal:!0,nominal:!1},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},NO_CANDIDATES:{code:1022,message:"No ICE candidates",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNCATEGORIZED_MHCP_ERROR:{code:1029,message:"Authorization failed due to uncategorized MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},POST_WITHOUT_OPTIONS:{code:1032,message:"Cannot POST without OPTIONS in mandatory TURN",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},CHIME_MEETING_NOT_FOUND:{code:1098,message:"Meeting or Attendee was deleted",fatal:!0,nominal:!0},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message",fatal:!1,nominal:!1},WHIP_SESSION_RESOURCE_DELETED:{code:1206,message:"WHIP signaling session resource not found",fatal:!0,nominal:!0},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_OPTIONS_FAILURE:{code:1501,message:"Failed to get ICE Servers from OPTIONS",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PING_SEND_FAIL:{code:1303,message:"Ping send fail",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},SEI_INSERT_NOT_PUBLISHING_VIDEO:{code:1460,message:"SEI failed to insert due to not publishing video",fatal:!1,nominal:!0},SEI_INSERT_INBAND_NOT_ENABLED:{code:1461,message:"SEI failed to insert due to in-band messaging not being enabled",fatal:!1,nominal:!0},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var Kr;(function(u){u.UNPUBLISH="unpublish",u.UNSUBSCRIBE="unsubscribe",u.UNLOAD="unload",u.CONNECTION_FAIL="connection fail",u.REASSIGNMENT="reassignment"})(Kr||(Kr={}));const ph="stageJoined",fu="stageParticipantJoined",la="stageParticipantLeft",so="stageParticipantKicked",So="stageParticipantUpdated",hl="localPublishingChanged",fl="stageRefresh",qn="stateChange",Rs="error",ci="reassignmentRequest",Nn="incompatibleCodecs",Rc="connectionStateChange",wc="mediaStreamCreated",co="mediaStreamRemoved",_r="error",pu="stageStreamSeiMessageReceived",pl="transformError",da="reassignmentStarted",mu="reassignmentSuccess",Gt="reassignmentFailed",ws="open",Is="closed",tr="messageParseError",ks="refresh",Yr="error",Jr="stageStateMessage",Ic="sdpAnswer",on="disconnectMessage",Os="reassignmentMessage",rd="incompatibleCodecs",id="ssu";function As(u){return c=function(l){return l.replace(/-/g,"+").replace(/_/g,"/").padEnd(l.length+(4-l.length%4)%4,"=")}(u),window.atob(c);var c}class $o{constructor(i,c){var l;this.analyticsTracker=c,this.rawToken=i;const f=i.split(".");if(f.length!==3)throw Error(`Token format incorrect. length: ${f.length}`);try{this.header=JSON.parse(As(f[0]))}catch(t){const o=t instanceof Error?`: ${t.message}`:"";throw Error(`Error parsing Stage Token header${o}`)}try{this.claims=JSON.parse(As(f[1]))}catch(t){const o=t instanceof Error?`: ${t.message}`:"";throw Error(`Error parsing Stage Token claims${o}`)}this.signature=f[2];const{claims:n}=this;this.stageARN=n.resource,this.customerId=(l=function(t){if(t.indexOf("arn:aws:")<0)return;const o=t.split(":");return o.length>=5?o[4]:void 0}(this.stageARN))!==null&&l!==void 0?l:"unknown",this.participantID=n.jti,this.eventsURL=n.events_url,this.whipURL=fr("whipUrl")||n.whip_url,this.userID=n.user_id,this.expirationTime=n.exp,this.topic=n.topic,this.parseVersionFlags(n.version);const{attributes:e}=n;e&&(this.attrGsRole=e.gs_role,this.attrGsSessionId=e.gs_session_id)}getPublishEndpoint(){let i="";return this.whipURL&&this.participantID&&(i=`${this.whipURL}/publish/${this.participantID}`),i}getSubscribeEndpoint(i){let c="";return this.whipURL&&(c=`${this.whipURL}/subscribe/${i}`),c}assertTokenIsUnexpired(i,c,l,f){jn("disableTokenValidation")||(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new ct(Object.assign(Object.assign({},_e.EXPIRED_TOKEN),{action:Oe.JOIN,location:l,tag:c,token:this,traceId:i,remoteParticipantId:f,message:_e.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(i){if(!i)return;const c=i.split(".");c.length===2&&(this.versionFlags=parseInt(c[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||!!(this.versionFlags&oo)}}function gu(u,i){return new $o(u,i)}var Eo;(function(u){u.PUBLISH="publish",u.SUBSCRIBE="subscribe"})(Eo||(Eo={}));class kc{constructor(i,c){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=i,this.trailing=!(c&&c.skipTrailing)}invoke(i,...c){return this.throttled?(this.trailingFn=i,this.trailingFnArgs=c,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),i(...c),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}var Ue=g(8954);class vu extends Et{constructor(i,c,l,f,n,e,t,o){super(et.SERVER_REQUEST,c,t,!0),Object.assign(this.properties,{action:i,http_method:f,remote_participant_id:e,request_uuid:n,url:l,transport:o})}}const ha="draft-ietf-wish-whip-04";var nr,Oc=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};function yu(u,i){return Oc(this,void 0,void 0,function*(){u.validateStatus=l=>l>=200&&l<300||l===403;const c=yield k()(u);if(c.status===403){if(c.data.code===2003)throw new ua.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",u,c.request,c);return u.url===c.request.responseURL?(u.validateStatus=l=>l>=200&&l<300,k()(u)):(u.url=c.request.responseURL,i<5?yu(u,i+1):(u.validateStatus=l=>l>=200&&l<300,k()(u)))}return c})}function ml(u){return Oc(this,void 0,void 0,function*(){return yu(u,0)})}function Wa(){}function Ps(u){switch(u){case"new":return Je.NEW;case"closed":return Je.CLOSED;case"disconnected":return Je.DISCONNECTED;case"failed":return Je.FAILED;case"idle":return Je.IDLE;case"checking":case"connecting":return Je.CONNECTING;case"completed":case"connected":return Je.CONNECTED;default:throw new Error(`unknown connecion state: ${u}`)}}function bu(u,i,c){let l=document.createElement(i);const f=()=>{l&&(l.removeEventListener("loadeddata",n),l.removeEventListener("error",f),l.srcObject=null,l.src="",l=null)},n=()=>{f(),c(i)};return l.addEventListener("loadeddata",n),l.addEventListener("error",f),l.srcObject=u,f}class fa extends Et{constructor(i,c,l,f,n){super(et.TRACE,i,c,!1),Object.assign(this.properties,{action:f,message:l,remote_participant_id:n})}}class Su extends Et{constructor(i,c,l,f,n){super(et.CONNECTION_STATE,c,l,!1),Object.assign(this.properties,{action:i,remote_participant_id:n,state:f})}}class Eu extends Et{constructor(i,c,l,f,n){super(et.ICE_GATHERING_STATE,c,l,!1),Object.assign(this.properties,{action:i,remote_participant_id:n,state:f})}}(function(u){u.POST="post",u.CONNECTED="connected",u.ICE_GATHERING="icegathering",u.SDP_EXCHANGE="sdpExchange",u.SET_REMOTE_DESC="setRemoteDesc",u.PEER_CONNECTION="peerConnection"})(nr||(nr={}));const Ac="start",xs="stop";class Ot{constructor(i,c){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=i,this.traceId=c}markActionStart(){this.markStart(nr.CONNECTED)}markPostStart(){this.markStart(nr.POST)}markPostStop(){this.markStop(nr.POST),this.postDuration=this.measure(nr.POST)}markIceGatheringStart(){this.markStart(nr.ICE_GATHERING)}markIceGatheringStop(){this.markStop(nr.ICE_GATHERING),this.timeToCandidate=this.measure(nr.ICE_GATHERING)}markActionStop(){this.markStop(nr.CONNECTED),this.timeToConnected=this.measure(nr.CONNECTED),this.markStop(nr.PEER_CONNECTION),this.peerConnectionDuration=this.measure(nr.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(nr.SET_REMOTE_DESC)}markSetRemoteDescStop(){const i=nr.SET_REMOTE_DESC;this.markStop(i),this.setRemoteDescDuration=this.measure(i),this.markStart(nr.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(nr.SDP_EXCHANGE)}markSdpExchangeStop(){const i=nr.SDP_EXCHANGE;this.markStop(i),this.sdpExchangeDuration=this.measure(i)}setTransport(i){this.sdpExchangeTransport=i}markStart(i){this.marks[`${this.namespace}.${i}.${Ac}`]=performance.now()}markStop(i){this.marks[`${this.namespace}.${i}.${xs}`]=performance.now()}measure(i){const c=`${this.namespace}.${i}.${Ac}`,l=`${this.namespace}.${i}.${xs}`,f=this.marks[c],n=this.marks[l];return f===void 0||n===void 0?0:n-f}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:i,postDuration:c,timeToCandidate:l,timeToConnected:f,sdpExchangeDuration:n,sdpExchangeTransport:e,setRemoteDescDuration:t,peerConnectionDuration:o}=this;return{optionsDuration:i,postDuration:c,timeToCandidate:l,timeToConnected:f,sdpExchangeDuration:n,sdpExchangeTransport:e,setRemoteDescDuration:t,peerConnectionDuration:o}}resetMeasurements(i){this.traceId=i,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var _t,Ds,Xr,Vo,Cr;(function(u){u.VIDEO="video",u.AUDIO="audio"})(_t||(_t={})),function(u){u.LOWEST_QUALITY="lowest_quality",u.HIGHEST_QUALITY="highest_quality"}(Ds||(Ds={})),function(u){u.HI="hi",u.MID="mid",u.LOW="low"}(Xr||(Xr={})),function(u){u.PORTRAIT="portrait",u.LANDSCAPE="landscape"}(Vo||(Vo={})),function(u){u.DEFAULT="default",u.LOW="low",u.MEDIUM="medium",u.HIGH="high"}(Cr||(Cr={}));var pa=g(7363);class kt{constructor(i){this.sdp=i}static splitLines(i){return i.trim().split(`
`).map(c=>c.trim())}static splitSections(i){return i.split(`
m=`).map((c,l)=>(l>0?`m=${c}`:c).trim()+kt.CRLF)}getUniqueRtpHeaderExtensionId(i){const c=[];for(const f of i)if(/^a=extmap:/.test(f.trim())){const n=+f.split("a=extmap:")[1].split(" ")[0];c.includes(n)||c.push(n)}c.sort((f,n)=>f-n);let l=0;for(const f of c){if(f-l>1)return l+1;l=f}return l===14?-1:l+1}withVideoLayersAllocationRtpHeaderExtension(i){const c="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",l=i?i.getRtpHeaderExtensionId(c):-1,f=l===-1?this.getUniqueRtpHeaderExtensionId(kt.splitLines(this.sdp)):l,n=kt.splitSections(this.sdp),e=[];for(let o of n){if(/^m=video/.test(o)&&kt.getRtpHeaderExtensionIdInSection(o,c)===-1){const s=kt.splitLines(o),h=[];if(f===-1||this.hasRtpHeaderExtensionId(f)){e.push(o);continue}for(const y of s)if(h.push(y),/^a=sendrecv/.test(y.trim())){const T=`a=extmap:${f} ${c}`;h.push(T)}o=h.join(kt.CRLF)+kt.CRLF}else if(l!==-1&&/^m=video/.test(o)&&kt.getRtpHeaderExtensionIdInSection(o,c)!==l){const s=kt.splitLines(o),h=[];for(const y of s){if(/^a=extmap:/.test(y.trim())&&y.split("a=extmap:")[1].split(" ")[1]===c){if(!this.hasRtpHeaderExtensionId(l)){const T=`a=extmap:${l} ${c}`;h.push(T)}continue}h.push(y)}o=h.join(kt.CRLF)+kt.CRLF}e.push(o)}const t=e.join("");return new kt(t)}withOpusAudioConfig(i,c){const l=pa.qg(this.sdp);for(const f of l.media)if(f.type==="audio"){const{payload:n}=f.rtp.find(s=>s.codec==="opus");if(!n)continue;let e=f.fmtp.find(s=>s.payload===n);e||(e={payload:n,config:""});const t=pa.Sl(e.config);if(t.maxaveragebitrate=i,typeof c=="boolean"){const s=c?1:0;t["sprop-stereo"]=s,t.stereo=s}let o="";for(const s of Object.keys(t))o+=`${s}=${t[s]}; `;e.config=o.trim()}return new kt(pa.M9(l))}withoutAudioRtcpRSize(){var i;const c=pa.qg(this.sdp);for(const l of c.media){if(l.type!=="audio")continue;const f=Gr()!==void 0,n=(i=Gr())!==null&&i!==void 0&&i;f&&(l.rtcpRsize=n?void 0:"rtcp-rsize")}return new kt(pa.M9(c))}withFilteredCandidates(i){const c=pa.qg(this.sdp);return c.media.forEach(l=>{const f=l.candidates;if(f){const n=f.filter(e=>e.transport===i);l.candidates=n}}),new kt(pa.M9(c))}static getRtpHeaderExtensionIdInSection(i,c){const l=kt.splitLines(i);for(const f of l)if(/^a=extmap:/.test(f.trim())){const n=f.split("a=extmap:")[1].split(" "),e=+n[0];if(n[1]===c)return e}return-1}getRtpHeaderExtensionId(i){const c=kt.splitSections(this.sdp);for(const l of c)if(/^m=video/.test(l)){const f=kt.getRtpHeaderExtensionIdInSection(l,i);if(f!==-1)return f}return-1}hasRtpHeaderExtensionId(i){const c=kt.splitLines(this.sdp);for(const l of c)if(/^a=extmap:/.test(l.trim())&&+l.split("a=extmap:")[1].split(" ")[0]===i)return!0;return!1}hasAudioNacksEnabled(){var i,c,l;return((l=(c=((i=pa.qg(this.sdp).media.filter(f=>f.type==="audio")[0])!==null&&i!==void 0?i:{}).rtcpFb)===null||c===void 0?void 0:c.filter(f=>f.type==="nack"))!==null&&l!==void 0?l:[]).length>0}}function Si(u){const{config:i}=u;return[{maxBitrate:i.maxBitrateBps}]}kt.CRLF=`\r
`,kt.rfc7587LowestBitrate=6e3,kt.rfc7587HighestBitrate=51e4;function Ei(u){return 1e3*u}const Ga=(u,...i)=>{const c=i.map(l=>typeof l!="object").filter(Boolean).length>0;if(typeof u=="object"&&!c)return(0,Sn.merge)({},u,...i)},Pc=u=>_u(u),_u=u=>(0,Sn.cloneDeep)(u),Qr=u=>{switch(u){case Ds.HIGHEST_QUALITY:return"highest";case Ds.LOWEST_QUALITY:default:return"lowest"}},en=u=>Object.freeze(u),_i=Object.freeze({DEFAULT_1080:en({maxBitrateKbps:2500,maxFramerate:30,width:1920,height:1080}),INACTIVE:en({maxBitrateKbps:0,maxFramerate:0,width:0,height:0})}),Ha=Object.freeze({DEFAULT_720:en({maxBitrateKbps:2500,maxFramerate:30,width:1280,height:720}),DEFAULT_540:en({maxBitrateKbps:1400,maxFramerate:15,width:960,height:540}),DEFAULT_480:en({maxBitrateKbps:1100,maxFramerate:15,width:854,height:480}),DEFAULT_360:en({maxBitrateKbps:600,maxFramerate:15,width:640,height:360}),DEFAULT_270:en({maxBitrateKbps:350,maxFramerate:15,width:480,height:270}),DEFAULT_180:en({maxBitrateKbps:150,maxFramerate:15,width:320,height:180}),DEFAULT_160:en({maxBitrateKbps:120,maxFramerate:15,width:284,height:160})}),Wo=Object.freeze({HI:en(Object.assign({},Ha.DEFAULT_720)),MID:en(Object.assign(Object.assign({},Ha.DEFAULT_360),{maxBitrateKbps:700,maxFramerate:20})),LOW:en(Object.assign(Object.assign({},Ha.DEFAULT_180),{maxBitrateKbps:200,maxFramerate:15}))}),za=u=>({rid:u,active:!1,scaleFactor:Cu(u),maxBitrateBps:Ei(_i.INACTIVE.maxBitrateKbps),maxFramerate:_i.INACTIVE.maxFramerate,width:_i.INACTIVE.width,height:_i.INACTIVE.height}),Cu=u=>{switch(u){case Xr.HI:return 1;case Xr.MID:return 2;case Xr.LOW:return 4;default:return 1}},_o=50,$i=2500,Go=10,pr=30,uo=160,Ci=1280,Ho=720*Ci,xc=16/9,qa=12,ma=128,Tu=64,gl={[Cr.DEFAULT]:0,[Cr.LOW]:50,[Cr.MEDIUM]:150,[Cr.HIGH]:250},vl={[Cr.DEFAULT]:0,[Cr.LOW]:100,[Cr.MEDIUM]:200,[Cr.HIGH]:300};function Zr(u){const{outbound:i,remoteInbound:c,networkQuality:l}=u;return{networkQuality:l,nackCount:i.nackCount,packetsSent:i.packetsSent,packetsLost:c==null?void 0:c.packetsLost,retransmittedPacketsSent:i.retransmittedPacketsSent,bytesSent:i.bytesSent,headerBytesSent:i.headerBytesSent,retransmittedBytesSent:i.retransmittedBytesSent,totalPacketSendDelay:i.totalPacketSendDelay}}function $n(u){var i,c,l;const{outbound:f,remoteInbound:n,networkQuality:e}=u;return{networkQuality:e,nackCount:f.nackCount,packetsSent:f.packetsSent,packetsLost:n==null?void 0:n.packetsLost,retransmittedPacketsSent:f.retransmittedPacketsSent,bytesSent:f.bytesSent,headerBytesSent:f.headerBytesSent,retransmittedBytesSent:f.retransmittedBytesSent,totalPacketSendDelay:f.totalPacketSendDelay,firCount:f.firCount,pliCount:f.pliCount,framesEncoded:f.framesEncoded,keyFramesEncoded:f.keyFramesEncoded,totalEncodeTime:f.totalEncodeTime,totalEncodedBytesTarget:f.totalEncodedBytesTarget,framesSent:f.framesSent,hugeFramesSent:f.hugeFramesSent,active:((i=f.framesPerSecond)!==null&&i!==void 0?i:0)!==0,qualityLimitationReason:f.qualityLimitationReason,qualityLimitationResolutionChanges:f.qualityLimitationResolutionChanges,qualityLimitationCpuDuration:(c=f.qualityLimitationDurations)===null||c===void 0?void 0:c.cpu,qualityLimitationBandwidthDuration:(l=f.qualityLimitationDurations)===null||l===void 0?void 0:l.bandwidth,frameWidth:f.frameWidth,frameHeight:f.frameHeight,framesPerSecond:f.framesPerSecond,rid:f.rid,ssrc:f.ssrc}}function ui(u,i){const c=new Map,l=new Map;for(const f of i.values())if(f.kind===u&&f.type==="outbound-rtp"&&f.ssrc){const n=f.rid||Mt;l.set(f.ssrc,n);let e=c.get(n);e||(e={},c.set(n,e)),e.outbound=f}for(const f of i.values())if(f.kind===u&&f.type==="remote-inbound-rtp"&&f.ssrc){const n=l.get(f.ssrc)||Mt,e=c.get(n);e&&(e.remoteInbound=f)}return c}function Co(u,i){const c=new Map;for(const l of i.values())if(l.kind===u&&l.type==="inbound-rtp"){const f=l.rid||Mt;c.set(f,{inbound:l})}return c}function To(u,i){return u!==Zn.DOWN&&i!=null?i:u}const yl=(u,i)=>{const c=[],l=Hr.getNetworkQuality(),f=ui("audio",u);for(const n of f.values())if(n.outbound){const e=n.outbound.rid||Mt,t=To(l,i.get(e)),o=Zr({outbound:n.outbound,remoteInbound:n.remoteInbound,networkQuality:t});c.push(o)}if(c.length)return c},bl=(u,i)=>{const c=[],l=Hr.getNetworkQuality(),f=ui("video",u);for(const n of f.values())if(n.outbound){const e=n.outbound.rid||Mt,t=$n({outbound:n.outbound,remoteInbound:n.remoteInbound});if(t.active){const o=To(l,i.get(e));t.networkQuality=o}c.push(t)}if(c.length)return c},Ka=(u,i)=>{const c=[],l=Hr.getNetworkQuality(),f=Co("audio",u);for(const e of f.values())if(e.inbound){const t=e.inbound.id;if(!t)continue;const o=To(l,i.get(t)),s={networkQuality:(n={inbound:e.inbound,networkQuality:o}).networkQuality,nackCount:n.inbound.nackCount,packetsReceived:n.inbound.packetsReceived,packetsLost:n.inbound.packetsLost,packetsDiscarded:n.inbound.packetsDiscarded,bytesReceived:n.inbound.bytesReceived,headerBytesReceived:n.inbound.headerBytesReceived,jitterBufferDelay:n.inbound.jitterBufferDelay,jitterBufferEmittedCount:n.inbound.jitterBufferEmittedCount,jitter:n.inbound.jitter,totalSamplesReceived:n.inbound.totalSamplesReceived,concealedSamples:n.inbound.concealedSamples,silentConcealedSamples:n.inbound.silentConcealedSamples,concealmentEvents:n.inbound.concealmentEvents,insertedSamplesForDeceleration:n.inbound.insertedSamplesForDeceleration,removedSamplesForAcceleration:n.inbound.removedSamplesForAcceleration,audioLevel:n.inbound.audioLevel};c.push(s)}var n;if(c.length)return c},Ro=(u,i)=>{const c=[],l=Hr.getNetworkQuality(),f=Co("video",u);for(const e of f.values())if(e.inbound){const t=e.inbound.id;if(!t)continue;const o={networkQuality:(n={inbound:e.inbound,networkQuality:To(l,i.get(t))}).networkQuality,nackCount:n.inbound.nackCount,packetsReceived:n.inbound.packetsReceived,packetsLost:n.inbound.packetsLost,packetsDiscarded:n.inbound.packetsDiscarded,bytesReceived:n.inbound.bytesReceived,headerBytesReceived:n.inbound.headerBytesReceived,jitterBufferDelay:n.inbound.jitterBufferDelay,jitterBufferEmittedCount:n.inbound.jitterBufferEmittedCount,jitter:n.inbound.jitter,pliCount:n.inbound.pliCount,firCount:n.inbound.firCount,framesReceived:n.inbound.framesReceived,framesDecoded:n.inbound.framesDecoded,keyFramesDecoded:n.inbound.keyFramesDecoded,framesDropped:n.inbound.framesDropped,totalDecodeTime:n.inbound.totalDecodeTime,totalInterFrameDelay:n.inbound.totalInterFrameDelay,totalSquaredInterFrameDelay:n.inbound.totalSquaredInterFrameDelay,pauseCount:n.inbound.pauseCount,totalPausesDuration:n.inbound.totalPausesDuration,freezeCount:n.inbound.freezeCount,totalFreezesDuration:n.inbound.totalFreezesDuration,frameWidth:n.inbound.frameWidth,frameHeight:n.inbound.frameHeight,framesPerSecond:n.inbound.framesPerSecond,ssrc:n.inbound.ssrc};c.push(o)}var n;if(c.length)return c};var Ms=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};const Ru="H264",Ns=u=>{const i=u==null?void 0:u.split("/");if((i==null?void 0:i.length)===2)return i[1]},li=(u,i)=>{const c=Ns(u);if(u===void 0||c===void 0)return;const l={mimeSubtype:c};if(i){const f=(n=>{const e=n.split(";"),t=new Map;for(const o of e){const[s,h]=o.split("=");t.set(s,h)}return t})(i);switch(c){case Ru:{const n=f.get("profile-level-id");n&&((e,t)=>{if(t.length<6)return;const o=t.substring(0,4),s=parseInt(t.substring(4,6),16);e.profile=o,e.level=s})(l,n);break}case"H265":((n,e)=>{const t=e.get("profile-id")||"0",o=e.get("tier-flag")||"0",s=parseInt(e.get("level-id")||"0",10),h=[o,t].join("_");n.profile=h,n.level=s})(l,f)}}return l},Ls=(u,i)=>u.sort((c,l)=>{if(Ns(c.mimeType)===Ru){const f=li(c.mimeType,c.sdpFmtpLine);if((f==null?void 0:f.profile)===i)return-1}return 0}),Ya=(u,i)=>{var c;const l=li(u.mimeType,u.sdpFmtpLine);return(l==null?void 0:l.mimeSubtype.toLowerCase())===i.mime.toLowerCase()&&((c=l==null?void 0:l.profile)===null||c===void 0?void 0:c.toLowerCase().indexOf(i.config.toLowerCase()))===0},Bs=(u,i)=>i.filter(c=>!c.mimeType.endsWith("rtx")).filter(c=>c.mimeType.indexOf("packetization-mode=0")===-1).find(c=>u.reduce((l,f)=>l&&Ya(c,f)===!1,!0));class Dc extends Et{constructor(i,c,l,f,n,e,t,o,s){var h,y;super(et.PUBLISHED_VIDEO_STATS,i,c,!1),Object.assign(this.properties,Object.assign({action:Oe.PUBLISH,node:(h=l==null?void 0:l.node)!==null&&h!==void 0?h:"",cluster:(y=l==null?void 0:l.cluster)!==null&&y!==void 0?y:""},((T,P,M,L,B,U)=>{var F,q,Y,z,re,ue,le,ve,be,ye,pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt,qt,On,pn,un,sn,tn,ln,Pn,Xt,dr,wi,hi;const vo=(q=(F=T==null?void 0:T.qualityLimitationDurations)===null||F===void 0?void 0:F.cpu)!==null&&q!==void 0?q:0,yo=(z=(Y=T==null?void 0:T.qualityLimitationDurations)===null||Y===void 0?void 0:Y.bandwidth)!==null&&z!==void 0?z:0,Ii=Math.max((re=T==null?void 0:T.bytesSent)!==null&&re!==void 0?re:0,0),Xo=8*Ii/(U??1),Po=Math.max((ue=P==null?void 0:P.packetsLost)!==null&&ue!==void 0?ue:0,0),Qo=Math.max((le=T==null?void 0:T.packetsSent)!==null&&le!==void 0?le:0,0),Ca=Po/Math.max(Qo,1),qi=li(L==null?void 0:L.mimeType,L==null?void 0:L.sdpFmtpLine);return{active:!!(T!=null&&T.framesPerSecond)&&T.framesPerSecond!==0,bytes_sent:Ii,codec_mime_type:qi==null?void 0:qi.mimeSubtype,codec_profile:qi==null?void 0:qi.profile,codec_level:qi==null?void 0:qi.level,configured_bitrate:B==null?void 0:B.max_bitrate,connection_bandwidth:(be=(ve=M==null?void 0:M.candidatePair)===null||ve===void 0?void 0:ve.availableOutgoingBitrate)!==null&&be!==void 0?be:0,encode_bitrate:Xo,encoder_implementation:(ye=T==null?void 0:T.encoderImplementation)!==null&&ye!==void 0?ye:"unknown",fir_count:(pe=T==null?void 0:T.firCount)!==null&&pe!==void 0?pe:0,fraction_packets_lost:Ca,frame_height:Math.max((Re=T==null?void 0:T.frameHeight)!==null&&Re!==void 0?Re:0,0),frame_width:Math.max((Me=T==null?void 0:T.frameWidth)!==null&&Me!==void 0?Me:0,0),frames_encoded:(Le=T==null?void 0:T.framesEncoded)!==null&&Le!==void 0?Le:0,frames_per_second:Math.max((Ae=T==null?void 0:T.framesPerSecond)!==null&&Ae!==void 0?Ae:0,0),frames_sent:(Pe=T==null?void 0:T.framesSent)!==null&&Pe!==void 0?Pe:0,header_bytes_sent:(qe=T==null?void 0:T.headerBytesSent)!==null&&qe!==void 0?qe:0,huge_frames_sent:(gt=T==null?void 0:T.hugeFramesSent)!==null&&gt!==void 0?gt:0,key_frames_encoded:(Bt=T==null?void 0:T.keyFramesEncoded)!==null&&Bt!==void 0?Bt:0,nack_count:(Ft=T==null?void 0:T.nackCount)!==null&&Ft!==void 0?Ft:0,packets_lost:Po,packets_sent:Qo,power_efficient_encoder:(Lt=T==null?void 0:T.powerEfficientEncoder)!==null&&Lt!==void 0&&Lt,pli_count:(qt=T==null?void 0:T.pliCount)!==null&&qt!==void 0?qt:0,quality_limitation_reason:(On=T==null?void 0:T.qualityLimitationReason)!==null&&On!==void 0?On:"none",quality_limitation_resolution_changes:(pn=T==null?void 0:T.qualityLimitationResolutionChanges)!==null&&pn!==void 0?pn:0,quality_limitation_cpu_duration:vo,quality_limitation_bandwidth_duration:yo,retransmitted_bytes_sent:(un=T==null?void 0:T.retransmittedBytesSent)!==null&&un!==void 0?un:0,retransmitted_packets_sent:(sn=T==null?void 0:T.retransmittedPacketsSent)!==null&&sn!==void 0?sn:0,rid:(tn=T==null?void 0:T.rid)!==null&&tn!==void 0?tn:Mt,scalability_mode:(ln=T==null?void 0:T.scalabilityMode)!==null&&ln!==void 0?ln:"unknown",target_bitrate:Math.max((Pn=T==null?void 0:T.targetBitrate)!==null&&Pn!==void 0?Pn:0,0),total_encode_time:(Xt=T==null?void 0:T.totalEncodeTime)!==null&&Xt!==void 0?Xt:0,total_encoded_bytes_target:(dr=T==null?void 0:T.totalEncodedBytesTarget)!==null&&dr!==void 0?dr:0,total_packet_send_delay:(wi=T==null?void 0:T.totalPacketSendDelay)!==null&&wi!==void 0?wi:0,protocol:(hi=M==null?void 0:M.localCandidate)===null||hi===void 0?void 0:hi.protocol}})(f,n,e,t,o,s)))}}class Mc extends Et{constructor(i,c,l,f,n,e,t,o,s,h,y,T){var P,M,L,B;super(et.PUBLISHED_VIDEO_STATS_WINDOW,i,c,!1);const U=Math.max(((P=f==null?void 0:f.timestamp)!==null&&P!==void 0?P:0)-((M=n==null?void 0:n.timestamp)!==null&&M!==void 0?M:0),0);Object.assign(this.properties,Object.assign({action:Oe.PUBLISH,node:(L=l==null?void 0:l.node)!==null&&L!==void 0?L:"",cluster:(B=l==null?void 0:l.cluster)!==null&&B!==void 0?B:"",window_size_ms:U},((F,q,Y,z,re,ue,le,ve,be,ye)=>{var pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt,qt,On,pn,un,sn,tn,ln,Pn,Xt,dr,wi,hi,vo,yo,Ii,Xo,Po,Qo,Ca,qi,Xs,zc,cs,Qs,qc,Zs,ec,Kc,tc,nc,rc,Rd,wd,Id,kd,Nh,Lh,Bh,jh,jl,Od,Uh,ic;const Ep=(Re=(pe=F==null?void 0:F.qualityLimitationDurations)===null||pe===void 0?void 0:pe.cpu)!==null&&Re!==void 0?Re:0,mf=(Le=(Me=q==null?void 0:q.qualityLimitationDurations)===null||Me===void 0?void 0:Me.cpu)!==null&&Le!==void 0?Le:0,gf=(Pe=(Ae=F==null?void 0:F.qualityLimitationDurations)===null||Ae===void 0?void 0:Ae.bandwidth)!==null&&Pe!==void 0?Pe:0,h0=(gt=(qe=q==null?void 0:q.qualityLimitationDurations)===null||qe===void 0?void 0:qe.bandwidth)!==null&&gt!==void 0?gt:0,wm=Math.max(((Bt=F==null?void 0:F.bytesSent)!==null&&Bt!==void 0?Bt:0)-((Ft=q==null?void 0:q.bytesSent)!==null&&Ft!==void 0?Ft:0),0),Im=typeof ve!="number"?1:ve/1e3,f0=8*wm/Im,km=Math.max(((Lt=Y==null?void 0:Y.packetsLost)!==null&&Lt!==void 0?Lt:0)-((qt=z==null?void 0:z.packetsLost)!==null&&qt!==void 0?qt:0),0),Om=Math.max(((On=F==null?void 0:F.packetsSent)!==null&&On!==void 0?On:0)-((pn=q==null?void 0:q.packetsSent)!==null&&pn!==void 0?pn:0),0),p0=km/Math.max(Om,1),Ad=li(ue==null?void 0:ue.mimeType,ue==null?void 0:ue.sdpFmtpLine),m0=8*(ye||0)/Im;return{active:!!(F!=null&&F.framesPerSecond)&&(F==null?void 0:F.framesPerSecond)!==0,bytes_sent:wm,codec_mime_type:Ad==null?void 0:Ad.mimeSubtype,codec_profile:Ad==null?void 0:Ad.profile,codec_level:Ad==null?void 0:Ad.level,configured_bitrate:le==null?void 0:le.max_bitrate,connection_bandwidth:(sn=(un=re==null?void 0:re.candidatePair)===null||un===void 0?void 0:un.availableOutgoingBitrate)!==null&&sn!==void 0?sn:0,encode_bitrate:f0,encoder_implementation:(tn=F==null?void 0:F.encoderImplementation)!==null&&tn!==void 0?tn:"unknown",fir_count:Math.max(((ln=F==null?void 0:F.firCount)!==null&&ln!==void 0?ln:0)-((Pn=q==null?void 0:q.firCount)!==null&&Pn!==void 0?Pn:0),0),fraction_packets_lost:p0,frame_height:Math.max((Xt=F==null?void 0:F.frameHeight)!==null&&Xt!==void 0?Xt:0,0),frame_width:Math.max((dr=F==null?void 0:F.frameWidth)!==null&&dr!==void 0?dr:0,0),frames_encoded:Math.max(((wi=F==null?void 0:F.framesEncoded)!==null&&wi!==void 0?wi:0)-((hi=q==null?void 0:q.framesEncoded)!==null&&hi!==void 0?hi:0),0),frames_per_second:Math.max((vo=F==null?void 0:F.framesPerSecond)!==null&&vo!==void 0?vo:0,0),frames_sent:Math.max(((yo=F==null?void 0:F.framesSent)!==null&&yo!==void 0?yo:0)-((Ii=q==null?void 0:q.framesSent)!==null&&Ii!==void 0?Ii:0),0),header_bytes_sent:Math.max(((Xo=F==null?void 0:F.headerBytesSent)!==null&&Xo!==void 0?Xo:0)-((Po=q==null?void 0:q.headerBytesSent)!==null&&Po!==void 0?Po:0),0),huge_frames_sent:Math.max(((Qo=F==null?void 0:F.hugeFramesSent)!==null&&Qo!==void 0?Qo:0)-((Ca=q==null?void 0:q.hugeFramesSent)!==null&&Ca!==void 0?Ca:0),0),key_frames_encoded:Math.max(((qi=F==null?void 0:F.keyFramesEncoded)!==null&&qi!==void 0?qi:0)-((Xs=q==null?void 0:q.keyFramesEncoded)!==null&&Xs!==void 0?Xs:0),0),nack_count:Math.max(((zc=F==null?void 0:F.nackCount)!==null&&zc!==void 0?zc:0)-((cs=q==null?void 0:q.nackCount)!==null&&cs!==void 0?cs:0),0),packets_lost:km,packets_sent:Om,power_efficient_encoder:(Qs=F==null?void 0:F.powerEfficientEncoder)!==null&&Qs!==void 0&&Qs,pli_count:Math.max(((qc=F==null?void 0:F.pliCount)!==null&&qc!==void 0?qc:0)-((Zs=q==null?void 0:q.pliCount)!==null&&Zs!==void 0?Zs:0),0),quality_limitation_reason:(ec=F==null?void 0:F.qualityLimitationReason)!==null&&ec!==void 0?ec:"none",quality_limitation_resolution_changes:Math.max(((Kc=F==null?void 0:F.qualityLimitationResolutionChanges)!==null&&Kc!==void 0?Kc:0)-((tc=q==null?void 0:q.qualityLimitationResolutionChanges)!==null&&tc!==void 0?tc:0),0),quality_limitation_cpu_duration:Math.max(Ep-mf,0),quality_limitation_bandwidth_duration:Math.max(gf-h0,0),retransmitted_bytes_sent:Math.max(((nc=F==null?void 0:F.retransmittedBytesSent)!==null&&nc!==void 0?nc:0)-((rc=q==null?void 0:q.retransmittedBytesSent)!==null&&rc!==void 0?rc:0),0),rid:(Rd=F==null?void 0:F.rid)!==null&&Rd!==void 0?Rd:Mt,retransmitted_packets_sent:Math.max(((wd=F==null?void 0:F.retransmittedPacketsSent)!==null&&wd!==void 0?wd:0)-((Id=q==null?void 0:q.retransmittedPacketsSent)!==null&&Id!==void 0?Id:0),0),scalability_mode:(kd=F==null?void 0:F.scalabilityMode)!==null&&kd!==void 0?kd:"unknown",target_bitrate:Math.max((Nh=F==null?void 0:F.targetBitrate)!==null&&Nh!==void 0?Nh:0,0),total_encode_time:Math.max(((Lh=F==null?void 0:F.totalEncodeTime)!==null&&Lh!==void 0?Lh:0)-((Bh=q==null?void 0:q.totalEncodeTime)!==null&&Bh!==void 0?Bh:0),0),total_encoded_bytes_target:Math.max(((jh=F==null?void 0:F.totalEncodedBytesTarget)!==null&&jh!==void 0?jh:0)-((jl=q==null?void 0:q.totalEncodedBytesTarget)!==null&&jl!==void 0?jl:0),0),total_packet_send_delay:Math.max(((Od=F==null?void 0:F.totalPacketSendDelay)!==null&&Od!==void 0?Od:0)-((Uh=q==null?void 0:q.totalPacketSendDelay)!==null&&Uh!==void 0?Uh:0),0),sei_write_count:be,sei_bytes_sent:ye,sei_bitrate:m0,protocol:(ic=re==null?void 0:re.localCandidate)===null||ic===void 0?void 0:ic.protocol}})(f,n,e,t,o,s,h,U,y,T)))}}class Nc extends Et{constructor(i,c,l,f,n,e,t,o,s,h){var y,T;super(et.PUBLISHED_AUDIO_STATS,i,c,!1),Object.assign(this.properties,Object.assign({action:Oe.PUBLISH,node:(y=l==null?void 0:l.node)!==null&&y!==void 0?y:"",cluster:(T=l==null?void 0:l.cluster)!==null&&T!==void 0?T:""},((P,M,L,B,U,F,q)=>{var Y,z,re,ue,le,ve,be,ye,pe,Re,Me,Le,Ae;const Pe=Math.max((Y=P==null?void 0:P.bytesSent)!==null&&Y!==void 0?Y:0,0),qe=8*Pe/(F??1),gt=Math.max((z=M==null?void 0:M.packetsLost)!==null&&z!==void 0?z:0,0),Bt=Math.max((re=P==null?void 0:P.packetsSent)!==null&&re!==void 0?re:0,0),Ft=gt/Math.max(Bt,1),Lt=li(B==null?void 0:B.mimeType,B==null?void 0:B.sdpFmtpLine);return{audio_nacks_enabled:(ue=q==null?void 0:q.audioNacks)!==null&&ue!==void 0&&ue,bytes_sent:Pe,codec_mime_type:Lt==null?void 0:Lt.mimeSubtype,configured_bitrate:(le=U==null?void 0:U.max_audio_bitrate_bps)!==null&&le!==void 0?le:0,connection_bandwidth:(be=(ve=L==null?void 0:L.candidatePair)===null||ve===void 0?void 0:ve.availableOutgoingBitrate)!==null&&be!==void 0?be:0,encode_bitrate:qe,fraction_packets_lost:Ft,header_bytes_sent:(ye=P==null?void 0:P.headerBytesSent)!==null&&ye!==void 0?ye:0,nack_count:(pe=P==null?void 0:P.nackCount)!==null&&pe!==void 0?pe:0,packets_lost:gt,packets_sent:Bt,retransmitted_bytes_sent:(Re=P==null?void 0:P.retransmittedBytesSent)!==null&&Re!==void 0?Re:0,retransmitted_packets_sent:(Me=P==null?void 0:P.retransmittedPacketsSent)!==null&&Me!==void 0?Me:0,target_bitrate:(Le=P==null?void 0:P.targetBitrate)!==null&&Le!==void 0?Le:0,protocol:(Ae=L==null?void 0:L.localCandidate)===null||Ae===void 0?void 0:Ae.protocol}})(f,n,e,t,o,s,h)))}}class wu extends Et{constructor(i,c,l,f,n,e,t,o,s,h,y){var T,P,M,L;super(et.PUBLISHED_AUDIO_STATS_WINDOW,i,c,!1);const B=Math.max(((T=f==null?void 0:f.timestamp)!==null&&T!==void 0?T:0)-((P=n==null?void 0:n.timestamp)!==null&&P!==void 0?P:0),0);Object.assign(this.properties,Object.assign({action:Oe.PUBLISH,node:(M=l==null?void 0:l.node)!==null&&M!==void 0?M:"",cluster:(L=l==null?void 0:l.cluster)!==null&&L!==void 0?L:"",window_size_ms:B},((U,F,q,Y,z,re,ue,le,ve)=>{var be,ye,pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt,qt,On,pn,un,sn,tn,ln,Pn,Xt;const dr=Math.max(((be=U==null?void 0:U.bytesSent)!==null&&be!==void 0?be:0)-((ye=F==null?void 0:F.bytesSent)!==null&&ye!==void 0?ye:0),0),wi=8*dr/(typeof le!="number"?1:le/1e3),hi=Math.max(((pe=q==null?void 0:q.packetsLost)!==null&&pe!==void 0?pe:0)-((Re=Y==null?void 0:Y.packetsLost)!==null&&Re!==void 0?Re:0),0),vo=Math.max(((Me=U==null?void 0:U.packetsSent)!==null&&Me!==void 0?Me:0)-((Le=F==null?void 0:F.packetsSent)!==null&&Le!==void 0?Le:0),0),yo=hi/Math.max(vo,1),Ii=li(re==null?void 0:re.mimeType,re==null?void 0:re.sdpFmtpLine);return{audio_nacks_enabled:(Ae=ve==null?void 0:ve.audioNacks)!==null&&Ae!==void 0&&Ae,bytes_sent:dr,codec_mime_type:Ii==null?void 0:Ii.mimeSubtype,configured_bitrate:(Pe=ue==null?void 0:ue.max_audio_bitrate_bps)!==null&&Pe!==void 0?Pe:0,connection_bandwidth:(gt=(qe=z==null?void 0:z.candidatePair)===null||qe===void 0?void 0:qe.availableOutgoingBitrate)!==null&&gt!==void 0?gt:0,encode_bitrate:wi,fraction_packets_lost:yo,header_bytes_sent:Math.max(((Bt=U==null?void 0:U.headerBytesSent)!==null&&Bt!==void 0?Bt:0)-((Ft=F==null?void 0:F.headerBytesSent)!==null&&Ft!==void 0?Ft:0),0),nack_count:Math.max(((Lt=U==null?void 0:U.nackCount)!==null&&Lt!==void 0?Lt:0)-((qt=F==null?void 0:F.nackCount)!==null&&qt!==void 0?qt:0),0),packets_lost:hi,packets_sent:Math.max(((On=U==null?void 0:U.packetsSent)!==null&&On!==void 0?On:0)-((pn=F==null?void 0:F.packetsSent)!==null&&pn!==void 0?pn:0),0),retransmitted_bytes_sent:Math.max(((un=U==null?void 0:U.retransmittedBytesSent)!==null&&un!==void 0?un:0)-((sn=F==null?void 0:F.retransmittedBytesSent)!==null&&sn!==void 0?sn:0),0),retransmitted_packets_sent:Math.max(((tn=U==null?void 0:U.retransmittedPacketsSent)!==null&&tn!==void 0?tn:0)-((ln=F==null?void 0:F.retransmittedPacketsSent)!==null&&ln!==void 0?ln:0),0),target_bitrate:Math.max((Pn=U==null?void 0:U.targetBitrate)!==null&&Pn!==void 0?Pn:0,0),protocol:(Xt=z==null?void 0:z.localCandidate)===null||Xt===void 0?void 0:Xt.protocol}})(f,n,e,t,o,s,h,B,y)))}}class Sl extends Et{constructor(i,c,l,f,n,e,t,o){var s,h;super(et.SUBSCRIBED_VIDEO_STATS,i,c,!1),Object.assign(this.properties,Object.assign({action:Oe.SUBSCRIBE,node:(s=f==null?void 0:f.node)!==null&&s!==void 0?s:"",cluster:(h=f==null?void 0:f.cluster)!==null&&h!==void 0?h:"",remote_participant_id:l},((y,T,P,M)=>{var L,B,U,F,q,Y,z,re,ue,le,ve,be,ye,pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt;let qt=0;y!=null&&y.jitterBufferDelay&&(y!=null&&y.jitterBufferEmittedCount)&&y.jitterBufferEmittedCount>0&&(qt=y.jitterBufferDelay/y.jitterBufferEmittedCount);const On=M??1,pn=Math.max((L=y==null?void 0:y.bytesReceived)!==null&&L!==void 0?L:0,0),un=8*pn/On;let sn=0;y!=null&&y.totalDecodeTime&&(y!=null&&y.framesDecoded)&&(sn=y.totalDecodeTime/Math.max(y==null?void 0:y.framesDecoded,1));const tn=Math.max((B=y==null?void 0:y.packetsLost)!==null&&B!==void 0?B:0,0),ln=Math.max((U=y==null?void 0:y.packetsReceived)!==null&&U!==void 0?U:0,0),Pn=tn/Math.max(ln+tn,1),Xt=li(P==null?void 0:P.mimeType,P==null?void 0:P.sdpFmtpLine);return{bytes_received:pn,codec_mime_type:Xt==null?void 0:Xt.mimeSubtype,codec_profile:Xt==null?void 0:Xt.profile,codec_level:Xt==null?void 0:Xt.level,connection_bandwidth:(q=(F=T==null?void 0:T.candidatePair)===null||F===void 0?void 0:F.availableIncomingBitrate)!==null&&q!==void 0?q:0,decode_bitrate:un,decoder_implementation:(Y=y==null?void 0:y.decoderImplementation)!==null&&Y!==void 0?Y:"unknown",fir_count:Math.max((z=y==null?void 0:y.firCount)!==null&&z!==void 0?z:0,0),fraction_packets_lost:Pn,frame_decode_time_avg:sn,frame_height:Math.max((re=y==null?void 0:y.frameHeight)!==null&&re!==void 0?re:0,0),frame_width:Math.max((ue=y==null?void 0:y.frameWidth)!==null&&ue!==void 0?ue:0,0),frames_decoded:Math.max((le=y==null?void 0:y.framesDecoded)!==null&&le!==void 0?le:0,0),frames_dropped:Math.max((ve=y==null?void 0:y.framesDropped)!==null&&ve!==void 0?ve:0,0),frames_received:Math.max((be=y==null?void 0:y.framesReceived)!==null&&be!==void 0?be:0,0),freeze_count:Math.max((ye=y==null?void 0:y.freezeCount)!==null&&ye!==void 0?ye:0,0),frames_rendered:Math.max((pe=y==null?void 0:y.framesRendered)!==null&&pe!==void 0?pe:0,0),frames_per_second:Math.max((Re=y==null?void 0:y.framesPerSecond)!==null&&Re!==void 0?Re:0,0),header_bytes_received:Math.max((Me=y==null?void 0:y.headerBytesReceived)!==null&&Me!==void 0?Me:0,0),jitter_buffer_delay_avg:qt,key_frames_decoded:Math.max((Le=y==null?void 0:y.keyFramesDecoded)!==null&&Le!==void 0?Le:0,0),nack_count:Math.max((Ae=y==null?void 0:y.nackCount)!==null&&Ae!==void 0?Ae:0,0),packets_discarded:Math.max((Pe=y==null?void 0:y.packetsDiscarded)!==null&&Pe!==void 0?Pe:0,0),packets_lost:tn,packets_received:ln,pause_count:Math.max((qe=y==null?void 0:y.pauseCount)!==null&&qe!==void 0?qe:0,0),pli_count:Math.max((gt=y==null?void 0:y.pliCount)!==null&&gt!==void 0?gt:0,0),power_efficient_decoder:(Bt=y==null?void 0:y.powerEfficientDecoder)!==null&&Bt!==void 0&&Bt,total_freezes_duration:Math.max((Ft=y==null?void 0:y.totalFreezesDuration)!==null&&Ft!==void 0?Ft:0,0),total_pauses_duration:Math.max((Lt=y==null?void 0:y.totalPausesDuration)!==null&&Lt!==void 0?Lt:0,0)}})(n,e,t,o)))}}class od extends Et{constructor(i,c,l,f,n,e,t,o,s,h,y){var T,P,M,L;super(et.SUBSCRIBED_VIDEO_STATS_WINDOW,i,c,!1);const B=Math.max(((T=n==null?void 0:n.timestamp)!==null&&T!==void 0?T:0)-((P=e==null?void 0:e.timestamp)!==null&&P!==void 0?P:0),0);Object.assign(this.properties,Object.assign({action:Oe.SUBSCRIBE,node:(M=f==null?void 0:f.node)!==null&&M!==void 0?M:"",cluster:(L=f==null?void 0:f.cluster)!==null&&L!==void 0?L:"",window_size_ms:B,remote_participant_id:l},((U,F,q,Y,z,re,ue,le)=>{var ve,be,ye,pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt,qt,On,pn,un,sn,tn,ln,Pn,Xt,dr,wi,hi,vo,yo,Ii,Xo,Po,Qo,Ca,qi,Xs,zc,cs,Qs,qc,Zs,ec,Kc,tc,nc,rc;let Rd=0,wd=0;if(U!=null&&U.jitterBufferEmittedCount&&(F!=null&&F.jitterBufferEmittedCount)&&U.jitterBufferEmittedCount>F.jitterBufferEmittedCount){U!=null&&U.jitterBufferDelay&&(F!=null&&F.jitterBufferDelay)&&(Rd=(U.jitterBufferDelay-F.jitterBufferDelay)/(U.jitterBufferEmittedCount-F.jitterBufferEmittedCount));const mf=F==null?void 0:F.jitterBufferMinimumDelay,gf=U==null?void 0:U.jitterBufferMinimumDelay;mf&&gf&&(wd=(gf-mf)/(U.jitterBufferEmittedCount-F.jitterBufferEmittedCount))}const Id=Math.max(((ve=U==null?void 0:U.bytesReceived)!==null&&ve!==void 0?ve:0)-((be=F==null?void 0:F.bytesReceived)!==null&&be!==void 0?be:0),0),kd=typeof z!="number"?1:z/1e3,Nh=8*Id/kd,Lh=Math.max(((ye=U==null?void 0:U.totalDecodeTime)!==null&&ye!==void 0?ye:0)-((pe=F==null?void 0:F.totalDecodeTime)!==null&&pe!==void 0?pe:0),0),Bh=Math.max(((Re=U==null?void 0:U.framesDecoded)!==null&&Re!==void 0?Re:0)-((Me=F==null?void 0:F.framesDecoded)!==null&&Me!==void 0?Me:0),0),jh=Lh/Math.max(Bh,1),jl=Math.max(((Le=U==null?void 0:U.packetsLost)!==null&&Le!==void 0?Le:0)-((Ae=F==null?void 0:F.packetsLost)!==null&&Ae!==void 0?Ae:0),0),Od=Math.max(((Pe=U==null?void 0:U.packetsReceived)!==null&&Pe!==void 0?Pe:0)-((qe=F==null?void 0:F.packetsReceived)!==null&&qe!==void 0?qe:0),0),Uh=jl/Math.max(Od+jl,1),ic=li(Y==null?void 0:Y.mimeType,Y==null?void 0:Y.sdpFmtpLine),Ep=8*(le||0)/kd;return{bytes_received:Id,codec_mime_type:ic==null?void 0:ic.mimeSubtype,codec_profile:ic==null?void 0:ic.profile,codec_level:ic==null?void 0:ic.level,connection_bandwidth:(Bt=(gt=q==null?void 0:q.candidatePair)===null||gt===void 0?void 0:gt.availableIncomingBitrate)!==null&&Bt!==void 0?Bt:0,decode_bitrate:Nh,decoder_implementation:(Ft=U==null?void 0:U.decoderImplementation)!==null&&Ft!==void 0?Ft:"unknown",fir_count:Math.max(((Lt=U==null?void 0:U.firCount)!==null&&Lt!==void 0?Lt:0)-((qt=F==null?void 0:F.firCount)!==null&&qt!==void 0?qt:0),0),fraction_packets_lost:Uh,frame_decode_time_avg:jh,frame_height:Math.max((On=U==null?void 0:U.frameHeight)!==null&&On!==void 0?On:0,0),frame_width:Math.max((pn=U==null?void 0:U.frameWidth)!==null&&pn!==void 0?pn:0,0),frames_decoded:Math.max(((un=U==null?void 0:U.framesDecoded)!==null&&un!==void 0?un:0)-((sn=F==null?void 0:F.framesDecoded)!==null&&sn!==void 0?sn:0),0),frames_dropped:Math.max(((tn=U==null?void 0:U.framesDropped)!==null&&tn!==void 0?tn:0)-((ln=F==null?void 0:F.framesDropped)!==null&&ln!==void 0?ln:0),0),frames_received:Math.max(((Pn=U==null?void 0:U.framesReceived)!==null&&Pn!==void 0?Pn:0)-((Xt=F==null?void 0:F.framesReceived)!==null&&Xt!==void 0?Xt:0),0),freeze_count:Math.max(((dr=U==null?void 0:U.freezeCount)!==null&&dr!==void 0?dr:0)-((wi=F==null?void 0:F.freezeCount)!==null&&wi!==void 0?wi:0),0),frames_rendered:Math.max((hi=U==null?void 0:U.framesRendered)!==null&&hi!==void 0?hi:0,0),frames_per_second:Math.max((vo=U==null?void 0:U.framesPerSecond)!==null&&vo!==void 0?vo:0,0),header_bytes_received:Math.max(((yo=U==null?void 0:U.headerBytesReceived)!==null&&yo!==void 0?yo:0)-((Ii=F==null?void 0:F.headerBytesReceived)!==null&&Ii!==void 0?Ii:0),0),configured_jitter_buffer_min_delay_ms:re??0,jitter_buffer_min_obtainable_delay:wd,jitter_buffer_delay_avg:Rd,key_frames_decoded:Math.max(((Xo=U==null?void 0:U.keyFramesDecoded)!==null&&Xo!==void 0?Xo:0)-((Po=F==null?void 0:F.keyFramesDecoded)!==null&&Po!==void 0?Po:0),0),nack_count:Math.max(((Qo=U==null?void 0:U.nackCount)!==null&&Qo!==void 0?Qo:0)-((Ca=F==null?void 0:F.nackCount)!==null&&Ca!==void 0?Ca:0),0),packets_discarded:Math.max(((qi=U==null?void 0:U.packetsDiscarded)!==null&&qi!==void 0?qi:0)-((Xs=F==null?void 0:F.packetsDiscarded)!==null&&Xs!==void 0?Xs:0),0),packets_lost:jl,packets_received:Od,pause_count:Math.max(((zc=U==null?void 0:U.pauseCount)!==null&&zc!==void 0?zc:0)-((cs=F==null?void 0:F.pauseCount)!==null&&cs!==void 0?cs:0),0),pli_count:Math.max(((Qs=U==null?void 0:U.pliCount)!==null&&Qs!==void 0?Qs:0)-((qc=F==null?void 0:F.pliCount)!==null&&qc!==void 0?qc:0),0),power_efficient_decoder:(Zs=U==null?void 0:U.powerEfficientDecoder)!==null&&Zs!==void 0&&Zs,total_freezes_duration:Math.max(((ec=U==null?void 0:U.totalFreezesDuration)!==null&&ec!==void 0?ec:0)-((Kc=F==null?void 0:F.totalFreezesDuration)!==null&&Kc!==void 0?Kc:0),0),total_pauses_duration:Math.max(((tc=U==null?void 0:U.totalPausesDuration)!==null&&tc!==void 0?tc:0)-((nc=F==null?void 0:F.totalPausesDuration)!==null&&nc!==void 0?nc:0),0),sei_read_count:ue,sei_bytes_received:le,sei_bitrate:Ep,protocol:(rc=q==null?void 0:q.localCandidate)===null||rc===void 0?void 0:rc.protocol}})(n,e,t,o,B,s,h,y)))}}class wo extends Et{constructor(i,c,l,f,n,e,t,o,s){var h,y;super(et.SUBSCRIBED_AUDIO_STATS,i,c,!1),Object.assign(this.properties,Object.assign({action:Oe.SUBSCRIBE,node:(h=f==null?void 0:f.node)!==null&&h!==void 0?h:"",cluster:(y=f==null?void 0:f.cluster)!==null&&y!==void 0?y:"",remote_participant_id:l},((T,P,M,L,B)=>{var U,F,q,Y,z,re,ue,le,ve,be,ye,pe,Re,Me,Le,Ae,Pe,qe;let gt=0;T!=null&&T.jitterBufferDelay&&(T!=null&&T.jitterBufferEmittedCount)&&T.jitterBufferEmittedCount>0&&(gt=T.jitterBufferDelay/T.jitterBufferEmittedCount);const Bt=L??1,Ft=Math.max((U=T==null?void 0:T.bytesReceived)!==null&&U!==void 0?U:0,0),Lt=8*Ft/Bt,qt=Math.max((F=T==null?void 0:T.packetsLost)!==null&&F!==void 0?F:0,0),On=Math.max((q=T==null?void 0:T.packetsReceived)!==null&&q!==void 0?q:0,0),pn=qt/Math.max(On+qt,1),un=Math.max((Y=T==null?void 0:T.concealedSamples)!==null&&Y!==void 0?Y:0,0),sn=Math.max((z=T==null?void 0:T.totalSamplesReceived)!==null&&z!==void 0?z:0,0),tn=un/Math.max(sn,1),ln=li(M==null?void 0:M.mimeType,M==null?void 0:M.sdpFmtpLine);return{audio_level:(re=T==null?void 0:T.audioLevel)!==null&&re!==void 0?re:0,audio_nacks_enabled:(ue=B==null?void 0:B.audioNacks)!==null&&ue!==void 0&&ue,bytes_received:Ft,codec_mime_type:ln==null?void 0:ln.mimeSubtype,connection_bandwidth:(ve=(le=P==null?void 0:P.candidatePair)===null||le===void 0?void 0:le.availableIncomingBitrate)!==null&&ve!==void 0?ve:0,concealed_samples:un,concealment_events:Math.max((be=T==null?void 0:T.concealmentEvents)!==null&&be!==void 0?be:0,0),silent_concealed_samples:Math.max((ye=T==null?void 0:T.silentConcealedSamples)!==null&&ye!==void 0?ye:0,0),decode_bitrate:Lt,fraction_audio_concealed:tn,fraction_packets_lost:pn,header_bytes_received:Math.max((pe=T==null?void 0:T.headerBytesReceived)!==null&&pe!==void 0?pe:0,0),inserted_samples_for_deceleration:Math.max((Re=T==null?void 0:T.insertedSamplesForDeceleration)!==null&&Re!==void 0?Re:0,0),jitter_buffer_delay_avg:gt,packets_discarded:Math.max((Me=T==null?void 0:T.packetsDiscarded)!==null&&Me!==void 0?Me:0,0),retransmitted_packets_received:Math.max((Le=T==null?void 0:T.retransmittedPacketsReceived)!==null&&Le!==void 0?Le:0,0),retransmitted_bytes_received:Math.max((Ae=T==null?void 0:T.retransmittedBytesReceived)!==null&&Ae!==void 0?Ae:0,0),packets_lost:qt,packets_received:On,nack_count:Math.max((Pe=T==null?void 0:T.nackCount)!==null&&Pe!==void 0?Pe:0,0),removed_samples_for_acceleration:Math.max((qe=T==null?void 0:T.removedSamplesForAcceleration)!==null&&qe!==void 0?qe:0,0),total_samples_received:sn}})(n,e,t,o,s)))}}class Io extends Et{constructor(i,c,l,f,n,e,t,o,s,h){var y,T,P,M;super(et.SUBSCRIBED_AUDIO_STATS_WINDOW,i,c,!1);const L=Math.max(((y=n==null?void 0:n.timestamp)!==null&&y!==void 0?y:0)-((T=e==null?void 0:e.timestamp)!==null&&T!==void 0?T:0),0);Object.assign(this.properties,Object.assign({action:Oe.SUBSCRIBE,window_size_ms:L,node:(P=f==null?void 0:f.node)!==null&&P!==void 0?P:"",cluster:(M=f==null?void 0:f.cluster)!==null&&M!==void 0?M:"",remote_participant_id:l},((B,U,F,q,Y,z,re)=>{var ue,le,ve,be,ye,pe,Re,Me,Le,Ae,Pe,qe,gt,Bt,Ft,Lt,qt,On,pn,un,sn,tn,ln,Pn,Xt,dr,wi,hi,vo,yo,Ii,Xo,Po;let Qo=0,Ca=0;if(B!=null&&B.jitterBufferEmittedCount&&(U!=null&&U.jitterBufferEmittedCount)&&B.jitterBufferEmittedCount>U.jitterBufferEmittedCount){B!=null&&B.jitterBufferDelay&&(U!=null&&U.jitterBufferDelay)&&(Qo=(B.jitterBufferDelay-U.jitterBufferDelay)/(B.jitterBufferEmittedCount-U.jitterBufferEmittedCount));const nc=U==null?void 0:U.jitterBufferMinimumDelay,rc=B==null?void 0:B.jitterBufferMinimumDelay;nc&&rc&&(Ca=(rc-nc)/(B.jitterBufferEmittedCount-U.jitterBufferEmittedCount))}const qi=typeof Y!="number"?1:Y/1e3,Xs=Math.max(((ue=B==null?void 0:B.bytesReceived)!==null&&ue!==void 0?ue:0)-((le=U==null?void 0:U.bytesReceived)!==null&&le!==void 0?le:0),0),zc=8*Xs/qi,cs=Math.max(((ve=B==null?void 0:B.packetsLost)!==null&&ve!==void 0?ve:0)-((be=U==null?void 0:U.packetsLost)!==null&&be!==void 0?be:0),0),Qs=Math.max(((ye=B==null?void 0:B.packetsReceived)!==null&&ye!==void 0?ye:0)-((pe=U==null?void 0:U.packetsReceived)!==null&&pe!==void 0?pe:0),0),qc=cs/Math.max(Qs+cs,1),Zs=Math.max(((Re=B==null?void 0:B.concealedSamples)!==null&&Re!==void 0?Re:0)-((Me=U==null?void 0:U.concealedSamples)!==null&&Me!==void 0?Me:0),0),ec=Math.max(((Le=B==null?void 0:B.totalSamplesReceived)!==null&&Le!==void 0?Le:0)-((Ae=U==null?void 0:U.totalSamplesReceived)!==null&&Ae!==void 0?Ae:0),0),Kc=Zs/Math.max(ec,1),tc=li(q==null?void 0:q.mimeType,q==null?void 0:q.sdpFmtpLine);return{audio_level:(Pe=B==null?void 0:B.audioLevel)!==null&&Pe!==void 0?Pe:0,audio_nacks_enabled:(qe=z==null?void 0:z.audioNacks)!==null&&qe!==void 0&&qe,bytes_received:Xs,codec_mime_type:tc==null?void 0:tc.mimeSubtype,connection_bandwidth:(Bt=(gt=F==null?void 0:F.candidatePair)===null||gt===void 0?void 0:gt.availableIncomingBitrate)!==null&&Bt!==void 0?Bt:0,decode_bitrate:zc,concealed_samples:Zs,concealment_events:Math.max(((Ft=B==null?void 0:B.concealmentEvents)!==null&&Ft!==void 0?Ft:0)-((Lt=U==null?void 0:U.concealmentEvents)!==null&&Lt!==void 0?Lt:0),0),silent_concealed_samples:Math.max(((qt=B==null?void 0:B.silentConcealedSamples)!==null&&qt!==void 0?qt:0)-((On=U==null?void 0:U.silentConcealedSamples)!==null&&On!==void 0?On:0),0),fraction_audio_concealed:Kc,fraction_packets_lost:qc,header_bytes_received:Math.max(((pn=B==null?void 0:B.headerBytesReceived)!==null&&pn!==void 0?pn:0)-((un=U==null?void 0:U.headerBytesReceived)!==null&&un!==void 0?un:0),0),inserted_samples_for_deceleration:Math.max(((sn=B==null?void 0:B.insertedSamplesForDeceleration)!==null&&sn!==void 0?sn:0)-((tn=U==null?void 0:U.insertedSamplesForDeceleration)!==null&&tn!==void 0?tn:0),0),configured_jitter_buffer_min_delay_ms:re??0,jitter_buffer_min_obtainable_delay:Ca,jitter_buffer_delay_avg:Qo,packets_discarded:Math.max(((ln=B==null?void 0:B.packetsDiscarded)!==null&&ln!==void 0?ln:0)-((Pn=U==null?void 0:U.packetsDiscarded)!==null&&Pn!==void 0?Pn:0),0),packets_lost:cs,packets_received:Qs,nack_count:Math.max(((Xt=B==null?void 0:B.nackCount)!==null&&Xt!==void 0?Xt:0)-((dr=U==null?void 0:U.nackCount)!==null&&dr!==void 0?dr:0),0),removed_samples_for_acceleration:Math.max(((wi=B==null?void 0:B.removedSamplesForAcceleration)!==null&&wi!==void 0?wi:0)-((hi=U==null?void 0:U.removedSamplesForAcceleration)!==null&&hi!==void 0?hi:0),0),retransmitted_packets_received:Math.max(((vo=B==null?void 0:B.retransmittedPacketsReceived)!==null&&vo!==void 0?vo:0)-((yo=U==null?void 0:U.retransmittedPacketsReceived)!==null&&yo!==void 0?yo:0),0),retransmitted_bytes_received:Math.max(((Ii=B==null?void 0:B.retransmittedBytesReceived)!==null&&Ii!==void 0?Ii:0)-((Xo=U==null?void 0:U.retransmittedBytesReceived)!==null&&Xo!==void 0?Xo:0),0),total_samples_received:ec,protocol:(Po=F==null?void 0:F.localCandidate)===null||Po===void 0?void 0:Po.protocol}})(n,e,t,o,L,s,h)))}}class js extends Et{constructor(i,c,l,f,n=Oe.PUBLISH,e=!1,t=""){super(et.SIMULCAST_LAYER_INFO,i,c,!1),Object.assign(this.properties,{rid:l,active:f,selected:e,source:n===Oe.PUBLISH?"publisher":"subscriber",remote_participant_id:t})}}const Us=u=>{console.warn(`[IVS Stages] ${u}`)};var Ja,ei,Tr;(function(u){u.Mobile="mobile",u.Tablet="tablet",u.Desktop="desktop",u.Tv="tv"})(Ja||(Ja={})),function(u){u.IOS="iOS",u.MacOS="macOS",u.Windows="Windows",u.Android="Android"}(ei||(ei={})),function(u){u.Safari="Safari",u.Firefox="Firefox",u.Chrome="Chrome",u.IE="Internet Explorer",u.Edge="Microsoft Edge"}(Tr||(Tr={}));const ko=function(u){const i=Vi(u);return{platform:{isMobile:zo(Ja.Mobile,i),isTablet:zo(Ja.Tablet,i),isDesktop:zo(Ja.Desktop,i),isTv:zo(Ja.Tv,i)},os:{name:st(i),version:qo(i),isIOS:ot(ei.IOS,i),isMacOS:ot(ei.MacOS,i),isWindows:ot(ei.Windows,i),isAndroid:ot(ei.Android,i)},browser:{name:Ko(i),version:Fs(i),isSafari:Ti(Tr.Safari,i),isFirefox:Ti(Tr.Firefox,i),isChrome:Ti(Tr.Chrome,i),isIE:Ti(Tr.IE,i),isEdge:Ti(Tr.Edge,i)}}}(window.navigator.userAgent);function Vi(u){try{return au.getParser(u||window.navigator.userAgent)}catch{}}function zo(u,i){return()=>(i||(i=Vi()),!(!i||i.getPlatformType(!0)!==u.toLowerCase()))}function qo(u){return()=>(u||(u=Vi()),u&&u.getOSVersion()||"")}function st(u){return()=>(u||(u=Vi()),u&&u.getOSName()||"")}function ot(u,i){return()=>(i||(i=Vi()),!(!i||i.getOSName(!0)!==u.toLowerCase()))}function Fs(u){return()=>(u||(u=Vi()),u&&u.getBrowserVersion()||"")}function Ko(u){return()=>(u||(u=Vi()),u&&u.getBrowserName()||"")}function Ti(u,i){return()=>(i||(i=Vi()),!(!i||i.getBrowserName().toLowerCase()!==u.toLowerCase()))}const Lc={name:"SimulcastUnsupported",message:`Simulcast is only supported on Chromium browsers at bitrates over ${Wo.MID.maxBitrateKbps}Kbps`,code:100},Wn={name:"SimulcastLayerInvalidType",message:"Layer configuration is invalid: ",code:101},mr={name:"SimulcastMaxLayersExceeded",message:"No more than 3 simulcast layers may be configured",code:102},Iu={name:"SimulcastDuplicateLayersConfigured",message:"Two duplicate layers are configured. At minimum bitrate, framerate, or dimensions must differ",code:103},El={name:"SimulcastMaxLayerBitrateExceeded",message:`maxBitrateKbps cannot exceed ${$i} Kbps`,code:105},Oo={name:"SimulcastMinLayerBitrateExceeded",message:`maxBitrateKbps cannot be less than ${_o} Kbps`,code:106},Ln={name:"SimulcastMaxLayerFramerateExceeded",message:`maxFramerate cannot exceed ${pr} fps`,code:107},gr={name:"SimulcastMinLayerFramerateExceeded",message:`maxFramerate cannot be less than ${Go} fps`,code:108},Xa={name:"SimulcastMaxLayerDimensionsExceeded",message:`dimensions cannot exceed max resolution of ${Ci}x720`,code:109},ku={name:"SimulcastMinLayerDimensionsExceeded",message:`width or height cannot be lower than ${uo}`,code:110},Qa={name:"SimulcastLayerConfigurationConflict",message:"Layer configuration conflict: ",code:111},Za={name:"SimulcastLayerOrientationMismatch",message:"Layer orientation different from input video track: ",code:112},Ou={name:"SimulcastLayerInputResolutionInsufficient",message:"Input video resolution is lower than the configured layer: ",code:113},Au={name:"SimulcastLayerInputFramerateInsufficient",message:"Input video framerate is lower than the configured layer: ",code:114};class rr extends Error{constructor({name:i,message:c,code:l,details:f,cause:n,params:e}){super(c),Error.captureStackTrace&&Error.captureStackTrace(this,rr),this.name=i,this.message=c,this.code=l,this.details=f,this.cause=n,this.params=e}}const $s=u=>({rid:u.rid,active:u.active,scaleResolutionDownBy:u.scaleFactor,maxBitrate:u.maxBitrateBps,maxFramerate:u.maxFramerate}),Pu=(u,i)=>u.width*u.height>i.width*i.height||u.maxBitrateKbps>i.maxBitrateKbps||u.maxFramerate>i.maxFramerate?1:es(u,i)?0:-1,es=(u,i)=>{if(typeof u!="object"||typeof i!="object")return!1;const c=Object.keys(u);for(const l of c)if(u[l]!==i[l])return!1;return!0},ga=u=>{const{width:i,height:c}=Vs(u);return i*c},Vs=u=>{const{height:i,width:c}=u;let l=Ci/xc,f=Ci;return i!==void 0&&(l=i),c!==void 0&&(f=c),i&&!c&&(f=i*xc),!i&&c&&(l=c/xc),{height:l,width:f}},xu=u=>{const{width:i,height:c}=u;return i/c>=1?Vo.LANDSCAPE:Vo.PORTRAIT},Ao=(u,i,c)=>{var l;const f=(l=u.getSettings().frameRate)!==null&&l!==void 0?l:pr;return Object.assign(Object.assign({},c),{active:!0,height:i.height,width:i.width,maxBitrateBps:Ei(i.maxBitrateKbps),maxFramerate:Math.min(i.maxFramerate,f),scaleFactor:Ws(i,u)})},Ws=(u,i)=>{const c=ga(i.getSettings()),l=ga(u);if(l>=c)return 1;const f=1/Math.sqrt(l/c);return Math.max(f,1)},Du=u=>{if(typeof u!="object"){const i=Object.assign({},Wn);throw i.message+=" is not an object",new rr(i)}},lo=(u,i)=>{if(typeof u!="number"){const c=Object.assign({},Wn);throw c.message+="maxBitrateKbps is not a number",new rr(c)}if(u<_o)throw new rr(Object.assign({},Oo));if(u>$i)throw new rr(Object.assign({},El));if(i&&u>i){const c=Object.assign({},Qa);throw c.message+=`maxBitrateKbps cannot be greater than stage maxVideoBitrateKbps of ${i}`,new rr(c)}},Br=(u,i)=>{if(typeof u!="number"){const c=Object.assign({},Wn);throw c.message+="maxFramerate is not a number",new rr(c)}if(u<Go)throw new rr(Object.assign({},gr));if(u>pr)throw new rr(Object.assign({},Ln));if(i&&u>i){const c=Object.assign({},Qa);throw c.message+=`maxFramerate cannot be greater than stage maxFramerate of ${i} `,new rr(c)}},va=(u,i)=>{var c;if(typeof u!="number"||typeof i!="number"){const n=Object.assign({},Wn);throw n.message+="width and height must be numbers",new rr(n)}if(u<uo||i<uo)throw new rr(Object.assign({},ku));const l=(c=jn("enable1080pResolution"))!==null&&c!==void 0&&c,f=l?1920:Ci;if(u>f||i>f)throw new rr(Object.assign({},Xa));if(u*i>(l?2073600:Ho))throw new rr(Object.assign({},Xa))},ad=(u,i)=>{const c=Vs(i.getSettings()),l=xu(c);l!==xu(u)&&Us(`${Za.message}forcing orientation to ${l}`)},mh=(u,i)=>{var c,l,f,n,e;let t=(0,Sn.cloneDeep)(i);const o=(c=t.simulcast)!==null&&c!==void 0?c:{},s=!ko.browser.isChrome()&&!ko.browser.isEdge(),h=(f=(l=u.getSettings())===null||l===void 0?void 0:l.displaySurface)!==null&&f!==void 0&&f,y=(n=t.maxVideoBitrateKbps)!==null&&n!==void 0?n:$i,T=!(Array.isArray((e=i.simulcast)===null||e===void 0?void 0:e.layers)||!i.maxVideoBitrateKbps)&&y<Wo.MID.maxBitrateKbps;if(typeof o.enabled=="boolean"&&o.enabled&&(s||h||T)){t.simulcast={enabled:!1};const{name:P,message:M}=Lc;Us(`${P}${M}, disabling the feature`)}return t=((P,M)=>{var L,B;const U=M,F=(L=M.simulcast)===null||L===void 0?void 0:L.layers;if(F===void 0)return U;if(!Array.isArray(F)){const q=Object.assign({},Wn);throw q.message+=" layers is not an array",new rr(q)}if(F.length===0)return(B=U.simulcast)===null||B===void 0||delete B.layers,U;if(F.length>3)throw new rr(Object.assign({},mr));if((0,Sn.uniqWith)(F,es).length!==F.length)throw new rr(Object.assign({},Iu));for(const q of F)Du(q),lo(q.maxBitrateKbps,M.maxVideoBitrateKbps),Br(q.maxFramerate,M.maxFramerate),va(q.width,q.height),ad(q,P);return U})(u,t),t};function _l(u){return u.track.kind===_t.AUDIO}function Mu(u){return u.track.kind===_t.VIDEO&&typeof u.config=="object"}function Nu(u){if(u!==void 0&&(u<_o||u>$i))throw new Error(`Stage bitrate must be a number between ${_o} kbps and ${$i} kbps inclusive`)}function Bc(u){return u!==void 0&&("maxBitrate"in u||"maxVideoBitrateKbps"in u||"maxFramerate"in u||"simulcast"in u||"inBandMessaging"in u||"minBitrate"in u)}function Cl(u,i){if(i===void 0)return i;let c=(0,Sn.cloneDeep)(i);return Bc(c)?(c.maxBitrate!==void 0&&(c.maxVideoBitrateKbps=c.maxBitrate,Us("maxBitrate is deprecated in favor of maxVideoBitrateKbps")),c=mh(u,c),Nu(c.maxVideoBitrateKbps),Nu(c.minBitrate),function(l){if(l!==void 0&&(l>pr||l<Go))throw new Error(`Stage framerate must be between ${Go} fps and ${pr} fps inclusive`)}(c.maxFramerate),function(l){if(l!==void 0){if(typeof l!="object")throw new Error("In-band messaging config must be an object");if(typeof l.enabled!="boolean")throw new Error("In-band messaging config enabled property must be a boolean")}}(c.inBandMessaging)):(function(l){if(l!==void 0&&(l<qa||l>ma))throw new Error(`Stage audio bitrate must be between ${qa} Kbps and ${ma} Kbps inclusive`)}(c.maxAudioBitrateKbps),function(l){if(l!==void 0&&typeof l!="boolean")throw new Error("Stage stereo prop must be a boolean")}(c.stereo)),c}const sd=(u,i,c)=>{var l;const f={[Xr.HI]:za(Xr.HI),[Xr.MID]:za(Xr.MID),[Xr.LOW]:za(Xr.LOW)},n=i.simulcast,e=c==null?void 0:c.simulcast;let t=n.layers.sort(Pu);const o=(l=e==null?void 0:e.layers)!==null&&l!==void 0?l:[],s=t.length,h=o.length;return t=t.map(y=>{((P,M)=>{const{width:L,height:B}=Vs(M.getSettings()),{width:U,height:F}=P;if(U*F>L*B){const q=`forcing layer of ${U}x${F} to the input dimensions ${L}x${B}`,{name:Y,message:z}=Ou;Us(`${Y}${z}${q}`)}})(y,u),((P,M)=>{var L;const B=(L=M.getSettings().frameRate)!==null&&L!==void 0?L:pr,U=P.maxFramerate;if(U>B){const F=`forcing layer of ${U}fps to the input framerate of ${B}`,{name:q,message:Y}=Au;Us(`${q}${Y}${F}`)}})(y,u);let T=((P,M)=>{const{maxVideoBitrateKbps:L}=M,B=P;return L&&P.maxBitrateKbps>L&&(B.maxBitrateKbps=L),B})(y,i);return T=((P,M)=>{const{maxFramerate:L}=M,B=P;return L&&P.maxFramerate>L&&(B.maxFramerate=L),B})(y,i),T}),(h===0||h===3)&&s===3?(f.hi=Ao(u,t[2],f.hi),f.mid=Ao(u,t[1],f.mid),f.low=Ao(u,t[0],f.low),Ue.ok(f)):h===1&&s===1?(f.hi=Ao(u,t[0],f.hi),Ue.ok(f)):h===2&&s===2?(f.hi=Ao(u,t[1],f.hi),f.low=Ao(u,t[0],f.low),Ue.ok(f)):Ue.err(null)},gh=(u,i,c)=>{const l=i.simulcast,f=i.inBandMessaging,n=Ei(i.minBitrate),e=Ei(i.maxVideoBitrateKbps),t=i.maxFramerate;let o=[{maxBitrate:e,maxFramerate:t}];const s=sd(u,i,c??{});return l.enabled&&s.ok&&(o=(h=>{const{hi:y,mid:T,low:P}=h;return[$s(P),$s(T),$s(y)]})(s.value)),{track:u,config:{minBitrateBps:n,maxBitrateBps:e,maxFramerate:t,inBandMessagingEnabled:f.enabled,simulcastEnabled:l.enabled,simulcastLayers:s.ok?s.value:void 0,encodingLayers:o}}},cd=u=>{const i=u.mediaStreamTrack,c=u.normalizedConfig;let l={};const f=u.validatedExternalConfig;return Bc(f)&&(l=f),function(n){return n.kind===_t.AUDIO}(i)?((n,e)=>{const t={maxBitrateBps:Ei(e.maxAudioBitrateKbps)},o=e==null?void 0:e.stereo;return typeof o=="boolean"&&(t.stereo=o),{track:n,config:t}})(i,c):gh(i,c,l)},Wi=(u,i)=>{const c={minBitrate:_o,maxBitrate:$i,maxVideoBitrateKbps:$i,maxFramerate:pr,simulcast:{enabled:!1,layers:[Object.assign({},Wo.HI),Object.assign({},Wo.MID),Object.assign({},Wo.LOW)]},maxAudioBitrateKbps:Tu,stereo:!1,inBandMessaging:{enabled:!1}},l=(0,Sn.cloneDeep)(i),f=Object.assign(Object.assign({},c),l);return Bc(l)&&(l.simulcast&&(f.simulcast=Object.assign(Object.assign({},c.simulcast),l.simulcast)),l.inBandMessaging&&(f.inBandMessaging=Object.assign(Object.assign({},c.inBandMessaging),l.inBandMessaging))),f},ti=(u,i)=>{if(typeof u=="number")return u;const c=i?gl:vl;return c[u]!==void 0?c[u]:0};class ud extends Et{constructor(i,c,l,f){super(et.MULTIHOST_CONFIGURATION,i,c,!1),Object.assign(this.properties,Object.assign(Object.assign({},l),{action:f}))}}class ld extends Et{constructor(i,c,l,f,n){super(et.MULTIHOST_SUBSCRIBE_CONFIGURATION,i,c,!1);const e={trigger:l,remote_participant_id:f,min_delay_when_publishing:ti(n.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:ti(n.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:n.inBandMessaging.enabled,simulcast_initial_layer_preference:n.simulcast.initialLayerPreference,simulcast_layer_poll_interval_ms:n.simulcast.layerPollingIntervalMs,simulcast_layer_poll_enabled:n.simulcast.layerPollingEnabled};Object.assign(this.properties,e)}}var ts=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Gs{constructor(i,c,l,f,n){this.analyticsTracker=n,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new kt(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=Gs.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.seiStats={seiReadCnt:0,seiBytesRead:0,seiWriteCnt:0,seiBytesWritten:0},this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0},this.vidNetworkQualityMap=new Map,this.audioNetworkQualityMap=new Map,this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case Je.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case Je.FAILED:this.flushStats()}},this.action=i,this.token=c,this.traceId=l,this.identifier=f}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:Ei(ma),hi_video_layer:"",mid_video_layer:"",low_video_layer:""}}set sdpAnswer(i){try{this.sdp=new kt(i),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(i,c=!1){this.peerConnection=i,this.simulcastEnabled=c,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var i;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(i=this.peerConnection)===null||i===void 0||i.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(i){this.sfuResource=i}updateMultihostConfiguration(i,c){var l,f,n,e,t,o,s,h,y;return ts(this,void 0,void 0,function*(){if(this.action!==Oe.PUBLISH||!this.peerConnection)return;const T=Gs.defaultMultihostConfiguration();if(c){const P=this.peerConnection.getSenders().filter(B=>B.track!==null&&B.track.kind==="video");let M="unknown";P.length>0&&(yield P[0].getStats()).forEach(B=>{if(B.type==="codec"&&(T.video_codec=B.mimeType,B.sdpFmtpLine)){const U=B.sdpFmtpLine.match(/profile-level-id=([a-f0-9]+)/);U&&U.length>0&&(M=U[1])}});const L=c.track.getSettings();T.width=(l=L.width)!==null&&l!==void 0?l:0,T.height=(f=L.height)!==null&&f!==void 0?f:0,T.target_fps=(n=L.frameRate)!==null&&n!==void 0?n:0,c.config?(T.max_bitrate=c.config.maxBitrateBps,T.min_bitrate=c.config.minBitrateBps,T.enable_simulcast=c.config.simulcastEnabled):(T.max_bitrate=Ei($i),T.min_bitrate=Ei(_o),T.enable_simulcast=!1),c.config.simulcastEnabled&&(T.hi_video_layer=this.mapLayerToMetric(M,(e=c.config.simulcastLayers)===null||e===void 0?void 0:e.hi),T.mid_video_layer=this.mapLayerToMetric(M,(t=c.config.simulcastLayers)===null||t===void 0?void 0:t.mid),T.low_video_layer=this.mapLayerToMetric(M,(o=c.config.simulcastLayers)===null||o===void 0?void 0:o.low))}if(i){const P=i.track.getSettings();T.auto_gain=(s=P.autoGainControl)!==null&&s!==void 0&&s,T.echo_cancellation=(h=P.echoCancellation)!==null&&h!==void 0&&h,T.noise_suppression=(y=P.noiseSuppression)!==null&&y!==void 0&&y,T.max_audio_bitrate_bps=i.config.maxBitrateBps,T.stereo=i.config.stereo}(0,Sn.isEqual)(T,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new ud(this.token,this.traceId,T,this.action)),this.multihostConfiguration=T)})}resetTransformers(i,c){this.senderVideoTransformer=c,this.receiveVideoTransformer=i,this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0}}getStats(i){var c;return ts(this,void 0,void 0,function*(){const l=yield(c=this.peerConnection)===null||c===void 0?void 0:c.getStats(i),{action:f}=this;if(l)if(i.kind==="audio"){if(f===Oe.PUBLISH)return{action:f,rawReport:l,stats:yl(l,this.audioNetworkQualityMap)};if(f===Oe.SUBSCRIBE)return{action:f,rawReport:l,stats:Ka(l,this.audioNetworkQualityMap)}}else{if(f===Oe.PUBLISH)return{action:f,rawReport:l,stats:bl(l,this.vidNetworkQualityMap)};if(f===Oe.SUBSCRIBE)return{action:f,rawReport:l,stats:Ro(l,this.vidNetworkQualityMap)}}})}mapLayerToMetric(i,c){return!c||!c.active?"":`${`${c.height}x${c.width}`}_${`${c.maxFramerate}fps`}_${c.maxBitrateBps/1e3+"kbps"}_${i}`}updateJitterBufferMinDelay(i){this.jitterBufferMinDelayInMs=i}setupIntervals(){this.action===Oe.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(i,c){return setInterval(i.bind(this),c)}getConnectionState(){var i;if(!this.peerConnection)return Je.NONE;const c=(i=this.peerConnection.connectionState)!==null&&i!==void 0?i:this.peerConnection.iceConnectionState;try{return Ps(c)}catch{return Je.IDLE}}pollSimulcastLayers(){var i;return ts(this,void 0,void 0,function*(){if(this.getConnectionState()===Je.CONNECTED){const c=yield(i=this.peerConnection)===null||i===void 0?void 0:i.getStats();if(!c)return;c.forEach(l=>{var f;if(l.type==="outbound-rtp"){const n=((f=l.framesPerSecond)!==null&&f!==void 0?f:0)!==0;switch(l.rid){case"low":n!==this.simulcastState.low&&(this.simulcastState.low=n,this.analyticsTracker.trackEventNoSharedProps(new js(this.token,this.traceId,l.rid,n)));break;case"mid":n!==this.simulcastState.mid&&(this.simulcastState.mid=n,this.analyticsTracker.trackEventNoSharedProps(new js(this.token,this.traceId,l.rid,n)));break;case"hi":n!==this.simulcastState.hi&&(this.simulcastState.hi=n,this.analyticsTracker.trackEventNoSharedProps(new js(this.token,this.traceId,l.rid,n)))}}})}})}flushStats(){var i;return ts(this,void 0,void 0,function*(){const c=yield(i=this.peerConnection)===null||i===void 0?void 0:i.getStats();c&&(this.action===Oe.PUBLISH?this.uploadPublisherStats(c):this.action===Oe.SUBSCRIBE&&this.uploadSubscriberStats(c))})}uploadStats(){var i;return ts(this,void 0,void 0,function*(){if(this.getConnectionState()===Je.CONNECTED){const c=yield(i=this.peerConnection)===null||i===void 0?void 0:i.getStats();if(!c)return;this.action===Oe.PUBLISH?this.uploadPublisherStats(c):this.action===Oe.SUBSCRIBE&&this.uploadSubscriberStats(c)}})}uploadPublisherStats(i){var c,l;const f={audio:{},video:[],candidateStats:{}},n=new Map,e=(Date.now()-this.connectionStartedTimestamp)/1e3,t=Object.assign({},this.multihostConfiguration),{seiWriteCnt:o,seiBytesWritten:s}=this.updateAndDiffSeiPublishStatsSinceLastUpdate((c=this.senderVideoTransformer)===null||c===void 0?void 0:c.getSenderStats());if(this.seiStats.seiWriteCnt+=o,this.seiStats.seiBytesWritten+=s,i.forEach(h=>{if(h.type==="outbound-rtp"){const y=i.get(h.remoteId),T=this.prevRemoteInboundStats.get(h.remoteId);switch(y&&this.prevRemoteInboundStats.set(y.id,y),h.kind){case"audio":f.audio=this.updateOutboundAudio(h),f.audio.remoteInbound=y,f.audio.prevRemoteInbound=T,f.audio.codec=n.get(h.codecId);break;case"video":f.video.push(Object.assign({},this.updateOutboundVideo(h),{remoteInbound:y,prevRemoteInbound:T,codec:n.get(h.codecId)}))}}h.type==="candidate-pair"&&h.nominated&&(f.candidateStats.candidatePair=h,f.candidateStats.localCandidate=i.get(h.localCandidateId),f.candidateStats.remoteCandidate=i.get(h.remoteCandidate)),h.type==="codec"&&n.set(h.id,h)}),f.video.forEach(h=>{var y,T;const{outbound:P,prevOutbound:M}=h;if(!P)return;const L=(T=(y=h.outbound)===null||y===void 0?void 0:y.rid)!==null&&T!==void 0?T:Mt;this.updateNetworkQualityPublish(L,this.vidNetworkQualityMap,P,M)}),f.audio.outbound){const h=(l=f.audio.outbound.rid)!==null&&l!==void 0?l:Mt;this.updateNetworkQualityPublish(h,this.audioNetworkQualityMap,f.audio.outbound,f.audio.prevOutbound)}this.analyticsTracker.trackEventNoSharedProps(new Nc(this.token,this.traceId,this.sfuResource,f.audio.outbound,f.audio.remoteInbound,f.candidateStats,f.audio.codec,t,e,this.sdpFeatures)),f.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new wu(this.token,this.traceId,this.sfuResource,f.audio.outbound,f.audio.prevOutbound,f.audio.remoteInbound,f.audio.prevRemoteInbound,f.candidateStats,f.audio.codec,t,this.sdpFeatures)),f.video.forEach(h=>{this.analyticsTracker.trackEventNoSharedProps(new Dc(this.token,this.traceId,this.sfuResource,h.outbound,h.remoteInbound,f.candidateStats,h.codec,t,e)),h.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new Mc(this.token,this.traceId,this.sfuResource,h.outbound,h.prevOutbound,h.remoteInbound,h.prevRemoteInbound,f.candidateStats,h.codec,t,this.seiStats.seiWriteCnt,this.seiStats.seiBytesWritten))})}updateNetworkQualityPublish(i,c,l,f){var n,e,t,o;let s=0;const h=Hr.getNetworkQuality(),y=(n=l.packetsSent)!==null&&n!==void 0?n:0,T=(e=l.nackCount)!==null&&e!==void 0?e:0;if(f)if(h===Zn.DOWN)c.set(i,Zn.DOWN);else{s=(T-((t=f==null?void 0:f.nackCount)!==null&&t!==void 0?t:0))/(y-((o=f==null?void 0:f.packetsSent)!==null&&o!==void 0?o:0));const P=this.convertLostRatioToQuality(s);c.set(i,P)}else c.set(i,h)}updateNetworkQualitySubscribe(i,c,l){var f,n,e,t;let o=0;const s=Hr.getNetworkQuality(),h=(f=c==null?void 0:c.packetsReceived)!==null&&f!==void 0?f:0,y=(n=c==null?void 0:c.nackCount)!==null&&n!==void 0?n:0;if(!c)return;const T=c.id;if(T)if(l)if(s===Zn.DOWN)i.set(T,Zn.DOWN);else{o=(y-((e=l==null?void 0:l.nackCount)!==null&&e!==void 0?e:0))/(h-((t=l==null?void 0:l.packetsReceived)!==null&&t!==void 0?t:0));const P=this.convertLostRatioToQuality(o);i.set(T,P)}else i.set(T,s)}uploadSubscriberStats(i){var c,l;const f={audio:{},video:{},candidateStats:{}},n=new Map,e=(Date.now()-this.connectionStartedTimestamp)/1e3,t=(c=this.jitterBufferMinDelayInMs)!==null&&c!==void 0?c:0,{seiReadCnt:o,seiBytesRead:s}=this.updateAndDiffSeiSubscribeStatsSinceLastUpdate((l=this.receiveVideoTransformer)===null||l===void 0?void 0:l.getReceiverStats());this.seiStats.seiReadCnt+=o,this.seiStats.seiBytesRead+=s,i.forEach(h=>{if(h.type==="inbound-rtp")switch(h.kind){case"audio":f.audio=this.updateInboundAudio(h),f.audio.codec=n.get(h.codecId),this.updateNetworkQualitySubscribe(this.audioNetworkQualityMap,f.audio.inbound,f.audio.prevInbound);break;case"video":f.video=this.updateInboundVideo(h),f.video.codec=n.get(h.codecId),this.updateNetworkQualitySubscribe(this.vidNetworkQualityMap,f.video.inbound,f.video.prevInbound)}h.type==="candidate-pair"&&h.nominated&&(f.candidateStats.candidatePair=h,f.candidateStats.localCandidate=i.get(h.localCandidateId),f.candidateStats.remoteCandidate=i.get(h.remoteCandidate)),h.type==="codec"&&n.set(h.id,h)}),this.analyticsTracker.trackEventNoSharedProps(new wo(this.token,this.traceId,this.identifier,this.sfuResource,f.audio.inbound,f.candidateStats,f.audio.codec,e,this.sdpFeatures)),f.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new Io(this.token,this.traceId,this.identifier,this.sfuResource,f.audio.inbound,f.audio.prevInbound,f.candidateStats,f.audio.codec,this.sdpFeatures,t)),this.analyticsTracker.trackEventNoSharedProps(new Sl(this.token,this.traceId,this.identifier,this.sfuResource,f.video.inbound,f.candidateStats,f.video.codec,e)),f.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new od(this.token,this.traceId,this.identifier,this.sfuResource,f.video.inbound,f.video.prevInbound,f.candidateStats,f.video.codec,t,this.seiStats.seiReadCnt,this.seiStats.seiBytesRead))}updateAndDiffSeiSubscribeStatsSinceLastUpdate(i){const c=this.prevVideoReceiverTransformerStats;if(!i)return{seiReadCnt:c.seiReadCnt,seiBytesRead:c.seiBytesRead};const l=i.seiReadCnt-c.seiReadCnt,f=i.seiBytesRead-c.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:i.seiReadCnt,seiBytesRead:i.seiBytesRead},{seiReadCnt:l,seiBytesRead:f}}updateAndDiffSeiPublishStatsSinceLastUpdate(i){const c=this.prevVideoSenderTransformerStats;if(!i)return{seiWriteCnt:c.seiWriteCnt,seiBytesWritten:c.seiBytesWritten};const l=i.seiWriteCnt-c.seiWriteCnt,f=i.seiBytesWritten-c.seiBytesWritten;return this.prevVideoSenderTransformerStats={seiWriteCnt:i.seiWriteCnt,seiBytesWritten:i.seiBytesWritten},{seiWriteCnt:l,seiBytesWritten:f}}updateOutboundAudio(i){const c=i,l=this.prevOutboundAudioStats,f=i.id===(l==null?void 0:l.id)?l:void 0;return this.prevOutboundAudioStats=i,{outbound:c,prevOutbound:f}}updateInboundAudio(i){const c=i,l=this.prevInboundAudioStats,f=i.id===(l==null?void 0:l.id)?l:void 0;return this.prevInboundAudioStats=i,{inbound:c,prevInbound:f}}updateInboundVideo(i){const c=i,l=this.prevInboundVideoStats.get(Mt),f=i.id===(l==null?void 0:l.id)?l:void 0;return this.prevInboundVideoStats.set(Mt,i),{inbound:c,prevInbound:f}}updateOutboundVideo(i){const c=i,l=this.getPrevOutboundVideo(i),f=i.id===(l==null?void 0:l.id)?l:void 0;return this.setPrevVideoStat(i),{outbound:c,prevOutbound:f}}getPrevOutboundVideo(i){return this.simulcastEnabled&&i.rid&&this.prevOutboundVideoStats.has(i.rid)?this.prevOutboundVideoStats.get(i.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(Mt)?this.prevOutboundVideoStats.get(Mt):void 0}setPrevVideoStat(i){this.simulcastEnabled&&i.rid?this.prevOutboundVideoStats.set(i.rid,i):this.simulcastEnabled||this.prevOutboundVideoStats.set(Mt,i)}convertLostRatioToQuality(i){return i<=0?Zn.EXCELLENT:i<=.01?Zn.GOOD:i<=.03?Zn.NORMAL:i<=.1?Zn.POOR:Zn.DOWN}}class dd extends Et{constructor(i,c,l,f,n){super(et.MINUTE,i,c,!1),Object.assign(this.properties,{action:f?Oe.PUBLISH:Oe.SUBSCRIBE,is_publishing:f,minutes_logged:l,subscribed_number:n})}}class vh extends Et{constructor(i){super(et.PUBLISH,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.PUBLISH,remote_participant_id:i.token.participantID})}}class Tl extends Et{constructor(i){super(et.UNPUBLISH,i.token,i.traceId,!0),Object.assign(this.properties,{action:Oe.PUBLISH,remote_participant_id:i.token.participantID})}}class Lu extends Et{constructor(i){var c,l,f,n;super(et.SUBSCRIBE,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.SUBSCRIBE,remote_participant_id:i.subscribedId,subscribed_id:i.subscribedId,is_edp_connected:i.isEdpConnected,is_reassignment:i.isReassignment,node:(l=(c=i.preAttemptSfuResource)===null||c===void 0?void 0:c.node)!==null&&l!==void 0?l:"",cluster:(n=(f=i.preAttemptSfuResource)===null||f===void 0?void 0:f.cluster)!==null&&n!==void 0?n:""})}}class hd extends Et{constructor(i){super(et.UNSUBSCRIBE,i.token,i.traceId,!0),Object.assign(this.properties,{action:Oe.SUBSCRIBE,remote_participant_id:i.unsubscribedId,unsubscribed_id:i.unsubscribedId})}}class yh extends Et{constructor(i){var c,l,f,n;super(et.PUBLISH_STARTED,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.PUBLISH,options_duration:i.optionsDuration,post_duration:i.postDuration,remote_participant_id:i.token.participantID,time_to_candidate:i.timeToCandidate,total_duration:i.totalDuration,edp_initial_connect_duration:i.edpInitialConnectDuration,edp_initial_connect_retry_times:i.edpInitialConnectRetries,edp_initial_state_duration:i.edpInitialStateDuration,edp_state_update_count:i.edpStateUpdateCount,sdp_exchange_duration:i.sdpExchangeDuration,sdp_exchange_transport:i.sdpExchangeTransport,set_remote_desc_duration:i.setRemoteDescDuration,peer_connection_duration:i.peerConnectionDuration,node:(l=(c=i.sfuResource)===null||c===void 0?void 0:c.node)!==null&&l!==void 0?l:"",cluster:(n=(f=i.sfuResource)===null||f===void 0?void 0:f.cluster)!==null&&n!==void 0?n:"",publish_retry_times:i.publishRetries,total_duration_with_retries:i.totalDurationWithRetries,protocol:i.protocol})}}class bh extends Et{constructor(i){super(et.PUBLISH_FAILED,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.PUBLISH,code:i.code,message:i.message,fatal:i.fatal,nominal:i.nominal,protocol:i.protocol})}}class fd extends Et{constructor(i){super(et.PUBLISH_ENDED,i.token,i.traceId,!0),Object.assign(this.properties,{action:Oe.PUBLISH,remote_participant_id:i.token.participantID,unpublish_successful:i.isUnpublishSuccessful,reason:i.reason,protocol:i.protocol})}}class Sh extends Et{constructor(i){var c,l,f,n;super(et.SUBSCRIBE_STARTED,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.SUBSCRIBE,options_duration:i.optionsDuration,post_duration:i.postDuration,remote_participant_id:i.remoteParticipantId,time_to_candidate:i.timeToCandidate,total_duration:i.totalDuration,edp_initial_connect_duration:i.edpInitialConnectDuration,edp_initial_connect_retry_times:i.edpInitialConnectRetries,edp_initial_state_duration:i.edpInitialStateDuration,edp_initial_state_publishing_count:i.edpInitialStatePublishingCount,edp_state_update_count:i.edpStateUpdateCount,sdp_exchange_duration:i.sdpExchangeDuration,sdp_exchange_transport:i.sdpExchangeTransport,set_remote_desc_duration:i.setRemoteDescDuration,peer_connection_duration:i.peerConnectionDuration,node:(l=(c=i.sfuResource)===null||c===void 0?void 0:c.node)!==null&&l!==void 0?l:"",cluster:(n=(f=i.sfuResource)===null||f===void 0?void 0:f.cluster)!==null&&n!==void 0?n:"",total_duration_with_retries:i.totalDurationWithRetries,subscribe_retry_times:i.subscribeRetryTimes,is_reassignment:i.isReassignment,protocol:i.protocol})}}class Eh extends Et{constructor(i){super(et.SUBSCRIBE_FAILED,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.SUBSCRIBE,remote_participant_id:i.remoteParticipantId,code:i.code,message:i.message,fatal:i.fatal,nominal:i.nominal,is_reassignment:i.isReassignment,protocol:i.protocol})}}class Rl extends Et{constructor(i){super(et.SUBSCRIBE_ENDED,i.token,i.traceId,!0),Object.assign(this.properties,{action:Oe.SUBSCRIBE,remote_participant_id:i.remoteParticipantId,unsubscribe_successful:i.isUnsubscribeSuccessful,reason:i.reason,protocol:i.protocol}),this.critical=!0}}class jc extends Et{constructor(i){super(et.STATE_UPDATED,i.token,i.traceId,!1),Object.assign(this.properties,{audio_muted:i.isAudioMuted,is_disconnected:i.isDisconnected,is_publishing:i.isPublishing,other_participant_id:i.otherParticipantId,other_participant_user_id:i.otherParticipantUserId,video_stopped:i.isVideoStopped})}}class Bu extends Et{constructor(i){var c,l,f,n,e;super(et.FIRST_FRAME,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.SUBSCRIBE,remote_participant_id:i.remoteParticipantId,edp_initial_connect_duration:i.edpInitialConnectDuration,edp_initial_connect_retry_times:i.edpInitialConnectRetries,edp_initial_state_duration:i.edpInitialStateDuration,edp_initial_state_publishing_count:i.edpInitialStatePublishingCount,edp_state_update_count:i.edpStateUpdateCount,sdp_exchange_duration:i.sdpExchangeDuration,sdp_exchange_transport:i.sdpExchangeTransport,set_remote_desc_duration:i.setRemoteDescDuration,peer_connection_duration:i.peerConnectionDuration,node:(l=(c=i.sfuResource)===null||c===void 0?void 0:c.node)!==null&&l!==void 0?l:"",cluster:(n=(f=i.sfuResource)===null||f===void 0?void 0:f.cluster)!==null&&n!==void 0?n:"",video_was_paused:i.videoWasPaused,first_frame_duration:i.firstFrameDuration,total_duration_with_retries:i.totalDurationWithRetries,subscribe_retry_times:i.subscribeRetryTimes,media_type:i.mediaType,configured_jitter_buffer_min_delay_ms:(e=i.currentJitterBufferMinDelayInMs)!==null&&e!==void 0?e:0,protocol:i.protocol})}}class _h extends Et{constructor(i){super(et.EDP_PONG,i.token,i.traceId,!1),Object.assign(this.properties,{event_endpoint:i.eventEndpoint,protocol:i.protocol,edp_rtt:i.edpRttMs})}}class Ch extends Et{constructor(i){super(et.JOIN,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.JOIN,event_endpoint:i.eventEndpoint,whip_endpoint:i.whipEndpoint})}}class Th extends Et{constructor(i){super(et.JOIN_ATTEMPT,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.JOIN,event_endpoint:i.eventEndpoint,whip_endpoint:i.whipEndpoint})}}class pd extends Et{constructor(i){super(et.JOIN_ATTEMPT_FAILED,i.token,i.traceId,!1),Object.assign(this.properties,{action:Oe.JOIN,event_endpoint:i.eventEndpoint,whip_endpoint:i.whipEndpoint,code:i.code,message:i.message,fatal:i.fatal,nominal:i.nominal,connect_retry_times:i.retryCnt})}}class wl extends Et{constructor(i){super(et.EDP_DISCONNECTED,i.token,i.traceId,!1),Object.assign(this.properties,{event_endpoint:i.eventEndpoint,protocol:i.protocol}),this.critical=!0}}class md extends Et{constructor(i){super(et.EDP_CONNECTED,i.token,i.traceId,!1),Object.assign(this.properties,{event_endpoint:i.eventEndpoint,protocol:i.protocol,connect_retry_times:i.numRetries}),this.critical=!0}}class Rh{constructor(i,c,l){this.token=i,this.analyticsTracker=l,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.maxConnectRetries=6,this.connectionAttempts=0,this.latestSequenceNumber=0,this.nextConnectionAttemptId=0,this.connectTimeoutId=0,this.latestPingTimestamp=0,this.pingIntervalId=0,this.pongTimeoutId=0,this.pingIntervalMs=15e3,this.pongTimeoutMs=3e4,this.attemptConnect=t=>{this.latestSequenceNumber=0,this.traceId=t||Nr(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:o,rawToken:s}=this.token;this.connecting=!0,this.closing=!1;try{const h=encodeURIComponent(this.traceId.value),y=`topic=${o}/publishers`,T=`traceid=${h}`,P="error_over_ws=1",M=`${this.addr}?${P}&${y}&${T}`;this.socket=this.createWebSocket(M,s),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(h){const y=h instanceof Error?h.message:void 0,T=this.createError(_e.EVENT_PLANE_WS_CREATE_FAILED,y);this.trackJoinFailed(T,this.getRetryCount()),this.emitter.emit(Yr,T)}},this.triggerSocketOpen=t=>{this.clearConnectionAttemptTimeouts();const o=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(o),this.emitter.emit(ws,{retryCnt:o,traceId:this.traceId,initialStageState:t}),this.pingIntervalId=window.setInterval(this.ping,this.pingIntervalMs)},this.ping=()=>{var t;if(this.logger.debug({msg:`${this.id}sending PING`}),!this.isSocketOpen()){const o=`${this.id} attempting to ping an unopened socket`;return this.logger.warn({msg:o}),void this.traceJoinOp(o)}this.latestPingTimestamp=performance.now(),this.pongTimeoutId===0&&(this.pongTimeoutId=window.setTimeout(this.pongTimedOut,this.pongTimeoutMs)),(t=this.socket)===null||t===void 0||t.send(JSON.stringify({type:"PING"}))},this.pongTimedOut=()=>{if(!this.isSocketOpen()){const o=`${this.id} attempting pong timeout on an unopened socket`;return this.logger.warn({msg:o}),void this.traceJoinOp(o)}this.logger.debug({msg:`${this.id} Pong timed out!`}),this.clearPingPongTracking();const t=this.createError(_e.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(Yr,t)},this.beforeUnload=()=>{this.emitter.emit(Is,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(t,o,s,h,y,T,P,M)=>{var L;const B={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:o,requestId:h,traceId:s,platform:"web",sdk:"1.28.0",whipVersion:ha,content:t,contentType:"application/sdp"}};y&&(B.payload.forceNode=y),T&&(B.payload.assignmentToken=T),P&&(B.payload.multiCodec=P);const U=gs()===void 0,F=gs()||U;M&&F&&(B.payload.initialLayerPref=Qr(M)),(L=this.socket)===null||L===void 0||L.send(JSON.stringify(B))},this.checkNonFatalRetriesLimit=t=>{if(t.fatal||this.connectionAttempts<=this.maxConnectRetries)return Ue.ok(!0);this.logger.debug({msg:`${this.id} maximum non-fatal retries of ${this.maxConnectRetries} exceeded`});const o=this.createError(_e.JOIN_TIMED_OUT);return Ue.err(o)},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackSocketError=t=>{this.connecting&&this.trackJoinFailed(t,this.getRetryCount()),this.analyticsTracker.trackError(t)},this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new wl({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.traceJoinOp=t=>{this.analyticsTracker.trackEventNoSharedProps(new fa(this.token,this.traceId,t,Oe.JOIN))},this.logger=new mt(c,Be.SOCKET),this.emitter=new Qn.EventEmitter,this.traceId=Nr(),this.id=`[${Va().value}] `;const f=gc("socketPingMs");f!==void 0&&(this.pingIntervalMs=f);const n=gc("socketPongMs");n!==void 0&&(this.pongTimeoutMs=n);const e=gc("socketConnectMaxRetries");e!==void 0&&(this.maxConnectRetries=e),window.addEventListener("beforeunload",this.beforeUnload)}connect(i,c,l=!1){this.close(),this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=i,this.traceId=c,l&&!this.connecting&&(window.clearTimeout(this.connectTimeoutId),this.connectTimeoutId=window.setTimeout(this.connectTimedOut.bind(this),12e3)),this.attemptConnect(c)}send(i){var c;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(i)}`}),this.logger.debug({msg:`${this.id}isReady called`}),this.isSocketOpen()?(c=this.socket)===null||c===void 0||c.send(JSON.stringify(i)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const i=this.connecting,c=this.isSocketOpen(),l=this.socket&&this.socket.readyState===this.socket.CLOSING,f=this.getRetryCount();if(this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.connectionAttempts=0,this.socket){if(this.cleanupWebSocket(),c&&this.isStateMessageReceived())this.trackJoinEnded(),this.emitter.emit(Is,"intentional-close");else if(i&&!l){const n=this.createError(_e.OPERATION_ABORTED);this.trackJoinFailed(n,f),this.analyticsTracker.trackError(n),this.emitter.emit(Yr,n)}}}markSocketAsClosed(){this.closing=!0,this.connecting=!1}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(i,c){return new WebSocket(i,c)}cleanupWebSocket(){this.socket&&(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,this.socket=void 0)}createError(i,c){return new ct(Object.assign({action:Oe.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:ao,details:c},i))}on(i,c){this.emitter.on(i,c)}off(i,c){this.emitter.off(i,c)}onMessage(i){this.logger.debug({msg:`${this.id}received message: ${i.data}`});try{const c=JSON.parse(i.data);switch(c.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const l=c.payload.sequenceNumber;l>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&this.connectTimeoutId>0?(this.triggerSocketOpen(c),window.setTimeout(()=>{this.emitter.emit(Jr,c)})):this.emitter.emit(Jr,c),this.latestSequenceNumber=l);break}case"PONG":window.clearTimeout(this.pongTimeoutId),this.pongTimeoutId=0,this.analyticsTracker.trackEventNoSharedProps(new _h({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp}));break;case"REFRESH":this.emitter.emit(ks);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(Ic,c.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(on,c.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(Os,c.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(rd,c.payload);break;case"aws:ivs:SSU":this.emitter.emit(id,c.payload);break;case"aws:ivs:JOIN_ERROR":this.handleJoinError(c.payload);break;default:(0,Sn.noop)()}}catch(c){this.logger.debug({msg:`onMessage JSON Parse error: ${c}`}),this.emitter.emit(tr,c)}}onError(i){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(i)}`})}onClose(i){if(this.logger.debug({msg:`${this.id} onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.clearPingPongTracking(),this.closing)return void(this.closing=!1);if(this.windowUnloading)return;const c=`code: ${i==null?void 0:i.code}, reason: ${i==null?void 0:i.reason}, wasClean: ${i==null?void 0:i.wasClean}`;if(this.connecting){const f=this.createError(_e.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,c);return void this.handleSocketError(f)}this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(Is,"unknown");const l=this.createError(_e.EVENT_PLANE_WS_UNEXPECTED_CLOSE,c);this.trackJoinEnded(),this.emitter.emit(Yr,l)}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),this.connectTimeoutId=window.setTimeout(this.triggerSocketOpen,12e3)}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttemptId),window.clearTimeout(this.connectTimeoutId),this.nextConnectionAttemptId=0,this.connectTimeoutId=0}clearConnectionAttempts(){this.connectionAttempts=0}connectTimedOut(){this.connecting=!1,this.logger.debug({msg:`${this.id} Connect timed out!`});const i=this.createError(_e.JOIN_TIMED_OUT);this.isSocketConnecting()&&this.trackJoinFailed(i,this.getRetryCount()),this.emitter.emit(Yr,i),this.close()}clearPingPongTracking(){window.clearInterval(this.pingIntervalId),window.clearTimeout(this.pongTimeoutId),this.pingIntervalId=0,this.pongTimeoutId=0}handleJoinError(i){const c=function(f){var n,e;let t;switch(f.code){case Lr.TOKEN_EXPIRED:t=_e.EXPIRED_TOKEN;break;case Lr.TOKEN_INVALID:case Lr.TOKEN_INVALID_SIGNATURE:case Lr.TOKEN_MISSING:t=_e.MALFORMED_TOKEN;break;case Lr.STAGE_DELETED:t=_e.STAGE_DELETED;break;case Lr.PARTICIPANT_DISCONNECTED:t=_e.PARTICIPANT_DISCONNECTED;break;case Lr.INTERNAL:t=_e.JOIN_SERVER_INTERNAL_ERROR;break;case Lr.BAD_REQUEST:t=_e.JOIN_SERVER_BAD_REQUEST;break;default:t=Object.assign(Object.assign({},_e.JOIN_FAILURE),{message:f.message||_e.JOIN_FAILURE.message})}return Object.assign(Object.assign({},t),{fatal:(n=f.fatal)!==null&&n!==void 0?n:t.fatal,nominal:(e=f.nominal)!==null&&e!==void 0?e:t.nominal})}(i),l=this.createError(c,`JOIN_ERROR: ${i.code}`);this.logger.debug({msg:`${this.id} received JOIN_ERROR: ${JSON.stringify(i)}`}),this.handleSocketError(l)}handleSocketError(i){const c=this.checkNonFatalRetriesLimit(i);let l=i;c.ok||(l=c.error,l.details=`Timeout triggered by ${i.code}`),this.trackSocketError(l),this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.cleanupWebSocket(),l.fatal?(this.clearConnectionAttempts(),this.emitter.emit(Yr,l)):this.queueExponentialBackoffRetry()}queueExponentialBackoffRetry(){let i=Math.pow(2,this.connectionAttempts-1);i>32&&(i=32),this.logger.debug({msg:`${this.id} reconnecting in ${i} seconds`}),window.clearTimeout(this.nextConnectionAttemptId),this.nextConnectionAttemptId=window.setTimeout(this.attemptConnect,1e3*i)}isSocketConnecting(){return this.socket&&this.socket.readyState===this.socket.CONNECTING}isSocketOpen(){return this.socket&&this.socket.readyState===this.socket.OPEN}isStateMessageReceived(){return this.latestSequenceNumber!==0}trackJoinStarted(i){this.analyticsTracker.trackEventNoSharedProps(new md({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:i,protocol:this.protocol,traceId:this.traceId}))}trackJoinAttempt(i){const{token:c,traceId:l}=this;this.analyticsTracker.trackEvent(new Th({token:c,eventEndpoint:(c==null?void 0:c.eventsURL)||"",whipEndpoint:(c==null?void 0:c.whipURL)||"",traceId:l}))}trackJoinFailed(i,c){const{token:l,traceId:f,code:n,message:e,fatal:t,nominal:o}=i;this.analyticsTracker.trackEvent(new pd({token:l,eventEndpoint:l.eventsURL,whipEndpoint:l.whipURL,traceId:f,code:n,message:e,fatal:t,nominal:o,retryCnt:c}))}}var gd=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})},ns,Rr,Gi,an;(function(u){u.SDP_EXCHANGE="xdp",u.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(ns||(ns={})),function(u){u.USER_INITIATED="user-initiated",u.CLIENT_RECONNECT="reconnect",u.TOKEN_REUSED="token-reused",u.UNKNOWN="unknown",u.PARTICIPANT_DISCONNECTED="participant-disconnected",u.STAGE_DELETED="stage-deleted",u.TOKEN_EXPIRED="token-expired"}(Rr||(Rr={})),function(u){u[u.NOT_CONNECTED=0]="NOT_CONNECTED",u[u.CONNECTION_LOST=1]="CONNECTION_LOST",u[u.TIMEDOUT=2]="TIMEDOUT",u[u.ABORTED=3]="ABORTED",u[u.INVALID_MESSAGE=4]="INVALID_MESSAGE",u[u.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"}(Gi||(Gi={})),function(u){u.DISCONNECTED="disconnected",u.CONNECTING="connecting",u.CONNECTED="connected",u.ERRORED="errored"}(an||(an={}));class Uc extends It{constructor(i,c,l){super(),this.token=i,this.nonScopedLogger=c,this.analyticsTracker=l,this.participants=new Map,this.disconnected=[],this.state={value:an.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(f,n)=>{this.logger.debug({msg:"onConnecting",context:f,event:n}),f.connectStartTime=performance.now();const e=n.type==="RECONNECT";e&&this.stageSocket.close();const{eventsURL:t}=this.token;this.emit(qn,an.CONNECTING),this.state.value=an.CONNECTING;const o=!e;this.stageSocket.connect(t,this.traceId,o)},this.onConnected=(f,n)=>{this.logger.debug({msg:"onConnected",context:f,event:n}),f.hasConnected=!0,this.emit(ph),this.emit(qn,an.CONNECTED),this.state.value=an.CONNECTED},this.onDisconnected=(f,n)=>{this.logger.debug({msg:"onDisconnected",context:f}),this.state.value=an.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),f.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(qn,an.DISCONNECTED,n)},this.onErrored=(f,n)=>{var e;this.logger.error({msg:"Connection failure occurred",err:n.payload.error}),this.emit(qn,an.ERRORED),this.emit(Rs,n.payload.error),this.state.value=an.ERRORED;const t=n.payload.error;if(t instanceof ct&&t.fatal&&(!((e=t.details)===null||e===void 0)&&e.includes("JOIN_ERROR"))&&f.hasConnected){const o=this.mapJoinErrorCodeToDisconnectReason(t);this.processStateUpdate({type:"DISCONNECT",reason:o})}else f.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=f=>{const n=this.state.value,e=this.state.context;switch(n){case an.DISCONNECTED:f.type==="CONNECT"&&this.onConnecting(e,f);break;case an.CONNECTING:f.type==="RECONNECT"?this.onConnecting(e,f):f.type==="DISCONNECT"?this.onDisconnected(e,f.reason):f.type==="CONNECT_SUCCESS"?this.onConnected(e,f):f.type==="ERROR"&&this.onErrored(e,f);break;case an.CONNECTED:f.type==="RECONNECT"?this.onConnecting(e,f):f.type==="DISCONNECT"?this.onDisconnected(e,f.reason):f.type==="ERROR"&&this.onErrored(e,f);break;case an.ERRORED:f.type==="RECONNECT"?this.onConnecting(e,f):f.type==="DISCONNECT"&&this.onDisconnected(e,f.reason)}},this.measureConnect=(f,n)=>{const e=this.stats.edpConnectCount,t=e+1,o=performance.now(),s=o-n;return Object.assign(this.stats,{edpConnectCount:t,edpConnectDuration:s}),e===0&&Object.assign(this.stats,{edpInitialStartConnectTime:n,edpInitialFinishConnectTime:o,edpInitialConnectDuration:s,edpInitialConnectRetries:f}),this.stats},this.measureStateUpdate=f=>{const{edpInitialFinishConnectTime:n}=this.stats,e=this.stats.edpStateUpdateCount,t=e+1;return Object.assign(this.stats,{edpStateUpdateCount:t}),e===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-n,edpInitialStatePublishingCount:f}),this.stats},this.trackMessageParseError=f=>{this.logger.error({msg:"Message Parse Error occurred",err:f.err});const n=new ct({token:f.token,traceId:f.traceId,code:_e.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:f.tag,location:f.location,message:f.message,details:f.err.message});this.analyticsTracker.trackEvent(new ia(n))},this.trackStageSocketMessageParseError=(f,n,e)=>{this.trackMessageParseError({token:f,traceId:n,tag:ao,location:"StageConnection.onMessage",message:_e.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:e})},this.trackStageStateMessageParseError=(f,n,e,t)=>{this.trackMessageParseError({token:f,traceId:n,tag:ao,location:"StageConnection.onStageStateMessage",message:t,err:e})},this.onDisconnectMessage=f=>{this.analyticsTracker.trackEventNoSharedProps(new fa(this.token,this.traceId,`DISCONNECT message received: ${f.code}:${f.reason}`,Oe.JOIN));let n=Rr.UNKNOWN;if(f.code==="PARTICIPANT_DISCONNECTED")n=Rr.PARTICIPANT_DISCONNECTED;else if(f.code==="STAGE_DELETED")n=Rr.STAGE_DELETED;else if(f.code==="TOKEN_REUSED"&&(n=Rr.TOKEN_REUSED,jn("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${f.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:n})},this.onReassignmentMessage=f=>{this.emit(ci,f)},this.onIncompatibleCodecsMessage=f=>{this.emit(Nn,f)},this.onSsuMessage=f=>{var n;const e=window.atob((n=f.A)!==null&&n!==void 0?n:"").trim();e&&e.startsWith("http")?Hr.currentEndpoint=e:this.logger.warn({msg:"SSU Url invalid"})},this.onStageStateMessage=(f,n,e)=>{var t,o;this.logger.debug({msg:"State Stage Message occurred",state:e});const s=e.payload,h=(t=s.participants)!==null&&t!==void 0?t:[],y=(o=s.disconnected)!==null&&o!==void 0?o:[],T=[],P=[];this.measureStateUpdate(h.length),this.enableFeaturesBasedOnServerFeatures(s.serverFeatures||[]);const M=(L,B)=>{this.analyticsTracker.trackEventNoSharedProps(new jc({token:f,otherParticipantId:L.id,otherParticipantUserId:L.userId,isAudioMuted:L.audioMuted,isVideoStopped:L.videoStopped,isPublishing:L.isPublishing,isDisconnected:B,traceId:n}))};this.participants.forEach(L=>{const B=h.find(U=>U.id===L.id);if(B){let U=!0,F=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach(q=>{U=U&&B[q.toString()]===L[q.toString()],U||(L[q.toString()]=B[q.toString()],F=!0)}),Object.keys(L.attributes).forEach(q=>{U=U&&B.attributes[q]===L.attributes[q],U||(L.attributes=B.attributes,F=!0)}),F&&(M(L,!1),this.emit(So,B))}else P.push(L)}),h.forEach(L=>{this.participants.get(L.id)||T.push(L)}),P.forEach(L=>{this.participants.delete(L.id),M(L,!0),this.emit(la,L)}),T.forEach(L=>{this.participants.set(L.id,L),M(L,!1),this.emit(fu,L)}),y.forEach(L=>{this.disconnected.find(B=>B.id===L.id)||(this.disconnected.push(L),L.status==="KICKED"&&this.emit(so,L))}),this.disconnected=y},this.nonScopedLogger=c,this.logger=new mt(c,Be.CONNECTION),this.stageSocket=new Rh(i,this.nonScopedLogger,l),this.token=i,this.traceId=Nr()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(i){return gd(this,void 0,void 0,function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:i}),this.traceId=i,this.state.value!==an.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:Rr.CLIENT_RECONNECT})),new Promise((c,l)=>{this.stageSocket.on(ws,f=>{var n,e;const{retryCnt:t,initialStageState:o}=f;o&&this.enableFeaturesBasedOnServerFeatures((e=(n=o.payload)===null||n===void 0?void 0:n.serverFeatures)!==null&&e!==void 0?e:[]),this.traceId=f.traceId||Nr(),this.measureConnect(t,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),c(this.traceId)}),this.stageSocket.on(Yr,f=>{l(f),this.processStateUpdate({type:"ERROR",payload:{error:f}})}),this.stageSocket.on(ks,()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(fl),this.processStateUpdate({type:"RECONNECT"})}),this.stageSocket.on(Jr,f=>this.onStageStateMessage(this.token,this.traceId,f)),this.stageSocket.on(tr,f=>this.trackStageSocketMessageParseError(this.token,this.traceId,f)),this.stageSocket.on(on,this.onDisconnectMessage),this.stageSocket.on(Os,this.onReassignmentMessage),this.stageSocket.on(rd,this.onIncompatibleCodecsMessage),this.stageSocket.on(id,this.onSsuMessage),this.stageSocket.on(Is,f=>{this.stopStageMinuteLoggedInterval()}),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:i}})})})}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:Rr.USER_INITIATED}),this.traceId}getParticipant(i){return this.participants.get(i)}listConnectedParticipants(){const i=[];return this.participants.forEach(c=>{c.subscribed&&i.push(c)}),i}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(i,c){this.stageSocket.send({audioMuted:i,type:"SET_STATE",version:"0",videoStopped:c})}setStagePublishing(i){this.isStagePublishing=i,this.emit(hl,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(i,c){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new dd(i,c,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval(()=>{this.analyticsTracker.trackEvent(new dd(i,c??Nr(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++},6e4))}stopStageMinuteLoggedInterval(i=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),i&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(i){const c=(e,t)=>{this.trackStageStateMessageParseError(this.token,this.traceId,t,`Could not parse "${e}" from the Eevee server features list`)},l=i.includes(ns.SDP_EXCHANGE);this.features.sdpExchange!==l&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${l}`}),this.features.sdpExchange=l);const f=i.find(e=>e.indexOf(ns.JITTER_BUFFER_MIN_DELAY_MS)!==-1),n=e=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${e}`}),this.features.jitterBufferMinDelayInMs=e};if(f!==void 0)try{const e=f.split("=")[1],t=parseInt(e,10);if(isNaN(t))throw new Error("Unable to parse - result is NaN");if(t<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===t||n(t)}catch(e){c(f,e),n(void 0)}else n(void 0)}mapJoinErrorCodeToDisconnectReason(i){switch(i.code){case _e.PARTICIPANT_DISCONNECTED.code:return Rr.PARTICIPANT_DISCONNECTED;case _e.STAGE_DELETED.code:return Rr.STAGE_DELETED;case _e.EXPIRED_TOKEN.code:return Rr.TOKEN_EXPIRED;default:return Rr.UNKNOWN}}isConnected(){return this.state.value===an.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(i,c,l,f,n,e,t,o,s){return gd(this,void 0,void 0,function*(){return this.isConnected()?new Promise((h,y)=>{const T=window.setTimeout(()=>{P(),y(Gi.TIMEDOUT)},12e3),P=()=>{window.clearTimeout(T),this.stageSocket.off(Ic,M),this.stageSocket.off(Yr,L)},M=B=>{B.requestId===f&&(P(),h(B))},L=()=>{P(),y(Gi.CONNECTION_LOST)};n==null||n.addEventListener("abort",()=>{P(),y(Gi.ABORTED)}),this.stageSocket.on(Ic,M),this.stageSocket.on(Yr,L),this.stageSocket.sendSdpOffer(i,c,l,f,e,t,o,s)}):Promise.reject(Gi.NOT_CONNECTED)})}}class ju{constructor(i){this.token=i}}const Uu=new RegExp("^(?:[a-z+]+:)?//","i");function Fc(u){return Uu.test(u)}function Fu({sdpExchangeTransport:u,serverHttpResponse:i,serverErrorCode:c}){return`sdpExchangeTransport: ${u}, serverHttpResponse: ${i}, serverErrorCode: ${c}`}var vd=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};const wh={[Gi.ABORTED]:_e.OPERATION_ABORTED,[Gi.NOT_CONNECTED]:_e.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Gi.CONNECTION_LOST]:_e.XDP_CONNECTION_LOST,[Gi.TIMEDOUT]:_e.XDP_TIMEOUT,[Gi.INVALID_MESSAGE]:_e.XDP_INVALID_ANSWER_MSG,[Gi.UNEXPECTED_ERROR]:_e.XDP_UNEXPECTED_ERROR};class $u extends ju{constructor(i,c,l,f){super(i),this.token=i,this.stageConnection=c,this.contextData=l,this.analyticsTracker=f}exchange(i){return vd(this,void 0,void 0,function*(){const c=Va(),{action:l}=this.contextData,{sdpOffer:f,url:n,traceId:e,forceNode:t,assignmentToken:o,multiCodec:s,abortController:h,initialLayerPreference:y}=i;let T;this.trackAttempt(n,c,e);try{T=yield this.stageConnection.exchangeSdp(f,n,e.value,c.value,h==null?void 0:h.signal,t,o,s,y)}catch(Y){if(typeof Y=="number")throw this.createClientSideErrorFromReasonCode(Y,e,c,l)}if(!T)return;const{httpStatusCode:P,errorCode:M,location:L,content:B,sessionDeleteLink:U,subscriberControlLink:F,videoLayersLink:q}=T;if(P>=200&&P<300)return{sdpAnswer:B,url:n,location:L,sessionDeleteLink:U,mediaControls:F,layerControls:q};throw this.createServerSideError(e,c,P,M,l)})}trackAttempt(i,c,l){const{remoteParticipantId:f,action:n}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new vu(n,this.token,i,"POST",c.value,f,l,"xdp"))}createServerSideError(i,c,l,f,n){const e=this.baseErrorProps(i,c);let t=si(l,f);return t||(t=_e.UNKNOWN_SERVER_ERROR),new ct(Object.assign(Object.assign(Object.assign({action:n},e),t),{details:Fu({sdpExchangeTransport:"xdp",serverHttpResponse:l,serverErrorCode:f})}))}baseErrorProps(i,c){const{remoteParticipantId:l,action:f}=this.contextData;return{token:this.token,traceId:i,tag:Zt(f,l),location:"EdpSdpExchanger.exchange",requestUUID:c,remoteParticipantId:l}}createClientSideErrorFromReasonCode(i,c,l,f){const n=this.baseErrorProps(c,l),e=wh[i];return new ct(e?Object.assign(Object.assign({action:f},n),e):Object.assign(Object.assign({action:f},n),_e.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}var rs=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Vu extends ju{constructor(i,c,l){super(i),this.contextData=c,this.analyticsTracker=l}exchange(i){var c,l,f;return rs(this,void 0,void 0,function*(){const n=Va(),{token:e}=this,{action:t,remoteParticipantId:o}=this.contextData,{sdpOffer:s,url:h,traceId:y,forceNode:T,assignmentToken:P,multiCodec:M,abortController:L,initialLayerPreference:B}=i;try{const F="POST",q="http";this.analyticsTracker.trackEventNoSharedProps(new vu(t,e,h,F,n.value,o,y,q));const Y={data:s,headers:{Authorization:`Bearer ${e.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":n.value,"X-Stages-SDK":"1.28.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":y.value,"X-Stages-WHIP-Version":ha,[Uo]:(U=JSON.stringify({[Fo]:["sau"]}),btoa(U).replace(/[^A-Za-z0-9+/]/g,""))},method:F,responseType:"text",url:h,signal:L==null?void 0:L.signal,params:{}};T&&(Y.params.force_node=T),P&&(Y.params.assignment_token=P),M&&(Y.params.multi_codec=!0);const z=gs()===void 0,re=gs()||z;B&&Y.headers&&re&&(Y.headers["X-Stages-Initial-Layer-Pref"]=Qr(B));const{data:ue,headers:le,request:ve}=yield ml(Y),be=this.parseWhipResource(h,le.location,le.link);return{url:ve.responseURL,sdpAnswer:ue,location:be==null?void 0:be.location,sessionDeleteLink:be==null?void 0:be.sessionDeleteLink,mediaControls:be==null?void 0:be.mediaControls,layerControls:be==null?void 0:be.layerControls}}catch(F){if(k().isCancel(F))throw new ct(Object.assign(Object.assign({},Fn(_e.OPERATION_ABORTED,F)),{action:t,token:e,traceId:y,tag:Zt(t,o),location:"StagePeerClient.start",requestUUID:n,remoteParticipantId:o}));const q=Number((c=F==null?void 0:F.response)===null||c===void 0?void 0:c.status)||-1,Y=((f=(l=F==null?void 0:F.response)===null||l===void 0?void 0:l.data)===null||f===void 0?void 0:f.code)||-1,z=function(re,ue){var le;return re instanceof ua.AxiosError&&re.response&&typeof re.response.status=="number"?re instanceof ua.AxiosError&&re.code==="ERR_NETWORK"?_e.NETWORK_FAILURE:si(Number(re.response.status),(le=re.response.data)===null||le===void 0?void 0:le.code)||ue:ue}(F,_e.WHIP_POST_FAILURE);throw new ct(Object.assign(Object.assign({},Fn(z,F)),{action:t,token:e,traceId:y,tag:Zt(t,o),details:Fu({sdpExchangeTransport:"http",serverHttpResponse:q,serverErrorCode:Y}),location:"StagePeerClient.start",requestUUID:n,remoteParticipantId:o}))}var U})}parseWhipResource(i,c,l){const f=new URL(i);let n;return n=function(e,t,o){if(!o)return e;if(e||(e={}),Fc(o))return e.location=o,e;const s=t.port?`:${t.port}`:"";return e.location=`${t.protocol}//${t.hostname}${s}${o}`,e}(n,f,c),n=function(e,t,o){if(!o)return e;e||(e={});const s=e;return o.split(",").forEach(h=>{const y=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(h);if((y==null?void 0:y.length)!==3)return;let T;if(Fc(y[1]))T=y[1];else{const P=t.port?`:${t.port}`:"";T=`${t.protocol}//${t.hostname}${P}${y[1]}`}switch(y[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":s.sessionDeleteLink=T;break;case"urn:ietf:params:whep:core:playback-controls":s.mediaControls=T;break;case"urn:ietf:params:whep:ext:core:layer":s.layerControls=T;break;default:return}}),s}(n,f,l),n}getTransport(){return"http"}}function Il(u){const{connection:i,token:c,action:l,identifier:f,tracker:n}=u,e=i&&i.supportsSdpExchange()&&i.isConnected(),t=l===Oe.SUBSCRIBE&&e&&!ou()&&!jn("disableXdpSubscribe"),o=l===Oe.PUBLISH&&e&&!ou()&&!jn("disableXdpPublish");return t||o?new $u(c,i,{action:l,remoteParticipantId:f},n):new Vu(c,{action:l,remoteParticipantId:f},n)}function Hs({stageErrorValue:u,action:i,token:c,traceId:l,tag:f,identifier:n,details:e}){return new ct(Object.assign(Object.assign({},u),{token:c,traceId:l,location:"peer-client",tag:f,action:i,remoteParticipantId:n,details:e}))}var wr;function Hi(u){var i;return!((i=u==null?void 0:u.sender)===null||i===void 0)&&i.createEncodedStreams?wr.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?wr.ENCODED_TRANSFORMS:wr.NONE}function zi(u){var i;return!((i=u==null?void 0:u.receiver)===null||i===void 0)&&i.createEncodedStreams?wr.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?wr.ENCODED_TRANSFORMS:wr.NONE}function Ih(){return Cs()(`/*! For license information please see transform.worker.worker.js.LICENSE.txt */
(()=>{"use strict";const e=new Uint8Array([158,80,78,165,238,90,79,2,148,159,176,51,163,118,141,162]);var t;!function(e){e.VIDEO_SEND="video/send",e.VIDEO_RECEIVE="video/receive",e.INSERT_SEI="insertSei"}(t||(t={}));function n(t,n){const{transformerId:s,type:r,payloads:a}=n;let o=[];if("sei"===n.type){const{value:n,messages:s}=function(t,n){function s(e,t,n){return n+t.length<=e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function r(e,t){const n=function(e,t){return new Uint8Array([0,0,1,6,5,...t,...e])}(e,function(e){const t=[];for(;e>=255;)t.push(255),e-=255;return t.push(e),new Uint8Array(t)}(t.length+e.length)),s=function(e){const t=[...e];let n=3;for(;n<t.length-2;)0!==t[n]||0!==t[n+1]||0!==t[n+2]&&1!==t[n+2]&&2!==t[n+2]&&3!==t[n+2]?n+=1:(t.splice(n+2,0,3),n+=3);return t}(new Uint8Array([...n,...t,128]));return new Uint8Array(s)}function a(e,n){const r=function(e){const t=new DataView(e);for(let e=0;e<t.byteLength-4;e++)if(s(t,[0,0,1],e)){const n=31&t.getUint8(e+3);if(n>=1&&n<=5)return e}return-1}(t.data);if(r>=0){const e=new ArrayBuffer(t.data.byteLength+n.byteLength),s=new Uint8Array(e);return s.set(new Uint8Array(t.data.slice(0,r)),0),s.set(n,r),s.set(new Uint8Array(t.data.slice(r)),r+n.byteLength),e}return e}return function(){const s=[];for(let o=0;o<n.length;o+=1){const i=r(e,new Uint8Array(n[o]));t.data=a(t.data,i),s.push({uuid:e,payload:n[o]})}return{value:t,messages:s}}()}(t,a||[]);t=n,o=s}return{success:!0,frame:t,transformerId:s,type:r,seiResult:o}}const s=function(){let e=[];const t=new Map;return{add:({payload:t,repeatCount:n})=>(e.push({payload:t,repeatCount:n}),!0),poll(n){t.has(n)||t.set(n,[]),t.size>0&&(t.forEach((t=>{t.push(...e)})),e=[]);const s=t.get(n)||[],r=s.filter((e=>e.repeatCount>0)).map((e=>Object.assign(Object.assign({},e),{repeatCount:e.repeatCount-1})));return t.set(n,r),s}}}(),r=e=>(t,r)=>{try{const a=t.getMetadata().synchronizationSource,o=(s?s.poll(a):[]).map((e=>e.payload)),i=n(t,Object.assign(Object.assign({},e),{payloads:o}));r.enqueue(i.frame),self.postMessage(Object.assign({success:i.success,seiResult:i.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}},a=e=>(t,n)=>{try{const s=function(e,t){const{type:n,transformerId:s}=t;if("sei"===n){const t=function(e){function t(e,t,n){return n+t.length<e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function n(e){const t=[];let n=0;for(;n<e.length;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(t.push(e[n]),t.push(e[n+1]),n+=3):(t.push(e[n]),n+=1);return new Uint8Array(t)}function s(e){let t=2;const n=e.byteLength;for(;t<n;){let s=0;for(;t<n&&255===e[t];)s+=255,t++;s+=e[t],t++;const r=Math.min(t+s,n),a=new Uint8Array(e.slice(t,r));return{uuid:a.slice(0,16),payload:a.slice(16)}}}return{messages:function(e){const r=new DataView(e.data),a=[];let o=0;if(!t(r,[0,0,1],0)&&!t(r,[0,0,0,1],0))return[];for(;o<r.byteLength-5;)if(t(r,[0,0,1],o)){const i=o+3;o=i;const c=31&r.getUint8(o),u=31&r.getUint8(o+1);if(6===c&&5===u){for(;o<r.byteLength&&!t(r,[0,0,1],o);)o++;const c=o,u=s(n(new Uint8Array(e.data.slice(i,c))));u&&a.push(Object.assign({},u))}else o++}else o++;return a}(e),frame:e}}(e),{frame:r,messages:a}=t;return{success:!0,frame:r,type:n,transformerId:s,seiResult:a}}return{success:!0,frame:e,transformerId:s,type:n}}(t,e);n.enqueue(s.frame),self.postMessage(Object.assign({success:s.success,seiResult:s.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}};function o(e,t,n,s){const o=new TransformStream({transform:"video/send"===e?r(t):a(t)});n.pipeThrough(o).pipeTo(s)}const i=self;i.addEventListener("message",(function(e){var n,r,a;if(!(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.operation)||!(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.transformerId))return;const{operation:i,transformerId:c}=e.data;switch(i){case t.VIDEO_SEND:case t.VIDEO_RECEIVE:o(i,{method:i,transformerId:c,type:"sei"},e.data.readable,e.data.writable);break;case t.INSERT_SEI:s.add({payload:e.data.payload,repeatCount:null!==(a=e.data.repeatCount)&&void 0!==a?a:0})}})),i.addEventListener("rtctransform",(function(e){const t=e.transformer;if(!t)return;o(t.options.method,t.options,t.readable,t.writable)}))})();`,"Worker",void 0,void 0)}(function(u){u.NONE="none",u.ENCODED_TRANSFORMS="encodedTransforms",u.INSERTABLE_STREAMS="insertableStreams"})(wr||(wr={}));const ho=(()=>{const u={};return{getWorker:i=>(u[i]||(u[i]=new Ih),u[i]),destroy:i=>{var c;(c=u[i])===null||c===void 0||c.terminate(),u[i]=void 0}}})();var Xe;(function(u){u.NOT_PUBLISHING_VIDEO="NOT_PUBLISHING_VIDEO",u.INBAND_MESSAGING_NOT_ENABLED="INBAND_MESSAGING_NOT_ENABLED",u.INVALID_REPEAT_COUNT="INVALID_REPEAT_COUNT",u.PAYLOAD_SIZE_INVALID="PAYLOAD_SIZE_INVALID",u.PAYLOAD_RATE_EXCEEDED="PAYLOAD_RATE_EXCEEDED",u.INVALID_TRACK_TYPE="INVALID_TRACK_TYPE"})(Xe||(Xe={}));class wt{constructor(i){this.maxFramerate=i,this.queued=[]}validateMessagePayload(i,c){if(i.byteLength<=0)return Ue.err(Xe.PAYLOAD_SIZE_INVALID);if(c<0||c>30)return Ue.err(Xe.INVALID_REPEAT_COUNT);if(i.byteLength>1024)return Ue.err(Xe.PAYLOAD_SIZE_INVALID);this.queued=this.trimPastPayloads(this.queued,1e3);const{before:l,after:f}=this.getPayloadSums(this.queued);if(l+i.byteLength>10240||f+i.byteLength*Math.max(1,c)>10240)return Ue.err(Xe.PAYLOAD_RATE_EXCEEDED);if(this.queued.push({byteLength:i.byteLength,timestamp:Date.now()}),c>0){const n=1e3/this.maxFramerate;let e=Date.now()+n;for(let t=0;t<c;t+=1)this.queued.push({byteLength:i.byteLength,timestamp:e}),e+=n}return Ue.ok(!0)}trimPastPayloads(i,c){const l=Date.now()-c;return i.filter(f=>f.timestamp>l)}getPayloadSums(i){const c=Date.now();return i.reduce((l,f)=>{const{before:n,after:e}=l;return f.timestamp<=c?{before:n+f.byteLength,after:e}:{before:n,after:e+f.byteLength}},{before:0,after:0})}}const ni="seiMessageReceived",Wt="error";var Pt;(function(u){u.CREATED="created",u.INITIALIZED="initialized",u.DESTROYED="destroyed"})(Pt||(Pt={}));class Yo extends It{constructor(i){super(),this.sessionId=i,this.state=Pt.CREATED,this.transformerId=Va().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=c=>{this.onTransformResult(c.data)}}initializeInsertableStreams(i){var c,l;this.worker=ho.getWorker(this.sessionId);const f=i.receiver.createEncodedStreams(),{readable:n,writable:e}=f;(c=this.worker)===null||c===void 0||c.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:n,writable:e},[n,e]),(l=this.worker)===null||l===void 0||l.addEventListener("message",this.onMessage)}initializeEncodedTransforms(i){var c;this.worker=ho.getWorker(this.sessionId);const l={method:"video/receive",type:"sei",transformerId:this.transformerId};i.receiver.transform=new RTCRtpScriptTransform(this.worker,l),(c=this.worker)===null||c===void 0||c.addEventListener("message",this.onMessage)}initialize(i,c){if(this.state!==Pt.CREATED)return!1;const l=zi(i);if(l===wr.NONE)return!1;if(c&&l===wr.INSERTABLE_STREAMS)this.initializeInsertableStreams(i);else{if(c||l!==wr.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(i)}return this.transceiver=i,this.state=Pt.INITIALIZED,!0}onTransceiverAdd(i){return this.initialize(i,!0)}onTrackEvent(i){return i.track.kind==="video"&&this.initialize(i.transceiver,!1)}static isSupported(i){return zi(i)!==wr.NONE}onTransformResult(i){return i.transformerId===this.transformerId&&(i.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!i.seiResult&&(i.seiResult.forEach(c=>{const{payload:l,uuid:f}=c;this.updateReadStats(c),this.emit(ni,{uuid:f,payload:l})}),i.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(i,_e.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(i,_e.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(i){this.seiReadCnt++,this.seiBytesRead+=i.payload.byteLength}getReceiverStats(){const{seiBytesRead:i,seiReadCnt:c}=this;return{seiReadCnt:c,seiBytesRead:i}}onError(i,c){const{type:l}=i;this.emit(Wt,{type:l,stageErrorValue:c})}destroy(){var i,c;this.state!==Pt.DESTROYED&&(this.removeAllListeners(),(i=this.worker)===null||i===void 0||i.removeEventListener("message",this.onMessage),!((c=this.transceiver)===null||c===void 0)&&c.receiver&&(this.transceiver.receiver.transform=null),this.state=Pt.DESTROYED)}getState(){return this.state}}class Wu{constructor(i){this.sessionId=i,this.state=Pt.CREATED,this.transformerId=Va().value,this.seiWriteCnt=0,this.seiBytesWritten=0,this.onMessage=c=>{this.onTransformResult(c.data)}}initializeInsertableStreams(i,c){var l,f;this.worker=ho.getWorker(this.sessionId);const n=i.sender.createEncodedStreams(),{readable:e,writable:t}=n;(l=this.worker)===null||l===void 0||l.postMessage({operation:"video/send",transformerId:this.transformerId,readable:e,writable:t},[e,t]),(f=this.worker)===null||f===void 0||f.addEventListener("message",this.onMessage)}initializeEncodedTransforms(i,c){var l;this.worker=ho.getWorker(this.sessionId);const f={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:c};i.sender.transform=new RTCRtpScriptTransform(this.worker,f),(l=this.worker)===null||l===void 0||l.addEventListener("message",this.onMessage)}initialize(i){var c;if(this.state!==Pt.CREATED)return!1;const l=Hi(i);if(l===wr.NONE)return!1;const f=i.sender.getParameters(),n=((c=f==null?void 0:f.encodings)===null||c===void 0?void 0:c.length)||1;if(l===wr.INSERTABLE_STREAMS)this.initializeInsertableStreams(i,n);else{if(l!==wr.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(i,n)}return this.transceiver=i,this.state=Pt.INITIALIZED,!0}static isSupported(i){return Hi(i)!==wr.NONE}sendSeiMessage(i,c){var l;return this.state===Pt.INITIALIZED&&this.transceiver?((l=this.worker)===null||l===void 0||l.postMessage({operation:"insertSei",transformerId:this.transformerId,payload:i,repeatCount:c}),Ue.ok(!0)):Ue.err(Xe.NOT_PUBLISHING_VIDEO)}onTransceiverAdd(i){return this.initialize(i)}onTrackEvent(i){return!1}onTransformResult(i){return i.transformerId===this.transformerId&&(i.success&&this.updateSendStats(i),i.success)}updateSendStats(i){i.seiResult&&i.seiResult.forEach(c=>{this.seiWriteCnt++,this.seiBytesWritten+=c.payload.byteLength})}getSenderStats(){const{seiBytesWritten:i,seiWriteCnt:c}=this;return{seiWriteCnt:c,seiBytesWritten:i}}destroy(){var i;this.state!==Pt.DESTROYED&&(!((i=this.transceiver)===null||i===void 0)&&i.receiver&&(this.transceiver.receiver.transform=null),this.state=Pt.DESTROYED)}getState(){return this.state}}class fo extends Et{constructor(i,c,l,f,n,e,t,o,s){super(et.SELECTED_PAIR_CHANGE,c,l,!1),Object.assign(this.properties,{action:i,protocol:f,local_type:n,local_addr:e,remote_addr:t,local_candidate_priority:o,remote_participant_id:s})}}var En=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};let Jo=null;class _n extends It{constructor(i,c,l,f,n,e,t,o,s){var h;if(super(),this.analyticsTracker=e,this.subscribeConfig=s,this.sfuResource={node:"",cluster:""},this.protocol="",this.incompatibleCodecs=new Set,this.connect=({audioOnly:y=!1,traceId:T,iceRestartOptions:P})=>En(this,void 0,void 0,function*(){const{token:M,tag:L,identifier:B,action:U}=this,F=!!P,q=new AbortController;let Y,z,re;this.abortController=q,this.traceId=T,this.protocol="",this.perfTracker.resetMeasurements(T);const ue=()=>{Y&&this.off(sa,Y),z&&this.off(Kt,z)},le=new Promise((ve,be)=>{const ye=function({action:Me,token:Le,traceId:Ae,tag:Pe,identifier:qe}){const gt=Me===Oe.SUBSCRIBE?_e.SUBSCRIBE_TIMED_OUT:_e.PUBLISH_TIMED_OUT;return new ct(Object.assign(Object.assign({},gt),{action:Me,token:Le,traceId:Ae,tag:Pe,location:"connect",remoteParticipantId:qe}))}({action:U,token:M,traceId:T,tag:L,identifier:B}),pe=function({action:Me,token:Le,traceId:Ae,tag:Pe}){const qe=_e.OPERATION_ABORTED;return new ct(Object.assign(Object.assign({},qe),{token:Le,traceId:Ae,location:"peer-client.connect",tag:Pe,action:Me}))}({action:U,token:M,traceId:T,tag:L}),Re=setTimeout(()=>{this.stop(),this.analyticsTracker.trackError(ye),be(ye)},1e4);Y=Me=>{clearTimeout(Re),F||this.stop(),be(Me)},z=Me=>{if(Me===Je.CONNECTED)clearTimeout(Re),ve();else if(Me===Je.FAILED){const Le=function({action:Ae,token:Pe,traceId:qe,tag:gt}){return new ct(Object.assign(Object.assign({},_e.PEER_CONNECTION_NETWORK_FAILURE),{token:Pe,traceId:qe,location:"peer-client.connect",tag:gt,action:Ae}))}({action:U,token:M,traceId:T,tag:L});clearTimeout(Re),be(Le)}},this.on(sa,Y),this.on(Kt,z),re=()=>{clearTimeout(Re)},q.signal.aborted&&(clearTimeout(Re),be(pe)),q.signal.addEventListener("abort",()=>{clearTimeout(Re),be(pe)})});try{const ve=yield Promise.all([En(this,void 0,void 0,function*(){F||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(y));const ye=P==null?void 0:P.assignmentToken,pe=P==null?void 0:P.nodeOverride;return yield this.exchangeSdp({iceRestart:F,nodeOverride:pe,assignmentToken:ye,abortController:q}),this.mediaStream}),le]);this.statsReporter.traceId=T;const be=ve[0];if(this.abortController=void 0,!F&&U===Oe.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(ye){this.logger.error({err:ye,msg:"error syncing transceivers"})}return{mediaStream:be}}catch(ve){throw re&&re(),ve}finally{ue()}}),this.disconnect=(y=!1)=>En(this,void 0,void 0,function*(){var T;const{token:P,action:M}=this;(T=this.abortController)===null||T===void 0||T.abort(),this.stop(),this.protocol="",y?this.cleanup(M,P.participantID,P,y):yield this.cleanup(M,P.participantID,P,y)}),this.resetTransformers=()=>{var y,T;(y=this.videoSenderTransformer)===null||y===void 0||y.destroy(),this.videoSenderTransformer=this.createVideoSenderTransformer(),(T=this.videoReceiverTransformer)===null||T===void 0||T.destroy(),this.videoReceiverTransformer=this.createVideoReceiverTransformer(),this.statsReporter.resetTransformers(this.videoReceiverTransformer,this.videoSenderTransformer)},this.onTrack=y=>{var T,P;const{token:M,action:L,traceId:B,identifier:U}=this;this.trace(M,B,`onTrack: ${y.track.kind}`,L,U),this.sendInBandMessagingEnabled&&((T=this.videoSenderTransformer)===null||T===void 0||T.onTrackEvent(y)),this.receiveInBandMessagingEnabled&&((P=this.videoReceiverTransformer)===null||P===void 0||P.onTrackEvent(y))},this.onIceGatheringStateChange=()=>{var y,T,P;const{token:M,action:L,traceId:B,identifier:U}=this;if(((y=this.peerConnection)===null||y===void 0?void 0:y.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((T=this.peerConnection)===null||T===void 0?void 0:T.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const F=this.peerConnection.iceGatheringState,q=new Eu(L,M,B,F,U);this.analyticsTracker.trackEventNoSharedProps(q)}this.trace(M,B,`ICE gathering state change: ${(P=this.peerConnection)===null||P===void 0?void 0:P.iceGatheringState}`,L,U)},this.onSelectedCandidatePairChange=()=>{var y,T,P,M,L,B,U,F,q,Y,z,re,ue,le;const{token:ve,action:be,traceId:ye,identifier:pe}=this,Re=(T=(y=this.peerConnection)===null||y===void 0?void 0:y.getReceivers()[0].transport)===null||T===void 0?void 0:T.iceTransport,Me=Re==null?void 0:Re.getSelectedCandidatePair();if(Me){const{local:Le,remote:Ae}=Me,Pe=`Selected candidate pair change (local, remote): ${Le==null?void 0:Le.candidate}, ${Ae==null?void 0:Ae.candidate}`;this.logger.debug({msg:Pe});const qe=new fo(be,ve,ye,(M=(P=Me.local)===null||P===void 0?void 0:P.protocol)!==null&&M!==void 0?M:"",(B=(L=Me.local)===null||L===void 0?void 0:L.type)!==null&&B!==void 0?B:"",(F=(U=Me.local)===null||U===void 0?void 0:U.address)!==null&&F!==void 0?F:"",(Y=(q=Me.remote)===null||q===void 0?void 0:q.address)!==null&&Y!==void 0?Y:"",(re=(z=Me.local)===null||z===void 0?void 0:z.priority)!==null&&re!==void 0?re:0,pe);this.analyticsTracker.trackEvent(qe),this.protocol=(le=(ue=Me.local)===null||ue===void 0?void 0:ue.protocol)!==null&&le!==void 0?le:""}},this.onIceCandidate=y=>En(this,void 0,void 0,function*(){var T,P;const{identifier:M,action:L,traceId:B}=this,U=(T=y.target.localDescription)===null||T===void 0?void 0:T.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new fa(this.token,B,`ice candidate: hasRelay = ${U}, candidate = ${(P=y.candidate)===null||P===void 0?void 0:P.candidate}`,L,M))}),this.onMute=()=>En(this,void 0,void 0,function*(){const{token:y,action:T,traceId:P,identifier:M}=this;this.trace(y,P,"Track has muted",T,M)}),this.onUnMute=()=>En(this,void 0,void 0,function*(){const{token:y,action:T,traceId:P,identifier:M}=this;this.trace(y,P,"Track has unmuted",T,M)}),this.fetchAndSetRemoteDescription=y=>En(this,void 0,void 0,function*(){var T,P,M,L;const B=(P=(T=this.peerConnection)===null||T===void 0?void 0:T.localDescription)===null||P===void 0?void 0:P.sdp;B||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:U,traceId:F,action:q,identifier:Y,tag:z}=this,{endpointURL:re,nodeOverride:ue,assignmentToken:le,multiCodec:ve,abortController:be}=y;let ye;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{const Ae=Il({connection:this.stageConnection,action:q,token:U,identifier:this.identifier,tracker:this.analyticsTracker});this.perfTracker.setTransport(Ae.getTransport());const Pe=ue||fr("node")||fr("dataPlaneEndpoint");ye=yield Ae.exchange({sdpOffer:B,url:re,traceId:F,forceNode:Pe,assignmentToken:le,multiCodec:ve,abortController:be,initialLayerPreference:(M=this.simulcastSubscribeConfig)===null||M===void 0?void 0:M.initialLayerPreference})}catch(Ae){let Pe=Ae;Pe instanceof ct||(Pe=new ct(Object.assign(Object.assign({},_e.UNEXPECTED_ERROR),{action:q,token:U,traceId:F,tag:z,details:Ae instanceof Error?Ae.message:"",location:"sdp-exchange"}))),Pe instanceof ct&&(this.analyticsTracker.trackError(Pe),this.emit(sa,Pe))}if(this.perfTracker.markSdpExchangeStop(),!ye)return;const{location:pe,sessionDeleteLink:Re,mediaControls:Me}=ye;let Le=ye.sdpAnswer;try{Le=this.mungeSdpAnswer(Le),ye.sdpAnswer=Le}catch(Ae){this.logger.error({err:Ae,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=Le,this.emit(Bo,ye),pe&&(this.whipResource={location:pe,sessionDeleteLink:Re,mediaControls:Me},this.sfuResource=function(Ae){const Pe=Ae.match(/https:\/\/([^/]+)\//);if(Pe){const qe=Pe[1].split(".");if(qe[0].includes("video-rtx"))return{node:`${qe[0]}.${qe[1]}`,cluster:qe[1]}}}(pe)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(L=this.peerConnection)===null||L===void 0?void 0:L.setRemoteDescription({sdp:Le,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(Ae){const Pe=new ct(Object.assign(Object.assign({},_e.SET_ANSWER_FAILURE),{action:q,token:U,traceId:F,tag:Zt(q,Y),location:"setRemoteDescription",remoteParticipantId:Y,details:Ae instanceof Error?Ae.message:""}));this.analyticsTracker.trackError(Pe),this.emit(sa,Pe)}}),this.cleanup=(y,T,P,M=!1)=>En(this,void 0,void 0,function*(){var L,B,U;const F=Va();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,this.closeFailedPeerConnections(),!(!((L=this.whipResource)===null||L===void 0)&&L.location))return this.trace(P,this.traceId,"whipResource location not known, exiting cleanup",y,T),void this.analyticsTracker.trackError(new ct(Object.assign(Object.assign({},_e.WHIP_URL_MISSING),{action:y,token:P,traceId:this.traceId,tag:Zt(y,T),location:y===Oe.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:F,remoteParticipantId:T})));let q=this.whipResource.location;if(this.trace(P,this.traceId,`use hostnamecachedurl: ${q}`,y,T),M){if(!((U=this.whipResource)===null||U===void 0)&&U.sessionDeleteLink){q=this.whipResource.sessionDeleteLink,this.trace(P,this.traceId,`DELETE via session-delete beacon path: ${q}`,y,T);try{navigator.sendBeacon(q,JSON.stringify({authorization:P.rawToken}))}catch(Y){this.analyticsTracker.trackErrorAndThrow(new ct(Object.assign(Object.assign({},Fn(_e.WHIP_DELETE_FAILURE,Y)),{action:y,token:P,traceId:this.traceId,tag:Zt(y,T),location:Oe.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:F,remoteParticipantId:T})))}}}else try{yield k().delete(q,{headers:{Authorization:`Bearer ${P.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":F.value,"X-Stages-SDK":"1.28.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":ha}})}catch(Y){((B=Y.response)===null||B===void 0?void 0:B.status)===404?this.trace(P,this.traceId,`DELETE returned 404, ignoring, action = ${y}, uuid = ${F.value}`,y,T):this.analyticsTracker.trackErrorAndThrow(new ct(Object.assign(Object.assign({},Fn(_e.WHIP_DELETE_FAILURE,Y)),{action:y,token:P,traceId:this.traceId,tag:Zt(y,T),location:Oe.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:F,remoteParticipantId:T})))}}),this.getConnectionState=()=>{if(!this.peerConnection)return Je.NONE;const y=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return Ps(y)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:y}),Je.IDLE}},this.onIceCandidateError=y=>{const{token:T,traceId:P,tag:M}=this;if(y.errorCode!==701){const L=new ct(Object.assign(Object.assign({},_e.ICE_CANDIDATE_ERROR),{action:this.action,token:T,traceId:P,tag:M,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(L),this.emit(sa,L)}},this.onIceConnectionStateChange=()=>{var y,T;const{token:P,traceId:M,action:L,identifier:B}=this;this.trace(P,M,`ICE connection state change: ${(y=this.peerConnection)===null||y===void 0?void 0:y.iceConnectionState}`,L,B),((T=this.peerConnection)===null||T===void 0?void 0:T.iceConnectionState)==="checking"&&this.peerConnection.getTransceivers().forEach(({receiver:U,sender:F})=>{[U,F].forEach(q=>{var Y,z;(z=(Y=q==null?void 0:q.transport)===null||Y===void 0?void 0:Y.iceTransport)===null||z===void 0||z.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)})}),this.onConnectionStateChange()},this.createVideoSenderTransformer=()=>new Wu(this.analyticsTracker.getSessionId()),this.createVideoReceiverTransformer=()=>{const y=new Yo(this.analyticsTracker.getSessionId()),{token:T,tag:P,identifier:M,action:L,traceId:B}=this;y.on(ni,q=>{this.emit(bi,q)});const U=function(q,Y){let z=0;return function(...re){const ue=Date.now();ue-z>=Y&&(z=ue,q(...re))}}(q=>{const Y=`Transform error occurred: ${q.type}`,z=Hs({traceId:B,token:T,tag:P,identifier:M,action:L,details:Y,stageErrorValue:_e.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:z,msg:"Error encountered when transforming receiver",error:q})},1e3),F=q=>{const Y=`Too many errors occurred: ${q.type}`,z=Hs({traceId:B,token:T,tag:P,identifier:M,action:L,details:Y,stageErrorValue:_e.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:z,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:q}),y.destroy(),this.analyticsTracker.trackError(z),this.emit(Ui,z)};return y.on(Wt,q=>{q.stageErrorValue.code!==_e.TRANSFORM_TOO_MANY_ERRORS.code?U(q):F(q)}),y},this.onConnectionStateChange=()=>{if(this.peerConnection){const T=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:P,traceId:M,identifier:L,action:B}=this,U=new Su(B,P,M,T,L);this.analyticsTracker.trackEventNoSharedProps(U),this.trace(P,M,`connection state change: ${T}`,B,L)}const y=this.getConnectionState();switch(y){case Je.CONNECTED:this.closeFailedPeerConnections(),this.perfTracker.markActionStop(),this.emit(Kt,y),this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream);break;case Je.FAILED:this.storeFailedPeerConnection(this.peerConnection),this.destroyPeerConnection({closeConnection:!1}),this.emit(Kt,y),this.handleConnectionFailure();break;default:this.emit(Kt,y)}},this.onIncompatibleCodecs=y=>En(this,void 0,void 0,function*(){if(y.forEach(M=>{let L=!1;this.incompatibleCodecs.forEach(B=>{B.config===M.config&&B.mime===M.mime&&(L=!0)}),L||this.incompatibleCodecs.add(M)}),this.peerConnection)try{yield(T=this.peerConnection,P=[...this.incompatibleCodecs],Ms(void 0,void 0,void 0,function*(){var M;for(const L of T.getSenders()){const B=L.getParameters();if(B.codecs.length>1){const U=B.codecs[0];let F=!1;for(const q of P)Ya(U,q)&&(F=!0);if(F){const q=Bs(P,B.codecs);(M=B.encodings)===null||M===void 0||M.forEach(Y=>{Y.active&&(Y.codec=q)}),yield L.setParameters(B)}}}}))}catch(M){const{token:L,action:B,traceId:U,identifier:F}=this,q=new ct(Object.assign(Object.assign({},_e.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:B,token:L,traceId:U,tag:Zt(B,F),location:"onIncompatibleCodecs",remoteParticipantId:F,details:M instanceof Error?M.message:""}));this.analyticsTracker.trackError(q),this.emit(sa,q)}var T,P}),this.token=i,this.logger=new mt(c,Be.WEBRTC),this.action=l,this.tag=f,this.traceId=n,l===Oe.SUBSCRIBE&&!t)throw new Error("Subscribe action provided without subscriber Id");this.jitterBufferConfig=s==null?void 0:s.jitterBuffer,this.simulcastSubscribeConfig=s==null?void 0:s.simulcast,this.subscriberId=t,this.stageConnection=o,this.failedPeerConnections=[],this.receiveInBandMessagingEnabled=!!(!((h=this.subscribeConfig)===null||h===void 0)&&h.inBandMessaging.enabled),this.perfTracker=new Ot(this.action,this.traceId),this.statsReporter=new Gs(l,i,n,this.identifier,this.analyticsTracker),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var i,c;return(c=(i=this.videoTransceiver)===null||i===void 0?void 0:i.mid)!==null&&c!==void 0?c:null}toggleStageConnectionListeners(i){var c,l;i?(c=this.stageConnection)===null||c===void 0||c.on(hl,this.handlePublishingChangedBinding):(l=this.stageConnection)===null||l===void 0||l.off(hl,this.handlePublishingChangedBinding)}updateSubscribeConfig(i){var c,l;if(this.jitterBufferConfig=i.jitterBuffer,this.simulcastSubscribeConfig=i.simulcast,this.action===Oe.SUBSCRIBE){const f=i.inBandMessaging.enabled;this.receiveInBandMessagingEnabled!==f&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for receiver"})}this.applyJitterBufferMinDelayConditionally((l=(c=this.stageConnection)===null||c===void 0?void 0:c.getIsStagePublishing())!==null&&l!==void 0&&l)}verifyOrUpdateTransceiverSync(){var i,c;return En(this,void 0,void 0,function*(){if(this.publishVideoStream){const l=this.getTransceiverForKind("video");l?this.publishVideoStream.track.id!==((i=l.sender.track)===null||i===void 0?void 0:i.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishVideoStream)):this.logger.warn({msg:"missing transceiver for video"})}if(this.publishAudioStream){const l=this.getTransceiverForKind("audio");l?this.publishAudioStream.track.id!==((c=l.sender.track)===null||c===void 0?void 0:c.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishAudioStream)):this.logger.warn({msg:"missing transceiver for audio"})}})}start(){return En(this,void 0,void 0,function*(){const{token:i,action:c,traceId:l,identifier:f}=this;c!==Oe.PUBLISH||i.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new ct(Object.assign(Object.assign({},Fn(_e.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:c,token:i,traceId:l,tag:Zt(c,f),location:"StagePeerClient.start",remoteParticipantId:f})));const n=function({action:e,identifier:t,token:o,analyticsTracker:s}){let h="";const y=gu(o,s);switch(e){case Oe.PUBLISH:h=y.getPublishEndpoint();break;case Oe.SUBSCRIBE:t&&(h=y.getSubscribeEndpoint(t))}return h}({action:c,identifier:f,token:i.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.endpointURL=n,this.createPeerConnection(),this.trace(i,l,"peer connection created",c,f)}catch(e){const t=new ct(Object.assign(Object.assign({action:c},Fn(_e.CREATE_PEER_CONNECTION_FAILURE,e)),{token:i,traceId:l,tag:Zt(c,f),location:"StagePeerClient.start",remoteParticipantId:f}));c===Oe.PUBLISH&&this.emit(Kt,Je.FAILED),this.emit(sa,t),this.analyticsTracker.trackErrorAndThrow(t)}})}mungeSdpOffer(i,c,l){if(l.simulcastEnabled&&(i=new kt(i).withVideoLayersAllocationRtpHeaderExtension().sdp),c===Oe.SUBSCRIBE)i=new kt(i).withOpusAudioConfig(Ei(ma),!0).sdp;else if(c===Oe.PUBLISH&&l.audioConfig){const{maxBitrateBps:f,stereo:n}=l.audioConfig;i=new kt(i).withOpusAudioConfig(f,n).sdp}return i}mungeSdpAnswer(i){ko.browser.isFirefox()&&this.publishAudioStream&&this.action===Oe.PUBLISH&&(i=new kt(i).withOpusAudioConfig(this.publishAudioStream.config.maxBitrateBps,void 0).sdp);const c=ko.browser.isChrome()||ko.browser.isEdge();this.action===Oe.SUBSCRIBE&&c&&(i=new kt(i).withoutAudioRtcpRSize().sdp);const l=function(){const f=fr("subscribeForceIceProtocol");if(f==="tcp"||f==="udp")return f}();return this.action===Oe.SUBSCRIBE&&l&&(i=new kt(i).withFilteredCandidates(l).sdp),i}createPeerConnection(){var i;this.logger.debug({msg:"setting up peer connection"}),this.peerConnection&&(this.logger.debug({msg:"peer connection is already established, cleaning up previous connection"}),this.destroyPeerConnection({closeConnection:!1})),this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,(i=this.publishVideoStream)===null||i===void 0?void 0:i.config.simulcastEnabled),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute)}destroyPeerConnection(i){var c,l,f,n,e,t,o,s,h;this.statsReporter.stop(),(c=this.peerConnection)===null||c===void 0||c.removeEventListener("connectionstatechange",this.onConnectionStateChange),(l=this.peerConnection)===null||l===void 0||l.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(f=this.peerConnection)===null||f===void 0||f.removeEventListener("icecandidateerror",this.onIceCandidateError),(n=this.peerConnection)===null||n===void 0||n.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(e=this.peerConnection)===null||e===void 0||e.removeEventListener("icecandidate",this.onIceCandidate),(t=this.peerConnection)===null||t===void 0||t.removeEventListener("track",this.onTrack),(o=this.peerConnection)===null||o===void 0||o.removeEventListener("mute",this.onMute),(s=this.peerConnection)===null||s===void 0||s.removeEventListener("unmute",this.onUnMute),(i.closeConnection||this.action===Oe.PUBLISH)&&((h=this.peerConnection)===null||h===void 0||h.close()),this.peerConnection=void 0}closeFailedPeerConnections(){for(const i of this.failedPeerConnections)i==null||i.close();this.failedPeerConnections=[]}storeFailedPeerConnection(i){i&&this.action!==Oe.PUBLISH&&this.failedPeerConnections.push(i)}stop(){var i,c;(i=this.videoReceiverTransformer)===null||i===void 0||i.destroy(),(c=this.videoSenderTransformer)===null||c===void 0||c.destroy(),this.destroyPeerConnection({closeConnection:!0})}getTransceiverForKind(i){if(!this.peerConnection)return;const c=this.peerConnection.getTransceivers();return i==="audio"?c.find(l=>l.mid==="0"):i==="video"?c.find(l=>l.mid==="1"):void 0}removeTrack(i){return En(this,void 0,void 0,function*(){if(i==="audio"||i==="video")if(this.peerConnection)try{const c=this.getTransceiverForKind(i);if(!c)return void this.logger.warn({msg:`tried removing track type ${i} but couldn't find transceiver`});yield c.sender.replaceTrack(null),i===_t.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0,yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(c){this.logger.warn({msg:"error replacing track",err:c})}else i===_t.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:i})})}replaceOrUpdateStream(i){return En(this,void 0,void 0,function*(){if(i.track){if(_l(i)?this.publishAudioStream=i:Mu(i)&&(this.publishVideoStream=i),this.peerConnection)try{const c=this.getTransceiverForKind(i.track.kind);if(!c)return void this.logger.warn({msg:`tried replacing track type ${i.track.kind} but couldn't find transceiver`,track:i.track});if(Mu(i)){const l=c.sender.getParameters(),f=i.config.encodingLayers;l.encodings=l.encodings.map(n=>{var e;const t=(e=n.rid)!==null&&e!==void 0?e:"",o=f.find(s=>{var h;return((h=s.rid)!==null&&h!==void 0?h:"")===t});return o?Object.assign(Object.assign({},n),o):n}),yield c.sender.setParameters(l)}else if(_l(i)){const l=c.sender.getParameters(),f=Si(i)[0];l.encodings=l.encodings.map(n=>Object.assign(Object.assign({},n),f)),yield c.sender.setParameters(l)}yield c.sender.replaceTrack(i.track),yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(c){this.logger.warn({msg:"error replacing track",err:c})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateStream with no track"})})}initializePeerConnection(i=!1){var c,l,f,n,e,t,o,s;return En(this,void 0,void 0,function*(){const{traceId:h,token:y,action:T,identifier:P}=this;Mr(this.peerConnection),this.resetTransformers();let M=new MediaStream;if(T===Oe.PUBLISH){this.publishAudioStream||(this.publishAudioStream={track:this.getSilentAudio(),config:{maxBitrateBps:Ei(qa),stereo:!1}});const L=this.peerConnection.getTransceivers(),B=[];L.forEach(ue=>{var le;B.concat((le=ue.sender.track)===null||le===void 0?void 0:le.id)}),M=new MediaStream([this.publishAudioStream.track,(c=this.publishVideoStream)===null||c===void 0?void 0:c.track].filter(ue=>!!ue&&!B.includes(ue.id)));const U=M.getAudioTracks()[0]||"audio",F=M.getVideoTracks()[0]||"video",q={direction:"sendonly",streams:[M],sendEncodings:Si(this.publishAudioStream)},Y={direction:"sendrecv",streams:[M],sendEncodings:(l=this.publishVideoStream)===null||l===void 0?void 0:l.config.encodingLayers};this.peerConnection.addTransceiver(U,q),this.trace(y,h,`track added, type: ${U.kind||U}`,T,P);const z=this.peerConnection.addTransceiver(F,Y);this.trace(y,h,`track added, type: ${F.kind||F}`,T,P);const re=!!(!((n=(f=this.publishVideoStream)===null||f===void 0?void 0:f.config)===null||n===void 0)&&n.inBandMessagingEnabled);this.sendInBandMessagingEnabled===void 0?this.sendInBandMessagingEnabled=re:this.sendInBandMessagingEnabled!==re&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for sender"}),this.sendInBandMessagingEnabled&&!Wu.isSupported(z)?this.handleTransformNotSupported():this.sendInBandMessagingEnabled&&((e=this.videoSenderTransformer)===null||e===void 0||e.onTransceiverAdd(z))}else T===Oe.SUBSCRIBE&&(y.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(y,h,"track added, type: audio",T,P),i||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(y,h,"track added, type: video",T,P),this.receiveInBandMessagingEnabled&&!Yo.isSupported(this.videoTransceiver)?this.handleTransformNotSupported():this.receiveInBandMessagingEnabled&&((t=this.videoReceiverTransformer)===null||t===void 0||t.onTransceiverAdd(this.videoTransceiver))),this.peerConnection.getTransceivers().forEach(L=>{L.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),M==null||M.addTrack(L.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})}),this.applyJitterBufferMinDelayConditionally((s=(o=this.stageConnection)===null||o===void 0?void 0:o.getIsStagePublishing())!==null&&s!==void 0&&s));return M})}handlePublishingChanged(i){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${i}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===Oe.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(i)}applyJitterBufferMinDelayConditionally(i){const c=this.currentJitterBufferMinDelayInMs,l=this.calcJitterBufferMinDelay(i,this.jitterBufferConfig);if(i){if(c===void 0||c>l){const f=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${l}`;this.logger.debug({msg:f}),this.trace(this.token,this.traceId,f,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(l)}}else if(c===void 0||l!==c){const f=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${l}`;this.logger.debug({msg:f}),this.trace(this.token,this.traceId,f,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(l)}}calcJitterBufferMinDelay(i,c){var l,f,n;let e=0;if(!(()=>{const t=RTCRtpReceiver.prototype;return!(!t||typeof t!="object")&&("jitterBufferTarget"in t||"playoutDelayHint"in t)})())return 0;if(i)e=ti((l=c==null?void 0:c.minDelayWhenPublishing)!==null&&l!==void 0?l:Cr.DEFAULT,i);else{e=ti((f=c==null?void 0:c.minDelayWhenSubscribeOnly)!==null&&f!==void 0?f:Cr.DEFAULT,i);const t=(n=this.stageConnection)===null||n===void 0?void 0:n.jitterBufferMinDelayInMs();(c==null?void 0:c.minDelayWhenSubscribeOnly)===Cr.DEFAULT&&t!==void 0&&(e=t,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${e}`}))}return e}applyAndTrackJitterBufferMinDelay(i){var c,l;this.currentJitterBufferMinDelayInMs=i,this.statsReporter.updateJitterBufferMinDelay(i),i!==void 0&&((l=(c=this.peerConnection)===null||c===void 0?void 0:c.getTransceivers())===null||l===void 0||l.forEach(f=>{f.receiver&&this.applyJitterBufferMinDelay(f.receiver,i)}))}applyJitterBufferMinDelay(i,c){let l="Unable to set jitter buffer min delay";if("jitterBufferTarget"in i)l=`setting jitterBufferTarget to: ${c} for track: ${i.track.kind}`,this.logger.debug({msg:l}),i.jitterBufferTarget=c;else if("playoutDelayHint"in i){const f=c/1e3;l=`setting playoutDelayHint to: ${c} for track: ${i.track.kind}`,this.logger.debug({msg:l}),i.playoutDelayHint=f}else this.logger.warn({msg:l});this.trace(this.token,this.traceId,l,this.action,this.identifier)}exchangeSdp(i){var c,l,f;return En(this,void 0,void 0,function*(){const{traceId:n,token:e,action:t,identifier:o,tag:s,endpointURL:h}=this,{iceRestart:y=!1,nodeOverride:T,assignmentToken:P,abortController:M}=i;let L;this.logger.debug({msg:`Exchanging SDP: ${n.value}, iceRestart=${y}, nodeOverride=${T}, assignmentToken=${P}`}),Mr(this.peerConnection),t===Oe.PUBLISH&&vc()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((U,F)=>{var q,Y;const z=(q=RTCRtpReceiver.getCapabilities("video"))===null||q===void 0?void 0:q.codecs;if(!z)return;let re=z;re=Ls(z,"42e0"),F.preferMainProfile&&(re=Ls(z,"4d00")),(Y=U.getTransceivers().find(ue=>ue.receiver.track.kind==="video"))===null||Y===void 0||Y.setCodecPreferences(re)})(this.peerConnection,{preferMainProfile:vc()}));try{this.trace(e,n,"Creating offer",t,o),L=yield this.peerConnection.createOffer({iceRestart:y})}catch(U){const F=new ct(Object.assign(Object.assign({},Fn(_e.CREATE_OFFER_FAILURE,U)),{action:t,token:e,traceId:n,tag:s,location:"exchangeSdp",remoteParticipantId:o}));this.emit(sa,F),this.analyticsTracker.trackErrorAndThrow(F)}L.sdp&&(L.sdp=this.mungeSdpOffer(L.sdp,t,{simulcastEnabled:(l=(c=this.publishVideoStream)===null||c===void 0?void 0:c.config.simulcastEnabled)!==null&&l!==void 0&&l,audioConfig:(f=this.publishAudioStream)===null||f===void 0?void 0:f.config})),this.trace(e,n,"Setting local description",t,o),yield this.peerConnection.setLocalDescription(L),this.trace(e,n,"local description set",t,o),h||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const B=t===Oe.PUBLISH&&vc()||t===Oe.SUBSCRIBE&&jn("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:h,nodeOverride:T,assignmentToken:P,multiCodec:B,abortController:M})})}getReports(){var i;return En(this,void 0,void 0,function*(){try{const c=(yield(i=this.peerConnection)===null||i===void 0?void 0:i.getStats())||[],l=[];return c.forEach(f=>{l.push(f)}),l}catch{return[]}})}requestRTCStats(i){return En(this,void 0,void 0,function*(){if(this.peerConnection)return this.statsReporter.getStats(i)})}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:i,tag:c,identifier:l,action:f,traceId:n}=this,e=Hs({traceId:n,token:i,tag:c,identifier:l,action:f,stageErrorValue:_e.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:e,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(e),this.emit(Ui,e)}handleConnectionFailure(){return En(this,void 0,void 0,function*(){const{token:i,traceId:c,tag:l}=this;this.analyticsTracker.trackError(new ct(Object.assign(Object.assign({},_e.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:i,traceId:c,tag:l,location:"onIceCandidateError",remoteParticipantId:this.identifier})))})}getSilentAudio(){Jo||(Jo=new AudioContext);const i=Jo.createOscillator(),c=Jo.createGain();i.connect(c);const l=Jo.createMediaStreamDestination();return c.connect(l),c.gain.value=0,i.start(),l.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}getProtocol(){return this.protocol}initStreamsToPublish(i){this.publishVideoStream=i.find(Mu),this.publishAudioStream=i.find(_l)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var i,c;return this.calcJitterBufferMinDelay((c=(i=this.stageConnection)===null||i===void 0?void 0:i.getIsStagePublishing())!==null&&c!==void 0&&c,this.jitterBufferConfig)}trace(i,c,l,f,n){this.analyticsTracker.trackEventNoSharedProps(new fa(i,c,l,f,n))}sendSeiMessage(i,c){const l=this.getTransceiverForKind("video");return this.videoSenderTransformer&&this.sendInBandMessagingEnabled?this.action===Oe.PUBLISH&&l?this.videoSenderTransformer.sendSeiMessage(i,c):Ue.err(Xe.NOT_PUBLISHING_VIDEO):Ue.err(Xe.INBAND_MESSAGING_NOT_ENABLED)}}const Ct=Oe.SUBSCRIBE;class Vn{constructor(i,c,l){this.analyticsTracker=i,this.token=c,this.remoteId=l,this.action=Ct}trackAttempt({stageConnectionStats:i,isReassignment:c=!1,traceIdOverride:l,preAttemptSfuResource:f}){const{action:n,analyticsTracker:e,token:t,remoteId:o}=this,s=l||Nr();return e.trackEvent(new Lu({token:this.token,subscribedId:this.remoteId,traceId:s,isEdpConnected:i.isConnected,isReassignment:c,preAttemptSfuResource:f})),{getTraceId:()=>s,trackSubscribeStarted({totalDurationWithRetries:h,retryTimes:y,sfuResource:T,peerClientPerfStats:P,protocol:M}){const{optionsDuration:L,postDuration:B,timeToCandidate:U,timeToConnected:F,sdpExchangeDuration:q,sdpExchangeTransport:Y,setRemoteDescDuration:z,peerConnectionDuration:re}=P,{edpInitialConnectDuration:ue,edpInitialConnectRetries:le,edpInitialStateDuration:ve,edpInitialStatePublishingCount:be,edpStateUpdateCount:ye}=i;e.trackEvent(new Sh({token:t,traceId:s,remoteParticipantId:o,optionsDuration:L,postDuration:B,timeToCandidate:U,totalDuration:F,edpInitialConnectDuration:ue,edpInitialConnectRetries:le,edpInitialStateDuration:ve,edpInitialStatePublishingCount:be,edpStateUpdateCount:ye,sdpExchangeDuration:q,sdpExchangeTransport:Y,setRemoteDescDuration:z,peerConnectionDuration:re,sfuResource:T,totalDurationWithRetries:h,subscribeRetryTimes:y,isReassignment:c,protocol:M}))},trackSubscribeFirstFrame:({peerClientPerfStats:h,totalDurationWithRetries:y,sfuResource:T,retryTimes:P,currentJitterBufferMinDelayInMs:M,mediaType:L,firstFrameDuration:B,protocol:U})=>{const{sdpExchangeDuration:F,sdpExchangeTransport:q,setRemoteDescDuration:Y,peerConnectionDuration:z}=h,{edpInitialConnectDuration:re,edpInitialConnectRetries:ue,edpInitialStateDuration:le,edpInitialStatePublishingCount:ve,edpStateUpdateCount:be}=i;this.analyticsTracker.trackEvent(new Bu({token:this.token,traceId:s,remoteParticipantId:o,edpInitialConnectDuration:re,edpInitialConnectRetries:ue,edpInitialStateDuration:le,edpInitialStatePublishingCount:ve,edpStateUpdateCount:be,sdpExchangeDuration:F,sdpExchangeTransport:q,setRemoteDescDuration:Y,peerConnectionDuration:z,videoWasPaused:!1,firstFrameDuration:B,mediaType:L,sfuResource:T,totalDurationWithRetries:y,subscribeRetryTimes:P,currentJitterBufferMinDelayInMs:M,protocol:U}))},trackSubscribeFailed(h,y,T){const P=((B,U,F)=>{if(B instanceof ct)return B;let q="";return B instanceof ua.AxiosError&&(q+=`AxiosError - ${B.code}`),new ct(Object.assign(Object.assign(Object.assign({},_e.SUBSCRIBE_FAILURE),{action:Ct,token:U,traceId:F,tag:qr,location:"subscribe",details:`${q} ${B==null?void 0:B.message}`}),{fatal:!0}))})(h,t,s);e.trackEvent(new Eh({token:t,traceId:s,remoteParticipantId:o,code:P.code,message:P.message,fatal:P.fatal,nominal:P.nominal,isReassignment:c,protocol:y}));const{isConnected:M}=i,L=new ct(Object.assign(Object.assign({},_e.SUBSCRIBE_FAILURE),{action:n,token:t,traceId:s,tag:Zt(Oe.SUBSCRIBE,o),location:"subscribe",remoteParticipantId:o,isEdpConnected:M,details:T}));return h instanceof ct&&(L.fatal=h.fatal,L.nominal=h.nominal,L.location=`subscribe > ${h.location}`),e.trackError(L),P},trackUnsubscribe:()=>{e.trackEvent(new hd({token:t,unsubscribedId:o,traceId:s}))},trackEndSucceeded:(h,y)=>{e.trackEvent(new Rl({token:t,traceId:s,remoteParticipantId:o,isUnsubscribeSuccessful:!0,reason:h,protocol:y}))},trackEndFailed:(h,y)=>{const T=new ct(Object.assign(Object.assign({},_e.UNSUBSCRIBE_FAILURE),{token:t,traceId:s,tag:Zt(Oe.SUBSCRIBE,o),location:"unsubscribe",remoteParticipantId:o}));return h!==Kr.UNLOAD&&h!==Kr.UNSUBSCRIBE||e.trackError(T),e.trackEvent(new Rl({token:t,traceId:s,remoteParticipantId:o,isUnsubscribeSuccessful:!0,reason:h,protocol:y})),T}}}}class kl extends Et{constructor(i,c,l,f,n,e){super(et.PLAYBACK_LAYER_REQUEST,i,c,!1),Object.assign(this.properties,{media_type:l,remote_participant_id:f,track_id:n,layer_id:e})}}class zs extends Et{constructor(i,c,l,f,n,e=1){super(et.PLAYBACK_LAYER_STATE,i,c,!1),Object.assign(this.properties,{media_type:l,remote_participant_id:f,track_id:n,request_count:e})}}var po,Kn,ya,zt;(function(u){u.PAUSE="pause",u.PLAY="play"})(po||(po={})),function(u){u.IDLE="idle",u.ACTIVE="active",u.ERRORED="errored",u.DESTROYED="destroyed"}(Kn||(Kn={})),function(u){u.SUCCESS="success"}(ya||(ya={})),function(u){u.FAILED="failed",u.DESTROYED="destroyed",u.THROTTLED="throttled"}(zt||(zt={}));var kn=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class qs{constructor(i){this.state=Kn.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>kn(this,void 0,void 0,function*(){return this.state!==Kn.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(po.PAUSE)}),this.startVideo=()=>kn(this,void 0,void 0,function*(){return this.state!==Kn.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(po.PLAY)}),this.setLayer=c=>kn(this,void 0,void 0,function*(){return this.state!==Kn.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(c)}),this.unsetLayer=()=>kn(this,void 0,void 0,function*(){return this.state!==Kn.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()}),this.getLayers=()=>kn(this,void 0,void 0,function*(){return this.state!==Kn.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()}),this.sendPlaybackRequest=c=>kn(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Ue.err)(zt.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,Ue.err)(zt.FAILED);this.logger.info({msg:`Sending ${c} request to ${this.playbackEndpoint}`});const l=c===po.PAUSE?{pause:[this.mid]}:{play:[this.mid]},f=this.createPostWhepRequest(l);return fetch(this.playbackEndpoint,f).then(n=>{if(n.status>=300){const e=new Error(`Error sending media controls request: ${n.status}:${n.statusText}`);return this.logger.error({err:e}),(0,Ue.err)(zt.FAILED)}return this.logger.debug({msg:`Request to ${c} was successful: ${n.status}`}),(0,Ue.ok)(ya.SUCCESS)}).catch(n=>(this.logger.error({err:n,msg:"Error sending media controls request"}),(0,Ue.err)(zt.FAILED)))}),this.sendLayerRequest=c=>kn(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Ue.err)(zt.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Ue.err)(zt.FAILED);const l=typeof c=="string",f=l?{mediaId:this.mid,encodingId:c}:{},n=l?`set : ${c}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${n} at ${this.layersEndpoint}`});const e=this.createPostWhepRequest(f);return this.trackLayerRequest(c??"auto"),fetch(this.layersEndpoint,e).then(t=>this.state===Kn.DESTROYED?(0,Ue.err)(zt.DESTROYED):t.status>=300?this.handleLayerRequestError(t.status,t.statusText):(this.logger.debug({msg:`Request to ${n} was successful: ${t.status}`}),(0,Ue.ok)(ya.SUCCESS))).catch(t=>this.handleLayerRequestError(0,t.message))}),this.sendLayerStateRequest=()=>kn(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Ue.err)(zt.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Ue.err)(zt.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const c=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,c).then(l=>kn(this,void 0,void 0,function*(){var f;if(this.state===Kn.DESTROYED)return(0,Ue.err)(zt.DESTROYED);if(l.status>=300)return this.handleLayerStateRequestError(l.status,l.statusText);const n=yield l.json(),e=(f=n==null?void 0:n.layers)!==null&&f!==void 0?f:[],t=JSON.stringify(e,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${t}`}),(0,Ue.ok)(e)})).catch(l=>this.handleLayerStateRequestError(0,l.message))}),this.logger=new mt(i.logger,Be.REMOTE_PLAYBACK),this.token=i.token,this.traceId=i.traceId,this.analyticsTracker=i.analyticsTracker,this.remoteParticipantId=i.remoteParticipantId}set mediaId(i){if(this.state!==Kn.DESTROYED){if(this.mid=i,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Kn.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Kn.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(i){var c,l;if(this.state!==Kn.DESTROYED){if(this.playbackEndpoint=(c=i.playback)!==null&&c!==void 0?c:null,this.layersEndpoint=(l=i.layers)!==null&&l!==void 0?l:null,!this.playbackEndpoint||!this.layersEndpoint){const f={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(f,null)}`}),void(this.state=Kn.IDLE)}this.mid&&(this.state=Kn.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Kn.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(i="command"){this.logger.info({msg:`skipping ${i}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(i){return i===Kn.DESTROYED?(0,Ue.err)(zt.DESTROYED):(0,Ue.err)(zt.FAILED)}createPostWhepRequest(i){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(i)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var i,c;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":Va().value,"X-Stages-SDK":"1.28.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(c=(i=this.traceId)===null||i===void 0?void 0:i.value)!==null&&c!==void 0?c:"","X-Stages-WHIP-Version":ha}}trackLayerRequest(i){var c;this.analyticsTracker.trackEventNoSharedProps(new kl(this.token,this.traceId,ht.VIDEO,this.remoteParticipantId,(c=this.mid)!==null&&c!==void 0?c:"unknown",i))}trackLayerStateRequest(i=1){var c;this.analyticsTracker.trackEventNoSharedProps(new zs(this.token,this.traceId,ht.VIDEO,this.remoteParticipantId,(c=this.mid)!==null&&c!==void 0?c:"unknown",i))}handleLayerRequestError(i,c){const l=`sendLayerRequest failed for reason: ${i} ${c}`;let f,n;return i===429?(f=zt.THROTTLED,n=_e.WHEP_SET_LAYER_REQUEST_THROTTLED):(f=zt.FAILED,n=_e.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(n,l),(0,Ue.err)(f)}handleLayerStateRequestError(i,c){const l=`sendLayerStateRequest failed for reason: ${i} ${c}`;let f,n;return i===429?(f=zt.THROTTLED,n=_e.WHEP_GET_LAYER_STATE_THROTTLED):(f=zt.FAILED,n=_e.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(n,l),(0,Ue.err)(f)}trackRequestError(i,c){const l=new Error(c);this.logger.error({err:l}),i.message=c;const f=this.createError(i);this.analyticsTracker.trackError(f)}createError(i,c){return new ct(Object.assign({action:Oe.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:qr,details:c},i))}}var $c,Vc,An,He,St=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})},ri=function(u,i,c,l){if(c==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?u!==i||!l:!i.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?l:c==="a"?l.call(u):l?l.value:i.get(u)};(function(u){u.DISCONNECTED="disconnected",u.CONNECTING="connecting",u.CONNECTED="connected",u.ERRORED="errored"})(An||(An={})),function(u){u.NONE="none",u.AUDIO_ONLY="audio_only",u.AUDIO_VIDEO="audio_video"}(He||(He={}));class Ri extends It{constructor(i,c,l,f,n,e,t){super(),this.id=i,this.token=c,this.stageConnection=l,this.nonScopedLogger=f,this.analyticsTracker=n,this.desiredSubscribeType=e,$c.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:An.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new kc(1e3),this.cleanupFirstFrameTracking=Wa,this.actualSubscribeType=He.NONE,this.action=Oe.SUBSCRIBE,this.updateDesiredSubscribeType=s=>{this.desiredSubscribeType=s,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=s=>{this.peerClient.updateSubscribeConfig(s)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const s=this.actualSubscribeType,h=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${h}`}),this.subscriptionState.connectionState===An.CONNECTED&&h!==He.NONE&&s!==h&&this.applyVideoControlsBySubscribeType(h,s)},this.onParticipantUpdated=s=>{ri(this,$c,"m",Vc).call(this,s)&&(this.logger.debug({msg:"onParticipantUpdated",participant:s}),this.processStateUpdate({isTargetPublishing:s.isPublishing}))},this.onParticipantJoined=s=>{ri(this,$c,"m",Vc).call(this,s)&&(this.logger.debug({msg:"onParticipantJoined",participant:s}),this.processStateUpdate({isTargetPublishing:s.isPublishing}))},this.onParticipantLeft=s=>{ri(this,$c,"m",Vc).call(this,s)&&(this.logger.debug({msg:"onParticipantLeft",participant:s}),this.processStateUpdate({isTargetPublishing:!1}))},this.onPeerClientConnectionStateChange=s=>{const h=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${s}`,state:s,targetParticipant:h}),this.processStateUpdate({peerClientState:s})},this.onPeerClientTransformError=s=>{this.emit(pl,s)},this.onSdpNegotiated=s=>{this.remotePlaybackController.endpoints={playback:s.mediaControls,layers:s.layerControls}},this.seiMessageHandler=s=>{this.emit(pu,s)},this.requestRTCStats=s=>St(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(s)}),this.trySubscribe=s=>St(this,void 0,void 0,function*(){var h,y;if(this.logger.debug({msg:`Subscribe attempt started: ${s}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==An.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:An.CONNECTING}));const T=this.stageConnection.getConnectionStats(),P=this.peerClient.getExpectedJitterBufferMinDelayInMs(),M=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:T,preAttemptSfuResource:M});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:L}=yield this.subscribe(this.attemptTracker.getTraceId()),B=performance.now()-this.startConnectingTimestamp,U=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const F=this.failedRetries;this.attemptToActualizeSubscribeType();const q=this.peerClient.getActionMeasurements(),Y=this.peerClient.getProtocol();if(this.attemptTracker.trackSubscribeStarted({sfuResource:U,totalDurationWithRetries:B,retryTimes:F,peerClientPerfStats:q,protocol:Y}),L){this.cleanupFirstFrameTracking();const z=this.actualSubscribeType,re=this.attemptTracker,ue=(le,ve)=>{re.trackSubscribeFirstFrame({peerClientPerfStats:q,sfuResource:U,totalDurationWithRetries:B,retryTimes:F,currentJitterBufferMinDelayInMs:P,mediaType:ve,firstFrameDuration:le,protocol:Y})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:L,subscribeType:z,callback:ue})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,L&&this.emit(wc,L,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(L){const B=(y=(h=this.peerClient)===null||h===void 0?void 0:h.getProtocol())!==null&&y!==void 0?y:"",U=this.attemptTracker.trackSubscribeFailed(L,B);this.logger.error({log:"Subscribe attempt failed",err:L}),this.onTrySubscribeFailure(U,s)}return!1});const o=Nr();this.peerClient=new _n(c,this.nonScopedLogger,this.action,Zt(this.action,i),o,n,i,l,t),this.logger=new mt(f,Be.SUBSCRIPTION),this.subscribeTracker=new Vn(this.analyticsTracker,c,i),this.remotePlaybackController=new qs({token:c,analyticsTracker:n,traceId:o,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(i,c){try{i===He.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch(l=>{this.logger.error({err:l,msg:"Remote playback request to stop video failed"})}):i===He.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch(l=>{this.logger.error({err:l,msg:"Remote playback request to start video failed"})}),this.actualSubscribeType=i,this.logger.debug({msg:`Desired subscribe type actualized from ${c} to ${i}.`})}catch(l){this.logger.error({err:l,msg:`Error updating subscribe type from ${c} to ${i}.`})}}processStateUpdate(i){const c=this.previousSignalState,l=Object.assign({},c,i);if(!this.isSubscriptionActive)return void this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"});l.isTargetPublishing?i.peerClientState===Je.CONNECTED?this.updateState({connectionState:An.CONNECTED,subscribeInProgress:!0}):i.peerClientState===Je.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Kr.CONNECTION_FAIL,this.peerClient.getProtocol()),this.updateState({subscribeInProgress:!1}),this.emit(co)):(c.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:An.DISCONNECTED}));const f=!c.isTargetPublishing&&i.isTargetPublishing,n=this.subscriptionState.connectionState===An.CONNECTED&&i.peerClientState===Je.FAILED;(f||n)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,i)}onTrySubscribeFailure(i,c){this.logger.debug({msg:"Changing/keeping state FAILED"});const l=i.fatal,f=i.code===_e.OPERATION_ABORTED.code,n=this.failedRetries<=4;if(!f&&!l&&n){const e=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${e}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout(()=>St(this,void 0,void 0,function*(){this.throttledTrySubscribe(c)}),e)}else this.updateState({connectionState:An.ERRORED}),this.emit(_r,i),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(Kt,this.onPeerClientConnectionStateChange),this.peerClient.on(Bo,this.onSdpNegotiated),this.peerClient.on(bi,this.seiMessageHandler),this.peerClient.on(Ui,this.onPeerClientTransformError),this.stageConnection.on(So,this.onParticipantUpdated),this.stageConnection.on(fu,this.onParticipantJoined),this.stageConnection.on(la,this.onParticipantLeft),this.stageConnection.on(so,this.onParticipantLeft);let i=!0;if(this.stageConnection.isConnected()){const c=this.stageConnection.getParticipant(this.id);i=!!(c!=null&&c.isPublishing)}this.processStateUpdate({isTargetPublishing:i})}throttledTrySubscribe(i){return this.throttler.invoke(this.trySubscribe,i)}updateState(i){i.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=i.subscribeInProgress),i.connectionState&&this.subscriptionState.connectionState!==i.connectionState&&(this.subscriptionState.connectionState=i.connectionState,this.emit(Rc,this.subscriptionState.connectionState))}stop(i=!1){this.peerClient.off(Kt,this.onPeerClientConnectionStateChange),this.peerClient.off(Ui,this.onPeerClientTransformError),this.peerClient.off(Bo,this.onSdpNegotiated),this.peerClient.off(bi,this.seiMessageHandler),this.unsubscribe(i),this.throttler.clear(),this.stageConnection.off(So,this.onParticipantUpdated),this.stageConnection.off(fu,this.onParticipantJoined),this.stageConnection.off(la,this.onParticipantLeft),this.stageConnection.off(so,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:An.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(i,c){return St(this,void 0,void 0,function*(){const{token:l,id:f}=this;l.assertTokenIsUnexpired(i,Zt(Oe.SUBSCRIBE,f),"subscribe",f);const{mediaStream:n}=yield this.peerClient.connect({audioOnly:c,traceId:i});return{peerClient:this.peerClient,mediaStream:n}})}unsubscribe(i=!1){return St(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===An.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const c=i?Kr.UNLOAD:Kr.UNSUBSCRIBE,l=this.peerClient.getProtocol();try{i?this.peerClient.disconnect(i):yield this.peerClient.disconnect(i),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(c,l)}catch{this.attemptTracker.trackEndFailed(c,l)}})}triggerIceRestart(i){var c;return St(this,void 0,void 0,function*(){const l=this.stageConnection.getConnectionStats(),f=this.peerClient.getSfuResource(),n=this.subscribeTracker.trackAttempt({stageConnectionStats:l,isReassignment:!0,traceIdOverride:i.traceId,preAttemptSfuResource:f}),e=performance.now();try{this.emit(da),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:i,traceId:i.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const t=performance.now()-e,o=this.peerClient.getSfuResource(),s=this.peerClient.getActionMeasurements();(c=this.attemptTracker)===null||c===void 0||c.trackEndSucceeded(Kr.REASSIGNMENT,this.peerClient.getProtocol()),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),n.trackSubscribeStarted({totalDurationWithRetries:t,sfuResource:o,retryTimes:0,peerClientPerfStats:s,protocol:this.peerClient.getProtocol()}),this.emit(mu)}catch(t){this.emit(Gt),this.logger.error({msg:"ICE restart attempt failed",err:t});const o=this.peerClient.getSfuResource(),s=n.trackSubscribeFailed(t,this.peerClient.getProtocol(),`iceRestart=true, startNode=${f.node}, endNode=${o==null?void 0:o.node}`);throw s.code===_e.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(s,"ice restart timeout"),t}})}measureFirstFrameDuration({mediaStream:i,subscribeType:c,callback:l}){const f=performance.now(),n=o=>{const s=performance.now()-f;l(s,o),o==="audio"?t():e()};let e=Wa,t=Wa;return c!==He.AUDIO_ONLY&&(e=function(o,s){return bu(o,"video",s)}(i,n)),t=function(o,s){return bu(o,"audio",s)}(i,n),()=>{e(),t()}}}var xt,ze;$c=new WeakSet,Vc=function(u){return u.id===this.id},function(u){u.JOIN_ERROR="JOIN_ERROR",u.PUBLISH_ERROR="PUBLISH_ERROR",u.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"}(xt||(xt={})),function(u){u[u.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",u[u.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",u[u.TIMEOUT=3]="TIMEOUT",u[u.FAILED=4]="FAILED",u[u.CANCELED=5]="CANCELED",u[u.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",u[u.CODEC_MISMATCH=7]="CODEC_MISMATCH",u[u.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED",u[u.STAGE_DELETED=9]="STAGE_DELETED",u[u.PARTICIPANT_DISCONNECTED=10]="PARTICIPANT_DISCONNECTED"}(ze||(ze={}));const yd={[ze.TOKEN_MALFORMED]:"Token is malformed",[ze.TOKEN_EXPIRED]:"Token expired and is no longer valid",[ze.TIMEOUT]:"Operation timed out",[ze.FAILED]:"Operation failed",[ze.CANCELED]:"Operation canceled",[ze.STAGE_AT_CAPACITY]:"Stage at capacity",[ze.CODEC_MISMATCH]:"Client codec is not supported",[ze.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation",[ze.STAGE_DELETED]:"Stage has been deleted, unable to join",[ze.PARTICIPANT_DISCONNECTED]:"Participant has been disconnected, unable to join"},Wc={[_e.EXPIRED_TOKEN.code]:ze.TOKEN_EXPIRED,[_e.MALFORMED_TOKEN.code]:ze.TOKEN_MALFORMED,[_e.JOIN_SERVER_BAD_REQUEST.code]:ze.FAILED,[_e.TOKEN_PERMISSIONS_DENIED.code]:ze.TOKEN_NOT_ALLOWED,[_e.OPERATION_ABORTED.code]:ze.CANCELED,[_e.JOIN_TIMED_OUT.code]:ze.TIMEOUT,[_e.STAGE_DELETED.code]:ze.STAGE_DELETED,[_e.PARTICIPANT_DISCONNECTED.code]:ze.PARTICIPANT_DISCONNECTED,[_e.EVENT_PLANE_WS_CREATE_FAILED.code]:ze.FAILED,[_e.PUBLISH_TIMED_OUT.code]:ze.TIMEOUT,[_e.PUBLISH_FAILURE.code]:ze.FAILED,[_e.SUBSCRIBE_TIMED_OUT.code]:ze.TIMEOUT,[_e.SUBSCRIBE_FAILURE.code]:ze.FAILED,[_e.STAGE_AT_CAPACITY.code]:ze.STAGE_AT_CAPACITY,[_e.NO_MATCHING_CODEC.code]:ze.CODEC_MISMATCH,[_e.NETWORK_FAILURE.code]:ze.FAILED,[_e.INTERNAL_SERVER_ERROR.code]:ze.FAILED,[_e.REMOTE_STREAM_NOT_FOUND.code]:ze.FAILED,[_e.INTERNAL_MHCP_ERROR.code]:ze.FAILED,[_e.UNREACHABLE_MHCP.code]:ze.FAILED,[_e.INVALID_SESSION_STATUS.code]:ze.FAILED,[_e.MHCP_ABORTED.code]:ze.FAILED,[_e.EVENT_PLANE_PONG_TIMEOUT.code]:ze.FAILED,[_e.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:ze.FAILED},Gu={[_e.SEI_INSERT_NOT_PUBLISHING_VIDEO.code]:"SEI insert failed due to not publishing video",[_e.SEI_INSERT_INBAND_NOT_ENABLED.code]:"SEI insert failed due to in-band messaging not being enabled for the stage stream"};class kh extends Error{constructor(i,c,l){super(),this.code=i,this.category=c,this.message=l,this.name="StageError",this.errorDetails=[],this.message=`[${c}] ${l}`}addDetails(i){this.errorDetails.push(i)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var Hu,ba,is;function Gc(u,i){let c;if(u instanceof ct){if(i===xt.JOIN_ERROR&&(u.code===_e.EVENT_PLANE_PONG_TIMEOUT.code||u.code===_e.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code))return;const l=Wc[u.code];l&&(c=function(f,n,e){var t,o,s;const h=yd[f],y=new kh(f,n,h);return y.addDetails({stageErrorMessage:h,stageErrorCode:f,stageErrorCategory:n,stageArn:(t=e.token)===null||t===void 0?void 0:t.stageARN,traceId:(o=e.traceId)===null||o===void 0?void 0:o.value,causeCode:e.code,causeDetails:e.details,causeMessage:e.message,causeLocation:e.location,participantId:(s=e.token)===null||s===void 0?void 0:s.participantID,timeUTC:new Date().toISOString()}),y}(l,i,u))}return c}(function(u){u.ERROR="error"})(Hu||(Hu={}));class Ol extends It{constructor(i){super(),this.logger=i,this.handleError=(c,l,f=!0)=>{const n=function(t){let o;return t instanceof ct&&(o=Gu[t.code]),o}(c),e=Gc(c,l);if(n&&this.logger.warn({msg:n}),e)return f&&this.emit(Hu.ERROR,e),e}}}(function(u){u.INTERNAL="internal",u.REMOTE="remote",u.API="api"})(ba||(ba={})),function(u){u.ADDITIVE="additive",u.REPLACE="replace"}(is||(is={}));class Oh{constructor(i){this.logger=new mt(i.logger,Be.CONNECTION),this.subscribeConfig={defaults:i.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(i,c,l,f=is.REPLACE){c=(h=>{const y=_u(h);if(y.jitterBuffer!==void 0){const T=P=>{if(typeof P=="number"){if(P<0)return 0;if(P>4e3)return 4e3}return P};y.jitterBuffer.minDelayWhenPublishing!==void 0&&(y.jitterBuffer.minDelayWhenPublishing=T(y.jitterBuffer.minDelayWhenPublishing)),y.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(y.jitterBuffer.minDelayWhenSubscribeOnly=T(y.jitterBuffer.minDelayWhenSubscribeOnly))}return y})(c),this.subscribeConfig.participants[i]===void 0&&(this.subscribeConfig.participants[i]={internalOverrides:{},apiOverrides:{},remoteOverrides:{},lastMerged:this.subscribeConfig.defaults});const n=this.subscribeConfig.participants[i];switch(l){case ba.INTERNAL:n.internalOverrides=this.handleSubscribeConfigLevelMerging(n.internalOverrides,c,f);break;case ba.REMOTE:n.remoteOverrides=this.handleSubscribeConfigLevelMerging(n.remoteOverrides,c,f);break;case ba.API:n.apiOverrides=this.handleSubscribeConfigLevelMerging(n.apiOverrides,c,f);break;default:(function(h){throw new Error(`Unknown case kind: ${h}`)})(l)}const e=Ga(this.subscribeConfig.defaults,n.internalOverrides,n.remoteOverrides,n.apiOverrides);if(e===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${i} | ${n}, ${c}`}),!1;const t=(o=n.lastMerged,s=e,(typeof o=="object"&&typeof s=="object"&&(0,Sn.isEqual)(o,s))===!1);var o,s;return n.lastMerged=e,this.subscribeConfig.participants[i]=n,t}handleExternalSubscribeConfigUpdate(i,c,l,f=is.REPLACE){const n=(e=>{const t={};return typeof e!="object"?Ue.err(new Error("Invalid input")):(e.jitterBuffer!==void 0&&(t.jitterBuffer={},e.jitterBuffer.minDelay!==void 0&&(t.jitterBuffer.minDelayWhenSubscribeOnly=e.jitterBuffer.minDelay)),e.inBandMessaging!==void 0&&(t.inBandMessaging={enabled:e.inBandMessaging.enabled===!0}),e.simulcast!==void 0&&(t.simulcast={},e.simulcast.initialLayerPreference!==void 0&&(t.simulcast.initialLayerPreference=e.simulcast.initialLayerPreference)),Ue.ok(t))})(c);return n.ok===!0&&this.handleSubscribeConfigUpdate(i,n.value,l,f)}handleSubscribeConfigLevelMerging(i,c,l){if(l===is.REPLACE)return c;{const f=Ga(i,c);return f===void 0?(this.logger.warn({msg:`Unable to merge '${i}' and '${c}' with type ${l}`}),i):f}}getSubscribeConfigSnapshot(i){return this.subscribeConfig.participants[i]===void 0?Pc(this.subscribeConfig.defaults):Pc(this.subscribeConfig.participants[i].lastMerged)}}class Ah extends Et{constructor(i){super(et.REASSIGNMENT_REQUEST,i.token,i.traceId,!1),Object.assign(this.properties,{target_local_participant_id:i.targetLocalParticipantId,target_remote_participant_id:i.targetRemoteParticipantId}),this.critical=!0}}var cn,Rt,Gn,os,mo,bd=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class zu extends It{constructor(i,c){super(),this.setGetStats=l=>{this._getInternalStats=l},this.getStats=()=>bd(this,void 0,void 0,function*(){return this.requestRTCStats()}),this.requestRTCStats=()=>bd(this,void 0,void 0,function*(){if(!this._getInternalStats)return;const l=yield this._getInternalStats(this.mediaStreamTrack);return l?l.rawReport:void 0}),this._getInternalStats=c,this.id=i.id,this.isMuted=!i.enabled,this.mediaStreamTrack=i,this.streamType=this.mediaStreamTrack.kind==="audio"?ht.AUDIO:ht.VIDEO}cleanup(){this.removeAllListeners(),this._getInternalStats=void 0}}(function(u){u.IDLE="IDLE",u.INITIALIZING="INITIALIZING",u.ACTIVE="ACTIVE",u.CONTROLS_PAUSED="CONTROLS_PAUSED",u.DESTROYED="DESTROYED"})(cn||(cn={})),function(u){u.LAYERS_CHANGED="LAYERS_CHANGED",u.LAYER_SELECTED="LAYER_SELECTED",u.ADAPTION_CHANGED="ADAPTION_CHANGED"}(Rt||(Rt={})),function(u){u.LAYERS_CHANGED="LAYERS_CHANGED",u.LAYER_SELECTED="LAYER_SELECTED",u.ADAPTION_CHANGED="ADAPTION_CHANGED"}(Gn||(Gn={})),function(u){u.UNAVAILABLE="unavailable",u.SELECTED="selected"}(os||(os={})),function(u){u.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged",u.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST="localStreamInsertSeiMsgRequest"}(mo||(mo={}));var go,Bn,Yn,as=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Al extends zu{constructor(i,c){super(i),this.setMuted=l=>{l!==this.isMuted&&(this.mediaStreamTrack.enabled=!l,this.isMuted=l,this.emit(mo.LOCAL_STREAM_MUTE_CHANGED,this))},this.insertSeiMessage=(l,f)=>as(this,void 0,void 0,function*(){let n;if(this.streamType==="audio")n=Xe.INVALID_TRACK_TYPE;else if(this.mediaConfig.inBandMessaging.enabled){const e=this.validator.validateMessagePayload(l,(f==null?void 0:f.repeatCount)||0);n=Ue.getErr(e)}else n=Xe.INBAND_MESSAGING_NOT_ENABLED;n?console.warn(`Unable to insert SEI message due to ${n}`):this.emit(mo.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this,l,f)}),this.requestQualityStats=()=>as(this,void 0,void 0,function*(){if(!this._getInternalStats)return;const l=yield this._getInternalStats(this.mediaStreamTrack);return l?l.stats:void 0}),this.validatedExternalConfig=Cl(i,c),this.normalizedConfig=Wi(0,this.validatedExternalConfig),this.mediaConfig=(0,Sn.cloneDeep)(this.normalizedConfig),this.validator=new wt(pr)}}class Pl{constructor(i,c){this.strategy=i,this.logger=c}setStrategy(i){this.strategy=i}hasStrategy(i){return this.strategy[i]!==void 0}stageStreamsToPublish(){let i=[];try{i=this.strategy.stageStreamsToPublish(),i=i.filter(f=>f instanceof Al)}catch(f){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:f}),console.error("Error executing stageStreamsToPublish",f),Ue.err(f)}let c=0,l=0;for(const f of i)f.mediaStreamTrack.kind==="audio"?c++:f.mediaStreamTrack.kind==="video"&&l++;if(c>1||l>1){const f=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return Ue.err(f)}return Ue.ok(i)}shouldPublishParticipant(i){try{return Ue.ok(this.strategy.shouldPublishParticipant(i))}catch(c){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:c}),console.error("Error executing shouldPublishParticipant",c),Ue.err(c)}}shouldSubscribeToParticipant(i){try{return Ue.ok(this.strategy.shouldSubscribeToParticipant(i))}catch(c){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:c}),console.error("Error executing shouldSubscribeToParticipant",c),Ue.err(c)}}subscribeConfiguration(i){var c,l;try{return Ue.ok((l=(c=this.strategy).subscribeConfiguration)===null||l===void 0?void 0:l.call(c,i))}catch(f){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:f}),console.error("Error executing subscribeConfiguration",f),Ue.err(f)}}preferredLayerForStream(i,c){var l,f;try{return Ue.ok((f=(l=this.strategy).preferredLayerForStream)===null||f===void 0?void 0:f.call(l,i,c))}catch(n){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:n}),console.error("Error executing preferredLayerForStream",n),Ue.err(n)}}}class xl extends It{constructor(i,c){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=Bn.NOT_PUBLISHED,this.logger=c,this.info=i,this.audioMuted=i.audioMuted,this.videoStopped=i.videoStopped}}(function(u){u.PUBLISH="publish",u.SUBSCRIBE="subscribe"})(go||(go={})),function(u){u.NOT_PUBLISHED="not_published",u.ATTEMPTING_PUBLISH="attempting_publish",u.PUBLISHED="published",u.ERRORED="errored"}(Bn||(Bn={})),function(u){u.NOT_SUBSCRIBED="not_subscribed",u.ATTEMPTING_SUBSCRIBE="attempting_subscribe",u.SUBSCRIBED="subscribed",u.ERRORED="errored"}(Yn||(Yn={}));function Sd(u){return u.map(i=>i.remote)}function Ph(u){return{label:u.encodingId,bitrateBps:1e3*u.bitrate,width:u.width,height:u.height,framesPerSecond:u.framesPerSecond,selected:u.selected}}function Ed(u,i){const c=u.width*u.height,l=i.width*i.height;return c>l||u.bitrateBps>i.bitrateBps||u.framesPerSecond>i.framesPerSecond?1:c===l&&u.bitrateBps===i.bitrateBps&&u.framesPerSecond===i.framesPerSecond?0:-1}var Dl=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class _d extends It{constructor(i){var c,l,f;super(),this.onAdaptionChanged=n=>{this.emit(Gn.ADAPTION_CHANGED,n)},this.onLayersChanged=n=>{this.emit(Gn.LAYERS_CHANGED,n)},this.onLayerSelected=(n,e)=>{this.emit(Gn.LAYER_SELECTED,n,e)},this.setGetStats=()=>{},this.requestRTCStats=()=>Dl(this,void 0,void 0,function*(){var n;return(n=this.internalStream)===null||n===void 0?void 0:n.requestRTCStats()}),this.requestQualityStats=()=>Dl(this,void 0,void 0,function*(){if(this.internalStream)try{const n=yield this.internalStream.getInternalStats();return n?n.stats:void 0}catch{return}}),this.getStats=()=>Dl(this,void 0,void 0,function*(){var n;return(n=this.internalStream)===null||n===void 0?void 0:n.requestRTCStats()}),this.setMuted=n=>{var e;(e=this.internalStream)===null||e===void 0||e.setMuted(n)},this.getLayers=()=>{var n,e;return(e=(n=this.internalStream)===null||n===void 0?void 0:n.layers)!==null&&e!==void 0?e:this.cachedLayers},this.getSelectedLayer=()=>{var n,e;return(e=(n=this.internalStream)===null||n===void 0?void 0:n.selectedLayer)!==null&&e!==void 0?e:this.cachedSelectedLayer},this.getLowestQualityLayer=()=>{var n,e;return(e=(n=this.internalStream)===null||n===void 0?void 0:n.lowestQualityLayer)!==null&&e!==void 0?e:this.cachedLowestLowestLayer},this.getHighestQualityLayer=()=>{var n,e;return(e=(n=this.internalStream)===null||n===void 0?void 0:n.highestQualityLayer)!==null&&e!==void 0?e:this.cachedHighestQualityLayer},this.internalStream=i,this.cachedId=this.internalStream.id,this.cachedParticipantInfo=(0,Sn.cloneDeep)(this.internalStream.participantInfo),this.cachedStreamType=this.internalStream.streamType,this.cachedMediaStreamTrack=(f=(l=(c=this.internalStream.mediaStreamTrack).clone)===null||l===void 0?void 0:l.call(c))!==null&&f!==void 0?f:{},this.cachedIsMuted=this.internalStream.isMuted,this.cachedIsAdapting=this.internalStream.isAdapting,this.cachedLayers=this.internalStream.layers,this.updateCachedStreamData(),this.internalStream.on(Rt.ADAPTION_CHANGED,this.onAdaptionChanged),this.internalStream.on(Rt.LAYERS_CHANGED,this.onLayersChanged),this.internalStream.on(Rt.LAYER_SELECTED,this.onLayerSelected)}updateCachedStreamData(){var i,c,l,f,n;this.cachedLayers=(c=(i=this.internalStream)===null||i===void 0?void 0:i.layers)!==null&&c!==void 0?c:[],this.cachedHighestQualityLayer=(l=this.internalStream)===null||l===void 0?void 0:l.highestQualityLayer,this.cachedLowestLowestLayer=(f=this.internalStream)===null||f===void 0?void 0:f.lowestQualityLayer,this.cachedSelectedLayer=(n=this.internalStream)===null||n===void 0?void 0:n.selectedLayer}get id(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.id)!==null&&c!==void 0?c:this.cachedId}get participantInfo(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.participantInfo)!==null&&c!==void 0?c:this.cachedParticipantInfo}get streamType(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.streamType)!==null&&c!==void 0?c:this.cachedStreamType}get mediaStreamTrack(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.mediaStreamTrack)!==null&&c!==void 0?c:this.cachedMediaStreamTrack}get isMuted(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.isMuted)!==null&&c!==void 0?c:this.cachedIsMuted}set isMuted(i){var c;(c=this.internalStream)===null||c===void 0||c.setMuted(i)}get isAdapting(){var i,c;return(c=(i=this.internalStream)===null||i===void 0?void 0:i.isAdapting)!==null&&c!==void 0?c:this.cachedIsAdapting}cleanup(){var i,c,l;this.updateCachedStreamData(),(i=this.internalStream)===null||i===void 0||i.off(Rt.ADAPTION_CHANGED,this.onAdaptionChanged),(c=this.internalStream)===null||c===void 0||c.off(Rt.LAYERS_CHANGED,this.onLayersChanged),(l=this.internalStream)===null||l===void 0||l.off(Rt.LAYER_SELECTED,this.onLayerSelected),this.internalStream=void 0,this.removeAllListeners()}}var Ks,Ys,Ml=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Cd extends zu{constructor({track:i,info:c,getStats:l,remotePlaybackController:f,analyticsTracker:n,token:e,subscribeConfig:t}){super(i,l),this.hasRemoteListenersForLayerEvents=()=>{const s=this.remote;return s.hasListenersFor(Gn.ADAPTION_CHANGED)||s.hasListenersFor(Gn.LAYERS_CHANGED)||s.hasListenersFor(Gn.LAYER_SELECTED)},this.setMuted=s=>{this.isMuted=s,this.mediaStreamTrack.enabled=!s},this.setLayer=s=>{const h=(0,Sn.cloneDeep)(s);if(this.queueLayerUpdateForValidState(h))return void this.logger.debug({msg:`setLayer:${h} queued, skipping for now`});const y=function(P,M){if(!P)return(0,Ue.ok)(void 0);const L=typeof P=="string"?P:P.label,B=M.filter(U=>U.label===L)[0];return B?(0,Ue.ok)(B):(0,Ue.err)(`Provided layer with id ${L} does not exist`)}(h,this._layers);if(!y.ok){const P=y.error;return void this.logger.error({err:P,msg:"Unable to select layer, skipping selection"})}const T=y.value;if(this.isNextUpdateAdaptionOnly(T))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(T)||this.isAdapting?T&&(this.logger.warn({msg:`setLayer:${JSON.stringify(T)} `}),this.handleManualUpdate(T)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=cn.INITIALIZING,this.prevState=cn.IDLE,this.analyticsTracker=n,this.token=e,this.id=i.id,this.info=c,this.mediaStreamTrack=i,this.remotePlaybackController=f,this.layerPollingIntervalId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this.subscribeConfig=t,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const o=iu();this.logger=new mt(new We(o),Be.REMOTE_STAGE_STREAM),this.streamType===ht.AUDIO?this.isMuted=c.audioMuted:this.isMuted=c.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers(!0)}transitionStateTo(i){this.state!==i&&(this.prevState=this.state,this.state=i)}initializeLayerPolling(){_c(this.mediaStreamTrack)?this.streamType!==ht.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingIntervalId!==null&&clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=setInterval(()=>{this.pollInternalLayers()},this.subscribeConfig.simulcast.layerPollingIntervalMs)):this.logger.debug({msg:"Skipping initializing polling for audio streams"}):this.logger.debug({msg:"Skipping initializing polling, media track is not active"})}startLayerPolling(){this.layerPollingIntervalId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingIntervalId!==null?(clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(i=!1){if(!_c(this.mediaStreamTrack))return void this.pauseControls();if(this.streamType===ht.AUDIO)return this.logger.debug({msg:"Skipping layer poll request for audio stream"}),void this.transitionStateTo(cn.ACTIVE);const c=!this.hasRemoteListenersForLayerEvents(),l=!this.subscribeConfig.simulcast.layerPollingEnabled;!i&&c&&l?this.logger.debug({msg:"Skipping layer request due to no listeners"}):this.remotePlaybackController.getLayers().then(f=>{if(this.isStateValidForLayerUpdates()){if(!f.ok)throw Error(f.error);this.updateInternalLayersFromRemote(f.value),this.transitionStateTo(cn.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})}).catch(f=>{this.logger.error({err:f,msg:"Error calling getLayers, returning current layers"})})}updateInternalLayersFromRemote(i){const c=this._layers,l=i.map(Ph).sort(Ed),f=!(0,Sn.isEqual)(l,c);this._layers=l;const n=this._selectedLayer,e=this._layers.filter(o=>o.selected)[0],t=!(0,Sn.isEqual)(e,n);n&&(n.selected=!1),this._selectedLayer=e,t&&(this.trackLayerUpdate(n),this.trackLayerUpdate(e)),this.isCommandQueueEmpty()&&(f&&this.emitLayersChanged(),t&&this.emitLayerSelected(e))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const i=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${i}`});for(const c of this.commandMap.keys()){const l=this.commandMap.get(c);l==null||l()}this.commandMap.clear()}queueLayerUpdateForValidState(i){if(!i)return this.commandMap.delete("setLayer"),!1;if(this.state===cn.INITIALIZING){const c=this.setLayer.bind(this,i);return this.commandMap.set("setLayer",c),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const i=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then(c=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(i,`Stream in invalid state: ${this.state}`);c.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(i,c.error)}).catch(()=>{})}resetAdaptionStateOnError(i,c){this._isAdapting=i,this.emitAdaptionChanged(),this.logger.error({err:c,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(i){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const c=this._isAdapting,l=this._selectedLayer;l&&(l.selected=!1),this._isAdapting=!1,this._selectedLayer=i,i.selected=!0,c!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(i,l),this.trackLayerUpdate(l),this.trackLayerUpdate(i),this.emitLayersChanged(),this.emitLayerSelected(i),this.remotePlaybackController.setLayer(i.label).then(f=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const n=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(c,n),void this.resetLayerOnError(l,i,n)}if(!f.ok){const n=f.error;return this.resetAdaptionStateOnError(c,n),void this.resetLayerOnError(l,i,n)}this.logger.debug({msg:`Layer successfully selected: ${i.label}`})}).catch(()=>{})}applyExistingControlState(){var i;this._isAdapting?this.remotePlaybackController.unsetLayer().then(()=>{}).catch(()=>{}):!((i=this._selectedLayer)===null||i===void 0)&&i.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then(()=>{}).catch(()=>{})}resetLayerOnError(i,c,l){c&&(c.selected=!1),i&&(i.selected=!0),this._selectedLayer=i,this.logger.error({err:l,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(i,c),this.emitLayersChanged(),i!==null&&this.emitLayerSelected(i,os.UNAVAILABLE),this.trackLayerUpdate(c),this.trackLayerUpdate(i)}updateLocalLayerStateBeforeRemote(i,c){this._layers=this._layers.map(l=>l.label===(i==null?void 0:i.label)?i:l.label===(c==null?void 0:c.label)?c:l).sort(Ed)}trackLayerUpdate(i){var c,l;this.analyticsTracker.trackEventNoSharedProps(new js(this.token,Nr(),(c=i==null?void 0:i.label)!==null&&c!==void 0?c:"auto",!0,Oe.SUBSCRIBE,(l=i==null?void 0:i.selected)!==null&&l!==void 0&&l,this.info.id))}isNextUpdateAdaptionOnly(i){return i===void 0&&this.isFirstLayerUpdate()||i===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(i){var c;return((c=this._selectedLayer)===null||c===void 0?void 0:c.label)===(i==null?void 0:i.label)}isStateValidForLayerUpdates(){return this.state===cn.ACTIVE||this.state===cn.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(i,c=os.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(i,null,2)}`}),this.emit(Rt.LAYER_SELECTED,(0,Sn.cloneDeep)(i),c)}emitLayersChanged(){this.emit(Rt.LAYERS_CHANGED,(0,Sn.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(Rt.ADAPTION_CHANGED,this._isAdapting)}get remote(){const i=this.weakRemoteMap.get(this.weakRemoteKey);if(i)return i;const c=new _d(this);return this.weakRemoteMap.set(this.weakRemoteKey,c),c}get participantInfo(){return(0,Sn.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,Sn.cloneDeep)(this._layers)}get selectedLayer(){var i;return(0,Sn.cloneDeep)((i=this._selectedLayer)!==null&&i!==void 0?i:void 0)}get highestQualityLayer(){return(0,Sn.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,Sn.cloneDeep)(this.layers[0])}getInternalStats(){return Ml(this,void 0,void 0,function*(){if(this._getInternalStats)return this._getInternalStats(this.mediaStreamTrack)})}pauseControls(){this.transitionStateTo(cn.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(cn.ACTIVE)}updateSubscribeConfig(i){const c=this.subscribeConfig;this.subscribeConfig=i,c.simulcast.layerPollingIntervalMs!==i.simulcast.layerPollingIntervalMs&&this.isStateValidForLayerUpdates()&&this.initializeLayerPolling()}cleanup(){this.transitionStateTo(cn.DESTROYED),super.cleanup(),this.weakRemoteMap.delete(this.weakRemoteKey),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(u){u.STATE_CHANGE="stateChange",u.MEDIA_STREAM_ADDED="mediaStreamAdded",u.MEDIA_STREAM_REMOVED="mediaStreamRemoved",u.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",u.ERROR="error"})(Ks||(Ks={})),function(u){u.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",u.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"}(Ys||(Ys={}));const Ir=Object.assign(Object.assign({},Ks),Ys);var Hc;(function(u){u.PUBLICATION_STATE_CHANGE="publicationStateChange"})(Hc||(Hc={}));const Sa=Object.assign(Object.assign({},Ks),Hc);var di=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class jr extends xl{constructor(i,c,l,f,n,e,t,o=!1){super(i,new mt(f,Be.REMOTE_PARTICIPANT)),this.subscribeState=Yn.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=s=>{this.logger.debug({msg:"subscriptionStateChange",state:s}),s===An.DISCONNECTED?this.updateSubscriptionState(Yn.NOT_SUBSCRIBED):s===An.CONNECTED?this.updateSubscriptionState(Yn.SUBSCRIBED):s===An.CONNECTING?this.updateSubscriptionState(Yn.ATTEMPTING_SUBSCRIBE):s===An.ERRORED?(this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams(),this.updateSubscriptionState(Yn.ERRORED)):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:s})},this.onSubscriptionStreamRemoved=()=>{this.logger.debug({msg:"onSubscriptionStreamRemoved"}),this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams()},this.onSubscriptionStreamCreated=(s,h)=>{this.logger.debug({msg:"onSubscriptionStreamCreated",stream:s}),this.pruneInactiveStreams();let y=s.getTracks().map(T=>{const P=new Cd({track:T,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:h,analyticsTracker:this.analyticsTracker,token:this.token,subscribeConfig:this.subscribeConfig});return this.streams.push(P),P});this.subscription.getDesiredSubscribeType()===He.AUDIO_ONLY&&(y=y.filter(T=>T.streamType!==ht.VIDEO)),this.emit(Ir.MEDIA_STREAM_ADDED,y)},this.onSubscriptionError=s=>{this.emit(Ir.ERROR,s)},this.onSubscriptionSeiMessageReceived=s=>{this.emit(Ir.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,s)},this.onSubscriptionTransformError=s=>{this.emit(Ir.ERROR,s)},this.onSubscriptionReassignmentStart=()=>{for(const s of this.streams)s.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const s of this.streams)s.resumeControls()},this.updateSubscribeStateIfNecessary=(s,h)=>{if(!this.info.capabilities.has(go.SUBSCRIBE))return;h!==void 0&&(this.subscribeConfig=h,this.subscription.updateSubscribeConfig(h),this.streams.forEach(P=>{P.updateSubscribeConfig(h)}));const y=s!==He.NONE&&this.publishState===Bn.PUBLISHED,T=this.subscribeState!==Yn.NOT_SUBSCRIBED&&this.subscribeState!==Yn.ERRORED;if(y&&!T)this.subscription.updateDesiredSubscribeType(s),this.subscribe();else if(!y&&T)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(s);else if(this.subscribeState===Yn.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==s)try{s===He.AUDIO_ONLY?this.emit(Ir.MEDIA_STREAM_REMOVED,this.filterStreamsByType(this.streams,ht.VIDEO)):s===He.AUDIO_VIDEO&&this.emit(Ir.MEDIA_STREAM_ADDED,this.filterStreamsByType(this.streams,ht.VIDEO)),this.subscription.updateDesiredSubscribeType(s)}catch(P){this.logger.error({err:P,msg:"error updating subscribe type"})}},this.updatePublishState=s=>{const h=s&&this.publishState===Bn.PUBLISHED,y=!s&&this.publishState===Bn.NOT_PUBLISHED;return!h&&!y&&(this.info.isPublishing=s,this.publishState=s?Bn.PUBLISHED:Bn.NOT_PUBLISHED,!0)},this.updateStreamState=(s,h)=>{this.audioMuted!==s&&(this.audioMuted=s,this.info.audioMuted=s,this.updateStreamMuteState(ht.AUDIO,s)),this.videoStopped!==h&&(this.videoStopped=h,this.info.videoStopped=h,this.updateStreamMuteState(ht.VIDEO,h))},this.updateStreamMuteState=(s,h)=>{const y=this.filterStreamsByType(this.streams,s),T=y[y.length-1];if(!T){const P=`state update received for ${this.info.id} for non-existent ${s} stream`;return this.logger.warn({msg:P}),void this.traceRemoteParticipantMsg(P)}T.setMuted(h),this.emit(Ir.MEDIA_STREAM_MUTE_CHANGED,T)},this.cleanup=()=>{this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==Yn.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=t,this.token=c,this.subscribeConfig=e,this.createSubscription=()=>{const s=new Ri(i.id,c,l,f,t,n,e);return s.on(Rc,this.onSubscriptionStateChange),s.on(wc,this.onSubscriptionStreamCreated),s.on(co,this.onSubscriptionStreamRemoved),s.on(_r,this.onSubscriptionError),s.on(pu,this.onSubscriptionSeiMessageReceived),s.on(pl,this.onSubscriptionTransformError),s.on(da,this.onSubscriptionReassignmentStart),s.on(mu,this.onSubscriptionReassignmentDone),s.on(Gt,this.onSubscriptionReassignmentDone),s},this.subscription=this.createSubscription(),o&&(this.publishState=Bn.PUBLISHED)}updateSubscriptionState(i){i!==this.subscribeState&&(this.subscribeState=i,this.emit(Ir.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}pruneInactiveStreams(){const i=[];this.streams=this.streams.filter(n=>!!_c(n.mediaStreamTrack)||(i.push(n),!1));const c=i.length;if(c===0)return;const l=this.filterStreamsByType(i,ht.AUDIO).length,f=c-l;this.traceRemoteParticipantMsg(`Pruning inactive streams (${l} audio, ${f} video)`),this.emitStreamsRemoved(i),i.forEach(n=>{n.remote.cleanup(),n.cleanup()})}filterStreamsByType(i,c){return i.filter(l=>l.streamType===c)}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(Yn.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===Yn.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(Rc,this.onSubscriptionStateChange),this.subscription.off(wc,this.onSubscriptionStreamCreated),this.subscription.off(co,this.onSubscriptionStreamRemoved),this.subscription.off(_r,this.onSubscriptionError),this.subscription.off(pl,this.onSubscriptionTransformError);const i=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),this.emitStreamsRemovedByType(i),this.updateSubscriptionState(Yn.NOT_SUBSCRIBED),this.cleanupStreams()}emitStreamsRemovedByType(i){switch(i){case He.AUDIO_VIDEO:this.emitStreamsRemoved(this.streams);break;case He.AUDIO_ONLY:this.emitStreamsRemoved(this.filterStreamsByType(this.streams,ht.AUDIO));case He.NONE:}}emitStreamsRemoved(i){this.emit(Ir.MEDIA_STREAM_REMOVED,i)}cleanupStreams(){this.streams.length!==0&&(this.logger.debug({msg:"Cleaning up streams due to internal removal"}),this.streams.forEach(i=>{i.remote.cleanup(),i.cleanup()}),this.streams=[])}traceRemoteParticipantMsg(i){this.analyticsTracker.trackEventNoSharedProps(new fa(this.token,Nr(),i,Oe.SUBSCRIBE,this.info.id))}triggerIceRestart(i){return di(this,void 0,void 0,function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(i)}finally{this.reassigning=!1}})}}const qu=Oe.PUBLISH;function Td(u,i,c){return new ct(Object.assign(Object.assign({},u),{token:i,traceId:c,location:"stage-publication.sendSeiMessage",tag:In,action:Oe.PUBLISH}))}class Nl{constructor(i,c){this.analyticsTracker=i,this.token=c,this.action=qu,this.traceId=Nr()}trackPublish(i){const{action:c,traceId:l,analyticsTracker:f,token:n}=this;return f.trackEvent(new vh({token:n,traceId:l})),{getTraceId:()=>l,trackPublishStarted({totalDurationWithRetries:e,retryTimes:t,sfuResource:o,peerClientPerfStats:s,protocol:h}){const{optionsDuration:y,postDuration:T,timeToCandidate:P,timeToConnected:M,sdpExchangeDuration:L,sdpExchangeTransport:B,setRemoteDescDuration:U,peerConnectionDuration:F}=s,{edpInitialConnectDuration:q,edpInitialConnectRetries:Y,edpInitialStateDuration:z,edpStateUpdateCount:re}=i;f.trackEvent(new yh({token:n,traceId:l,optionsDuration:y,postDuration:T,timeToCandidate:P,totalDuration:M,edpInitialConnectDuration:q,edpInitialConnectRetries:Y,edpInitialStateDuration:z,edpStateUpdateCount:re,sdpExchangeDuration:L,sdpExchangeTransport:B,setRemoteDescDuration:U,peerConnectionDuration:F,publishRetries:t,totalDurationWithRetries:e,sfuResource:o,protocol:h}))},trackPublishFailed(e,t){const o=((h,y,T)=>{if(h instanceof ct)return h;let P="";return h instanceof ua.AxiosError&&(P+=`AxiosError - ${h.code}`),new ct(Object.assign(Object.assign(Object.assign({},_e.PUBLISH_FAILURE),{action:qu,token:y,traceId:T,tag:In,location:"publish",details:`${P} ${h.message}`}),{fatal:!0}))})(e,n,l);f.trackEvent(new bh({token:n,traceId:l,code:o.code,message:o.message,fatal:o.fatal,nominal:o.nominal,protocol:t}));const s=new ct(Object.assign(Object.assign({},_e.PUBLISH_FAILURE),{action:c,token:n,traceId:l,tag:In,location:"publish"}));return e instanceof ct&&(s.fatal=e.fatal,s.nominal=e.nominal,s.location=`publish > ${e.location}`),f.trackError(s),o},trackUnpublish:()=>{f.trackEvent(new Tl({token:n,traceId:l}))},trackEndSucceeded:(e,t)=>{f.trackEvent(new fd({token:n,isUnpublishSuccessful:!0,traceId:l,reason:e,protocol:t}))},trackEndFailed:(e,t)=>{const o=new ct(Object.assign(Object.assign({},_e.UNPUBLISH_FAILURE),{token:n,traceId:l,tag:Fe,location:"unpublish"}));return e!==Kr.UNLOAD&&e!==Kr.UNPUBLISH||this.analyticsTracker.trackError(o),f.trackEvent(new fd({token:n,isUnpublishSuccessful:!1,traceId:l,reason:e,protocol:t})),o},createSeiNotPublishingVideoError:()=>Td(_e.SEI_INSERT_NOT_PUBLISHING_VIDEO,n,l),createSeiInBandMessagingNotEnabledError:()=>Td(_e.SEI_INSERT_INBAND_NOT_ENABLED,n,l)}}}var Jn,Ur,Ea=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};(function(u){u.DISCONNECTED="disconnected",u.CONNECTING="connecting",u.CONNECTED="connected",u.ERRORED="errored"})(Jn||(Jn={})),function(u){u.STATE_CHANGE="stateChange",u.ERROR="error",u.TRANSFORM_ERROR="transformError"}(Ur||(Ur={}));class xh extends It{constructor(i,c,l,f){super(),this.token=i,this.stageConnection=c,this.nonScopedLogger=l,this.analyticsTracker=f,this.streamsToPublish=[],this.publicationState=Jn.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=Oe.PUBLISH,this.start=n=>{this.publicationState===Jn.DISCONNECTED||this.publicationState===Jn.ERRORED?(this.streamsToPublish=n,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=n=>Ea(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(n)}),this.stop=(n=!1)=>Ea(this,void 0,void 0,function*(){this.peerClient.off(Kt,this.onPeerClientConnectionStateChange),this.peerClient.off(Ui,this.onPeerClientTransformError),yield this.unpublish(n),this.updateState(Jn.DISCONNECTED)}),this.processStateUpdate=n=>{const{publicationState:e}=this;e===Jn.DISCONNECTED||e===Jn.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Jn.CONNECTING),this.tryPublish()):e===Jn.CONNECTING?n===Je.CONNECTED&&this.updateState(Jn.CONNECTED):e===Jn.CONNECTED&&n===Je.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Kr.CONNECTION_FAIL,this.peerClient.getProtocol()),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Jn.CONNECTING),this.tryPublish()))},this.updateState=n=>{this.publicationState=n,this.emit(Ur.STATE_CHANGE,n)},this.tryPublish=()=>Ea(this,void 0,void 0,function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const n=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(n);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.streamsToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const e=this.peerClient.getSfuResource(),t=this.latestPubAttemptNum-1,o=performance.now()-this.startConnectingTimestamp,s=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:e,totalDurationWithRetries:o,retryTimes:t,peerClientPerfStats:s,protocol:this.peerClient.getProtocol()}),this.latestPubAttemptNum=0}catch(e){this.logger.error({msg:"publish failed!",err:e});const t=this.attemptTracker.trackPublishFailed(e,this.peerClient.getProtocol()),o=t.code===_e.OPERATION_ABORTED.code,s=t.fatal,h=this.latestPubAttemptNum===4;if(o)return;if(s||h)return this.logger.error({msg:`Stopping attempts: isFatal=${s}, isLastAttempt=${h}`,err:e}),this.updateState(Jn.ERRORED),void this.emit(Ur.ERROR,t);const y=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${y}ms`}),this.nextAttemptTimerId=window.setTimeout(()=>{this.tryPublish()},y)}}}),this.publish=(n,e)=>Ea(this,void 0,void 0,function*(){this.peerClient.initStreamsToPublish(n),yield this.peerClient.connect({audioOnly:!1,traceId:e})}),this.unpublish=(n=!1)=>Ea(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===Jn.DISCONNECTED||this.publicationState===Jn.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const e=n?Kr.UNLOAD:Kr.UNPUBLISH,t=this.peerClient.getProtocol();try{n?this.peerClient.disconnect(n):yield this.peerClient.disconnect(n),this.attemptTracker.trackEndSucceeded(e,t)}catch{this.attemptTracker.trackEndFailed(e,t)}}),this.replaceOrUpdateStream=n=>Ea(this,void 0,void 0,function*(){this.streamsToPublish.find(e=>e.track.kind===n.track.kind)?this.streamsToPublish=this.streamsToPublish.map(e=>e.track.kind===n.track.kind?n:e):this.streamsToPublish.push(n),yield this.peerClient.replaceOrUpdateStream(n)}),this.onPeerClientConnectionStateChange=n=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${n}`,state:n}),this.processStateUpdate(n)},this.onPeerClientTransformError=n=>{this.emit(Ur.TRANSFORM_ERROR,n)},this.onIncompatibleCodecs=n=>Ea(this,void 0,void 0,function*(){yield this.peerClient.onIncompatibleCodecs(n)}),this.sendSeiMessage=(n,e)=>{if(this.publicationState!==Jn.CONNECTED)return this.attemptTracker&&this.emit(Ur.ERROR,this.attemptTracker.createSeiNotPublishingVideoError()),Ue.err(Xe.NOT_PUBLISHING_VIDEO);const t=this.peerClient.sendSeiMessage(n,e),o=Ue.getErr(t);return o&&this.attemptTracker&&(o===Xe.INBAND_MESSAGING_NOT_ENABLED?this.emit(Ur.ERROR,this.attemptTracker.createSeiInBandMessagingNotEnabledError()):o===Xe.NOT_PUBLISHING_VIDEO&&this.emit(Ur.ERROR,this.attemptTracker.createSeiNotPublishingVideoError())),t},this.peerClient=new _n(i,this.nonScopedLogger,this.action,Zt(this.action),Nr(),this.analyticsTracker,void 0,c,void 0),this.logger=new mt(l,Be.PUBLICATION),this.peerClient.on(Kt,this.onPeerClientConnectionStateChange),this.peerClient.on(Ui,this.onPeerClientTransformError),this.publishTracker=new Nl(this.analyticsTracker,this.token)}removeTrack(i){return Ea(this,void 0,void 0,function*(){this.streamsToPublish=this.streamsToPublish.filter(c=>c.track.kind!==i),yield this.peerClient.removeTrack(i)})}}var fn,Ll=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};class Dh extends xl{constructor(i,c,l,f,n){super(i,new mt(l,Be.LOCAL_PARTICIPANT)),this.onPublicationStateChange=e=>{switch(this.logger.debug({msg:"publicationStateChange",state:e}),e){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(Bn.PUBLISHED);break;case"connecting":this.updatePublishState(Bn.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(Bn.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:e})}},this.onPublicationError=e=>{this.emit(Sa.ERROR,e)},this.updatePublishState=e=>{this.info.isPublishing=e===Bn.PUBLISHED,this.publishState=e,this.emit(Sa.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=e=>{e.streamType===ht.AUDIO&&(this.audioMuted=e.isMuted,this.info.audioMuted=e.isMuted),e.streamType===ht.VIDEO&&(this.videoStopped=e.isMuted,this.info.videoStopped=e.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit(Sa.MEDIA_STREAM_MUTE_CHANGED,e)},this.handleInsertSeiMsgRequest=(e,t,o)=>{this.sendSeiMessage(t,o==null?void 0:o.repeatCount)},this.publish=e=>{this.logger.debug({msg:"publish"}),e.forEach(o=>{o&&(this.setupStreamListeners(o),o.streamType===ht.AUDIO?(this.audioStream=o,this.audioMuted=!o.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):o.streamType===ht.VIDEO&&(this.videoStream=o,this.videoStopped=!o.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),o.setGetStats(this.publication.requestRTCStats))}),this.connection.emitStageState(this.audioMuted,this.videoStopped);const t=e.map(o=>cd(o));this.publication.start(t)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==Bn.NOT_PUBLISHED&&this.publishState!==Bn.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=e=>Ll(this,void 0,void 0,function*(){yield this.publication.onIncompatibleCodecs(e)}),this.sendSeiMessage=(e,t=0)=>this.publication.sendSeiMessage(e,t),this.sendSeiMessageString=(e,t=0)=>{const o=new TextEncoder().encode(e);return this.publication.sendSeiMessage(o,t)},this.connection=f,this.createPublication=()=>{const e=new xh(c,f,l,n);return e.on(Ur.STATE_CHANGE,this.onPublicationStateChange),e.on(Ur.ERROR,this.onPublicationError),e.on(Ur.TRANSFORM_ERROR,this.onPublicationError),e},this.publication=this.createPublication()}setupStreamListeners(i){i.on(mo.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),i.streamType===ht.VIDEO&&i.on(mo.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleInsertSeiMsgRequest)}removeTrack(i){var c,l,f;i.streamType===ht.AUDIO?((c=this.audioStream)===null||c===void 0||c.off(mo.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):i.streamType===ht.VIDEO&&((l=this.videoStream)===null||l===void 0||l.off(mo.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),(f=this.videoStream)===null||f===void 0||f.off(mo.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(i.streamType)}replaceOrAddTrack(i){return Ll(this,void 0,void 0,function*(){this.setupStreamListeners(i),i.setGetStats(this.publication.requestRTCStats),i.streamType===ht.AUDIO?(this.audioStream=i,this.audioMuted=!i.mediaStreamTrack.enabled):i.streamType===ht.VIDEO&&(this.videoStream=i,this.videoStopped=!i.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const c=cd(i);yield this.publication.replaceOrUpdateStream(c)})}unpublish(){if(this.publishState===Bn.NOT_PUBLISHED||this.publishState===Bn.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(Ur.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(Ur.ERROR,this.onPublicationError),this.publication.off(Ur.TRANSFORM_ERROR,this.onPublicationError);const i=[this.audioStream,this.videoStream].filter(c=>!!c);i.forEach(c=>{c.cleanup()}),this.audioStream=void 0,this.videoStream=void 0,this.emit(Sa.MEDIA_STREAM_REMOVED,i),this.updatePublishState(Bn.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(u){u.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",u.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",u.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",u.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",u.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",u.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",u.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",u.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",u.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",u.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",u.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",u.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",u.ERROR="error",u.STAGE_LEFT="stageLeft"})(fn||(fn={}));var ss=function(u,i,c,l){return new(c||(c=Promise))(function(f,n){function e(s){try{o(l.next(s))}catch(h){n(h)}}function t(s){try{o(l.throw(s))}catch(h){n(h)}}function o(s){var h;s.done?f(s.value):(h=s.value,h instanceof c?h:new c(function(y){y(h)})).then(e,t)}o((l=l.apply(u,[])).next())})};const Js=u=>!!u;class Bl extends It{constructor(i,c){super(),this.connectionState=an.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(f,n)=>{var e,t;if(this.connectionState=f,f===an.ERRORED&&(this.connectionStateErrored=!0),f===an.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==Bn.NOT_PUBLISHED&&this.stageConnection.emitStageState((e=this.localParticipant)===null||e===void 0?void 0:e.audioMuted,(t=this.localParticipant)===null||t===void 0?void 0:t.videoStopped),f===an.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),f===an.DISCONNECTED){if(n&&n!==Rr.CLIENT_RECONNECT&&n!==Rr.USER_INITIATED){let o=_a.UNKNOWN;(function(s){return Object.values(_a).includes(s)})(n)?o=n:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${n}`}),this.cleanup(o)}}else this.emit(fn.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var f;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new fa(this.token,(f=this.joinTraceId)!==null&&f!==void 0?f:new td,"reusing local participant from repeat join",Oe.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const f=function(n){var e,t;const o=new Set;return n.token.claims.capabilities.allow_publish&&o.add(go.PUBLISH),n.token.claims.capabilities.allow_subscribe&&o.add(go.SUBSCRIBE),{id:n.token.participantID,userId:(e=n.token.userID)!==null&&e!==void 0?e:"",attributes:(t=n.token.claims.attributes)!==null&&t!==void 0?t:{},capabilities:o,isLocal:!0,userInfo:{},videoStopped:n.videoStopped,audioMuted:n.audioMuted,isPublishing:n.isPublishing}}({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new Dh(f,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on(Sa.PUBLICATION_STATE_CHANGE,n=>{this.onPublishStateChanged(this.localParticipant.info,n)}),this.localParticipant.on(Sa.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on(Sa.MEDIA_STREAM_MUTE_CHANGED,n=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,n):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})}),this.localParticipant.on(Sa.ERROR,n=>{this.errorManager.handleError(n,xt.PUBLISH_ERROR)}),this.emit(fn.STAGE_PARTICIPANT_JOINED,f)},this.onRemoteParticipantJoined=f=>{if(f.id!==this.token.participantID){const n=function(s){return{id:s.id,userId:s.userId,attributes:s.attributes,capabilities:new Set([go.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:s.videoStopped,audioMuted:s.audioMuted,isPublishing:s.isPublishing}}(f);if(this.participants.has(n.id))return void this.logger.warn({msg:"Remote participant already tracked"});let e=He.NONE;n.capabilities.has(go.SUBSCRIBE)&&(e=Ue.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(n),e),this.updateManagerWithExternalSubscribeConfig(n,"joined"));const t=this.configManager.getSubscribeConfigSnapshot(n.id),o=new jr(n,this.token,this.stageConnection,this.logger.unwrap(),e,t,this.analyticsTracker,f.isPublishing);this.participants.set(n.id,o),this.setupRemoteParticipantListeners(o),this.emit(fn.STAGE_PARTICIPANT_JOINED,o.info),o.updateSubscribeStateIfNecessary(e)}},this.setupRemoteParticipantListeners=f=>{f.on(Ir.SUBSCRIPTION_STATE_CHANGE,n=>{this.onParticipantSubscribeStateChanged(f.info.id,n)}),f.on(Ir.MEDIA_STREAM_ADDED,n=>{const e=this.participants.get(f.info.id);if(e){for(const t of n)this.setupRemoteParticipantStreamEvents(e.info,t);this.emit(fn.STAGE_PARTICIPANT_STREAMS_ADDED,e.info,Sd(n)),this.updateStreamLayerForParticipantInfo(f.info,f.streams)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})}),f.on(Ir.MEDIA_STREAM_REMOVED,n=>{const e=this.participants.get(f.info.id);e?this.emit(fn.STAGE_PARTICIPANT_STREAMS_REMOVED,e.info,Sd(n)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})}),f.on(Ir.MEDIA_STREAM_MUTE_CHANGED,n=>{this.onStreamMuteChange(f.info,n.remote)}),f.on(Ir.ERROR,n=>{this.errorManager.handleError(n,xt.SUBSCRIBE_ERROR)}),f.on(Ir.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,n=>{this.onSeiMessageReceived(f.info,n)})},this.onRemoteParticipantLeft=f=>{if(this.connectionState!==an.CONNECTED)return;const n=this.participants.get(f);n?(n.participantLeave(),n.unsubscribe(),n.cleanup(),this.participants.delete(f),this.emitParticipantLeave(n.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=f=>{this.emit(fn.STAGE_PARTICIPANT_LEFT,f)},this.onRemoteParticipantStateChanged=f=>{const n=this.participants.get(f.id);if(!n)return void this.logger.warn({msg:"Remote participant updated but not tracked"});n.updatePublishState(f.isPublishing)&&this.onPublishStateChanged(n.info,n.publishState),n.updateStreamState(f.audioMuted,f.videoStopped);const e=this.strategyWrapper.shouldSubscribeToParticipant(n.info);if(Ue.isNotOk(e))return;this.updateManagerWithExternalSubscribeConfig(n.info,"updated");const t=this.configManager.getSubscribeConfigSnapshot(n.info.id),o=Ue.getOk_or(e,He.NONE);n.updateSubscribeStateIfNecessary(o,t)},this.onPublishStateChanged=(f,n)=>{this.emit(fn.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,f,n)},this.onParticipantSubscribeStateChanged=(f,n)=>{const e=this.participants.get(f);e?this.emit(fn.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,e.info,n):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=f=>{this.localParticipant&&this.emit(fn.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,f)},this.onLocalStreamsRemoved=f=>{this.localParticipant&&this.emit(fn.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,f)},this.onStreamMuteChange=(f,n)=>{this.emit(fn.STAGE_STREAM_MUTE_CHANGED,f,n)},this.onSeiMessageReceived=(f,n)=>{this.emit(fn.STAGE_STREAM_SEI_MESSAGE_RECEIVED,f,n)},this.leave=()=>{this.cleanup(_a.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var f;this.participants.forEach(n=>{n.quickUnsubscribe()}),(f=this.localParticipant)===null||f===void 0||f.quickUnpublish(),this.stageConnection.disconnect(),this.emit(fn.STAGE_CONNECTION_STATE_CHANGED,an.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=f=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new $a({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:f})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const n=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(n);const e=this.participants.entries();for(const[t,o]of e)o.unsubscribe(),this.participants.delete(t),o.cleanup(),this.emitParticipantLeave(o.info);ho.destroy(this.analyticsTracker.getSessionId()),this.stageConnection.disconnect(),this.emit(fn.STAGE_CONNECTION_STATE_CHANGED,an.DISCONNECTED),this.emit(fn.STAGE_LEFT,f),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach(f=>{if(f.info.capabilities.has(go.SUBSCRIBE)){const n=this.strategyWrapper.shouldSubscribeToParticipant(f.info);if(Ue.isNotOk(n))return;const e=Ue.getOk_or(n,He.NONE);this.updateManagerWithExternalSubscribeConfig(f.info,"updated");const t=this.configManager.getSubscribeConfigSnapshot(f.info.id);f.updateSubscribeStateIfNecessary(e,t),this.updateStreamLayerForParticipantInfo(f.info,f.streams)}}),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var f;if(!this.localParticipant||!(!((f=this.localParticipant)===null||f===void 0)&&f.info.capabilities.has(go.PUBLISH)))return;const n=this.localParticipant.publishState!==Bn.NOT_PUBLISHED&&this.localParticipant.publishState!==Bn.ERRORED,e=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(Ue.isNotOk(e))return;let t=Ue.getOk_or(e,!1);if(!n&&!t)return;if(n&&!t)return void this.localParticipant.unpublish();const o=this.strategyWrapper.stageStreamsToPublish();if(Ue.isNotOk(o)){const h=Ue.getErr(o);if(h instanceof Error&&h.cause==="UserStrategy")throw h;return}const s=Ue.getOk_or(o,[]);t=t&&s.length>0,!n&&t?(this.localParticipant.publish(s),this.onLocalStreamsAdded(s)):this.syncTracksToPublish(s)},this.syncTracksToPublish=f=>{var n;if(!this.localParticipant)return;const e=this.localParticipant.audioStream,t=this.localParticipant.videoStream,{updates:o,streamsToAdd:s,streamsToRemove:h}=this.determineStreamUpdates(e,t,f);if(o.length){for(const y of o)y.newStream?(n=this.localParticipant)===null||n===void 0||n.replaceOrAddTrack(y.newStream):y.oldStream&&this.localParticipant.removeTrack(y.oldStream);h.length!==0&&this.onLocalStreamsRemoved(h),s.length!==0&&this.onLocalStreamsAdded(s)}},this.determineStreamUpdates=(f,n,e=[])=>{const t=[],o=e.slice(0,2);if(o.sort((y,T)=>y.streamType===ht.AUDIO?-1:1),o.length===0)f&&t.push({oldStream:f}),n&&t.push({oldStream:n});else if(o.length===1){const y=o[0];y.streamType===ht.AUDIO?n&&t.push({oldStream:n}):y.streamType===ht.VIDEO&&f&&t.push({oldStream:f})}o.forEach(y=>{var T,P;y.streamType===ht.AUDIO?f?f.id===y.id&&(0,Sn.isEqual)(f.mediaConfig,y.mediaConfig)||(!!(!((T=f.mediaConfig)===null||T===void 0)&&T.stereo)!=!!(!((P=y.mediaConfig)===null||P===void 0)&&P.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),t.push({oldStream:f,newStream:y})):t.push({newStream:y}):y.streamType===ht.VIDEO&&(n?n.id===y.id&&(0,Sn.isEqual)(n.mediaConfig,y.mediaConfig)||t.push({oldStream:n,newStream:y}):t.push({newStream:y}))});const s=t.map(y=>y.newStream).filter(Js),h=t.map(y=>y.oldStream).filter(Js);return{updates:t,streamsToAdd:s,streamsToRemove:h}},this.onReassignmentMessage=f=>ss(this,void 0,void 0,function*(){if(jn("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!ko.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const n=Nr();this.trackReassignmentRequest(f,n);const e=this.participants.get(f.remoteParticipantId),t=this.token.participantID,o=function(s,{localParticipantId:h,remoteParticipant:y}){const{participantId:T}=s;if(h!==T)return Ue.err(Object.assign(Object.assign({},_e.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${T}`}));if(!y)return Ue.err(Object.assign(Object.assign({},_e.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${y}`}));if(y.isReassigning())return Ue.err(_e.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const P=y.subscription.peerClient.getConnectionState();return[Je.CONNECTED,Je.DISCONNECTED].includes(P)?Ue.ok(y):Ue.err(Object.assign(Object.assign({},_e.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${P}`}))}(f,{localParticipantId:t,remoteParticipant:e});if(!o.ok)this.trackReassignmentRequestRejected(o.error,n);else try{const{token:s,nodeOverride:h}=f;yield o.value.triggerIceRestart({assignmentToken:s,traceId:n,nodeOverride:h})}catch(s){this.logger.error({msg:"Reassignment failed.",err:s})}}),this.onIncompatibleCodecsMessage=f=>ss(this,void 0,void 0,function*(){var n;yield(n=this.localParticipant)===null||n===void 0?void 0:n.onIncompatibleCodecs(f.codecs)}),this.analyticsTracker=new bc;const l=iu();this.logger=new mt(new We(l),Be.STAGE),this.strategyWrapper=new Pl(c,this.logger),this.configManager=new Oh({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:Cr.DEFAULT,minDelayWhenSubscribeOnly:Cr.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:Ds.LOWEST_QUALITY,layerPollingEnabled:!0,layerPollingIntervalMs:3e3}}}),this.errorManager=new Ol(this.logger.unwrap());try{this.token=gu(i,this.analyticsTracker)}catch(f){const n=new ct(Object.assign({action:Oe.JOIN,token:i,traceId:Nr(),tag:ao,location:"Stage.constructor"},_e.MALFORMED_TOKEN));throw f instanceof Error&&(n.details=f.message),this.errorManager.handleError(n,xt.JOIN_ERROR)||f}this.stageConnection=new Uc(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(qn,(i,c)=>{this.onConnectionStateChanged(i,c)}),this.stageConnection.on(fu,i=>{this.onRemoteParticipantJoined(i)}),this.stageConnection.on(la,i=>{this.onRemoteParticipantLeft(i.id)}),this.stageConnection.on(So,i=>{var c;i.id!==((c=this.localParticipant)===null||c===void 0?void 0:c.info.id)&&this.onRemoteParticipantStateChanged(i)}),this.stageConnection.on(ci,i=>ss(this,void 0,void 0,function*(){yield this.onReassignmentMessage(i)})),this.stageConnection.on(Nn,i=>ss(this,void 0,void 0,function*(){yield this.onIncompatibleCodecsMessage(i)})),this.stageConnection.on(Rs,i=>{i instanceof ct&&this.analyticsTracker.trackError(i),this.errorManager.handleError(i,xt.JOIN_ERROR)}),this.errorManager.on(Hu.ERROR,i=>{this.emit(fn.ERROR,i)})}setupRemoteParticipantStreamEvents(i,c){const l=c.remote;c.on(Rt.ADAPTION_CHANGED,f=>{this.emit(fn.STAGE_STREAM_ADAPTION_CHANGED,i,l,f)}),c.on(Rt.LAYERS_CHANGED,f=>{this.emit(fn.STAGE_STREAM_LAYERS_CHANGED,i,l,f),this.updateStreamLayerForParticipantInfo(i,[c])}),c.on(Rt.LAYER_SELECTED,(f,n)=>{this.emit(fn.STAGE_STREAM_LAYER_SELECTED,i,l,f,n)}),c.layers.length>0&&(this.emit(fn.STAGE_STREAM_LAYERS_CHANGED,i,l,l.getLayers()),this.emit(fn.STAGE_STREAM_LAYER_SELECTED,i,l,l.getSelectedLayer(),os.SELECTED))}join(){return ss(this,void 0,void 0,function*(){this.analyticsTracker.start(),this.joinTraceId=Nr(),this.analyticsTracker.trackEvent(new Ch({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(Nr(),ao,"join")}catch(i){throw this.errorManager.handleError(i,xt.JOIN_ERROR)||i}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===an.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(i){throw this.logger.error({err:i,msg:"error joining stage"}),this.errorManager.handleError(i,xt.JOIN_ERROR,!1)||i}})}replaceStrategy(i){this.strategyWrapper.setStrategy(i),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(i,c){var l;const f=Ue.getOk(this.strategyWrapper.subscribeConfiguration(i)),n=Ue.getOk(this.getRemoteSubscribeConfiguration()),e=this.getInternalSubscribeOverrides(),t=i.id;let o=!1;f&&(o=this.configManager.handleExternalSubscribeConfigUpdate(t,f,ba.API));let s=!1;n&&(s=this.configManager.handleSubscribeConfigUpdate(t,n,ba.REMOTE));let h=!1;if(e&&(h=this.configManager.handleSubscribeConfigUpdate(t,e,ba.INTERNAL)),o||s||h){const y=this.configManager.getSubscribeConfigSnapshot(t);this.analyticsTracker.trackEventNoSharedProps(new ld(this.token,(l=this.joinTraceId)!==null&&l!==void 0?l:Nr(),c==="joined"?"initial":"ad-hoc",t,y))}}getRemoteSubscribeConfiguration(){return Ue.err("todo")}getInternalSubscribeOverrides(){const i=this.strategyWrapper.hasStrategy("preferredLayerForStream"),c=this.hasListenersFor(fn.STAGE_STREAM_LAYERS_CHANGED)||this.hasListenersFor(fn.STAGE_STREAM_ADAPTION_CHANGED)||this.hasListenersFor(fn.STAGE_STREAM_LAYER_SELECTED);return{simulcast:{layerPollingEnabled:i||c}}}updateStreamLayerForParticipantInfo(i,c){c.forEach(l=>{if(l.streamType==="audio")return;const f=this.strategyWrapper.preferredLayerForStream(i,l.remote),n=Ue.getOk_or(f,void 0);l.setLayer(n)})}trackReassignmentRequestRejected(i,c){const{token:l}=this,f=new ct(Object.assign(Object.assign({},i),{token:l,action:Oe.JOIN,traceId:c,tag:qr,location:"publish"}));this.logger.error({err:f,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(f)}trackReassignmentRequest(i,c){const{token:l}=this;this.analyticsTracker.trackEvent(new Ah({token:l,traceId:c,targetLocalParticipantId:i.participantId,targetRemoteParticipantId:i.remoteParticipantId}))}}var _a;(function(u){u.UNKNOWN="unknown",u.USER_INITIATED="user-initiated",u.TOKEN_REUSED="token-reused",u.PARTICIPANT_DISCONNECTED="participant-disconnected",u.STAGE_DELETED="stage-deleted"})(_a||(_a={}));const Mh=I})(),R})())})(l0);var hr=l0.exports;class YT{constructor(a,d){yt(this,"config");yt(this,"callbacks");yt(this,"localStreams",[]);yt(this,"localStream",null);yt(this,"isPublishing",!1);yt(this,"isLocalAudioEnabled",!0);yt(this,"isLocalVideoEnabled",!0);this.config=a,this.callbacks=d}async startPublishing(){var a,d,p,g;try{if(this.localStream&&(this.localStream.getTracks().forEach(R=>R.stop()),this.localStream=null),this.localStreams.forEach(R=>{var E;return(E=R.mediaStreamTrack)==null?void 0:E.stop()}),this.localStreams=[],this.config.videoInputDeviceId){const E=(await HT(this.config.videoInputDeviceId,((d=(a=this.config)==null?void 0:a.canvasConfig)==null?void 0:d.width)||640,((g=(p=this.config)==null?void 0:p.canvasConfig)==null?void 0:g.height)||480)).getVideoTracks()[0];if(E){const w=this.config.enableInBandMessaging!==!1?{inBandMessaging:{enabled:!0}}:void 0;E.enabled=this.isLocalVideoEnabled,this.localStreams.push(new hr.LocalStageStream(E,w))}}if(this.config.audioInputDeviceId){const E=(await Ug(this.config.audioInputDeviceId)).getAudioTracks()[0];E&&(E.enabled=this.isLocalAudioEnabled,this.localStreams.push(new hr.LocalStageStream(E)))}this.localStreams.length>0&&(this.localStream=new MediaStream(this.localStreams.map(R=>R.mediaStreamTrack).filter(R=>R)),this.callbacks.onLocalStreamReady&&this.callbacks.onLocalStreamReady(this.localStream)),this.isPublishing=!0,this.callbacks.onPublishingStarted&&this.callbacks.onPublishingStarted()}catch(R){throw console.error("Failed to start publishing:",R),this.callbacks.onError&&this.callbacks.onError(R),R}}stopPublishing(){this.localStream&&(this.localStream.getTracks().forEach(a=>a.stop()),this.localStream=null),this.localStreams.forEach(a=>{var d;return(d=a.mediaStreamTrack)==null?void 0:d.stop()}),this.localStreams=[],this.isLocalAudioEnabled=!0,this.isLocalVideoEnabled=!0,this.callbacks.onAudioToggled&&this.callbacks.onAudioToggled(!0),this.callbacks.onVideoToggled&&this.callbacks.onVideoToggled(!0),this.isPublishing=!1,this.callbacks.onPublishingStopped&&this.callbacks.onPublishingStopped()}toggleVideo(){this.setLocalVideoEnabled(!this.isLocalVideoEnabled)}toggleAudio(){this.setLocalAudioEnabled(!this.isLocalAudioEnabled)}setLocalAudioEnabled(a){var p;this.isLocalAudioEnabled=a;const d=(p=this.localStreams.find(g=>{var R;return((R=g.mediaStreamTrack)==null?void 0:R.kind)==="audio"}))==null?void 0:p.mediaStreamTrack;a&&!d&&this.config.audioInputDeviceId?Ug(this.config.audioInputDeviceId).then(g=>{const R=g.getAudioTracks()[0];R&&(this.localStreams.push(new hr.LocalStageStream(R)),this.localStream?this.localStream.addTrack(R):this.localStream=new MediaStream([R]),this.callbacks.onAudioToggled&&this.callbacks.onAudioToggled(!0))}).catch(()=>{this.callbacks.onAudioToggled&&this.callbacks.onAudioToggled(!1)}):d&&(d.enabled=a,this.callbacks.onAudioToggled&&this.callbacks.onAudioToggled(a))}setLocalVideoEnabled(a){if(this.isLocalVideoEnabled=a,!this.localStream)return;const d=this.localStream.getVideoTracks()[0];d&&(d.enabled=a,this.callbacks.onVideoToggled&&this.callbacks.onVideoToggled(a))}getStreams(){return this.localStreams.filter(d=>{const p=d.mediaStreamTrack;return p?p.kind==="audio"?this.isLocalAudioEnabled&&p.enabled&&p.readyState==="live":this.isLocalVideoEnabled&&p.enabled&&p.readyState==="live":(console.log("Stream has no mediaStreamTrack"),!1)})}getRawVideoStream(){return this.localStreams.find(a=>{var d;return((d=a.mediaStreamTrack)==null?void 0:d.kind)==="video"})??null}shouldPublish(){return this.config.role==="admin"||this.config.role==="user"&&this.isPublishing}getLocalStream(){return this.localStream}}class JT{constructor(a,d,p){yt(this,"config");yt(this,"callbacks");yt(this,"mediaManager");yt(this,"canvases",new Map);yt(this,"resizeObservers",new Map);yt(this,"animationFrameId",null);yt(this,"lastRender",0);yt(this,"targetFps",15);yt(this,"isSafari",/Safari/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent));this.config=a,this.callbacks=d,this.mediaManager=p}addParticipant(){this.startRenderLoop()}removeParticipant(a){this.removeCanvas(a),this.canvases.size===0&&this.stopRenderLoop()}createCanvas(a,d){var S,b,I;const p=document.createElement("canvas");p.id=`participant-canvas-${a}`,p.style.width="100%",p.style.height="100%",p.style.display="block",p.style.objectFit="cover",p.style.transform="scaleX(-1)",(S=this.config.canvasConfig)!=null&&S.style&&Object.assign(p.style,this.config.canvasConfig.style);const g=window.devicePixelRatio||1,R=d.getBoundingClientRect(),E=(R.width||((b=this.config.canvasConfig)==null?void 0:b.width)||640)*g,w=(R.height||((I=this.config.canvasConfig)==null?void 0:I.height)||480)*g;p.width=E,p.height=w;const m=p.getContext("2d");return m&&(m.scale(g,g),m.imageSmoothingEnabled=!0,m.imageSmoothingQuality=this.isSafari?"medium":"high"),this.canvases.set(a,p),d.appendChild(p),this.setupResizeObserver(a,p,d),this.callbacks.onParticipantCanvasCreated&&this.callbacks.onParticipantCanvasCreated(a,p),p}removeCanvas(a){const d=this.resizeObservers.get(a);d&&(d.disconnect(),this.resizeObservers.delete(a));const p=this.canvases.get(a);p&&p.parentNode&&p.parentNode.removeChild(p),this.canvases.delete(a),this.callbacks.onParticipantCanvasRemoved&&this.callbacks.onParticipantCanvasRemoved(a)}setupResizeObserver(a,d,p){const g=()=>{var I,_;const E=window.devicePixelRatio||1,w=p.getBoundingClientRect(),m=(w.width||((I=this.config.canvasConfig)==null?void 0:I.width)||640)*E,S=(w.height||((_=this.config.canvasConfig)==null?void 0:_.height)||480)*E;d.width=m,d.height=S;const b=d.getContext("2d");b&&(b.scale(E,E),b.imageSmoothingEnabled=!0,b.imageSmoothingQuality=this.isSafari?"medium":"high")};if(g(),typeof ResizeObserver>"u"){console.warn("ResizeObserver is not supported, falling back to window resize listener");const E=()=>g();window.addEventListener("resize",E),this.resizeObservers.set(a,{disconnect:()=>window.removeEventListener("resize",E),observe:()=>{},unobserve:()=>{}});return}const R=new ResizeObserver(()=>g());R.observe(p),this.resizeObservers.set(a,R)}startRenderLoop(){if(this.animationFrameId)return;const a=()=>{const d=performance.now();if(d-this.lastRender<1e3/this.targetFps){this.animationFrameId=requestAnimationFrame(a);return}this.lastRender=d,this.canvases.forEach((p,g)=>this.renderCanvas(g,p)),this.animationFrameId=requestAnimationFrame(a)};this.animationFrameId=requestAnimationFrame(a)}stopRenderLoop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}renderCanvas(a,d){const p=d.getContext("2d");if(!p)return;const g=window.devicePixelRatio||1,R=d.width/g,E=d.height/g;p.clearRect(0,0,R,E),p.fillStyle="#3c4043",p.fillRect(0,0,R,E);const w=this.mediaManager.media.get(a),m=w==null?void 0:w.videoElement;if(m&&m.videoWidth>0&&m.videoHeight>0&&m)try{const b=Math.min(R/m.videoWidth,E/m.videoHeight),I=m.videoWidth*b,_=m.videoHeight*b,A=(R-I)/2,C=(E-_)/2;p.drawImage(m,A,C,I,_)}catch(b){console.warn(`Failed to draw video for ${a}:`,b)}else p.drawImage(new Image,0,0,R,E)}getCanvases(){return new Map(this.canvases)}getCanvas(a){return this.canvases.get(a)||null}cleanup(){this.canvases.forEach((a,d)=>this.removeCanvas(d)),this.stopRenderLoop()}}class XT{constructor(a,d,p,g){yt(this,"config");yt(this,"callbacks");yt(this,"publishManager");yt(this,"subscriptionManager");yt(this,"stage",null);yt(this,"handlers",{});this.config=a,this.callbacks=d,this.publishManager=p,this.subscriptionManager=g}setEventHandlers(a){this.handlers=a}async initialize(){try{this.stage=new hr.Stage(this.config.token,this.createStrategy()),this.registerEvents(),await this.stage.join()}catch(a){throw console.error("Stage initialization failed:",a),a}}createStrategy(){return{stageStreamsToPublish:()=>this.publishManager.getStreams(),shouldPublishParticipant:()=>this.publishManager.shouldPublish(),shouldSubscribeToParticipant:a=>this.subscriptionManager.getSubscribeType(a),subscribeConfiguration:this.config.enableInBandMessaging!==!1?()=>({inBandMessaging:{enabled:!0}}):void 0}}registerEvents(){this.stage&&(this.handlers.onConnectionStateChanged&&this.stage.on(hr.StageEvents.STAGE_CONNECTION_STATE_CHANGED,this.handlers.onConnectionStateChanged),this.handlers.onParticipantJoined&&this.stage.on(hr.StageEvents.STAGE_PARTICIPANT_JOINED,this.handlers.onParticipantJoined),this.handlers.onParticipantLeft&&this.stage.on(hr.StageEvents.STAGE_PARTICIPANT_LEFT,this.handlers.onParticipantLeft),this.handlers.onParticipantStreamsAdded&&this.stage.on(hr.StageEvents.STAGE_PARTICIPANT_STREAMS_ADDED,this.handlers.onParticipantStreamsAdded),this.handlers.onParticipantStreamsRemoved&&this.stage.on(hr.StageEvents.STAGE_PARTICIPANT_STREAMS_REMOVED,this.handlers.onParticipantStreamsRemoved),this.handlers.onStreamSeiMessageReceived&&this.config.enableInBandMessaging!==!1&&this.stage.on(hr.StageEvents.STAGE_STREAM_SEI_MESSAGE_RECEIVED,this.handlers.onStreamSeiMessageReceived))}unregisterEvents(){this.stage&&(this.handlers.onConnectionStateChanged&&this.stage.off(hr.StageEvents.STAGE_CONNECTION_STATE_CHANGED,this.handlers.onConnectionStateChanged),this.handlers.onParticipantJoined&&this.stage.off(hr.StageEvents.STAGE_PARTICIPANT_JOINED,this.handlers.onParticipantJoined),this.handlers.onParticipantLeft&&this.stage.off(hr.StageEvents.STAGE_PARTICIPANT_LEFT,this.handlers.onParticipantLeft),this.handlers.onParticipantStreamsAdded&&this.stage.off(hr.StageEvents.STAGE_PARTICIPANT_STREAMS_ADDED,this.handlers.onParticipantStreamsAdded),this.handlers.onParticipantStreamsRemoved&&this.stage.off(hr.StageEvents.STAGE_PARTICIPANT_STREAMS_REMOVED,this.handlers.onParticipantStreamsRemoved),this.handlers.onStreamSeiMessageReceived&&this.stage.off(hr.StageEvents.STAGE_STREAM_SEI_MESSAGE_RECEIVED,this.handlers.onStreamSeiMessageReceived))}refreshStrategy(){try{this.stage?this.stage.refreshStrategy():console.error("Stage is null, cannot refresh strategy")}catch(a){console.error("Failed to refresh strategy:",a)}}leave(){var a;this.unregisterEvents(),(a=this.stage)==null||a.leave(),this.stage=null}handleConnectionStateChanged(a){if(a===hr.StageConnectionState.CONNECTED&&this.callbacks.onConnected){this.callbacks.onConnected();return}if(a===hr.StageConnectionState.DISCONNECTED&&this.callbacks.onDisconnected){this.callbacks.onDisconnected();return}a===hr.StageConnectionState.ERRORED&&this.callbacks.onError&&this.callbacks.onError(new Error("Stage connection errored"))}}class QT{constructor(a,d,p){yt(this,"callbacks");yt(this,"mediaManager");yt(this,"participantManager");yt(this,"intervalId",null);this.callbacks=a,this.mediaManager=d,this.participantManager=p}start(){this.stop(),this.intervalId=window.setInterval(()=>{this.mediaManager.media.forEach((a,d)=>{const p=this.participantManager.getSelfId();if(d===p)return;const{analyser:g,volume:R}=a;if(!g)return;const E=new Uint8Array(g.fftSize);g.getByteTimeDomainData(E);let w=0;for(let S=0;S<E.length;S++){const b=(E[S]-128)/128;w+=b*b}const m=Math.min(1,Math.sqrt(w/E.length)*2);a.volume=R*.6+m*.4,Math.abs(a.volume-R)>.02&&this.callbacks.onParticipantVolumeChanged&&this.callbacks.onParticipantVolumeChanged(d,a.volume)})},500)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}}class ZT{constructor(){yt(this,"subscriptions",new Map)}setSubscription(a,d){const p=this.subscriptions.get(a)||{video:!0,audio:!0};this.subscriptions.set(a,{video:d.video??p.video,audio:d.audio??p.audio})}getSubscription(a){return this.subscriptions.get(a)||null}removeSubscription(a){this.subscriptions.delete(a)}getSubscribeType(a){const d=this.getSubscription(a.id)||{video:!0,audio:!0};return d.video&&d.audio||d.video?hr.SubscribeType.AUDIO_VIDEO:d.audio?hr.SubscribeType.AUDIO_ONLY:hr.SubscribeType.NONE}}class eR{constructor(a,d={}){yt(this,"config");yt(this,"callbacks");yt(this,"stageManager");yt(this,"publishManager");yt(this,"participantManager");yt(this,"subscriptionManager");yt(this,"mediaManager");yt(this,"commandManager");yt(this,"renderManager");yt(this,"statusMonitor");this.config=a,this.callbacks=d,this.subscriptionManager=new ZT,this.publishManager=new YT(this.config,this.callbacks),this.participantManager=new KT(this.publishManager),this.mediaManager=new qT(this.callbacks,this.subscriptionManager,this.participantManager),this.stageManager=new XT(this.config,this.callbacks,this.publishManager,this.subscriptionManager),this.commandManager=new zT(this.config,this.callbacks,this.publishManager,this.mediaManager,this.participantManager),this.renderManager=new JT(this.config,this.callbacks,this.mediaManager),this.statusMonitor=new QT(this.callbacks,this.mediaManager,this.participantManager),this.stageManager.setEventHandlers({onConnectionStateChanged:this.stageManager.handleConnectionStateChanged.bind(this.stageManager),onParticipantJoined:this.handleParticipantJoined.bind(this),onParticipantLeft:this.handleParticipantLeft.bind(this),onParticipantStreamsAdded:this.handleParticipantStreamsAdded.bind(this),onParticipantStreamsRemoved:this.handleParticipantStreamsRemoved.bind(this),onStreamSeiMessageReceived:this.config.enableInBandMessaging!==!1?this.commandManager.handleSeiMessage.bind(this.commandManager):void 0})}async initialize(){try{await this.stageManager.initialize(),this.statusMonitor.start(),this.callbacks.onInitialized&&this.callbacks.onInitialized()}catch(a){throw this.callbacks.onError&&this.callbacks.onError(a),a}}async startPublishing(){await this.publishManager.startPublishing(),this.stageManager.refreshStrategy()}stopPublishing(){this.publishManager.stopPublishing(),this.updateParticipantStatus()}toggleVideo(){this.publishManager.toggleVideo(),this.updateParticipantStatus()}toggleAudio(){this.publishManager.toggleAudio(),this.updateParticipantStatus()}setLocalAudioEnabled(a){this.publishManager.setLocalAudioEnabled(a),this.updateParticipantStatus()}setLocalVideoEnabled(a){this.publishManager.setLocalVideoEnabled(a),this.updateParticipantStatus()}getParticipants(){return this.participantManager.getParticipants()}getSelfId(){return this.participantManager.getSelfId()}leaveStage(){this.publishManager.stopPublishing(),this.stageManager.leave(),this.statusMonitor.stop(),this.renderManager.cleanup(),this.mediaManager.cleanupAll(),this.participantManager.clear(),this.callbacks.onStageLeft&&this.callbacks.onStageLeft()}setParticipantSubscription(a,d){this.subscriptionManager.setSubscription(a,d),this.mediaManager.updateSubscription(a),this.stageManager.refreshStrategy()}getParticipantSubscription(a){return this.subscriptionManager.getSubscription(a)}muteParticipantAudio(a){this.commandManager.muteAudio(a)}unmuteParticipantAudio(a){this.commandManager.unmuteAudio(a)}muteParticipantVideo(a){this.commandManager.muteVideo(a)}unmuteParticipantVideo(a){this.commandManager.unmuteVideo(a)}getParticipantVolume(a){return this.mediaManager.getVolume(a)}getParticipantCanvases(){return this.renderManager.getCanvases()}getParticipantCanvas(a){return this.renderManager.getCanvas(a)}createParticipantCanvas(a,d){return this.renderManager.createCanvas(a,d)}removeParticipantCanvas(a){this.renderManager.removeCanvas(a)}async broadcastCommand(a,d){return await this.commandManager.broadcastCommand(a,d)}getLocalStreamStatus(){const a=this.publishManager.getLocalStream(),{hasAudio:d,hasVideo:p}=Rm(a),g=this.participantManager.getSelfId();return{hasAudio:d,hasVideo:p,selfId:g}}updateParticipantStatus(){const{hasAudio:a,hasVideo:d,selfId:p}=this.getLocalStreamStatus(),g={hasAudio:a,hasVideo:d,isActive:a||d,lastUpdated:Date.now()};p&&(this.callbacks.onStreamStatusChanged&&p&&this.callbacks.onStreamStatusChanged(p,g),this.commandManager.broadcastCommand({type:Oi.StatusUpdate,targetParticipantId:p,data:{hasAudio:a,hasVideo:d}}))}handleParticipantJoined(a){this.participantManager.add(a),this.subscriptionManager.setSubscription(a.id,{video:!0,audio:!0}),this.mediaManager.initializeParticipant(a.id),this.renderManager.addParticipant(),this.callbacks.onParticipantJoined&&this.callbacks.onParticipantJoined(a.id,a.attributes)}handleParticipantLeft(a){this.participantManager.remove(a.id),this.subscriptionManager.removeSubscription(a.id),this.mediaManager.cleanup(a.id),this.renderManager.removeParticipant(a.id),this.callbacks.onParticipantLeft&&this.callbacks.onParticipantLeft(a.id)}handleParticipantStreamsAdded(a,d){const p=this.mediaManager.addStreams(a.id,d);this.participantManager.checkSelfParticipant(a,d),this.mediaManager.attachStreams(a.id),this.callbacks.onRemoteStreamAdded&&this.callbacks.onRemoteStreamAdded(p,a.id)}handleParticipantStreamsRemoved(a,d){this.mediaManager.removeStreams(a.id,d)||(this.mediaManager.cleanup(a.id),this.callbacks.onRemoteStreamRemoved&&this.callbacks.onRemoteStreamRemoved(a.id))}}const tR={sdk:null,isInitialized:!1,isConnected:!1,isPublishing:!1,participants:[],settings:{token:"",role:"user",videoDeviceId:"",audioDeviceId:""},error:null};function nR(r,a){switch(a.type){case"SET_SDK":return{...r,sdk:a.payload};case"SET_INITIALIZED":return{...r,isInitialized:a.payload};case"SET_CONNECTED":return{...r,isConnected:a.payload};case"SET_PUBLISHING":return{...r,isPublishing:a.payload};case"ADD_PARTICIPANT":return{...r,participants:[...r.participants.filter(d=>d.id!==a.payload.id),a.payload]};case"REMOVE_PARTICIPANT":return{...r,participants:r.participants.filter(d=>d.id!==a.payload)};case"CLEAR_PARTICIPANTS":return{...r,participants:[]};case"UPDATE_PARTICIPANT":return{...r,participants:r.participants.map(d=>d.id===a.payload.id?{...d,...a.payload.updates}:d)};case"UPDATE_SETTINGS":return{...r,settings:{...r.settings,...a.payload}};case"SET_ERROR":return{...r,error:a.payload};default:return r}}const d0=ae.createContext(void 0),rR=({children:r})=>{const[a,d]=ae.useReducer(nR,tR),p=ae.useCallback(async Q=>{try{if(d({type:"SET_ERROR",payload:null}),a.sdk){try{a.sdk.leaveStage()}catch{console.error("Failed to leave stage")}d({type:"SET_SDK",payload:null}),d({type:"SET_INITIALIZED",payload:!1}),d({type:"SET_CONNECTED",payload:!1}),d({type:"SET_PUBLISHING",payload:!1}),d({type:"CLEAR_PARTICIPANTS"})}const Z={onInitialized:()=>{d({type:"SET_INITIALIZED",payload:!0})},onConnected:()=>{d({type:"SET_CONNECTED",payload:!0})},onDisconnected:()=>{d({type:"SET_CONNECTED",payload:!1})},onAudioToggled:G=>{console.log("onAudioToggled",G)},onVideoToggled:G=>{console.log("onVideoToggled",G)},onParticipantJoined:(G,ie)=>{console.log("Participant joined:",G,ie),d({type:"ADD_PARTICIPANT",payload:{id:G,role:ie==null?void 0:ie.role,isPublishing:!1,volume:0,isMuted:!1,streamStatus:{hasAudio:!1,hasVideo:!1,isActive:!1,lastUpdated:Date.now()}}})},onParticipantLeft:G=>{d({type:"REMOVE_PARTICIPANT",payload:G})},onPublishingStarted:()=>{d({type:"SET_PUBLISHING",payload:!0})},onPublishingStopped:()=>{d({type:"SET_PUBLISHING",payload:!1})},onError:G=>{d({type:"SET_ERROR",payload:G.message})},onParticipantMuted:G=>{d({type:"UPDATE_PARTICIPANT",payload:{id:G,updates:{isMuted:!0}}})},onParticipantUnmuted:G=>{d({type:"UPDATE_PARTICIPANT",payload:{id:G,updates:{isMuted:!1}}})},onStreamStatusChanged:(G,ie)=>{console.log("onStreamStatusChanged",G,ie),d({type:"UPDATE_PARTICIPANT",payload:{id:G,updates:{streamStatus:{hasAudio:ie.hasAudio,hasVideo:ie.hasVideo,isActive:ie.isActive,lastUpdated:ie.lastUpdated}}}})},onRemoteStreamAdded:(G,ie)=>{console.log("Remote stream received:",ie,G);const de=G.getVideoTracks().length>0,ne=G.getAudioTracks().length>0;d({type:"UPDATE_PARTICIPANT",payload:{id:ie,updates:{streamStatus:{hasVideo:de,hasAudio:ne,isActive:de||ne,lastUpdated:Date.now()}}}})},onRemoteStreamRemoved:G=>{console.log("Remote stream removed:",G)},onParticipantVolumeChanged:(G,ie)=>{d({type:"UPDATE_PARTICIPANT",payload:{id:G,updates:{volume:ie}}})},onParticipantCanvasCreated:(G,ie)=>{console.log("Participant canvas created:",G,ie)},onParticipantCanvasRemoved:G=>{console.log("Participant canvas removed:",G)}},Se=new eR(Q,Z);d({type:"SET_SDK",payload:Se}),await Se.initialize()}catch(Z){d({type:"SET_ERROR",payload:Z instanceof Error?Z.message:"Unknown error"})}},[a.sdk]),g=ae.useCallback(async()=>{a.sdk&&await a.sdk.startPublishing()},[a.sdk]),R=ae.useCallback(()=>{a.sdk&&a.sdk.stopPublishing()},[a.sdk]),E=ae.useCallback(()=>{a.sdk&&a.sdk.toggleAudio()},[a.sdk]),w=ae.useCallback(()=>{a.sdk&&a.sdk.toggleVideo()},[a.sdk]),m=ae.useCallback(()=>{a.sdk&&(a.sdk.leaveStage(),d({type:"SET_SDK",payload:null}),d({type:"SET_INITIALIZED",payload:!1}),d({type:"SET_CONNECTED",payload:!1}),d({type:"SET_PUBLISHING",payload:!1}),d({type:"CLEAR_PARTICIPANTS"}),d({type:"UPDATE_SETTINGS",payload:{token:"",role:"user",videoDeviceId:"",audioDeviceId:""}}))},[a.sdk]),S=ae.useCallback(Q=>{d({type:"UPDATE_SETTINGS",payload:Q})},[]),b=ae.useCallback(()=>{d({type:"SET_ERROR",payload:null})},[]),I=ae.useCallback(Q=>{a.sdk&&a.sdk.muteParticipantAudio(Q)},[a.sdk]),_=ae.useCallback(Q=>{a.sdk&&a.sdk.unmuteParticipantAudio(Q)},[a.sdk]),A=ae.useCallback(Q=>{a.sdk&&a.sdk.muteParticipantVideo(Q)},[a.sdk]),C=ae.useCallback(Q=>{a.sdk&&a.sdk.unmuteParticipantVideo(Q)},[a.sdk]),v=ae.useCallback(Q=>a.sdk?a.sdk.getParticipantVolume(Q):0,[a.sdk]),O=ae.useCallback((Q,Z)=>{a.sdk&&a.sdk.setParticipantSubscription(Q,Z)},[a.sdk]),j=ae.useCallback(Q=>{var Z;(Z=a.sdk)==null||Z.broadcastCommand({type:Oi.MuteAudio,targetParticipantId:Q},5)},[a.sdk]),D=ae.useCallback(Q=>{var Z;(Z=a.sdk)==null||Z.broadcastCommand({type:Oi.UnmuteAudio,targetParticipantId:Q},5)},[a.sdk]),x=ae.useCallback(Q=>{var Z;console.log("adminMuteVideoUser",Q),(Z=a.sdk)==null||Z.broadcastCommand({type:Oi.MuteVideo,targetParticipantId:Q},5)},[a.sdk]),N=ae.useCallback(Q=>{var Z;(Z=a.sdk)==null||Z.broadcastCommand({type:Oi.UnmuteVideo,targetParticipantId:Q},5)},[a.sdk]),$=ae.useCallback((Q,Z)=>a.sdk?a.sdk.createParticipantCanvas(Q,Z):null,[a.sdk]),H=ae.useCallback(Q=>{a.sdk&&a.sdk.removeParticipantCanvas(Q)},[a.sdk]),K=ae.useCallback(Q=>a.sdk?a.sdk.getParticipantCanvas(Q):null,[a.sdk]),ce={state:a,initializeSdk:p,startPublishing:g,stopPublishing:R,toggleAudio:E,toggleVideo:w,leaveStage:m,updateSettings:S,clearError:b,muteParticipantAudio:I,unmuteParticipantAudio:_,muteParticipantVideo:A,unmuteParticipantVideo:C,adminMuteUser:j,adminUnmuteUser:D,adminMuteVideoUser:x,adminUnmuteVideoUser:N,getParticipantVolume:v,setParticipantSubscription:O,createParticipantCanvas:$,removeParticipantCanvas:H,getParticipantCanvas:K};return ut.jsx(d0.Provider,{value:ce,children:r})},RR=()=>{const r=ae.useContext(d0);if(r===void 0)throw new Error("useCommunication must be used within a CommunicationProvider");return r};function iR(){return ut.jsx(ae.Suspense,{children:ut.jsx(FT,{children:ut.jsx(rR,{children:ut.jsx(Ay,{router:GT})})})})}const wR=Object.freeze(Object.defineProperty({__proto__:null,default:iR},Symbol.toStringTag,{value:"Module"}));export{Uy as $,Xc as A,eC as B,ap as C,Rv as D,Bf as E,Lf as F,Vl as G,Ky as H,gm as I,nn as J,TR as K,X_ as L,F_ as M,cc as N,cR as O,Fv as P,Ju as Q,Jd as R,lc as S,Xy as T,dm as U,oS as V,KS as W,df as X,qS as Y,fp as Z,cr as _,RR as a,Xh as a0,gR as a1,Q_ as a2,tu as a3,f_ as a4,yg as a5,Df as a6,Rg as a7,yR as a8,wg as a9,ER as aa,_R as ab,Ku as ac,vR as ad,pR as ae,Av as af,dR as ag,lf as ah,fR as ai,uR as aj,lR as ak,wR as al,Xi as b,Ne as c,xf as d,Fy as e,ql as f,ii as g,fi as h,eu as i,Ji as j,xv as k,hf as l,Sf as m,$r as n,Rp as o,D_ as p,mR as q,Ef as r,Do as s,fm as t,sR as u,bR as v,SR as w,ZE as x,tE as y,hR as z};
